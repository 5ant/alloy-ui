AUI.add("aui-diagram-builder-impl",function(aH){var at=aH.Lang,c=at.isArray,Q=at.isObject,bb=at.isString,a7=at.isBoolean,p=at.emptyFn,az=aH.WidgetStdMod,bm=aH.Array,ak=function(A){return(A instanceof aH.DiagramBuilderBase);},a8=function(A){return(A instanceof aH.DiagramNode);},K=function(A){return(A instanceof aH.Connector);},Y=function(A){return(A instanceof aH.ArrayList);},bh=function(A){return(A instanceof aH.DataSet);},aM=function(A,bp){var bo=c(bp)?bp:bp.getXY();var bq=c(A)?A:A.getXY();return bm.map(bq,function(bs,br){return Math.max(0,bs-bo[br]);});},aq="activeElement",aK="addAnchor",be="addAnchorMessage",m="addNode",aO="anchor",aI="anchors",g="sourceUID",e="targetUID",aU="radius",aC="anchorsDragConfig",ae="shapeDragConfig",ad="availableField",G="backspace",D="lock",ao="boolean",t="boundingBox",bi="builder",ay="cancel",ba="sources",U="targets",au="visible",aA="canvas",aX="click",bc="closeEvent",N="closeMessage",bf="condition",aF="content",W="controls",aV="controlsToolbar",aT="data",aB="dblclick",aj="delete",aR="deleteConnectorsMessage",r="deleteNodesMessage",a1="description",O="diagram",aE="diagram-builder",aN="diagramNode",I="diagram-node",bg="diagram-node-manager",a4="dragNode",J="editEvent",T="editMessage",Z="editing",a0="end",a="esc",a6="field",w="fields",aL="fieldsDragConfig",aG="fork",am="graphic",a5="height",u="hover",aW="id",x="join",ab="keydown",aD="link",aw="max",af="maxFields",z="maxSources",v="mouseenter",ap="mouseleave",q="name",s="node",aQ="p1",aP="p2",d="parentNode",o="pencil",ax="records",n="recordset",k="region",bj="rendered",S="required",a9="selected",R="shuffle",aa="source",ba="sources",aS="start",an="state",l="target",U="targets",L="task",X="connector",f="type",V="width",bd="wrapper",F="xy",E="zIndex",a3="shape",ag="shapeBoundary",j="shapeInvite",B="boundary",bl="-",i=".",ac="",h="#",P="_",C=aH.getClassName,ah=C(O,bi,aO,s,aw,U),aJ=C(O,bi,aO,u),aZ=C(O,bi,aO,s),M=C(O,bi,aO,s,bd),y=C(O,bi,W),ar=C(O,s),a2=C(O,s,a3,B),b=C(O,s,aF),aY=C(O,s,Z),bk=C(O,s,a9);var av=function(){var bo="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",A="<br/>";aH.all(".aui-diagram-node").each(function(bu){var bp=ac,br=aH.Widget.getByNode(bu),bq=br.get("name"),bt=br.get("boundingBox"),bs=bt.one(".log")||aH.Node.create("<div class=log />").appendTo(bt);bp+=bq+A;br.get(w).each(function(bv){bp+=bo+"a: "+bv.get("id")+A;bv.get("targets").each(function(bw){var bx=bw.get(aN);bw.get("node").setContent(bw.get("id"));bp+=bo+bo+"t: "+bx.get("name")+" (s: "+bw.get("id")+")"+A;});bv.get("sources").each(function(bx){var bw=bx.get(aN);bx.get("node").setContent(bx.get("id"));bp+=bo+bo+"s: "+bw.get("name")+" (t: "+bx.get("id")+")"+A;});});bs.setContent(bp);});};var H=aH.Component.create({NAME:aE,ATTRS:{fieldsDragConfig:{value:null,setter:"_setFieldsDragConfig",validator:Q},graphic:{valueFn:function(){return new aH.Graphic();},validator:Q},strings:{value:{addNode:"Add node",cancel:"Cancel",deleteConnectorsMessage:"Are you sure you want to delete the selected connector(s)?",propertyName:"Property Name",save:"Save",settings:"Settings",value:"Value"}},connector:{setter:"_setConnector",value:null}},EXTENDS:aH.DiagramBuilderBase,FIELDS_TAB:0,SETTINGS_TAB:1,prototype:{selectedConnector:null,selectedNode:null,initializer:function(){var A=this;A.after({render:A.syncConnectionsUI});A.on({cancel:A._onCancel,"drag:drag":A._onDrag,"drag:end":A._onDragEnd,"drop:hit":A._onDropHit,save:A._onSave});A.handlerKeyDown=aH.getDoc().on(ab,aH.bind(A._afterKeyEvent,A));A.dropContainer.delegate(aX,aH.bind(A._onNodeClick,A),i+ar);A.dropContainer.delegate(v,aH.bind(A._onMouseenterAnchors,A),i+aZ);A.dropContainer.delegate(ap,aH.bind(A._onMouseleaveAnchors,A),i+aZ);},renderUI:function(){var A=this;aH.DiagramBuilder.superclass.renderUI.apply(this,arguments);A._renderGraphic();},syncUI:function(){var A=this;aH.DiagramBuilder.superclass.syncUI.apply(this,arguments);A._setupFieldsDrag();A.connector=A.get(X);},syncConnectionsUI:function(){var A=this;A.get(w).each(function(bo){bo.syncConnectionsUI();});},clearFields:function(){var bo=this;var A=[];bo.get(w).each(function(bp){A.push(bp);});bm.each(A,function(bp){bp.destroy();});A=bo.editingConnector=bo.editingNode=bo.selectedNode=null;},closeEditProperties:function(){var A=this;var bo=A.editingNode;var bp=A.tabView;bp.selectTab(aH.DiagramBuilder.FIELDS_TAB);bp.disableTab(aH.DiagramBuilder.SETTINGS_TAB);if(bo){bo.get(t).removeClass(aY);}A.editingConnector=null;A.editingNode=null;},connect:function(bo,bp){var A=this;if(bb(bo)){bo=aH.Widget.getByNode(h+aH.DiagramNode.buildNodeId(bo));}if(bb(bp)){bp=aH.Widget.getByNode(h+aH.DiagramNode.buildNodeId(bp));}if(bo&&bp){bo.connect(bp.toTarget());}return A;},connectAll:function(bo){var A=this;bm.each(bo,function(bp){if(bp.hasOwnProperty(aa)&&bp.hasOwnProperty(l)){A.connect(bp.source,bp.target,bp.connector);}});return A;},createField:function(bo){var A=this;if(!a8(bo)){bo.builder=A;bo.bubbleTargets=A;bo=new (A.getFieldClass(bo.type||s))(bo);}return bo;},deleteSelectedConnectors:function(bp){var bo=this;var A=bo.getStrings();var bq=bo.getSelectedConnectors();if(bq.length&&confirm(A[aR])){bm.each(bq,function(br){});}},deleteSelectedNode:function(){var A=this;var bo=A.selectedNode;if(bo){if(!bo.get(S)){bo.close();}}},eachConnector:function(bp){var A=this;var bo=false;A.get(w).each(function(bq){bq.get(U).each(function(br){bp.call(A,bq.getConnector(br),br,bq);});});},editConnector:function(bo){var A=this;if(bo){var bp=A.tabView;A.closeEditProperties();bp.enableTab(aH.DiagramBuilder.SETTINGS_TAB);bp.selectTab(aH.DiagramBuilder.SETTINGS_TAB);A.propertyList.set(n,bo.getProperties());A.editingConnector=A.selectedConnector=bo;}},editNode:function(bp){var A=this;if(bp){var bo=A.tabView;A.closeEditProperties();bo.enableTab(aH.DiagramBuilder.SETTINGS_TAB);bo.selectTab(aH.DiagramBuilder.SETTINGS_TAB);A.propertyList.set(n,bp.getProperties());bp.get(t).addClass(aY);A.editingNode=A.selectedNode=bp;}},getSelectedConnectors:function(){var A=this;var bo=[];A.eachConnector(function(bp){if(bp.get(a9)){bo.push(bp);
}});return bo;},getFieldClass:function(bp){var A=this;var bo=aH.DiagramBuilder.types[bp];if(bo){return bo;}else{aH.log("The field type: ["+bp+"] couldn't be found.");return null;}},isFieldsDrag:function(bp){var A=this;var bo=A.fieldsDrag;return(bp===bo.dd);},plotField:function(bo){var A=this;if(!bo.get(bj)){bo.render(A.dropContainer);}},unselectConnectors:function(){var A=this;bm.each(A.getSelectedConnectors(),function(bo){bo.set(a9,false);});},unselectNodes:function(){var A=this;var bo=A.selectedNode;if(bo){bo.set(a9,false);}A.selectedNode=null;},select:function(bo){var A=this;A.unselectNodes();A.selectedNode=bo.set(a9,true).focus();},stopEditing:function(){var A=this;A.unselectConnectors();A.unselectNodes();A.closeEditProperties();},toJSON:function(){var A=this;var bo={nodes:[]};A.get(w).each(function(bq){var br=bq.get(q);var bp={transitions:[]};bm.each(bq.SERIALIZABLE_ATTRS,function(bs){bp[bs]=bq.get(bs);});bq.get(w).each(function(bs){bs.get(U).each(function(bt){bp.transitions.push({connector:bs.getConnector(bt).toJSON(),source:br,target:bt.get(aN).get(q)});});});bo.nodes.push(bp);});return bo;},_afterKeyEvent:function(bo){var A=this;if(bo.hasModifier()||aH.getDoc().get(aq).test(":input,td")){return;}if(bo.isKey(a)){A._onEscKey(bo);}else{if(bo.isKey(G)||bo.isKey(aj)){A._onDeleteKey(bo);}}},_onCancel:function(bo){var A=this;A.closeEditProperties();},_onDrag:function(bp){var A=this;var bo=bp.target;if(A.isFieldsDrag(bo)){var bq=aH.Widget.getByNode(bo.get(a4));bq.alignSources();bq.alignTargets();}},_onDragEnd:function(bp){var A=this;var bo=bp.target;if(A.isFieldsDrag(bo)){var bq=aH.Widget.getByNode(bo.get(a4));bq.set(F,bq.getLeftTop());}},_onDropHit:function(bp){var A=this;var bo=bp.drag;if(A.isAvailableFieldsDrag(bo)){var br=bo.get(s).getData(ad);var bq=A.addField({xy:aM(bo.lastXY,A.dropContainer),type:br.get(f),fields:[{}]});A.select(bq);}},_onDeleteKey:function(bo){var A=this;A.deleteSelectedConnectors();A.deleteSelectedNode();bo.halt();},_onEscKey:function(bo){var A=this;A.stopEditing();bo.halt();},_onMouseenterAnchors:function(bo){var A=this;bo.currentTarget.addClass(aJ);},_onMouseleaveAnchors:function(bo){var A=this;bo.currentTarget.removeClass(aJ);},_onNodeClick:function(bo){var A=this;var bp=aH.Widget.getByNode(bo.currentTarget);A.select(bp);A._onNodeEdit(bo);},_onNodeEdit:function(bo){var A=this;if(!bo.target.ancestor(i+b,true)){return;}var bp=aH.Widget.getByNode(bo.currentTarget);if(bp){A.editNode(bp);}},_onSave:function(bp){var A=this;var bo=A.editingNode;var bq=A.editingConnector;var br=A.propertyList.get(n);if(bo){bm.each(br.get(ax),function(bs){var bt=bs.get(aT);bo.set(bt.attributeName,bt.value);});}else{if(bq){bm.each(br.get(ax),function(bs){var bt=bs.get(aT);bq.set(bt.attributeName,bt.value);});}}},_renderGraphic:function(){var A=this;A.get(am).render(A.get(aA));},_setConnector:function(bp){var A=this;if(!K(bp)){var bo=A.get(aA).getXY();bp=new aH.Connector(aH.merge({graphic:A.get(am),lazyDraw:true,p1:bo,p2:bo,shapeHover:null},bp));}return bp;},_setFieldsDragConfig:function(bp){var A=this;var bo=A.dropContainer;return aH.merge({bubbleTargets:A,container:bo,dragConfig:{plugins:[{cfg:{constrain:bo},fn:aH.Plugin.DDConstrained},{cfg:{scrollDelay:150},fn:aH.Plugin.DDWinScroll}]},nodes:i+ar},bp||{});},_setupFieldsDrag:function(){var A=this;A.fieldsDrag=new aH.DD.Delegate(A.get(aL));}}});aH.DiagramBuilder=H;aH.DiagramBuilder.types={};var al=aH.Component.create({NAME:bg,EXTENDS:aH.Base});aH.DiagramNodeManager=new al();var ai=aH.Component.create({NAME:I,EXTENDS:aH.Overlay,});var bn=aH.Component.create({NAME:I,UI_ATTRS:[q,S,a9],ATTRS:{builder:{validator:ak},graphic:{writeOnce:true,validator:Q},shapeBoundary:{validator:Q,value:{height:40,type:"rect",stroke:{weight:10,color:"transparent"},width:40}},shapeInvite:{validator:Q,value:{radius:10,type:"circle",stroke:{weight:5,color:"#ff6600",opacity:0.8},fill:{color:"#ffd700",opacity:0.8}}},sources:{value:null,writeOnce:true,setter:"_setSources"},targets:{value:null,writeOnce:true,setter:"_setTargets"},required:{value:false,validator:a7},description:{value:ac,validator:bb},height:{value:60},name:{valueFn:function(){var A=this;return A.get(f)+(++aH.Env._uidx);},validator:bb},selected:{value:false,validator:a7},strings:{value:{addAnchorMessage:"Add Anchor",closeMessage:"Close",deleteNodesMessage:"Are you sure you want to delete the selected node(s)?",description:"Description",editMessage:"Edit",name:"Name",type:"Type"}},type:{value:s,validator:bb},controlsToolbar:{validator:Q,valueFn:"_valueControlsToolbar"},width:{value:60},zIndex:{value:100},tabIndex:{value:1}},EXTENDS:ai,getNodeByName:function(A){return aH.Widget.getByNode(h+aH.DiagramNode.buildNodeId(A));},buildNodeId:function(A){return aN+P+a6+P+A.replace(/[^a-z0-9.:_-]/ig,"_");},prototype:{boundary:null,connectors:null,isOverBoundary:false,publishedSource:null,CONTROLS_TEMPLATE:'<div class="'+y+'"></div>',SERIALIZABLE_ATTRS:[a1,q,S,f,V,a5,E,F],initializer:function(){var A=this;A.connectors={};A.after({render:A._afterRender});A.publish({boundaryDrag:{defaultFn:A._defBoundaryDrag},boundaryDragEnd:{defaultFn:A._defBoundaryDragEnd},boundaryDragOut:{defaultFn:A._defBoundaryDragOut},boundaryDragOver:{defaultFn:A._defBoundaryDragOver},boundaryDragStart:{defaultFn:A._defBoundaryDragStart},boundaryDrop:{defaultFn:A._defBoundaryDrop},boundaryMouseEnter:{defaultFn:A._defBoundaryMouseEnter},boundaryMouseLeave:{defaultFn:A._defBoundaryMouseLeave}});aH.DiagramNodeManager.on({publishedSource:function(bo){A.publishedSource=bo.source;},sourceReleased:function(bo){A.publishedSource.isOverBoundary=false;A.publishedSource=null;}});A.get(t).addClass(ar+bl+A.get(f));},destructor:function(){var A=this;A.invite.destroy();A.get(am).destroy();A.get(bi).removeField(A);},alignTargets:function(){var A=this;A.get(U).each(aH.bind(A.alignTarget,A));},alignSources:function(){var A=this;A.get(ba).each(aH.bind(A.alignSource,A));},alignSource:function(bo){var A=this;var bp=aH.DiagramNode.getNodeByName(bo.name);if(bp){bp.alignTargets();
}},alignTarget:function(bp){var A=this;var bq=aH.DiagramNode.getNodeByName(bp.name);if(bq){var bo=A.getConnector(bp);if(bo){bo.set(aQ,A._normalizeDiagramNodeXY(A,bp.xy));bo.set(aP,A._normalizeDiagramNodeXY(bq,bp.destXY));}}},getConnector:function(bo){var A=this;return A.connectors[bo.uid];},close:function(){var bo=this;var A=bo.getStrings();if(confirm(A[r])){bo.destroy();}return bo;},getContainer:function(){var A=this;return(A.get(bi).dropContainer||A.get(t).get(d));},getLeftTop:function(){var A=this;return aM(A.get(t),A.getContainer());},getProperties:function(){var A=this;var bo=A.getPropertyModel();bm.each(bo,function(br){var bq=A.get(br.attributeName),bp=at.type(bq);if(bp===ao){bq=String(bq);}br.value=bq;});return bo;},getPropertyModel:function(){var bo=this;var A=bo.getStrings();return[{attributeName:a1,editor:new aH.TextAreaCellEditor(),name:A[a1]},{attributeName:q,editor:new aH.TextCellEditor({validator:{rules:{value:{required:true}}}}),name:A[q]},{attributeName:f,editor:false,name:A[f]}];},renderShapeBoundary:function(){var A=this;var bo=A.boundary=A.get(am).addShape(A.get(ag));bo.end();return bo;},renderShapeInvite:function(){var A=this;var bo=A.invite=A.get(bi).get(am).addShape(A.get(j));bo.set(au,false);bo.end();return bo;},syncConnectionsUI:function(){var A=this;A.get(U).each(aH.bind(A.connect,A));},addNodeSource:function(bp){var A=this;var bo=A.get(ba);bp=A.createSourceOrTargetObj(bp);if(!bo.containsKey(bp.uid)){bp.uid=aH.guid();bo.add(bp.uid,bp);}},createSourceOrTargetObj:function(bp){var A=this;var bo={xy:[0,0],destXY:[0,0],uid:aH.guid()};if(bb(bp)){bo.name=bp;}else{if(Q(bp)){bo=aH.mix(bp,bo);}}return bo;},addNodeTarget:function(bp){var A=this;var bo=A.get(U);bp=A.createSourceOrTargetObj(bp);if(!bo.containsKey(bp.uid)){bp.uid=aH.guid();bo.add(bp.uid,bp);}},removeNodeSource:function(bo){var A=this;return A.get(ba).removeKey(bo.uid);},removeNodeTarget:function(bo){var A=this;return A.get(U).removeKey(bo.uid);},isTargetConnected:function(bo){var A=this;return A.connectors.hasOwnProperty(bo.uid);},toTarget:function(){var A=this;return A.createSourceOrTargetObj({name:A.get(q)});},connect:function(bq){var A=this;var bo=null;bq=A.createSourceOrTargetObj(bq);var br=aH.DiagramNode.getNodeByName(bq.name);if(br){if(!A.isTargetConnected(bq)){var bp=A.createSourceOrTargetObj({name:A.get(q)});br.addNodeSource(bp);A.addNodeTarget(bq);bo=new aH.Connector({graphic:A.get(bi).get(am),sourceUID:bp.uid,targetUID:bq.uid});console.log("CONNECT",bq);A.connectors[bq.uid]=bo;}}A.alignTarget(bq);return bo;},disconnect:function(bp){var A=this;var bo=bp.get(e);var bq=A.get(U).item(bo);var br=aH.DiagramNode.getNodeByName(bq.name);if(br&&A.isTargetConnected(bq)){br.removeNodeSource(bp.get(g));A.removeNodeTarget(bo);bp.destroy();}},_normalizeDiagramNodeXY:function(bq,bo){var A=this;var bp=bq.get(t).getXY();return[bp[0]+bo[0],bp[1]+bo[1]];},_afterRender:function(bo){var A=this;A.setStdModContent(az.BODY,ac,az.AFTER);A._renderGraphic();A._renderControls();},_bindBoundaryEvents:function(){var A=this;A.boundary.detachAll().on({mouseenter:aH.bind(A._onBoundaryMouseEnter,A),mouseleave:aH.bind(A._onBoundaryMouseLeave,A)});},_defBoundaryDrag:function(bq){var A=this;var bp=A.get(bi);var br=A.boundaryDragDelegate.dd.mouseXY;bp.connector.set(aP,br);if(A.isOverBoundary){var bo=A.invite;var bs=bo.get(aU)||0;var br=A.boundaryDragDelegate.dd.mouseXY;if(!bo.get(au)){bo.set(au,true);}bo.setXY([br[0]-bs,br[1]-bs]);}},_defBoundaryDragEnd:function(bo){var A=this;A.get(bi).connector.hide();A.publishedSource.invite.set(au,false);aH.DiagramNodeManager.fire("sourceReleased",{source:A});console.log("_defBoundaryDragEnd",bo);},_defBoundaryDragOut:function(bp){var A=this;var bo=A.publishedSource;bo.isOverBoundary=false;bo.invite.set(au,false);console.log("_defBoundaryDragOut",bp,A.invite);},_defBoundaryDragOver:function(bp){var A=this;var bo=A.publishedSource;if(bo!==A){bo.isOverBoundary=true;}console.log("_defBoundaryDragOver",bp);},_defBoundaryDragStart:function(bp){var A=this;var bo=A.get(bi);var bq=A.boundaryDragDelegate.dd.startXY;bo.connector.show().set(aQ,bq);aH.DiagramNodeManager.fire("publishedSource",{source:A});console.log("_defBoundaryDragStart",bp);},_defBoundaryDrop:function(bo){var A=this;console.log("_defBoundaryDrop",bo);},_defBoundaryMouseEnter:function(bo){var A=this;console.log("_defBoundaryMouseEnter",bo);},_defBoundaryMouseLeave:function(bo){var A=this;console.log("_defBoundaryMouseLeave",bo);},_handleCloseEvent:function(bo){var A=this;if(!A.get(S)){A.close();}},_handleEditEvent:function(bo){var A=this;A.get(bi).editNode(A);},_onBoundaryDrag:function(bo){var A=this;A.fire("boundaryDrag",{dragEvent:bo,source:A.publishedSource});},_onBoundaryDragEnd:function(bp){var A=this;var bo=A.publishedSource;if(bo&&A.isOverBoundary){A.fire("boundaryDrop",{dragEvent:bp,source:bo});}A.fire("boundaryDragEnd",{dragEvent:bp,source:bo});},_onBoundaryDragStart:function(bo){var A=this;A.fire("boundaryDragStart",{dragEvent:bo});},_onBoundaryMouseEnter:function(bp){var A=this;var bo=A.publishedSource;A.fire("boundaryMouseEnter",{domEvent:bp});if(bo){A.fire("boundaryDragOver",{domEvent:bp,source:bo});}},_onBoundaryMouseLeave:function(bp){var A=this;var bo=A.publishedSource;A.fire("boundaryMouseLeave",{domEvent:bp});if(bo){A.fire("boundaryDragOut",{domEvent:bp,source:bo});}},_renderControls:function(){var A=this;var bo=A.get(t);A.controlsNode=aH.Node.create(A.CONTROLS_TEMPLATE).appendTo(bo);},_renderControlsToolbar:function(bo){var A=this;A.controlsToolbar=new aH.Toolbar(A.get(aV)).render(A.controlsNode);A._uiSetRequired(A.get(S));},_renderGraphic:function(){var A=this;A.set(am,new aH.Graphic({height:A.get(a5),render:A.bodyNode,width:A.get(V)}));A.renderShapeInvite();A.renderShapeBoundary().addClass(a2);A._bindBoundaryEvents();A._setupBoundaryDrag();},_setSources:function(bo){var A=this;if(!bh(bo)){bo=A._createDataSet();}return bo;},_setTargets:function(bp){var A=this;if(!bh(bp)){var bo=A._createDataSet();aH.Array.each(bp,function(br){var bq=aH.guid();
br=Q(br)?aH.mix(br,{uid:bq}):{uid:bq,name:br};bo.add(bq,A.createSourceOrTargetObj(br));});bp=bo;}return bp;},_setupBoundaryDrag:function(){var A=this;var bo=A.get(bi);A.boundaryDragDelegate=new aH.DD.Delegate({container:A.bodyNode,nodes:i+a2,dragConfig:{useShim:false,plugins:[{cfg:{constrain:(bo?bo.get(aA):null)},fn:aH.Plugin.DDConstrained},{cfg:{scrollDelay:150},fn:aH.Plugin.DDWinScroll},{cfg:{borderStyle:"0px",moveOnEnd:false,resizeFrame:false},fn:aH.Plugin.DDProxy}]},on:{"drag:drag":aH.bind(A._onBoundaryDrag,A),"drag:end":aH.bind(A._onBoundaryDragEnd,A),"drag:start":aH.bind(A._onBoundaryDragStart,A)}});aH.Do.after(A._bindBoundaryEvents,A.boundaryDragDelegate.dd,"_unprep",A);},_uiSetName:function(bp){var A=this;var bo=A.get(t);bo.set(aW,aH.DiagramNode.buildNodeId(bp));},_uiSetRequired:function(bq){var bp=this;var bo=bp.getStrings();var A=bp.controlsToolbar;if(A){if(bq){A.remove(bc);}else{A.add({handler:aH.bind(bp._handleCloseEvent,bp),icon:ay,id:bc,title:bo[N]});}}},_uiSetSelected:function(bo){var A=this;A.get(t).toggleClass(bk,bo);if(bo&&!A.controlsToolbar){A._renderControlsToolbar();}},_uiSetXY:function(bp){var A=this;var bo=A.getContainer().getXY();this._posNode.setXY([bp[0]+bo[0],bp[1]+bo[1]]);},_createDataSet:function(){var A=this;return new aH.DataSet({bubbleTargets:A});},_valueControlsToolbar:function(bp){var bo=this;var A=bo.getStrings();return{activeState:false,children:[{handler:aH.bind(bo._handleEditEvent,bo),icon:o,id:J,title:A[T]},{handler:aH.bind(bo._handleCloseEvent,bo),icon:ay,id:bc,title:A[N]}]};}}});aH.DiagramNode=bn;aH.DiagramBuilder.types[s]=aH.DiagramNode;aH.DiagramNodeState=aH.Component.create({NAME:I,ATTRS:{height:{value:40},type:{value:an},width:{value:40}},EXTENDS:aH.DiagramNode});aH.DiagramBuilder.types[an]=aH.DiagramNodeState;aH.DiagramNodeCondition=aH.Component.create({NAME:I,ATTRS:{height:{value:60},type:{value:bf},width:{value:60}},EXTENDS:aH.DiagramNodeState,prototype:{renderShapeBoundary:function(){var A=this;var bo=A.boundary=A.get(am).addShape(A.get(ag));bo.translate(10,10);bo.rotate(45);bo.end();return bo;}}});aH.DiagramBuilder.types[bf]=aH.DiagramNodeCondition;aH.DiagramNodeStart=aH.Component.create({NAME:I,ATTRS:{type:{value:aS}},EXTENDS:aH.DiagramNodeState});aH.DiagramBuilder.types[aS]=aH.DiagramNodeStart;aH.DiagramNodeEnd=aH.Component.create({NAME:I,ATTRS:{type:{value:a0}},EXTENDS:aH.DiagramNodeState});aH.DiagramBuilder.types[a0]=aH.DiagramNodeEnd;aH.DiagramNodeJoin=aH.Component.create({NAME:I,ATTRS:{height:{value:60},type:{value:x},width:{value:60}},EXTENDS:aH.DiagramNodeState});aH.DiagramBuilder.types[x]=aH.DiagramNodeJoin;aH.DiagramNodeFork=aH.Component.create({NAME:I,ATTRS:{height:{value:60},type:{value:aG},width:{value:60}},EXTENDS:aH.DiagramNodeState});aH.DiagramBuilder.types[aG]=aH.DiagramNodeFork;aH.DiagramNodeTask=aH.Component.create({NAME:I,ATTRS:{height:{value:70},type:{value:L},width:{value:70}},EXTENDS:aH.DiagramNodeState});aH.DiagramBuilder.types[L]=aH.DiagramNodeTask;},"@VERSION@",{requires:["aui-data-set","aui-diagram-builder-base","aui-diagram-builder-connector","overlay"],skinnable:true});