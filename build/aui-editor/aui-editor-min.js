AUI.add("aui-editor-base",function(a){var c=a.Lang,d="editor";var b=a.Component.create({NAME:d,EXTENDS:a.EditorBase,ATTRS:{toolbarConfig:{value:null}},prototype:{initializer:function(){var e=this;e.publish("toolbar:ready",{fireOnce:true});e.after("ready",function(){e.plug(a.Plugin.EditorToolbar,e.get("toolbarConfig"));e.fire("toolbar:ready");e.focus();});},addCss:function(f){var e=this;e.on("toolbar:ready",function(){var g=e.getInstance();g.Get.css(f);});},addGroup:function(f){var e=this;e.on("toolbar:ready",function(){e.toolbar.addGroup(f);});},addGroupType:function(f,g){var e=this;e.on("toolbar:ready",function(){e.toolbar.addGroupType(f,g);});}}});a.Editor=b;},"@VERSION@",{requires:["aui-base","editor-base","aui-editor-toolbar-plugin"]});AUI.add("aui-editor-tools-plugin",function(b){var e=b.Lang,f=b.UA,g="justify",j={div:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,p:true},l={br:true},c={li:true},d='<div style="text-align: {0};">{1}</div>';function k(n){var o=null;var p=n.get("childNodes");p.some(function(r,q,s){if(r.get("innerHTML")=="{0}"){r.html("");o=r;return true;}return k(r);});return o;}function m(o,p,n){var r=b.Node.create(n);o.insert(r,p);if(r.html()!=""){if(r.html()=="{0}"){r.html("");}else{var q=k(r);if(q){r=q;}}}return r;}function h(p,o){var n=(f.ie?"innerText":"textContent");return(p.get(n)==o.get(n));}var a={};b.mix(b.Plugin.ExecCommand.COMMANDS,{justify:function(q,p){var u=this;var v=u.get("host");var o=v.getInstance();var t=new o.Selection();var s=t.getSelected();var r=false;if(t.isCollapsed||!s.size()){var n=t.anchorTextNode;s=[n];r=true;}b.each(s,function(z,w,B){var x=z.get("tagName");if(x){x=x.toLowerCase();}if(l[x]){return;}if(x=="font"){var A=z.get("parentNode");if(!A.test("body")){z=A;x=z.get("tagName").toLowerCase();}}if(!z.test("body")&&z.getComputedStyle("textAlign")==p){return;}var y=z.get("parentNode");var C;if(j[x]||z.getComputedStyle("display")=="block"){C=z;}else{if(!y.get("childNodes").item(1)||c[x]){x=y.get("tagName").toLowerCase();if(j[x]||y.getComputedStyle("display")=="block"){C=y;}}else{if(r){v.execCommand("inserthtml",e.sub(d,[p,o.Selection.CURSOR]));t.focusCursor(true,true);return;}else{C=b.Node.create(e.sub(d,[p,""]));y.insert(C,z);C.append(z);}}}if(C){C.setStyle("textAlign",p);}});},justifycenter:function(){var n=this;return n.get("host").execCommand(g,"center");},justifyleft:function(){var n=this;return n.get("host").execCommand(g,"left");},justifyright:function(){var n=this;return n.get("host").execCommand(g,"right");},subscript:function(){var n=this;return n.get("host").execCommand("wrap","sub");},superscript:function(){var n=this;return n.get("host").execCommand("wrap","sup");},wraphtml:function(z,H){var E=this;var v=E.get("host");var t=v.getInstance();var G=new t.Selection();var w=G.getSelected();if(!G.isCollapsed&&w.size()){var y;var C;var r;var s;var n;if(w.size()>1){var F;var u;w.each(function(M,I,N){var J=M;var L=0;var K;while((J=J.ancestor())&&!J.test("body")){L++;K=J;}if(u==null||L<u){F=I;u=L;}});var D=w.item(F);var q=(D.test("font")?D.ancestor().ancestor():D.ancestor());var x=[];n=q.get("childNodes");w.each(function(K,I,L){var J=K;var M=-1;if(K.ancestor().test("body")){M=I;}else{while((J=J.ancestor())!=null){n.some(function(N,P,O){if(N==J){M=P;return true;}});if(M!=-1){break;}}}x[I]=M;});if(x.length>1){var o;var B;for(var A=0;A<x.length;A++){if(x[A]!=-1){if(x[A]<o||o==null){o=x[A];y=w.item(A);C=n.item(o);}if(x[A]>B||B==null){B=x[A];r=w.item(A);s=n.item(B);}}else{C=null;break;}}}}if(C!=null&&((C==s)||(h(y,C)&&h(r,s)))){var q=C.ancestor();var p=m(q,C,H);for(var A=o;A<=B;A++){p.append(n.item(A));}}else{w.each(function(L,I,M){var J=L.get("tagName").toLowerCase();if(!l[J]){var K=L.ancestor();var N=m(K,L,H);N.append(L);}});}}else{v.execCommand("inserthtml",e.sub(H,[t.Selection.CURSOR]));if(H.indexOf("{0}")!=-1){G.focusCursor(true,true);}}}});b.Plugin.EditorTools=a;},"@VERSION@",{requires:["aui-base","editor-base"]});AUI.add("aui-editor-menu-plugin",function(d){var l=d.Lang,a=l.isString,f=d.ClassNameManager.getClassName,q="editormenu",c="editormenuplugin",n="menu",r="content",b=f(q,r,"list"),h=f(q,r,"text"),k=f(q,r,"item"),o="<{1}{2}>{0}</{1}>",m='<li class="'+k+'">'+o+"</li>",e='<ul class="'+b+'"></ul>',j='<li class="'+h+'"><span>{0}</span></li>';var g=d.Component.create({NAME:q,EXTENDS:d.OverlayContext,ATTRS:{headerContent:{value:"",setter:function(t){var s=this;s._headerContent=t;return"";}},host:{value:false},items:{value:null}},prototype:{renderUI:function(){var s=this;g.superclass.renderUI.apply(s,arguments);var y=s.get("host");var u=s.get("contentBox");var w=s._headerContent;var v=s.get("items");var x=d.Node.create(e);d.each(v,function(D,B,E){var A="";if(a(D)){A+=l.sub(j,[D]);}else{var z=s._generateTagAttr(D);A+=l.sub(m,[D.label,D.tag,z]);}var C=d.Node.create(A);C.setData(q,D);x.append(C);});var t=new d.Panel({collapsible:false,headerContent:w,icons:[{icon:"close",handler:{fn:s.hide,context:s}}]}).render(u);t.bodyNode.append(x);s._menuList=x;},bindUI:function(){var s=this;g.superclass.bindUI.apply(s,arguments);s._menuList.delegate("click",s._onMenuListItemClick,"."+k,s);},_generateTagAttr:function(y){var s=this;var t=[];var v="";var u=y.attributes;var x=y.styles;if(u){for(var w in u){t.push(" "+w+'="'+u[w]+'"');}}if(x){t=[' style="'];for(var w in x){t.push(w+": "+x[w]+";");}t.push('"');}return t.join("");},_onMenuListItemClick:function(y){var t=this;var x=y.currentTarget;var v=x.getData(q);var s=t._generateTagAttr(v);var u=l.sub(o,["{0}",v.tag,s]);var w=t.get("host");w.execCommand("wraphtml",u);w.focus();t.hide();},_uiSetHeight:function(v){var s=this;var t=s.get("boundingBox");var u=s._menuList;t.setStyle("height","auto");u.setStyle("height",v);},_uiSetWidth:function(v){var s=this;var t=s.get("boundingBox");var u=s._menuList;t.setStyle("width","auto");u.setStyle("width",v);}}});var p=d.Component.create({EXTENDS:d.Plugin.Base,NAME:c,NS:n,prototype:{add:function(t){var s=this;var u=s.get("host");return new g(d.mix({host:u},t)).render();
}}});d.namespace("Plugin").EditorMenu=p;},"@VERSION@",{requires:["aui-base","editor-base","aui-overlay-context","aui-panel","aui-editor-tools-plugin"]});AUI.add("aui-editor-toolbar-plugin",function(t){var ak=t.Lang,E=ak.isArray,u=ak.isFunction,af=t.ClassNameManager.getClassName,J="editortoolbar",ai="toolbar",x="alignment",F="align-left",X="align-inline",w="align-block",aj="align-right",L="color",Q="content",q="font",ae="indent",m="input",S="insert",H="insertimage",Y="insertlink",T="list",y="select",c="source",n="styles",aa="subscript",Z="text",O="circle-check",a="close",ac={backcolor:true,forecolor:true,format:true,insertimage:true,insertlink:true,source:true,styles:true},B=["b","big","font","em","i","small","s","strike","strong","sub","sup","u"],r=af("button","holder"),s=af("field",m),z=af("field",m,"text"),h=af("field","label"),I=af("field","numeric"),o=af(J,"align","node"),C=af(J,H),l=af(J,Y),b=af(J,y,"fontname"),ad=af(J,y,"fontsize"),f=af(J,"size","separator"),j=af(J,c,"textarea"),e=af("state","active"),k=af(J),D=af(J,Q),R='<div class="'+o+'"></div>',p="<a></a>",G="<img />",N='<a href="{0}"{2}>{1}</a>',g='<textarea class="'+j+'"></textarea>',ah='<div class="'+k+'"><div class="'+D+'"></div></div>',V='<div class="'+r+'"></div>',ag='<select class="'+b+'">{0}</select>',v='<option selected="selected"></option>'+"<option>Arial</option>"+"<option>Arial Black</option>"+"<option>Comic Sans MS</option>"+"<option>Courier New</option>"+"<option>Lucida Console</option>"+"<option>Tahoma</option>"+"<option>Times New Roman</option>"+"<option>Trebuchet MS</option>"+"<option>Verdana</option>",W='<select class="'+ad+'">{0}</select>',P='<option selected="selected"></option>'+'<option value="1">10</option>'+'<option value="2">13</option>'+'<option value="3">16</option>'+'<option value="4">18</option>'+'<option value="5">24</option>'+'<option value="6">32</option>'+'<option value="7">48</option>',M='<span class="'+f+'">x</span>';var K=t.Component.create({NAME:J,NS:ai,EXTENDS:t.Plugin.Base,ATTRS:{append:{value:null},groups:{value:[{type:q},{type:Z},{type:L},{type:x},{type:ae},{type:T},{type:S},{type:c}]}},prototype:{initializer:function(){var aB=this;var ar=aB.get("host");var ap=ar.frame.get("container");var az=aB.get("append");var aC=aB.get("groups");var an=t.Node.create(ah);var aq=an.one("."+D);ap.placeBefore(an);aB._boundingBox=an;aB._contentBox=aq;var at=[];if(az!=null&&E(az)){var au=az.length;for(var ax=0;ax<au;ax++){var aA=az[ax];if(aA.index!=null){var al=aB._isGroupIncluded("type",aC,aA.type);if(al!=-1){aC.splice(al,1);}aC.splice(Math.min(aA.index,aC.length),0,aA);}else{aC.push(aA);}}}for(ax=0;ax<aC.length;ax++){var am=aC[ax];var av=U[am.type]||am;var ay=[];if(E(am.include)){var A=am.include.length;for(var aw=0;aw<A;aw++){al=aB._isGroupIncluded("icon",av.children,am.include[aw]);if(al!=-1){ay.push(av.children[al]);}}}else{ay=av.children;}var ao=aB._addGroup(am,av,ay);if(ao){at.push(ao);}}aB._toolbars=at;aq.delegate("click",function(aG){var aE=this;var aF=t.Widget.getByNode(aG.currentTarget);if(aF){var aD=aF.get("icon").split("-");if(!ac[aD[0]]){aE.execCommand(aD[0],(aD[1]?aD[1]:""));aE.focus();}}},"button",ar);},addGroup:function(am){var A=this;var al=U[am.type]||am;A._addGroup(am,al);},addGroupType:function(al,am){var A=this;if(!U[al]){U[al]=am;}},_addGroup:function(ao,av,az){var aC=this;var al=(az==null&&ao.index!=null);az=az||av.children;if(E(az)){var ar=aC.get("host");var aq=aC._contentBox;var am=[];var ap;var au={boundingBox:aC._boundingBox,contentBox:aq};for(var ay=0;ay<az.length;ay++){var A=az[ay];if(!A.select){var aE=YUI.AUI.defaults.EditorToolbar.STRINGS[A._titleKey];A.title=(aE!=null?aE:ab[A._titleKey]);am.push(A);}}if(am.length){ap=new t.Toolbar(t.merge(av.config,ao.toolbar,{children:am})).render(aq);}var aw=av.generate;if(aw&&u(aw.init)){aw.init.call(aC,ar,au);}am=(am.length?am:az);for(ay=0;ay<am.length;ay++){var aB=am[ay];var aA=aB.icon;if(aw&&u(aw[aA])){var aD=(ao.config?ao.config[aA]:null);au.button=(aB.select||!ap?null:ap.item(ay));aw[aA].call(aC,ar,au,aD);}}if(al){var at=aq.get("childNodes");var ax=at.size();var an=ao.index;if(an<ax-1){aq.insert(at.item(ax-1),at.item(an));}}return ap;}return null;},_isGroupIncluded:function(al,an,ao){var A=this;for(var am=0;am<an.length;am++){if(an[am][al]==ao){return am;}}return -1;},_updateToolbar:function(A,aq){var ar=this;if(A.changedNode){var am=A.commands;var at=ar.toolbars;var av=function(ax,aw,az){var ay=!!(am[ax.get("icon")]);ax.StateInteraction.set("active",ay);};if(at){for(var ao=0;ao<at.length;ao++){at[ao].each(av);}}var al=A.fontFamily;var ap=aq._fontNameOptions;var au=A.fontSize;var an=aq._fontSizeOptions;if(ap){ap.item(0).set("selected",true);ap.each(function(ax,aw,az){var ay=ax.get("value").toLowerCase();if(ay===al.toLowerCase()){ax.set("selected",true);}});}if(an){au=au.replace("px","");an.item(0).set("selected",true);an.each(function(ay,ax,aA){var az=ay.get("value").toLowerCase();var aw=ay.get("text");if(aw===au){ay.set("selected",true);}});}}}}});function d(am){var A=this;var ao=am.currentTarget;var al=ao.get("className");var an=al.substring(al.lastIndexOf("-")+1);var ap=ao.get("value");A.execCommand(an,ap);A.focus();}K.generateOverlay=function(an,am,A){var al=new t["OverlayContext"+(A?"Panel":"")](t.merge({align:{node:an,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:an},am)).render();return al;};K.generateColorPicker=function(aq,an,am,ar){var ap=an.button;var al=ap.get("boundingBox");var A=new t.ColorPicker(t.merge({align:{node:al,points:["tl","bl"]},trigger:al},am));if(am&&am.plugins){for(var ao=0;ao<am.plugins.length;ao++){A.plug(am.plugins[ao],am);}}A.render(t.getBody());A.on("colorChange",function(av){var at=this;var au=A.get("rgb");aq.execCommand(ar,au.hex);aq.focus();});};K.openOverlayToAlignNode=function(am,al,an,A){var ap=an.getXY();var ao=A.getXY();ap=[ap[0]+ao[0],ap[1]+ao[1]];al.setStyle("width",A.get("offsetWidth"));al.setStyle("height",A.get("offsetHeight"));al.setXY(ap);al.show();am.set("align",{node:al,points:["tl","bc"]});
am.show();};var ab={ALIGN:"Align",ALIGN_BLOCK:"Block",ALIGN_LEFT:"Left",ALIGN_INLINE:"Inline",ALIGN_RIGHT:"Right",BACKCOLOR:"Background Color",BOLD:"Bold",BORDER:"Border",DESCRIPTION:"Description",EDIT_IMAGE:"Edit Image",EDIT_LINK:"Edit Link",FORECOLOR:"Foreground Color",IMAGE_URL:"Image URL",INDENT:"Indent",INSERT:"Insert",INSERT_IMAGE:"Insert Image",INSERT_LINK:"Insert Link",INSERT_ORDERED_LIST:"Insert Numbered List",INSERT_UNORDERED_LIST:"Insert Bulleted List",ITALIC:"Italic",JUSTIFY_LEFT:"Justify Left",JUSTIFY_CENTER:"Justify Center",JUSTIFY_RIGHT:"Justify Right",LINE_THROUGH:"Line Through",LINK_URL:"Link URL",OPEN_IN_NEW_WINDOW:"Open in new window",OUTDENT:"Outdent",PADDING:"Padding",REMOVE_FORMAT:"Format Source",SAVE:"Save",SIZE:"Size",SOURCE:"Source",SUBSCRIPT:"Subscript",SUPERSCRIPT:"Superscript",STYLES:"Styles",UNDERLINE:"Underline"};if(!YUI.AUI.defaults.EditorToolbar){YUI.AUI.defaults.EditorToolbar={STRINGS:{}};}t.mix(YUI.AUI.defaults.EditorToolbar.STRINGS,ab);var U={};U[x]={children:[{icon:"justifyleft",_titleKey:"JUSTIFY_LEFT"},{icon:"justifycenter",_titleKey:"JUSTIFY_CENTER"},{icon:"justifyright",_titleKey:"JUSTIFY_RIGHT"}]};U[L]={children:[{icon:"forecolor",_titleKey:"FORECOLOR"},{icon:"backcolor",_titleKey:"BACKCOLOR"}],generate:{forecolor:function(an,am,al){var A=this;K.generateColorPicker(an,am,al,"forecolor");},backcolor:function(an,am,al){var A=this;K.generateColorPicker(an,am,al,"backcolor");}}};U[q]={children:[{icon:"fontname",select:true},{icon:"fontsize",select:true}],generate:{init:function(an,am){var A=this;var al=am.contentBox;an.after("nodeChange",function(ap){var ao=this;switch(ap.changedType){case"keyup":case"mousedown":ao._updateToolbar(ap,am);break;}},A);},fontname:function(ap,ao,an){var A=this;var al=ao.contentBox;var aq;var ar=[v];if(an&&an.optionHtml){ar[0]=an.optionHtml;}aq=t.Node.create(ak.sub(ag,ar));al.append(aq);aq.on("change",d,ap);var am=al.all("."+b+" option");ao._fontNameOptions=am;return aq;},fontsize:function(ap,ao,an){var A=this;var al=ao.contentBox;var aq;var ar=[P];if(an&&an.optionHtml){ar[0]=an.optionHtml;}aq=t.Node.create(ak.sub(W,ar));al.append(aq);aq.on("change",d,ap);var am=al.all("."+ad+" option");ao._fontSizeOptions=am;return aq;}}};U[ae]={children:[{icon:"indent",_titleKey:"INDENT"},{icon:"outdent",_titleKey:"OUTDENT"}]};U[S]={children:[{icon:"insertimage",_titleKey:"INSERT_IMAGE"},{icon:"insertlink",_titleKey:"INSERT_LINK"}],generate:{insertimage:function(ao,ax,aG){var aE=this;var A=ax.button;var ar=A.get("boundingBox");var aD=K.generateOverlay(ar,aG,true);var aA=aD.get("contentBox");var av=new t.Panel({collapsible:false,title:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_IMAGE,icons:[{icon:a,handler:{fn:aD.hide,context:aD}}]}).render(aA);aA=av.bodyNode;if(aG&&aG.dataBrowser){aG.dataBrowser.render(aA);}else{var aq;var aH;var aF=new t.Form({cssClass:C,labelAlign:"left"}).render(aA);var au=[{labelText:"none",value:"none"}];for(var aB=1;aB<6;aB++){au.push({labelText:aB+"px",value:aB+"px solid"});}aF.add([{id:"imageURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.IMAGE_URL},{id:"size",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.SIZE,type:"hidden"},{id:"width",labelText:false,cssClass:I},{id:"height",labelText:false,cssClass:I},{id:"padding",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.PADDING},new t.Select({id:"border",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.BORDER,options:au}),{id:"align",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN,type:"hidden"},{id:"description",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.DESCRIPTION},{id:"linkURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);aF.getField("width").get("boundingBox").placeAfter(M);var ap=aF.get("contentBox");var aC=t.Node.create(V);var aw=aF.getField("openInNewWindow");var az=new t.ButtonItem({icon:O,label:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT}).render(aC);az.on("click",function(aJ){var aT=this;var aK;var aN;var aR;if(aq){aN=aq;aR=aq.get("parentNode");if(aR.get("tagName").toLowerCase()=="a"){aK=aR;}}else{aN=t.Node.create(G);}var aM=aF.get("fieldValues");var aS=aM.description;var aO={src:aM.imageURL,title:aS,alt:aS};var aQ={border:aM.border};var aU=parseInt(aM.height,10);var aL=parseInt(aM.width,10);if(!isNaN(aU)){aO.height=aU;}if(!isNaN(aL)){aO.width=aL;}var aP=parseInt(aM.padding,10);if(!isNaN(aP)){aQ.padding=aP;}ay.some(function(aX,aW,aZ){var aV=this;var aY=aX.StateInteraction.get("active");if(aY){aQ.display="";switch(aW){case 0:aO.align="left";break;case 1:aO.align="";break;case 2:aO.align="center";aQ.display="block";break;case 3:aO.align="right";break;}return true;}return false;});aN.setAttrs(aO);aN.setStyles(aQ);var aI=aM.linkURL;if(aI){if(!aK){aK=t.Node.create(p);if(aq){aR.insert(aK,aq);}aK.append(aN);}aK.setAttribute("href",aI);aK.setAttribute("target",(aw.get("node").get("checked")?"_blank":""));aN=aK;}else{if(aq&&aK){aR.insert(aq,aK);aK.remove(true);}}if(!aq&&aH&&aH.anchorNode){aH.anchorNode.append(aN);}aD.hide();});var at=t.Node.create(G);var al=aF.getField("height");var am=aF.getField("width");at.on("load",function(aJ){var aI=aJ.currentTarget;if(!al.get("value")||!am.get("value")){aF.set("values",{height:aI.get("height"),width:aI.get("width")});}});aF.getField("imageURL").get("node").on("blur",function(aI){at.set("src",this.val());});ap.append(aC);var ay=new t.Toolbar({activeState:true,children:[{icon:F,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_LEFT},{icon:X,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_INLINE},{icon:w,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_BLOCK},{icon:aj,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_RIGHT}]});ay.after("buttonitem:click",function(aJ){var aI=aJ.target;ay.each(function(aL,aK,aM){if(aL!=aI){aL.StateInteraction.set("active",false);}});});ay.render(aF.getField("align").get("contentBox"));aD.on("show",function(aI){if(!aH||!aH.anchorNode){var aJ=ao.getInstance();
ao.focus();aH=new aJ.Selection();}});aD.after("hide",function(aI){aF.resetValues();ay.each(function(aK,aJ,aL){aK.StateInteraction.set("active",false);});aw.get("node").set("checked",false);av.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_IMAGE);az.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT);an.hide();aD.set("align",{node:ar,points:["tl","bl"]});aq=null;});var an=t.Node.create(R);an.hide();t.getBody().append(an);ao.on("toolbar:ready",function(){var aI=ao.frame._iframe;var aJ=ao.getInstance();aI.on("mouseout",function(aK){aH=new aJ.Selection();});aJ.one("body").delegate("click",function(aP){var aK=this;if(aq!=aP.currentTarget){var aM=aP.currentTarget;var aO=aM.get("parentNode");var aL=aM.getStyle("borderWidth");var aQ=aM.getStyle("padding");var aR=(aO.get("tagName").toLowerCase()=="a");aF.set("values",{border:(aL?aL+" solid":""),description:aM.get("alt"),height:aM.get("height"),imageURL:aM.get("src"),linkURL:(aR?aO.get("href"):""),width:aM.get("width"),padding:(aQ?parseInt(aQ):"")});var aN=1;switch(aM.getAttribute("align")){case"left":aN=0;break;case"center":aN=2;break;case"right":aN=3;break;}ay.item(aN).StateInteraction.set("active",true);aw.get("node").attr("checked",(aR&&aO.getAttribute("target")=="_blank"));av.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.EDIT_IMAGE);az.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.SAVE);aq=aM;K.openOverlayToAlignNode(aD,an,aI,aM);}},"img");});}},insertlink:function(am,av,aB){var aA=this;var A=av.button;var ao=A.get("boundingBox");var az=K.generateOverlay(ao,aB,true);var ax=az.get("contentBox");var at=new t.Panel({collapsible:false,title:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_LINK,icons:[{icon:a,handler:{fn:az.hide,context:az}}]}).render(ax);ax=at.bodyNode;var ap=am.frame._iframe;var an;var aC;var ar=new t.Form({cssClass:l,labelAlign:"left"}).render(ax);ar.add([{id:"description",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.DESCRIPTION},{id:"linkURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);var aq=ar.get("contentBox");var ay=t.Node.create(V);var au=ar.getField("openInNewWindow");var aw=new t.ButtonItem({icon:O,label:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT}).render(ay);aw.on("click",function(aF){var aD=this;var aE=ar.get("fieldValues");if(an){an.setAttribute("href",aE.linkURL);an.set("innerHTML",aE.description);if(au.get("node").get("checked")){an.setAttribute("target","_blank");}else{an.setAttribute("target","");}}else{am.execCommand("inserthtml",ak.sub(N,[aE.linkURL,aE.description,(au.get("node").get("checked")?' target="_blank"':"")]));}az.hide();});aq.append(ay);az.after("hide",function(aD){ar.resetValues();au.get("node").set("checked",false);at.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.CREATE_LINK);aw.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT);al.hide();az.set("align",{node:ao,points:["tl","bl"]});an=null;});var al=t.Node.create(R);al.hide();t.getBody().append(al);am.on("toolbar:ready",function(){var aD=am.getInstance();aD.one("body").delegate("click",function(aH){var aE=this;if(an!=aH.currentTarget){var aG=aH.currentTarget;if(!aG.one("img")){var aF=aG.get("parentNode");ar.set("values",{description:aG.get("innerHTML"),linkURL:aG.getAttribute("href")});au.get("node").attr("checked",(aG.getAttribute("target")=="_blank"));at.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.EDIT_LINK);aw.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.SAVE);an=aG;K.openOverlayToAlignNode(az,al,ap,aG);}}},"a");});}}};U[T]={children:[{icon:"insertunorderedlist",_titleKey:"INSERT_UNORDERED_LIST"},{icon:"insertorderedlist",_titleKey:"INSERT_ORDERED_LIST"}],generate:{init:function(al){var A=this;al.plug(t.Plugin.EditorLists);}}};U[c]={children:[{icon:"format",_titleKey:"REMOVE_FORMAT"},{icon:"source",_titleKey:"SOURCE"}],generate:{format:function(ao,am,al){var A=this;var an=am.button;an.on("click",function(at){var ap=this;var au=ap.getInstance();var ar=new au.Selection();var aq=ar.getSelected();if(!ar.isCollapsed&&aq.size()){aq.each(function(aB,ax,aC){var av=this;aB.removeAttribute("style");var az=aB.get("innerHTML");az=az.replace(/<([a-zA-Z0-9]*)\b[^>]*>/g,"<$1>");for(var ay=0;ay<B.length;ay++){var aw=new RegExp("(<"+B[ay]+">|<\\/"+B[ay]+">)","ig");az=az.replace(aw,"");}aB.set("innerHTML",az);var aA=aB.get("parentNode");if(!aA.test("body")){aA.removeAttribute("style");}});}},ao);},source:function(aq,ao,an){var A=this;var am=ao.contentBox;var ap=ao.button;var ar;var al=t.Node.create(g);aq.on("toolbar:ready",function(){var at=this;var av=aq.frame;var au=av.get("container");al.hide();au.append(al);});ap._visible=false;ap.on("click",function(ax){var at=this;var ay=aq.frame;var av=ap._visible;if(av){at.set("content",al.val());al.hide();al.val("");ay.show();}else{var aw=ay._iframe;al.val(at.getContent());var au=aw.get("offsetHeight")-al.getPadding("tb");al.setStyle("height",au);ay.hide();al.show();}av=!av;ap._visible=av;am.all("select").attr("disabled",av);am.all("button").attr("disabled",av);ap.get("contentBox").attr("disabled",false);},aq);}}};U[n]={children:[{icon:"styles",_titleKey:"STYLES"}],generate:{styles:function(ap,an,am){var A=this;var ao=an.button;var al=ao.get("boundingBox");ap.plug(t.Plugin.EditorMenu);ap.menu.add(t.merge({align:{node:al,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:al},am));}}};U[aa]={children:[{icon:"subscript",_titleKey:"SUBSCRIPT"},{icon:"superscript",_titleKey:"SUPERSCRIPT"}]};U[Z]={children:[{icon:"bold",_titleKey:"BOLD"},{icon:"italic",_titleKey:"ITALIC"},{icon:"underline",_titleKey:"UNDERLINE"},{icon:"strikethrough",_titleKey:"LINE_THROUGH"}]};t.namespace("Plugin").EditorToolbar=K;},"@VERSION@",{requires:["aui-base","aui-button-item","aui-color-picker","aui-editor-menu-plugin","aui-editor-tools-plugin","aui-form-select","aui-overlay-context-panel","aui-panel","aui-toolbar","createlink-base","editor-lists","editor-base","plugin"]});
AUI.add("aui-editor-bbcode-plugin",function(r){var e=r.Lang,n=e.isArray,o=e.isString,k=r.ClassNameManager.getClassName,j="bbcodeplugin",q="bbcode",m="quote",w=m,p=w+"-content",y=w+"-title",s="\\[(({0})=([^\\]]*))\\]([\\s\\S]*?)\\[\\/{0}\\]",u="\\[({0})\\]([\\s\\S]*?)\\[\\/{0}\\]",d="<{0}(>|\\b[^>]*>)([\\s\\S]*?)</{0}>",f="<(([a-z0-9]+)\\b[^>]*?style=(\"|').*?{0}\\s*:\\s*([^;\"']+);?[^>]*)>([\\s\\S]*?)<(/\\2)>",h="(<[a-z0-9]+[^>]*>|</[a-z0-9]+>)",l='<div class="'+w+'"><div class="'+p+'">',g="</div></div>",c='<div class="'+y+'">$1</div>'+l,t=new RegExp(h,"gi"),v=[{convert:[["br"]],regExp:"<{0}[^>]*>",output:"\n"},{convert:[["&nbsp;"]],regExp:"{0}",output:" "},{convert:[{tags:["font-family"],source:["font"]},{tags:["font-size"],source:["size"]},{tags:["[^a-z-]*color"],source:["color"]}],regExp:f,output:"<$1>[{0}=$4]$5[/{0}]<$6>"},{convert:[{tags:["font-style"],source:["i"]},{tags:["font-weight"],source:["b"]}],regExp:f,output:"<$1>[{0}]$5[/{0}]<$6>"},{convert:[["text-decoration"]],regExp:f,output:function(){var A="";var z=arguments[4].toLowerCase();if(z.indexOf("underline")!=-1){A+="[u]";}else{if(z.indexOf("line-through")!=-1){A+="[s]";}}if(A!=""){return"<"+arguments[1]+">"+A+arguments[5]+A.replace("[","[/")+"<"+arguments[6]+">";}return arguments[0];}},{convert:[["margin-left"]],regExp:f,output:function(){var A="";var B=parseInt(arguments[3],10);if(!isNaN(B)){var C=Math.floor(B/40);for(var z=0;z<C;z++){A+="[indent]";}}A=A+arguments[5]+A.replace(/\[/g,"[/");return"<"+arguments[1]+">"+A+"<"+arguments[6]+">";}},{convert:[{tags:["font","size"],source:["size"]},{tags:["font","face"],source:["font"]}],regExp:"(<{0}\\b[^>]*{1}=(\"|')([^\"']+)(\"|')[^>]*>)([\\s\\S]*?)(</{0}>)",output:"$1[{0}=$3]$5[/{0}]$6"},{convert:[["text-align"]],regExp:f,output:"<$1>[$4]$5[/$4]<$6>"},{convert:[["quote"]],regExp:"<div\\b[^>]*class=(\"|')([^\"']*?)_"+w+"[^\"']*(\"|')[^>]*>([\\s\\S]*?)</div>",output:"$4"},{convert:[["span"]],regExp:d,output:"$2"},{convert:[["blockquote"]],regExp:d,output:"[indent]$2[/indent]"},{convert:[["b"],["strong"]],regExp:d,output:"[b]$2[/b]"},{convert:[["i"],["em"]],regExp:d,output:"[i]$2[/i]"},{convert:[["u"]],regExp:d,output:"[u]$2[/u]"},{convert:[["s"],["strike"]],regExp:d,output:"[s]$2[/s]"},{convert:[["img"]],regExp:"(<a[^>]*>)?<{0}\\b[^>]*src=(\"|')([^\"']+)(\"|')[^>]*>(</a>)?",output:"[img]$3[/img]"},{convert:[["a"]],regExp:"<{0}\\b[^>]*href=(\"|')mailto:([^\"']+)(\"|')[^>]*>([\\s\\S]*?)</{0}>",output:"[email=$2]$4[/email]"},{convert:[["a"]],regExp:"<{0}\\b[^>]*href=(\"|')([^\"']+)(\"|')[^>]*>([\\s\\S]*?)</{0}>",output:"[url=$2]$4[/url]"},{convert:[["center"]],regExp:d,output:"[center]$2[/center]"},{convert:[["ul"]],regExp:d,output:"[list]$2[/list]"},{convert:[["ol"]],regExp:d,output:"[list=1]$2[/list]"},{convert:[["li"]],regExp:d,output:"[*]$2"},{convert:[["code"]],regExp:d,output:"[code]$2[/code]"},{convert:[["div"]],regExp:d,output:"$2\n"},{convert:[["h1"],["h2"],["h3"],["h4"],["h5"],["h6"]],regExp:d,output:"[b]$2[/b]\n"},{convert:[["p"]],regExp:d,output:"\n$2\n"},{convert:[{tags:["list","left|center|right"],source:["list"]}],regExp:"(\\[{0}[^\\]]*\\])\\s*\\[({1})\\]([\\s\\S]*?)\\[/\\2\\]\\s*\\[/{0}\\]",output:"[$2]$1$3[/{0}][/$2]"}],b=[{convert:[{tags:["b"],source:["b"]},{tags:["i"],source:["i"]},{tags:["u"],source:["u"]},{tags:["s"],source:["s"]},{tags:["code"],source:["code"]}],regExp:u,output:"<{0}>$2</{0}>"},{convert:[{tags:["color"],source:["color"]}],regExp:s,output:'<span style="{0}: $3;">$4</span>'},{convert:[{tags:["font"],source:["face"]},{tags:["size"],source:["size"]}],regExp:s,output:'<font {0}="$3">$4</font>'},{convert:[["img"]],regExp:u,output:'<img src="$2" alt="" />'},{convert:[{tags:["email"],source:["mailto:"]},{tags:["url"],source:[""]}],regExp:s,output:'<a href="{0}$3">$4</a>'},{convert:[["list"]],regExp:"\\[({0}(=1)?)]([\\s\\S]*?)\\[\\/{0}\\]",output:function(){var B="";if(arguments[1]=="list=1"){B+="<ol>";}else{B+="<ul>";}var z=e.trim(arguments[3]).split("[*]");for(var A=1;A<z.length;A++){B+="<li>"+z[A]+"</li>";}if(arguments[1]=="list=1"){B+="</ol>";}else{B+="</ul>";}return B;}},{convert:[{tags:["indent"],source:["blockquote"]}],regExp:u,output:"<{0}>$2</{0}>"},{convert:[["left"],["center"],["right"]],regExp:u+"\n?",output:'<div style="text-align: $1;">$2</div>'},{convert:[["\n"]],regExp:"{0}",output:"<br />"}];var x={};x[m]={children:[{icon:"quote",_titleKey:"QUOTE"}]};r.mix(r.Plugin.ExecCommand.COMMANDS,{quote:function(C,D){var z=this;var B=z.get("host");var A=l+"{0}"+g;B.execCommand("wraphtml",A);B.focus();}});if(!YUI.AUI.defaults.EditorToolbar){YUI.AUI.defaults.EditorToolbar={STRINGS:{}};}r.mix(YUI.AUI.defaults.EditorToolbar.STRINGS,{QUOTE:"Quote"});var a=r.Component.create({NAME:j,NS:q,EXTENDS:r.Plugin.Base,ATTRS:{host:{value:false}},prototype:{initializer:function(){var z=this;var A=z.get("host");A.addGroupType(m,x[m]);z.afterHostMethod("getContent",z.getBBCode,z);A.on("contentChange",z._contentChange,z);},getBBCode:function(){var z=this;var C=z.get("host");var D=C.getInstance();var E=D.one("body").cloneNode(true);var A;var B=function(N,H,F){var I;var M=N;do{if(M){I=M;}M=M.one("div."+p);}while(M);var L=I.get("parentNode");if(L.hasClass(m)){var K=L.previous();var J="["+m;if(K&&K.hasClass(y)){var G=K.get("innerHTML");G=G.replace(t,"");J+="="+(G.charAt(G.length-1)==":"?G.substring(0,G.length-1):K.get("innerHTML"));K.remove(true);}J+="]"+I.get("innerHTML")+"[/"+m+"]\n";L.set("innerHTML",J);L.removeClass(m);L.addClass("_"+m);}};while(A=E.all("div."+w)){if(!A.size()){break;}A.each(B);}html=E.get("innerHTML");html=z._parseTagExpressions(v,html);html=html.replace(t,"");return new r.Do.AlterReturn(null,html);},getContentAsHtml:function(){var z=this;var A=z.get("host");return A.constructor.prototype.getContent.apply(A,arguments);},setContentAsBBCode:function(A){var z=this;var B=z.get("host");B.set("content",A);},_contentChange:function(A){var z=this;A.newVal=z._parseBBCode(A.newVal);A.stopImmediatePropagation();},_parseBBCode:function(A){var z=this;var B=A;B=B.replace(/\[quote=([^\]]*)\]/gi,c);
B=B.replace(/\[quote\]/gi,l);B=B.replace(/\[\/quote\]\n?/gi,g);B=z._parseTagExpressions(b,B);return B;},_parseTagExpressions:function(J,F){var I=this;var E;var H;var z;var A;var K;for(var D=0;D<J.length;D++){E=J[D];H=E.convert;A=H.length;for(var C=0;C<A;C++){var B=E.output;z=H[C];if(n(z)){K=z;}else{K=z.tags;if(o(B)){B=e.sub(B,z.source);}}var G=e.sub(E.regExp,K);F=F.replace(new RegExp(G,"gi"),B);}}return F;}}});r.namespace("Plugin").EditorBBCode=a;},"@VERSION@",{requires:["aui-base","editor-base"]});AUI.add("aui-editor-creole-parser",function(a){if(!b){var b={};}if(!b.Simple){b.Simple={};}b.Simple.Base=function(c,d){if(!arguments.length){return;}this.grammar=c;this.grammar.root=new this.ruleConstructor(this.grammar.root);this.options=d;};b.Simple.Base.prototype={ruleConstructor:null,grammar:null,options:null,parse:function(d,e,c){if(c){for(i in this.options){if(typeof c[i]=="undefined"){c[i]=this.options[i];}}}else{c=this.options;}e=e.replace(/\r\n?/g,"\n");this.grammar.root.apply(d,e,c);if(c&&c.forIE){d.innerHTML=d.innerHTML.replace(/\r?\n/g,"\r\n");}}};b.Simple.Base.prototype.constructor=b.Simple.Base;b.Simple.Base.Rule=function(d){if(!arguments.length){return;}for(var c in d){this[c]=d[c];}if(!this.children){this.children=[];}};b.Simple.Base.prototype.ruleConstructor=b.Simple.Base.Rule;b.Simple.Base.Rule.prototype={regex:null,capture:null,replaceRegex:null,replaceString:null,tag:null,attrs:null,children:null,match:function(d,c){return d.match(this.regex);},build:function(f,e,c){var g;if(this.capture!==null){g=e[this.capture];}var h;if(this.tag){h=document.createElement(this.tag);f.appendChild(h);}else{h=f;}if(g){if(this.replaceRegex){g=g.replace(this.replaceRegex,this.replaceString);}this.apply(h,g,c);}if(this.attrs){for(var d in this.attrs){h.setAttribute(d,this.attrs[d]);if(c&&c.forIE&&d=="class"){h.className=this.attrs[d];}}}return this;},apply:function(c,e,m){var h=""+e;var g=[];if(!this.fallback.apply){this.fallback=new this.constructor(this.fallback);}while(true){var d=false;var l=false;for(var f=0;f<this.children.length;f++){if(typeof g[f]=="undefined"){if(!this.children[f].match){this.children[f]=new this.constructor(this.children[f]);}g[f]=this.children[f].match(h,m);}if(g[f]&&(!d||d.index>g[f].index)){d=g[f];l=this.children[f];if(d.index==0){break;}}}var k=d?d.index:h.length;if(k>0){this.fallback.apply(c,h.substring(0,k),m);}if(!d){break;}if(!l.build){l=new this.constructor(l);}l.build(c,d,m);var j=d.index+d[0].length;h=h.substring(j);for(var f=0;f<this.children.length;f++){if(g[f]){if(g[f].index>=j){g[f].index-=j;}else{g[f]=void 0;}}}}return this;},fallback:{apply:function(d,e,c){if(c&&c.forIE){e=e.replace(/\n/g," \r");}d.appendChild(document.createTextNode(e));}}};b.Simple.Base.Rule.prototype.constructor=b.Simple.Base.Rule;b.Simple.Creole=function(c){var h={};h.link="[^\\]|~\\n]*(?:(?:\\](?!\\])|~.)[^\\]|~\\n]*)*";h.linkText="[^\\]~\\n]*(?:(?:\\](?!\\])|~.)[^\\]~\\n]*)*";h.uriPrefix="\\b(?:(?:https?|ftp)://|mailto:)";h.uri=h.uriPrefix+h.link;h.rawUri=h.uriPrefix+"\\S*[^\\s!\"',.:;?]";h.interwikiPrefix="[\\w.]+:";h.interwikiLink=h.interwikiPrefix+h.link;h.img="\\{\\{((?!\\{)[^|}\\n]*(?:}(?!})[^|}\\n]*)*)"+(c&&c.strict?"":"(?:")+"\\|([^}~\\n]*((}(?!})|~.)[^}~\\n]*)*)"+(c&&c.strict?"":")?")+"}}";var f=function(g,j){if(j instanceof Function){return j(g);}j=j instanceof Array?j:[j];if(typeof j[1]=="undefined"){j[1]="";}return j[0]+g+j[1];};var e={hr:{tag:"hr",regex:/(^|\n)\s*----\s*(\n|$)/},br:{tag:"br",regex:/\\\\/},preBlock:{tag:"pre",capture:2,regex:/(^|\n)\{\{\{\n((.*\n)*?)\}\}\}(\n|$)/,replaceRegex:/^ ([ \t]*\}\}\})/gm,replaceString:"$1"},tt:{tag:"tt",regex:/\{\{\{(.*?\}\}\}+)/,capture:1,replaceRegex:/\}\}\}$/,replaceString:""},ulist:{tag:"ul",capture:0,regex:/(^|\n)([ \t]*\*[^*#].*(\n|$)([ \t]*[^\s*#].*(\n|$))*([ \t]*[*#]{2}.*(\n|$))*)+/},olist:{tag:"ol",capture:0,regex:/(^|\n)([ \t]*#[^*#].*(\n|$)([ \t]*[^\s*#].*(\n|$))*([ \t]*[*#]{2}.*(\n|$))*)+/},li:{tag:"li",capture:0,regex:/[ \t]*([*#]).+(\n[ \t]*[^*#\s].*)*(\n[ \t]*\1[*#].+)*/,replaceRegex:/(^|\n)[ \t]*[*#]/g,replaceString:"$1"},table:{tag:"table",capture:0,regex:/(^|\n)(\|.*?[ \t]*(\n|$))+/},tr:{tag:"tr",capture:2,regex:/(^|\n)(\|.*?)\|?[ \t]*(\n|$)/},th:{tag:"th",regex:/\|+=([^|]*)/,capture:1},td:{tag:"td",capture:1,regex:"\\|+([^|~\\[{]*((~(.|(?=\\n)|$)|"+"\\[\\["+h.link+"(\\|"+h.linkText+")?\\]\\]"+(c&&c.strict?"":"|"+h.img)+"|[\\[{])[^|~]*)*)"},singleLine:{regex:/.+/,capture:0},paragraph:{tag:"p",capture:0,regex:/(^|\n)([ \t]*\S.*(\n|$))+/},text:{capture:0,regex:/(^|\n)([ \t]*[^\s].*(\n|$))+/},strong:{tag:"strong",capture:1,regex:/\*\*([^*~]*((\*(?!\*)|~(.|(?=\n)|$))[^*~]*)*)(\*\*|\n|$)/},em:{tag:"em",capture:1,regex:"\\/\\/(((?!"+h.uriPrefix+")[^\\/~])*"+"(("+h.rawUri+"|\\/(?!\\/)|~(.|(?=\\n)|$))"+"((?!"+h.uriPrefix+")[^\\/~])*)*)(\\/\\/|\\n|$)"},img:{regex:h.img,build:function(l,k,j){var g=document.createElement("img");g.src=k[1];g.alt=k[2]===undefined?(j&&j.defaultImageText?j.defaultImageText:""):k[2].replace(/~(.)/g,"$1");l.appendChild(g);}},namedUri:{regex:"\\[\\[("+h.uri+")\\|("+h.linkText+")\\]\\]",build:function(l,k,g){var j=document.createElement("a");j.href=k[1];if(g&&g.isPlainUri){j.appendChild(document.createTextNode(k[2]));}else{this.apply(j,k[2],g);}l.appendChild(j);}},namedLink:{regex:"\\[\\[("+h.link+")\\|("+h.linkText+")\\]\\]",build:function(l,k,g){var j=document.createElement("a");j.href=g&&g.linkFormat?f(k[1].replace(/~(.)/g,"$1"),g.linkFormat):k[1].replace(/~(.)/g,"$1");this.apply(j,k[2],g);l.appendChild(j);}},unnamedUri:{regex:"\\[\\[("+h.uri+")\\]\\]",build:"dummy"},unnamedLink:{regex:"\\[\\[("+h.link+")\\]\\]",build:"dummy"},unnamedInterwikiLink:{regex:"\\[\\[("+h.interwikiLink+")\\]\\]",build:"dummy"},rawUri:{regex:"("+h.rawUri+")",build:"dummy"},escapedSequence:{regex:"~("+h.rawUri+"|.)",capture:1,tag:"span",attrs:{"class":"escaped"}},escapedSymbol:{regex:/~(.)/,capture:1,tag:"span",attrs:{"class":"escaped"}}};e.unnamedUri.build=e.rawUri.build=function(k,j,g){if(!g){g={};}g.isPlainUri=true;
e.namedUri.build.call(this,k,Array(j[0],j[1],j[1]),g);};e.unnamedLink.build=function(k,j,g){e.namedLink.build.call(this,k,Array(j[0],j[1],j[1]),g);};e.namedInterwikiLink={regex:"\\[\\[("+h.interwikiLink+")\\|("+h.linkText+")\\]\\]",build:function(n,l,j){var k=document.createElement("a");var g,o;if(j&&j.interwiki){g=l[1].match(/(.*?):(.*)/);o=j.interwiki[g[1]];}if(typeof o=="undefined"){if(!e.namedLink.apply){e.namedLink=new this.constructor(e.namedLink);}return e.namedLink.build.call(e.namedLink,n,l,j);}k.href=f(g[2].replace(/~(.)/g,"$1"),o);this.apply(k,l[2],j);n.appendChild(k);}};e.unnamedInterwikiLink.build=function(k,j,g){e.namedInterwikiLink.build.call(this,k,Array(j[0],j[1],j[1]),g);};e.namedUri.children=e.unnamedUri.children=e.rawUri.children=e.namedLink.children=e.unnamedLink.children=e.namedInterwikiLink.children=e.unnamedInterwikiLink.children=[e.escapedSymbol,e.img];for(var d=1;d<=6;d++){e["h"+d]={tag:"h"+d,capture:2,regex:"(^|\\n)[ \\t]*={"+d+"}[ \\t]"+"([^~]*?(~(.|(?=\\n)|$))*)[ \\t]*=*\\s*(\\n|$)"};}e.ulist.children=e.olist.children=[e.li];e.li.children=[e.ulist,e.olist];e.li.fallback=e.text;e.table.children=[e.tr];e.tr.children=[e.th,e.td];e.td.children=[e.singleLine];e.th.children=[e.singleLine];e.h1.children=e.h2.children=e.h3.children=e.h4.children=e.h5.children=e.h6.children=e.singleLine.children=e.paragraph.children=e.text.children=e.strong.children=e.em.children=[e.escapedSequence,e.strong,e.em,e.br,e.rawUri,e.namedUri,e.namedInterwikiLink,e.namedLink,e.unnamedUri,e.unnamedInterwikiLink,e.unnamedLink,e.tt,e.img];e.root={children:[e.h1,e.h2,e.h3,e.h4,e.h5,e.h6,e.hr,e.ulist,e.olist,e.preBlock,e.table],fallback:{children:[e.paragraph]}};b.Simple.Base.call(this,e,c);};b.Simple.Creole.prototype=new b.Simple.Base();b.Simple.Creole.prototype.constructor=b.Simple.Creole;a.CreoleParser=b.Simple.Creole;},"@VERSION@",{requires:["aui-base"]});AUI.add("aui-editor-html-creole",function(d){var k=d.Lang;var r="\n";var g="**";var p="//";var b="p";var c="ol";var a="#";var f="ul";var l="*";var h=/(?:^|\s)font-weight\s*:\s*bold\s*;?/i;var n=/^h([1-6])$/i;var m=/(?:^|\s)font-style\s*:\s*italic\s*;?/i;var e=/[^\t\n\r ]/;var j=/(\r?\n\s*)$/;var o=" ";var q=d.Component.create({NAME:"domparsercreole",ATTRS:{data:{value:null,validator:k.isString}},EXTENDS:d.Base,prototype:{_endResult:null,_ulLevel:0,initializer:function(){},convert:function(v){var s=this;if(v){this.set("data",v);}else{v=this.get("data");}var u=d.config.doc.createElement("div");u.innerHTML=v;s._handle(u);var t=s._endResult.join("");s._endResult=null;return t;},_isAllWS:function(s){return !(e.test(s.data));},_isDataAvailable:function(){var s=this;return s._endResult&&s._endResult.length;},_isIgnorable:function(u){var s=this;var t=u.nodeType;return(t==8)||((t==3)&&s._isAllWS(u));},_isLastItemNewLine:function(u){var s=this;var t=s._endResult;return(t&&j.test(t.slice(-1)));},_handle:function(x){var D=this;var u,v,z,A,B,C,t,y,s,w;if(!k.isArray(D._endResult)){D._endResult=[];}v=x.childNodes;w=D._pushTagList;t=v.length;for(A=0;A<t;A++){B=[];C=[];y=[];s=[];u=v[A];if(D._isIgnorable(u)){continue;}D._handleElementStart(u,B,C);D._handleStyles(u,y,s);w.call(D,B);w.call(D,y);D._handle(u);D._handleElementEnd(u,B,C);w.call(D,s.reverse());w.call(D,C);}z=x.data;D._handleData(z,x);},_handleData:function(u,t){var s=this;if(k.isValue(u)){s._endResult.push(u);}},_handleElementStart:function(w,u,t){var s=this;var v=w.tagName;var x;if(v){v=v.toLowerCase();if(v==b){s._handleParagraph(w,u,t);}else{if(v=="br"){s._handleBreak(w,u,t);}else{if(v=="a"){s._handleLink(w,u,t);}else{if(v=="strong"||v=="b"){s._handleStrong(w,u,t);}else{if(v=="em"||v=="i"){s._handleEm(w,u,t);}else{if(v=="img"){s._handleImage(w,u,t);}else{if(v==f){s._handleUnorderedList(w,u,t);}else{if(v=="li"){s._handleListItem(w,u,t);}else{if(v==c){s._handleOrderedList(w,u,t);}else{if(v=="hr"){s._handleHr(w,u,t);}else{if(v=="pre"){s._handlePre(w,u,t);}else{if((x=n.exec(v))){s._handleHeader(w,u,t,x);}else{if(v=="th"){s._handleTableHeader(w,u,t);}else{if(v=="tr"){s._handleTableRow(w,u,t);}else{if(v=="td"){s._handleTableCell(w,u,t);}}}}}}}}}}}}}}}}},_handleElementEnd:function(w,u,t){var s=this;var v=w.tagName;if(v){v=v.toLowerCase();}if(v==b){if(!s._isLastItemNewLine()){s._endResult.push(r);}}else{if(v==f||v==c){s._ulLevel-=1;if(!s._isLastItemNewLine()){s._endResult.push(r);}}else{if(v=="table"){t.push(r);}}}},_handleBreak:function(u,t,s){t.push("\\\\");},_handleEm:function(u,t,s){t.push(p);s.push(p);},_handleHeader:function(w,u,t,x){var s=this;var v=new Array(parseInt(x[1],10)+1);v=v.join("=");if(s._isDataAvailable()&&!s._isLastItemNewLine()){u.push(r);}u.push(v,o);t.push(o,v,r);},_handleHr:function(v,u,t){var s=this;if(s._isDataAvailable()&&!s._isLastItemNewLine()){u.push(r);}u.push("----",r);},_handleImage:function(w,u,s){var t=w.alt;var v=w.src;u.push("{{",v);if(t){u.push("|",t);}s.push("}}");},_handleLink:function(u,t,s){var v=u.href;t.push("[[",v,"|");s.push("]]");},_handleListItem:function(t,u,x){var z=this;var w=z._ulLevel;var A=(s===f)?l:a;var v=t.parentNode;var s=v.tagName.toLowerCase();var y=new Array(w+1);y=y.join(A);if(z._isDataAvailable()&&!z._isLastItemNewLine()){u.push(r);}u.push(y,o);},_handleOrderedList:function(v,u,t){var s=this;s._ulLevel+=1;},_handleParagraph:function(v,u,t){var s=this;if(s._isDataAvailable()){var x=j.exec(s._endResult.slice(-2).join(""));var w=x?x[1].length:0;while(w++<2){u.push(r);}}t.push(r);},_handlePre:function(v,u,t){var s=this;if(s._isDataAvailable()&&!s._isLastItemNewLine()){u.push(r);}u.push("{{{",r);t.push(r,"}}}",r);},_handleStrong:function(u,t,s){t.push(g);s.push(g);},_handleStyles:function(t,s,w){var v=t.style;if(v){var u=v.cssText;if(h.test(u)){s.push(g);w.push(g);}if(m.test(u)){s.push(p);w.push(p);}}},_handleTableCell:function(u,t,s){t.push("|");},_handleTableHeader:function(u,t,s){t.push("|","=");},_handleTableRow:function(v,u,t){var s=this;if(s._isDataAvailable()){u.push(r);}t.push("|");},_handleUnorderedList:function(v,u,t){var s=this;s._ulLevel+=1;
},_pushTagList:function(x){var t=this;var v,u,w,s;v=t._endResult;w=x.length;for(u=0;u<w;u++){s=x[u];v.push(s);}}}});d.HTML2CreoleConvertor=q;},"@VERSION@",{requires:["aui-editor-base"]});AUI.add("aui-editor-creole-plugin",function(e){var g=e.Lang,h=g.isArray,b=g.isString,f=e.ClassNameManager.getClassName,k="creoleplugin",a="creole",d="(<[a-z][a-z0-9]*[^>]*>|</[a-z][a-z0-9]*>)",c=new RegExp(d,"gi");if(!YUI.AUI.defaults.EditorToolbar){YUI.AUI.defaults.EditorToolbar={STRINGS:{}};}var j=e.Component.create({NAME:k,NS:a,EXTENDS:e.Plugin.Base,ATTRS:{interwiki:{value:{WikiCreole:"http://www.wikicreole.org/wiki/",Wikipedia:"http://en.wikipedia.org/wiki/"}},host:{value:false},linkFormat:{value:""},strict:{value:false}},prototype:{html2creole:null,initializer:function(){var l=this;this._creole=new e.CreoleParser({forIE:e.UA.os==="windows",interwiki:this.get("interwiki"),linkFormat:this.get("linkFormat"),strict:this.get("strict")});var m=l.get("host");l.afterHostMethod("getContent",l.getCreoleCode,l);m.on("contentChange",l._contentChange,l);},_convertHTML2Creole:function(m){var l=this;if(!l.html2creole){l.html2creole=new e.HTML2CreoleConvertor({data:m});}else{l.html2creole.set("data",m);}return l.html2creole.convert();},getCreoleCode:function(){var l=this;var m=e.Do.originalRetVal;m=l._convertHTML2Creole(m);m=m.replace(c,"");return new e.Do.AlterReturn(null,m);},getContentAsHtml:function(){var l=this;var m=l.get("host");return m.constructor.prototype.getContent.apply(m,arguments);},setContentAsCreoleCode:function(m){var l=this;var n=l.get("host");n.set("content",m);},_contentChange:function(m){var l=this;m.newVal=l._parseCreoleCode(m.newVal);m.stopImmediatePropagation();},_parseCreoleCode:function(m){var l=this;var o=e.config.doc.createElement("div");l._creole.parse(o,m);var n=o.innerHTML;return n;}}});e.namespace("Plugin").EditorCreoleCode=j;},"@VERSION@",{requires:["aui-base","editor-base","aui-editor-html-creole","aui-editor-creole-parser"]});AUI.add("aui-editor",function(a){},"@VERSION@",{use:["aui-editor-base","aui-editor-tools-plugin","aui-editor-menu-plugin","aui-editor-toolbar-plugin","aui-editor-bbcode-plugin","aui-editor-creole-parser","aui-editor-creole-plugin"],skinnable:true});