AUI.add("aui-editor-html-creole",function(c){var j=c.Lang;var q="\n";var f="**";var o="//";var g="pre";var b="ol";var a="#";var e="ul";var k="*";var h=/(?:^|\s)font-weight\s*:\s*bold\s*;?/i;var m=/^h([1-6])$/i;var l=/(?:^|\s)font-style\s*:\s*italic\s*;?/i;var d=/[^\t\n\r ]/;var i=/(\r?\n\s*)$/;var n=" ";var p=c.Component.create({NAME:"domparsercreole",ATTRS:{data:{value:null,validator:j.isString}},EXTENDS:c.Base,prototype:{_endResult:null,_ulLevel:0,initializer:function(){},convert:function(u){var r=this;if(u){this.set("data",u);}else{u=this.get("data");}var t=c.config.doc.createElement("div");t.innerHTML=u;r._handle(t);var s=r._endResult.join("");r._endResult=null;return s;},_isAllWS:function(r){return !(d.test(r.data));},_isIgnorable:function(t){var r=this;var s=t.nodeType;return(s==8)||((s==3)&&r._isAllWS(t));},_isLastItemNewLine:function(t){var r=this;var s=r._endResult;return(s&&i.test(s.slice(-1)));},_handle:function(w){var C=this;var t,u,y,z,A,B,s,x,r,v;if(!j.isArray(C._endResult)){C._endResult=[];}u=w.childNodes;v=C._pushTagList;s=u.length;for(z=0;z<s;z++){A=[];B=[];x=[];r=[];t=u[z];if(C._isIgnorable(t)){continue;}C._handleElementStart(t,A,B);C._handleStyles(t,A,B);v.call(C,A);v.call(C,x);C._handle(t);C._handleElementEnd(t,A,B);v.call(C,r.reverse());v.call(C,B);}y=w.data;C._handleData(y,w);},_handleData:function(v,u){var s=this;if(j.isValue(v)){s._endResult.push(v);var r=u.parentNode;if(r){var t=r.tagName;if(t){t=t.toLowerCase();}}if(t===g){if(!i.test(v)){s._endResult.push(q);}}}},_handleElementStart:function(v,t,s){var r=this;var u=v.tagName;var w;if(u){u=u.toLowerCase();if(u=="p"){r._handleParagraph(v,t,s);}else{if(u=="br"){r._handleBreak(v,t,s);}else{if(u=="a"){r._handleLink(v,t,s);}else{if(u=="strong"||u=="b"){r._handleStrong(v,t,s);}else{if(u=="em"||u=="i"){r._handleEm(v,t,s);}else{if(u=="img"){r._handleImage(v,t,s);}else{if(u==e){r._handleUnorderedList(v,t,s);}else{if(u=="li"){r._handleListItem(v,t,s);}else{if(u==b){r._handleOrderedList(v,t,s);}else{if(u=="hr"){r._handleHr(v,t,s);}else{if(u==g){r._handlePre(v,t,s);}else{if((w=m.exec(u))){r._handleHeader(v,t,s,w);}else{if(u=="th"){r._handleTableHeader(v,t,s);}else{if(u=="tr"){r._handleTableRow(v,t,s);}else{if(u=="td"){r._handleTableCell(v,t,s);}}}}}}}}}}}}}}}}},_handleElementEnd:function(v,t,s){var r=this;var u=v.tagName;if(u){u=u.toLowerCase();}if(u===e||u===b){r._ulLevel-=1;if(!r._isLastItemNewLine()){r._endResult.push(q);}}else{if(u==="table"){s.push(q);}}},_handleBreak:function(t,s,r){s.push("\\\\");},_handleEm:function(t,s,r){s.push(o);r.push(o);},_handleHeader:function(v,t,s,w){var r=this;var u=new Array(parseInt(w[1],10)+1);u=u.join("=");if(!r._isLastItemNewLine()){t.push(q);}t.push(u,n);s.push(n,u,q);},_handleHr:function(u,t,s){var r=this;if(!r._isLastItemNewLine()){t.push(q);}t.push("----",q);},_handleImage:function(v,t,r){var s=v.alt;var u=v.src;t.push("{{",u);if(s){t.push("|",s);}r.push("}}");},_handleLink:function(t,s,r){var u=t.href;s.push("[[",u,"|");r.push("]]");},_handleListItem:function(s,t,w){var y=this;var v=y._ulLevel;var z=(r===e)?k:a;var u=s.parentNode;var r=u.tagName.toLowerCase();var x=new Array(v+1);x=x.join(z);if(!y._isLastItemNewLine()){t.push(q);}t.push(x,n);},_handleOrderedList:function(u,t,s){var r=this;r._ulLevel+=1;},_handleParagraph:function(u,t,s){var r=this;var w=i.exec(r._endResult.slice(-1));var v=w?w[1].length:0;while(v++<2){t.push(q);}s.push(q,q);},_handlePre:function(u,t,s){var r=this;if(!r._isLastItemNewLine()){t.push(q);}t.push("{{{",q);s.push("}}}",q);},_handleStrong:function(t,s,r){s.push(f);r.push(f);},_handleStyles:function(s,r,v){var u=s.style;if(u){var t=u.cssText;if(h.test(t)){r.push(f);v.push(f);}if(l.test(t)){r.push(o);v.push(o);}}},_handleTableCell:function(t,s,r){s.push("|");},_handleTableHeader:function(t,s,r){s.push("|","=");},_handleTableRow:function(t,s,r){s.push(q);r.push("|");},_handleUnorderedList:function(u,t,s){var r=this;r._ulLevel+=1;},_pushTagList:function(w){var s=this;var u,t,v,r;u=s._endResult;v=w.length;for(t=0;t<v;t++){r=w[t];u.push(r);}}}});c.HTML2CreoleConvertor=p;},"@VERSION@",{requires:["aui-editor-base"]});