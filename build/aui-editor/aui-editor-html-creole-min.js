AUI.add("aui-editor-html-creole",function(d){var j=d.Lang;var q="\n";var g="**";var o="//";var b="p";var c="ol";var a="#";var f="ul";var k="*";var h=/(?:^|\s)font-weight\s*:\s*bold\s*;?/i;var m=/^h([1-6])$/i;var l=/(?:^|\s)font-style\s*:\s*italic\s*;?/i;var e=/[^\t\n\r ]/;var i=/(\r?\n\s*)$/;var n=" ";var p=d.Component.create({NAME:"domparsercreole",ATTRS:{data:{value:null,validator:j.isString}},EXTENDS:d.Base,prototype:{_endResult:null,_ulLevel:0,initializer:function(){},convert:function(u){var r=this;if(u){this.set("data",u);}else{u=this.get("data");}var t=d.config.doc.createElement("div");t.innerHTML=u;r._handle(t);var s=r._endResult.join("");r._endResult=null;return s;},_isAllWS:function(r){return !(e.test(r.data));},_isDataAvailable:function(){var r=this;return r._endResult&&r._endResult.length;},_isIgnorable:function(t){var r=this;var s=t.nodeType;return(s==8)||((s==3)&&r._isAllWS(t));},_isLastItemNewLine:function(t){var r=this;var s=r._endResult;return(s&&i.test(s.slice(-1)));},_handle:function(w){var C=this;var t,u,y,z,A,B,s,x,r,v;if(!j.isArray(C._endResult)){C._endResult=[];}u=w.childNodes;v=C._pushTagList;s=u.length;for(z=0;z<s;z++){A=[];B=[];x=[];r=[];t=u[z];if(C._isIgnorable(t)){continue;}C._handleElementStart(t,A,B);C._handleStyles(t,x,r);v.call(C,A);v.call(C,x);C._handle(t);C._handleElementEnd(t,A,B);v.call(C,r.reverse());v.call(C,B);}y=w.data;C._handleData(y,w);},_handleData:function(t,s){var r=this;if(j.isValue(t)){r._endResult.push(t);}},_handleElementStart:function(v,t,s){var r=this;var u=v.tagName;var w;if(u){u=u.toLowerCase();if(u==b){r._handleParagraph(v,t,s);}else{if(u=="br"){r._handleBreak(v,t,s);}else{if(u=="a"){r._handleLink(v,t,s);}else{if(u=="strong"||u=="b"){r._handleStrong(v,t,s);}else{if(u=="em"||u=="i"){r._handleEm(v,t,s);}else{if(u=="img"){r._handleImage(v,t,s);}else{if(u==f){r._handleUnorderedList(v,t,s);}else{if(u=="li"){r._handleListItem(v,t,s);}else{if(u==c){r._handleOrderedList(v,t,s);}else{if(u=="hr"){r._handleHr(v,t,s);}else{if(u=="pre"){r._handlePre(v,t,s);}else{if((w=m.exec(u))){r._handleHeader(v,t,s,w);}else{if(u=="th"){r._handleTableHeader(v,t,s);}else{if(u=="tr"){r._handleTableRow(v,t,s);}else{if(u=="td"){r._handleTableCell(v,t,s);}}}}}}}}}}}}}}}}},_handleElementEnd:function(v,t,s){var r=this;var u=v.tagName;if(u){u=u.toLowerCase();}if(u==b){if(!r._isLastItemNewLine()){r._endResult.push(q);}}else{if(u==f||u==c){r._ulLevel-=1;if(!r._isLastItemNewLine()){r._endResult.push(q);}}else{if(u=="table"){s.push(q);}}}},_handleBreak:function(t,s,r){s.push("\\\\");},_handleEm:function(t,s,r){s.push(o);r.push(o);},_handleHeader:function(v,t,s,w){var r=this;var u=new Array(parseInt(w[1],10)+1);u=u.join("=");if(r._isDataAvailable()&&!r._isLastItemNewLine()){t.push(q);}t.push(u,n);s.push(n,u,q);},_handleHr:function(u,t,s){var r=this;if(r._isDataAvailable()&&!r._isLastItemNewLine()){t.push(q);}t.push("----",q);},_handleImage:function(v,t,r){var s=v.alt;var u=v.src;t.push("{{",u);if(s){t.push("|",s);}r.push("}}");},_handleLink:function(t,s,r){var u=t.href;s.push("[[",u,"|");r.push("]]");},_handleListItem:function(s,t,w){var y=this;var v=y._ulLevel;var z=(r===f)?k:a;var u=s.parentNode;var r=u.tagName.toLowerCase();var x=new Array(v+1);x=x.join(z);if(y._isDataAvailable()&&!y._isLastItemNewLine()){t.push(q);}t.push(x,n);},_handleOrderedList:function(u,t,s){var r=this;r._ulLevel+=1;},_handleParagraph:function(u,t,s){var r=this;if(r._isDataAvailable()){var w=i.exec(r._endResult.slice(-2).join(""));var v=w?w[1].length:0;while(v++<2){t.push(q);}}s.push(q);},_handlePre:function(u,t,s){var r=this;if(r._isDataAvailable()&&!r._isLastItemNewLine()){t.push(q);}t.push("{{{",q);s.push(q,"}}}",q);},_handleStrong:function(t,s,r){s.push(g);r.push(g);},_handleStyles:function(s,r,v){var u=s.style;if(u){var t=u.cssText;if(h.test(t)){r.push(g);v.push(g);}if(l.test(t)){r.push(o);v.push(o);}}},_handleTableCell:function(t,s,r){s.push("|");},_handleTableHeader:function(t,s,r){s.push("|","=");},_handleTableRow:function(u,t,s){var r=this;if(r._isDataAvailable()){t.push(q);}s.push("|");},_handleUnorderedList:function(u,t,s){var r=this;r._ulLevel+=1;},_pushTagList:function(w){var s=this;var u,t,v,r;u=s._endResult;v=w.length;for(t=0;t<v;t++){r=w[t];u.push(r);}}}});d.HTML2CreoleConvertor=p;},"@VERSION@",{requires:["aui-editor-base"]});