AUI.add("aui-editor-html-creole",function(q){var j=q.Lang;var m="\n";var k="**";var r="//";var d="ol";var e="#";var i="p";var c="pre";var g="ul";var o="*";var b=/(?:^|\s)font-weight\s*:\s*bold\s*;?/i;var f=/^h([1-6])$/i;var p=/(?:^|\s)font-style\s*:\s*italic\s*;?/i;var n=/(\r?\n\s*)$/;var h=/[^\t\n\r ]/;var l=" ";var a=q.Component.create({NAME:"domparsercreole",ATTRS:{data:{value:null,validator:j.isString}},EXTENDS:q.Base,prototype:{_endResult:null,_inPRE:false,_ulLevel:0,initializer:function(){},convert:function(v){var s=this;if(v){this.set("data",v);}else{v=this.get("data");}var u=q.config.doc.createElement("div");u.innerHTML=v;s._handle(u);var t=s._endResult.join("");s._endResult=null;return t;},_isAllWS:function(s){return s.isElementContentWhitespace||!(h.test(s.data));},_isDataAvailable:function(){var s=this;return s._endResult&&s._endResult.length;},_isIgnorable:function(u){var s=this;var t=u.nodeType;return(u.isElementContentWhitespace||t==8)||((t==3)&&s._isAllWS(u));},_isLastItemNewLine:function(u){var s=this;var t=s._endResult;return(t&&n.test(t.slice(-1)));},_handle:function(x){var D=this;var u,v,z,A,B,C,t,y,s,w;if(!j.isArray(D._endResult)){D._endResult=[];}v=x.childNodes;w=D._pushTagList;t=v.length;for(A=0;A<t;A++){B=[];C=[];y=[];s=[];u=v[A];if(D._isIgnorable(u)&&!D._inPRE){continue;}D._handleElementStart(u,B,C);D._handleStyles(u,y,s);w.call(D,B);w.call(D,y);D._handle(u);D._handleElementEnd(u,B,C);w.call(D,s.reverse());w.call(D,C);}z=x.data;D._handleData(z,x);},_handleData:function(u,t){var s=this;if(j.isValue(u)){s._endResult.push(u);}},_handleElementStart:function(w,u,t){var s=this;var v=w.tagName;var x;if(v){v=v.toLowerCase();if(v==i){s._handleParagraph(w,u,t);}else{if(v=="br"){s._handleBreak(w,u,t);}else{if(v=="a"){s._handleLink(w,u,t);}else{if(v=="strong"||v=="b"){s._handleStrong(w,u,t);}else{if(v=="em"||v=="i"){s._handleEm(w,u,t);}else{if(v=="img"){s._handleImage(w,u,t);}else{if(v==g){s._handleUnorderedList(w,u,t);}else{if(v=="li"){s._handleListItem(w,u,t);}else{if(v==d){s._handleOrderedList(w,u,t);}else{if(v=="hr"){s._handleHr(w,u,t);}else{if(v==c){s._handlePre(w,u,t);}else{if((x=f.exec(v))){s._handleHeader(w,u,t,x);}else{if(v=="th"){s._handleTableHeader(w,u,t);}else{if(v=="tr"){s._handleTableRow(w,u,t);}else{if(v=="td"){s._handleTableCell(w,u,t);}}}}}}}}}}}}}}}}},_handleElementEnd:function(w,u,t){var s=this;var v=w.tagName;if(v){v=v.toLowerCase();}if(v==i){if(!s._isLastItemNewLine()){s._endResult.push(m);}}else{if(v==g||v==d){s._ulLevel-=1;if(!s._isLastItemNewLine()){s._endResult.push(m);}}else{if(v==c){if(!s._isLastItemNewLine()){s._endResult.push(m);}s._inPRE=false;}else{if(v=="table"){t.push(m);}}}}},_handleBreak:function(v,u,t){var s=this;if(s._inPRE){u.push(m);}else{u.push("\\\\");}},_handleEm:function(u,t,s){t.push(r);s.push(r);},_handleHeader:function(w,u,t,x){var s=this;var v=new Array(parseInt(x[1],10)+1);v=v.join("=");if(s._isDataAvailable()&&!s._isLastItemNewLine()){u.push(m);}u.push(v,l);t.push(l,v,m);},_handleHr:function(v,u,t){var s=this;if(s._isDataAvailable()&&!s._isLastItemNewLine()){u.push(m);}u.push("----",m);},_handleImage:function(w,u,s){var t=w.alt;var v=w.src;u.push("{{",v);if(t){u.push("|",t);}s.push("}}");},_handleLink:function(u,t,s){var v=u.href;t.push("[[",v,"|");s.push("]]");},_handleListItem:function(y,v,u){var t=this;var s=y.parentNode;var x=s.tagName.toLowerCase();var z=(x===g)?o:e;var w=new Array(t._ulLevel+1);w=w.join(z);if(t._isDataAvailable()&&!t._isLastItemNewLine()){v.push(m);}v.push(w,l);},_handleOrderedList:function(v,u,t){var s=this;s._ulLevel+=1;},_handleParagraph:function(v,u,t){var s=this;if(s._isDataAvailable()){var x=n.exec(s._endResult.slice(-2).join(""));var w=x?x[1].length:0;while(w++<2){u.push(m);}}t.push(m);},_handlePre:function(v,u,t){var s=this;s._inPRE=true;var w=s._endResult;var x=v.innerHTML;if(s._isDataAvailable()&&!s._isLastItemNewLine()){w.push(m);}u.push("{{{",m);t.push("}}}",m);},_handleStrong:function(u,t,s){t.push(k);s.push(k);},_handleStyles:function(t,s,w){var v=t.style;if(v){var u=v.cssText;if(b.test(u)){s.push(k);w.push(k);}if(p.test(u)){s.push(r);w.push(r);}}},_handleTableCell:function(u,t,s){t.push("|");},_handleTableHeader:function(u,t,s){t.push("|","=");},_handleTableRow:function(v,u,t){var s=this;if(s._isDataAvailable()){u.push(m);}t.push("|");},_handleUnorderedList:function(v,u,t){var s=this;s._ulLevel+=1;},_pushTagList:function(x){var t=this;var v,u,w,s;v=t._endResult;w=x.length;for(u=0;u<w;u++){s=x[u];v.push(s);}}}});q.HTML2CreoleConvertor=a;},"@VERSION@",{requires:["aui-editor-base"]});