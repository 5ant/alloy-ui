AUI.add("aui-editor-toolbar-plugin",function(P){var AA=P.Lang,Q=AA.isFunction,v=P.ClassNameManager.getClassName,e="editortoolbar",y="toolbar",U="alignment",a="align-left",p="align-inline",S="align-block",z="align-right",g="color",j="content",M="font",u="indent",J="input",l="insert",c="insertimage",m="list",V="select",C="source",K="styles",r="subscript",q="text",s={backcolor:true,forecolor:true,format:true,insertimage:true,source:true,styles:true},X=["b","big","font","em","i","small","s","strike","strong","sub","sup","u"],N=v("button","holder"),O=v("field",J),W=v("field",J,"text"),G=v("field","label"),d=v("field","numeric"),Y=v(e,c),k=v(e,c,"align"),B=v(e,V,"fontname"),t=v(e,V,"fontsize"),E=v(e,"size","separator"),H=v(e,C,"textarea"),D=v("state","active"),I=v(e),Z=v(e,j),L="<a></a>",b="<img />",T='<div class="'+k+'"></div>',F='<textarea class="'+H+'"></textarea>',x='<div class="'+I+'"><div class="'+Z+'"></div></div>',n='<div class="'+N+'"></div>',w='<select class="'+B+'">{0}</select>',R='<option selected="selected"></option>'+"<option>Arial</option>"+"<option>Arial Black</option>"+"<option>Comic Sans MS</option>"+"<option>Courier New</option>"+"<option>Lucida Console</option>"+"<option>Tahoma</option>"+"<option>Times New Roman</option>"+"<option>Trebuchet MS</option>"+"<option>Verdana</option>",o='<select class="'+t+'">{0}</select>',i='<option selected="selected"></option>'+'<option value="1">10</option>'+'<option value="2">13</option>'+'<option value="3">16</option>'+'<option value="4">18</option>'+'<option value="5">24</option>'+'<option value="6">32</option>'+'<option value="7">48</option>',h='<span class="'+E+'">x</span>';var f=P.Component.create({NAME:e,NS:y,EXTENDS:P.Plugin.Base,ATTRS:{groups:{value:[{type:q},{type:U},{type:u},{type:m}]}},prototype:{initializer:function(){var AP=this;var AG=AP.get("host");var AE=AG.frame.get("container");var AQ=AP.get("groups");var AC=P.Node.create(x);var AF=AC.one("."+Z);AE.placeBefore(AC);var AI={boundingBox:AC,contentBox:AF};var AH=[];AP.on("buttonitem:click",function(AU){var AT=this;var AS=AU.target.get("icon").split("-");if(!s[AS[0]]){AT.execCommand(AS[0],(AS[1]?AS[1]:""));AT.focus();}},AG);for(var AM=0;AM<AQ.length;AM++){var AB=AQ[AM];var AJ=GROUPS[AB.type];var AD;var A=[];for(var AL=0;AL<AJ.children.length;AL++){if(!AJ.children[AL].select){A.push(AJ.children[AL]);}}if(A.length>0){AD=new P.Toolbar(P.merge(AJ.config,AB.toolbar,{children:A})).render(AF);AD.addTarget(AP);AH.push(AD);}var AK=AJ.generate;if(AK&&Q(AK.init)){AK.init.call(AP,AG,AI);}for(var AL=0;AL<AJ.children.length;AL++){var AO=AJ.children[AL];var AN=AO.icon;if(AK&&Q(AK[AN])){var AR=(AB.config?AB.config[AN]:null);AI.button=(AO.select||!AD?null:AD.item(AL));AK[AN].call(AP,AG,AI,AR);}}}AI.toolbars=AH;},_updateToolbar:function(A,AG){var AH=this;if(A.changedNode){var AC=A.commands;var AI=AG.toolbars;var AK=function(AM,AL,AO){var AN=!!(AC[AM.get("icon")]);AM.StateInteraction.set("active",AN);};if(AI){for(var AE=0;AE<AI.length;AE++){AI[AE].each(AK);}}var AB=A.fontFamily;var AF=AG._fontNameOptions;var AJ=A.fontSize;var AD=AG._fontSizeOptions;if(AF){AF.item(0).set("selected",true);AF.each(function(AM,AL,AO){var AN=AM.get("value").toLowerCase();if(AN===AB.toLowerCase()){AM.set("selected",true);}});}if(AD){AJ=AJ.replace("px","");AD.item(0).set("selected",true);AD.each(function(AN,AM,AP){var AO=AN.get("value").toLowerCase();var AL=AN.get("text");if(AL===AJ){AN.set("selected",true);}});}}}}});f.generateOverlay=function(AD,AC,A){var AB=new P["OverlayContext"+(A?"Panel":"")](P.merge({align:{node:AD,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:AD},AC)).render();return AB;};f.generateColorPicker=function(AG,AD,AC,AH){var AF=AD.button;var AB=AF.get("boundingBox");var A=new P.ColorPicker(P.merge({align:{node:AB,points:["tl","bl"]},trigger:AB},AC));if(AC&&AC.plugins){for(var AE=0;AE<AC.plugins.length;AE++){A.plug(AC.plugins[AE],AC);}}A.render(P.getBody());A.on("colorChange",function(AK){var AI=this;var AJ=A.get("rgb");AG.execCommand(AH,AJ.hex);AG.focus();});};f.STRINGS={ALIGN:"Align",ALIGN_BLOCK:"Block",ALIGN_LEFT:"Left",ALIGN_INLINE:"Inline",ALIGN_RIGHT:"Right",BACKCOLOR:"Background Color",BOLD:"Bold",BORDER:"Border",CREATE_LINK:"Create Link",DESCRIPTION:"Description",EDIT_IMAGE:"Edit Image",FORECOLOR:"Foreground Color",IMAGE_URL:"Image URL",INDENT:"Indent",INSERT:"Insert",INSERT_IMAGE:"Insert Image",INSERT_ORDERED_LIST:"Insert Numbered List",INSERT_UNORDERED_LIST:"Insert Bulleted List",ITALIC:"Italic",JUSTIFY_LEFT:"Justify Left",JUSTIFY_CENTER:"Justify Center",JUSTIFY_RIGHT:"Justify Right",LINK_URL:"Link URL",OPEN_IN_NEW_WINDOW:"Open in new window",OUTDENT:"Outdent",PADDING:"Padding",REMOVE_FORMAT:"Format Source",SAVE:"Save",SIZE:"Size",SOURCE:"Source",SUBSCRIPT:"Subscript",SUPERSCRIPT:"Superscript",LINE_THROUGH:"Line Through",UNDERLINE:"Underline"};GROUPS={};GROUPS[U]={children:[{icon:"justifyleft",title:f.STRINGS.JUSTIFY_LEFT},{icon:"justifycenter",title:f.STRINGS.JUSTIFY_CENTER},{icon:"justifyright",title:f.STRINGS.JUSTIFY_RIGHT}]};GROUPS[g]={children:[{icon:"forecolor",title:f.STRINGS.FORECOLOR},{icon:"backcolor",title:f.STRINGS.BACKCOLOR}],generate:{forecolor:function(AD,AC,AB){var A=this;f.generateColorPicker(AD,AC,AB,"forecolor");},backcolor:function(AD,AC,AB){var A=this;f.generateColorPicker(AD,AC,AB,"backcolor");}}};GROUPS[M]={children:[{icon:"fontname",select:true},{icon:"fontsize",select:true}],generate:{init:function(AD,AC){var A=this;var AB=AC.contentBox;P.delegate("change",function(AG){var AE=this;var AI=AG.currentTarget;var AF=AI.get("className");var AH=AF.substring(AF.lastIndexOf("-")+1);var AJ=AI.get("value");AD.execCommand(AH,AJ);AD.focus();},AB,"select");AD.after("nodeChange",function(AF){var AE=this;switch(AF.changedType){case"keyup":case"mousedown":AE._updateToolbar(AF,AC);break;}},A);},fontname:function(AG,AF,AE){var A=this;var AB=AF.contentBox;var AD;var AH=[R];if(AE&&AE.optionHtml){AH[0]=AE.optionHtml;}AD=AA.sub(w,AH);AB.append(AD);var AC=AB.all("."+B+" option");AF._fontNameOptions=AC;
},fontsize:function(AG,AF,AE){var A=this;var AB=AF.contentBox;var AD;var AH=[i];if(AE&&AE.optionHtml){AH[0]=AE.optionHtml;}AD=AA.sub(o,AH);AB.append(AD);var AC=AB.all("."+t+" option");AF._fontSizeOptions=AC;}}};GROUPS[u]={children:[{icon:"indent",title:f.STRINGS.INDENT},{icon:"outdent",title:f.STRINGS.OUTDENT}]};GROUPS[l]={children:[{icon:"insertimage",title:f.STRINGS.INSERT_IMAGE},{icon:"createlink",title:f.STRINGS.CREATE_LINK}],generate:{insertimage:function(AE,AN,AW){var AU=this;var A=AN.button;var AH=A.get("boundingBox");var AT=f.generateOverlay(AH,AW,true);var AQ=AT.get("contentBox");var AL=new P.Panel({collapsible:false,headerContent:f.STRINGS.INSERT_IMAGE,icons:[{icon:"close",handler:{fn:AT.hide,context:AT}}]}).render(AQ);AQ=AL.bodyNode;if(AW&&AW.dataBrowser){AW.dataBrowser.render(AQ);}else{var AI=AE.frame._iframe;var AG;var AX;var AV=new P.Form({cssClass:Y,labelAlign:"left"}).render(AQ);var AK=[{labelText:"none",value:""}];for(var AR=1;AR<6;AR++){AK.push({labelText:AR+"px",value:AR+"px solid"});}AV.add([{id:"imageURL",labelText:f.STRINGS.IMAGE_URL},{id:"size",labelText:f.STRINGS.SIZE,type:"hidden"},{id:"width",labelText:false,cssClass:d},{id:"height",labelText:false,cssClass:d},{id:"padding",labelText:f.STRINGS.PADDING},new P.Select({id:"border",labelText:f.STRINGS.BORDER,options:AK}),{id:"align",labelText:f.STRINGS.ALIGN,type:"hidden"},{id:"description",labelText:f.STRINGS.DESCRIPTION},{id:"linkURL",labelText:f.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:f.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);AV.getField("width").get("boundingBox").placeAfter(h);var AF=AV.get("contentBox");var AS=P.Node.create(n);var AM=AV.getField("openInNewWindow");var AP=new P.ButtonItem({icon:"circle-check",label:f.STRINGS.INSERT}).render(AS);AP.on("click",function(AZ){var Aj=this;var Aa;var Ad;var Ah;if(AG){Ad=AG;Ah=AG.get("parentNode");if(Ah.get("tagName").toLowerCase()=="a"){Aa=Ah;}}else{Ad=P.Node.create(b);}var Ac=AV.get("fieldValues");var Ai=Ac.description;var Ae={src:Ac.imageURL,title:Ai,alt:Ai};var Ag={border:Ac.border};var Ak=parseInt(Ac.height,10);var Ab=parseInt(Ac.width,10);if(!isNaN(Ak)){Ae.height=Ak;}if(!isNaN(Ab)){Ae.width=Ab;}var Af=parseInt(Ac.padding,10);if(!isNaN(Af)){Ag.padding=Af;}AO.some(function(An,Am,Ap){var Al=this;var Ao=An.StateInteraction.get("active");if(Ao){Ag.display="";switch(Am){case 0:Ae.align="left";break;case 1:Ae.align="";break;case 2:Ae.align="center";Ag.display="block";break;case 3:Ae.align="right";break;}return true;}});Ad.setAttrs(Ae);Ad.setStyles(Ag);var AY=Ac.linkURL;if(AY){if(!Aa){Aa=P.Node.create(L);if(AG){Ah.insert(Aa,AG);}Aa.append(Ad);}Aa.setAttribute("href",AY);Aa.setAttribute("target",(AM.get("node").get("checked")?"_blank":""));Ad=Aa;}else{if(AG&&Aa){Ah.insert(AG,Aa);Aa.remove(true);}}if(!AG&&AX&&AX.anchorNode){AX.anchorNode.append(Ad);}AT.hide();});var AJ=P.Node.create(b);var AB=AV.getField("height");var AC=AV.getField("width");AJ.on("load",function(AZ){var AY=AZ.currentTarget;if(!AB.get("value")||!AC.get("value")){AV.set("values",{height:AY.get("height"),width:AY.get("width")});}});AV.getField("imageURL").get("node").on("blur",function(AY){AJ.set("src",this.val());});AF.append(AS);var AO=new P.Toolbar({activeState:true,children:[{icon:a,title:f.STRINGS.ALIGN_LEFT},{icon:p,title:f.STRINGS.ALIGN_INLINE},{icon:S,title:f.STRINGS.ALIGN_BLOCK},{icon:z,title:f.STRINGS.ALIGN_RIGHT}]});AO.after("buttonitem:click",function(AZ){var AY=AZ.target;AO.each(function(Ab,Aa,Ac){if(Ab!=AY){Ab.StateInteraction.set("active",false);}});});AO.render(AV.getField("align").get("contentBox"));AT.on("show",function(AY){if(!AX||!AX.anchorNode){var AZ=AE.getInstance();AE.focus();AX=new AZ.Selection();}});AT.after("hide",function(AY){AV.resetValues();AO.each(function(Aa,AZ,Ab){Aa.StateInteraction.set("active",false);});AM.get("node").set("checked",false);AL.set("title",f.STRINGS.INSERT_IMAGE);AP.set("label",f.STRINGS.INSERT);AD.hide();AT.set("align",{node:AH,points:["tl","bl"]});AG=null;});AI.on("mouseout",function(AY){var AZ=AE.getInstance();AX=new AZ.Selection();});var AD=P.Node.create(T);AD.hide();P.getBody().append(AD);AE.on("frame:ready",function(AY){var AZ=AE.getInstance();AZ.one("body").delegate("click",function(Ab){var Ai=this;if(AG!=Ab.currentTarget){var Ac=Ab.currentTarget;var Ag=Ac.get("parentNode");var Aa=Ac.getStyle("borderWidth");var Af=Ac.getStyle("padding");var Ad=(Ag.get("tagName").toLowerCase()=="a");AV.set("values",{border:(Aa?Aa+" solid":""),description:Ac.get("alt"),height:Ac.get("height"),imageURL:Ac.get("src"),linkURL:(Ad?Ag.get("href"):""),width:Ac.get("width"),padding:(Af?parseInt(Af):"")});var Ae=1;switch(Ac.getAttribute("align")){case"left":Ae=0;break;case"center":Ae=2;break;case"right":Ae=3;break;}AO.item(Ae).StateInteraction.set("active",true);AV.getField("openInNewWindow").get("node").attr("checked",(Ad&&Ag.getAttribute("target")=="_blank"));AL.set("title",f.STRINGS.EDIT_IMAGE);AP.set("label",f.STRINGS.SAVE);var Aj=AI.getXY();var Ah=Ac.getXY();Aj=[Aj[0]+Ah[0],Aj[1]+Ah[1]];AD.setStyle("width",Ac.get("offsetWidth"));AD.setStyle("height",Ac.get("offsetHeight"));AD.setXY(Aj);AD.show();AG=Ac;AT.set("align",{node:AD,points:["tl","bc"]});AT.show();}},"img");});}},createlink:function(AD,AC,AB){var A=this;AD.plug(P.Plugin.CreateLinkBase);}}};GROUPS[m]={children:[{icon:"insertunorderedlist",title:f.STRINGS.INSERT_UNORDERED_LIST},{icon:"insertorderedlist",title:f.STRINGS.INSERT_ORDERED_LIST}],generate:{init:function(AB){var A=this;AB.plug(P.Plugin.EditorLists);}}};GROUPS[C]={children:[{icon:"format",title:f.STRINGS.REMOVE_FORMAT},{icon:"source",title:f.STRINGS.SOURCE}],generate:{format:function(AE,AC,AB){var A=this;var AF=AE.frame;var AD=AC.button;AD.on("click",function(AJ){var AG=this;var AK=AG.getInstance();var AI=new AK.Selection();var AH=AI.getSelected();if(!AI.isCollapsed&&AH.size()){AH.each(function(AR,AN,AS){var AL=this;AR.removeAttribute("style");var AP=AR.get("innerHTML");AP=AP.replace(/<([a-zA-Z0-9]*)\b[^>]*>/g,"<$1>");for(var AO=0;AO<X.length;
AO++){var AM=new RegExp("(<"+X[AO]+">|<\\/"+X[AO]+">)","ig");AP=AP.replace(AM,"");}AR.set("innerHTML",AP);var AQ=AR.get("parentNode");if(!AQ.test("body")){AQ.removeAttribute("style");}});}},AE);},source:function(AE,AH,AC){var AI=this;var AB=AE.frame;var A=AB.get("container");var AF=AH.contentBox;var AD=AH.button;var AG=P.Node.create(F);AG.hide();A.append(AG);AD._visible=false;AD.on("click",function(AM){var AK=AD._visible;if(AK){AE.set("content",AG.val());AG.hide();AG.val("");AB.show();}else{var AL=AB._iframe;AG.val(AE.getContent());var AJ=AL.get("offsetHeight")-AG.getPadding("tb");AG.setStyle("height",AJ);AB.hide();AG.show();}AK=!AK;AD._visible=AK;AF.all("select").attr("disabled",AK);AF.all("button").attr("disabled",AK);AD.get("contentBox").attr("disabled",false);});}}};GROUPS[K]={children:[{icon:"styles"}],generate:{styles:function(AF,AD,AC){var A=this;var AE=AD.button;var AB=AE.get("boundingBox");AF.plug(P.Plugin.EditorMenu);AF.menu.add(P.merge({align:{node:AB,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:AB},AC));}}};GROUPS[r]={children:[{icon:"subscript",title:f.STRINGS.SUBSCRIPT},{icon:"superscript",title:f.STRINGS.SUPERSCRIPT}]};GROUPS[q]={children:[{icon:"bold",title:f.STRINGS.BOLD},{icon:"italic",title:f.STRINGS.ITALIC},{icon:"underline",title:f.STRINGS.UNDERLINE},{icon:"strikethrough",title:f.STRINGS.LINE_THROUGH}]};P.namespace("Plugin").EditorToolbar=f;},"@VERSION@",{requires:["aui-base","aui-button-item","aui-color-picker","aui-editor-menu-plugin","aui-editor-tools-plugin","aui-form-select","aui-overlay-context-panel","aui-panel","aui-toolbar","createlink-base","editor-lists","editor-base","plugin"]});