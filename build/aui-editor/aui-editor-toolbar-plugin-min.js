AUI.add("aui-editor-toolbar-plugin",function(P){var v=P.Lang,Q=v.isFunction,r=P.ClassNameManager.getClassName,b="editortoolbar",u="toolbar",S="alignment",d="color",g="content",M="font",p="indent",J="input",h="insert",Z="insertimage",i="list",q="mouseout",T="select",C="source",K="styles",m="subscript",l="text",n={backcolor:true,forecolor:true,format:true,insertimage:true,source:true,styles:true},V=["b","big","font","em","i","small","s","strike","strong","sub","sup","u"],N=r("button","holder"),O=r("field",J),U=r("field",J,"text"),G=r("field","label"),a=r("field","numeric"),W=r(b,Z),B=r(b,T,"fontname"),o=r(b,T,"fontsize"),E=r(b,"size","separator"),H=r(b,C,"textarea"),D=r("state","active"),I=r(b),X=r(b,g),L="<a></a>",Y="<img />",F='<textarea class="'+H+'"></textarea>',t='<div class="'+I+'"><div class="'+X+'"></div></div>',j='<div class="'+N+'"></div>',s='<select class="'+B+'">{0}</select>',R='<option selected="selected"></option>'+"<option>Arial</option>"+"<option>Arial Black</option>"+"<option>Comic Sans MS</option>"+"<option>Courier New</option>"+"<option>Lucida Console</option>"+"<option>Tahoma</option>"+"<option>Times New Roman</option>"+"<option>Trebuchet MS</option>"+"<option>Verdana</option>",k='<select class="'+o+'">{0}</select>',f='<option selected="selected"></option>'+'<option value="1">10</option>'+'<option value="2">13</option>'+'<option value="3">16</option>'+'<option value="4">18</option>'+'<option value="5">24</option>'+'<option value="6">32</option>'+'<option value="7">48</option>',e='<span class="'+E+'">x</span>';var c=P.Component.create({NAME:b,NS:u,EXTENDS:P.Plugin.Base,ATTRS:{groups:{value:[{type:l},{type:S},{type:p},{type:i}]}},prototype:{initializer:function(){var AK=this;var AB=AK.get("host");var z=AB.frame.get("container");var AL=AK.get("groups");var x=P.Node.create(t);var AA=x.one("."+X);z.placeBefore(x);var AD={boundingBox:x,contentBox:AA};var AC=[];AK.on("buttonitem:click",function(AP){var AO=this;var AN=AP.target.get("icon").split("-");if(!n[AN[0]]){AO.execCommand(AN[0],(AN[1]?AN[1]:""));AO.focus();}},AB);for(var AH=0;AH<AL.length;AH++){var w=AL[AH];var AE=GROUPS[w.type];var y;var A=[];for(var AG=0;AG<AE.children.length;AG++){if(!AE.children[AG].select){A.push(AE.children[AG]);}}if(A.length>0){y=new P.Toolbar(P.merge(AE.config,w.toolbar,{children:A})).render(AA);y.addTarget(AK);AC.push(y);}var AF=AE.generate;if(AF&&Q(AF.init)){AF.init.call(AK,AB,AD);}for(var AG=0;AG<AE.children.length;AG++){var AJ=AE.children[AG];var AI=AJ.icon;if(AF&&Q(AF[AI])){var AM=(w.config?w.config[AI]:null);AD.button=(AJ.select||!y?null:y.item(AG));AF[AI].call(AK,AB,AD,AM);}}}AD.toolbars=AC;},_updateToolbar:function(A,AB){var AC=this;if(A.changedNode){var x=A.commands;var AD=AB.toolbars;var AF=function(AH,AG,AJ){var AI=!!(x[AH.get("icon")]);AH.StateInteraction.set("active",AI);};if(AD){for(var z=0;z<AD.length;z++){AD[z].each(AF);}}var w=A.fontFamily;var AA=AB._fontNameOptions;var AE=A.fontSize;var y=AB._fontSizeOptions;if(AA){AA.item(0).set("selected",true);AA.each(function(AH,AG,AJ){var AI=AH.get("value").toLowerCase();if(AI===w.toLowerCase()){AH.set("selected",true);}});}if(y){AE=AE.replace("px","");y.item(0).set("selected",true);y.each(function(AI,AH,AK){var AJ=AI.get("value").toLowerCase();var AG=AI.get("text");if(AG===AE){AI.set("selected",true);}});}}}}});c.generateOverlay=function(x,w){var A=new P.OverlayContext(P.merge({align:{node:x,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:x},w)).render();return A;};c.generateColorPicker=function(AB,y,x,AC){var AA=y.button;var w=AA.get("boundingBox");var A=new P.ColorPicker(P.merge({align:{node:w,points:["tl","bl"]},trigger:w},x));if(x&&x.plugins){for(var z=0;z<x.plugins.length;z++){A.plug(x.plugins[z],x);}}A.render(P.getBody());A.on("colorChange",function(AF){var AD=this;var AE=A.get("rgb");AB.execCommand(AC,AE.hex);AB.focus();});};c.STRINGS={ALIGN:"Align",ALIGN_BLOCK:"Block",ALIGN_LEFT:"Left",ALIGN_INLINE:"Inline",ALIGN_RIGHT:"Right",BACKCOLOR:"Background Color",BOLD:"Bold",BORDER:"Border",CREATE_LINK:"Create Link",DESCRIPTION:"Description",FORECOLOR:"Foreground Color",IMAGE_URL:"Image URL",INDENT:"Indent",INSERT:"Insert",INSERT_IMAGE:"Insert Image",INSERT_ORDERED_LIST:"Insert Numbered List",INSERT_UNORDERED_LIST:"Insert Bulleted List",ITALIC:"Italic",JUSTIFY_LEFT:"Justify Left",JUSTIFY_CENTER:"Justify Center",JUSTIFY_RIGHT:"Justify Right",LINK_URL:"Link URL",OPEN_IN_NEW_WINDOW:"Open in new window",OUTDENT:"Outdent",PADDING:"Padding",REMOVE_FORMAT:"Format Source",SIZE:"Size",SOURCE:"Source",SUBSCRIPT:"Subscript",SUPERSCRIPT:"Superscript",LINE_THROUGH:"Line Through",UNDERLINE:"Underline"};GROUPS={};GROUPS[S]={children:[{icon:"justifyleft",title:c.STRINGS.JUSTIFY_LEFT},{icon:"justifycenter",title:c.STRINGS.JUSTIFY_CENTER},{icon:"justifyright",title:c.STRINGS.JUSTIFY_RIGHT}]};GROUPS[d]={children:[{icon:"forecolor",title:c.STRINGS.FORECOLOR},{icon:"backcolor",title:c.STRINGS.BACKCOLOR}],generate:{forecolor:function(y,x,w){var A=this;c.generateColorPicker(y,x,w,"forecolor");},backcolor:function(y,x,w){var A=this;c.generateColorPicker(y,x,w,"backcolor");}}};GROUPS[M]={children:[{icon:"fontname",select:true},{icon:"fontsize",select:true}],generate:{init:function(y,x){var A=this;var w=x.contentBox;P.delegate("change",function(AB){var z=this;var AD=AB.currentTarget;var AA=AD.get("className");var AC=AA.substring(AA.lastIndexOf("-")+1);var AE=AD.get("value");y.execCommand(AC,AE);y.focus();},w,"select");y.after("nodeChange",function(AA){var z=this;switch(AA.changedType){case"keyup":case"mousedown":z._updateToolbar(AA,x);break;}},A);},fontname:function(AB,AA,z){var A=this;var w=AA.contentBox;var y;var AC=[R];if(z&&z.optionHtml){AC[0]=z.optionHtml;}y=v.sub(s,AC);w.append(y);var x=w.all("."+B+" option");AA._fontNameOptions=x;},fontsize:function(AB,AA,z){var A=this;var w=AA.contentBox;var y;var AC=[f];if(z&&z.optionHtml){AC[0]=z.optionHtml;}y=v.sub(k,AC);w.append(y);var x=w.all("."+o+" option");AA._fontSizeOptions=x;}}};GROUPS[p]={children:[{icon:"indent",title:c.STRINGS.INDENT},{icon:"outdent",title:c.STRINGS.OUTDENT}]};
GROUPS[h]={children:[{icon:"insertimage",title:c.STRINGS.INSERT_IMAGE},{icon:"createlink",title:c.STRINGS.CREATE_LINK}],generate:{insertimage:function(y,AI,AQ){var AO=this;var A=AI.button;var AA=A.get("boundingBox");var AN=c.generateOverlay(AA,AQ);var AK=AN.get("contentBox");var AE=new P.Panel({collapsible:false,headerContent:c.STRINGS.INSERT_IMAGE,icons:[{icon:"close",handler:{fn:AN.hide,context:AN}}]}).render(AK);AK=AE.bodyNode;if(AQ&&AQ.dataBrowser){AQ.dataBrowser.render(AK);}else{var AG=y.getInstance();var AB=y.frame._iframe;var AR=null;var AP=new P.Form({cssClass:W,labelAlign:"left"}).render(AK);var AD=[{labelText:"none",value:""}];for(var AL=1;AL<6;AL++){AD.push({labelText:AL+"px",value:AL+"px solid"});}AP.add([{id:"imageURL",labelText:c.STRINGS.IMAGE_URL},{id:"size",labelText:c.STRINGS.SIZE,type:"hidden"},{id:"width",labelText:false,cssClass:a},{id:"height",labelText:false,cssClass:a},{id:"padding",labelText:c.STRINGS.PADDING},new P.Select({id:"border",labelText:c.STRINGS.BORDER,options:AD}),{id:"align",labelText:c.STRINGS.ALIGN,type:"hidden"},{id:"description",labelText:c.STRINGS.DESCRIPTION},{id:"linkURL",labelText:c.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:c.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);AP.getField("width").get("boundingBox").placeAfter(e);var z=AP.get("contentBox");var AM=P.Node.create(j);var AH=AP.getField("openInNewWindow");var AF=new P.ButtonItem({icon:"circle-check",label:c.STRINGS.INSERT}).render(AM);var AC=P.Node.create(Y);var w=AP.getField("height");var x=AP.getField("width");AC.on("load",function(AT){var AS=AT.currentTarget;if(!w.get("value")||!x.get("value")){AP.set("values",{height:AS.get("height"),width:AS.get("width")});}});AP.getField("imageURL").get("node").on("blur",function(AS){AC.set("src",this.val());});AF.on("click",function(AU){var Ac=this;var AX=P.Node.create(Y);var AW=AP.get("fieldValues");var Ab=AW.description;var AY={src:AW.imageURL,title:Ab,alt:Ab};var Aa={border:AW.border};var Ad=parseInt(AW.height,10);var AV=parseInt(AW.width,10);if(!isNaN(Ad)){AY.height=Ad;}if(!isNaN(AV)){AY.width=AV;}var AZ=parseInt(AW.padding,10);if(!isNaN(AZ)){Aa.padding=AZ;}AJ.some(function(Ag,Af,Ai){var Ae=this;var Ah=Ag.StateInteraction.get("active");if(Ah){Aa.display="";switch(Af){case 0:AY.align="left";break;case 1:AY.align="";break;case 2:AY.align="center";Aa.display="block";break;case 3:AY.align="right";break;}return true;}});AX.attr(AY);AX.setStyles(Aa);var AT=AW.linkURL;if(AT){var AS=P.Node.create(L);AS.attr("href",AT);if(AH.get("node").get("checked")){AS.attr("target","_blank");}AS.append(AX);AX=AS;}if(AR&&AR.anchorNode){AR.anchorNode.append(AX);}AN.hide();});z.append(AM);var AJ=new P.Toolbar({activeState:true,children:[{icon:"align-left",title:c.STRINGS.ALIGN_LEFT},{icon:"align-inline",title:c.STRINGS.ALIGN_INLINE},{icon:"align-block",title:c.STRINGS.ALIGN_BLOCK},{icon:"align-right",title:c.STRINGS.ALIGN_RIGHT}]});AJ.after("buttonitem:click",function(AT){var AS=AT.target;AJ.each(function(AV,AU,AW){if(AV!=AS){AV.StateInteraction.set("active",false);}});});AJ.render(AP.getField("align").get("contentBox"));AN.after("hide",function(AS){AP.resetValues();AJ.each(function(AU,AT,AV){AU.StateInteraction.set("active",false);});AH.get("node").set("checked",false);});AB.on(q,function(AS){var AT=y.getInstance();AR=new AT.Selection();});}},createlink:function(y,x,w){var A=this;y.plug(P.Plugin.CreateLinkBase);}}};GROUPS[i]={children:[{icon:"insertunorderedlist",title:c.STRINGS.INSERT_UNORDERED_LIST},{icon:"insertorderedlist",title:c.STRINGS.INSERT_ORDERED_LIST}],generate:{init:function(w){var A=this;w.plug(P.Plugin.EditorLists);}}};GROUPS[C]={children:[{icon:"format",title:c.STRINGS.REMOVE_FORMAT},{icon:"source",title:c.STRINGS.SOURCE}],generate:{format:function(z,x,w){var A=this;var AA=z.frame;var y=x.button;y.on("click",function(AE){var AB=this;var AF=AB.getInstance();var AD=new AF.Selection();var AC=AD.getSelected();if(!AD.isCollapsed&&AC.size()){AC.each(function(AM,AI,AN){var AG=this;AM.removeAttribute("style");var AK=AM.get("innerHTML");AK=AK.replace(/<([a-zA-Z0-9]*)\b[^>]*>/g,"<$1>");for(var AJ=0;AJ<V.length;AJ++){var AH=new RegExp("(<"+V[AJ]+">|<\\/"+V[AJ]+">)","ig");AK=AK.replace(AH,"");}AM.set("innerHTML",AK);var AL=AM.get("parentNode");if(!AL.test("body")){AL.removeAttribute("style");}});}},z);},source:function(z,AC,x){var AD=this;var w=z.frame;var A=w.get("container");var AA=AC.contentBox;var y=AC.button;var AB=P.Node.create(F);AB.hide();A.append(AB);y._visible=false;y.on("click",function(AH){var AF=y._visible;if(AF){z.set("content",AB.val());AB.hide();AB.val("");w.show();}else{var AG=w._iframe;AB.val(z.getContent());var AE=AG.get("offsetHeight")-AB.getPadding("tb");AB.setStyle("height",AE);w.hide();AB.show();}AF=!AF;y._visible=AF;AA.all("select").attr("disabled",AF);AA.all("button").attr("disabled",AF);y.get("contentBox").attr("disabled",false);});}}};GROUPS[K]={children:[{icon:"styles"}],generate:{styles:function(AA,y,x){var A=this;var z=y.button;var w=z.get("boundingBox");AA.plug(P.Plugin.EditorMenu);AA.menu.add(P.merge({align:{node:w,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:w},x));}}};GROUPS[m]={children:[{icon:"subscript",title:c.STRINGS.SUBSCRIPT},{icon:"superscript",title:c.STRINGS.SUPERSCRIPT}]};GROUPS[l]={children:[{icon:"bold",title:c.STRINGS.BOLD},{icon:"italic",title:c.STRINGS.ITALIC},{icon:"underline",title:c.STRINGS.UNDERLINE},{icon:"strikethrough",title:c.STRINGS.LINE_THROUGH}]};P.namespace("Plugin").EditorToolbar=c;},"@VERSION@",{requires:["aui-base","aui-button-item","aui-color-picker","aui-editor-menu-plugin","aui-editor-tools-plugin","aui-form-select","aui-overlay-context","aui-panel","aui-toolbar","createlink-base","editor-lists","editor-base","plugin"]});