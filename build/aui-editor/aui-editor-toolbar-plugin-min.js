AUI.add("aui-editor-toolbar-plugin",function(T){var AJ=T.Lang,d=AJ.isArray,U=AJ.isFunction,AE=T.ClassNameManager.getClassName,i="editortoolbar",AH="toolbar",X="alignment",e="align-left",w="align-inline",W="align-block",AI="align-right",k="color",p="content",Q="font",AD="indent",M="input",r="insert",g="insertimage",x="insertlink",s="list",Y="select",D="source",N="styles",z="subscript",y="text",n="circle-check",B="close",AB={backcolor:true,forecolor:true,format:true,insertimage:true,insertlink:true,source:true,styles:true},a=["b","big","font","em","i","small","s","strike","strong","sub","sup","u"],R=AE("button","holder"),S=AE("field",M),Z=AE("field",M,"text"),I=AE("field","label"),h=AE("field","numeric"),O=AE(i,"align","node"),b=AE(i,g),L=AE(i,x),C=AE(i,Y,"fontname"),AC=AE(i,Y,"fontsize"),G=AE(i,"size","separator"),J=AE(i,D,"textarea"),F=AE("state","active"),K=AE(i),c=AE(i,p),q='<div class="'+O+'"></div>',P="<a></a>",f="<img />",m='<a href="{0}"{2}>{1}</a>',H='<textarea class="'+J+'"></textarea>',AG='<div class="'+K+'"><div class="'+c+'"></div></div>',u='<div class="'+R+'"></div>',AF='<select class="'+C+'">{0}</select>',V='<option selected="selected"></option>'+"<option>Arial</option>"+"<option>Arial Black</option>"+"<option>Comic Sans MS</option>"+"<option>Courier New</option>"+"<option>Lucida Console</option>"+"<option>Tahoma</option>"+"<option>Times New Roman</option>"+"<option>Trebuchet MS</option>"+"<option>Verdana</option>",v='<select class="'+AC+'">{0}</select>',o='<option selected="selected"></option>'+'<option value="1">10</option>'+'<option value="2">13</option>'+'<option value="3">16</option>'+'<option value="4">18</option>'+'<option value="5">24</option>'+'<option value="6">32</option>'+'<option value="7">48</option>',l='<span class="'+G+'">x</span>';var j=T.Component.create({NAME:i,NS:AH,EXTENDS:T.Plugin.Base,ATTRS:{append:{value:null},groups:{value:[{type:Q},{type:y},{type:z},{type:k},{type:X},{type:AD},{type:s},{type:r},{type:D}]}},prototype:{initializer:function(){var AZ=this;var AQ=AZ.get("host");var AO=AQ.frame.get("container");var AX=AZ.get("append");var Aa=AZ.get("groups");var AM=T.Node.create(AG);var AP=AM.one("."+c);AO.placeBefore(AM);AZ._boundingBox=AM;AZ._contentBox=AP;var AR=[];if(AX!=null&&d(AX)){var AS=AX.length;for(var AV=0;AV<AS;AV++){var AY=AX[AV];if(AY.index!=null){var AK=AZ._isGroupIncluded("type",Aa,AY.type);if(AK!=-1){Aa.splice(AK,1);}Aa.splice(Math.min(AY.index,Aa.length),0,AY);}else{Aa.push(AY);}}}for(var AV=0;AV<Aa.length;AV++){var AL=Aa[AV];var AT=t[AL.type]||AL;var AW=[];if(d(AL.include)){var A=AL.include.length;for(var AU=0;AU<A;AU++){var AK=AZ._isGroupIncluded("icon",AT.children,AL.include[AU]);if(AK!=-1){AW.push(AT.children[AK]);}}}else{AW=AT.children;}var AN=AZ._addGroup(AL,AT,AW);if(AN){AR.push(AN);}}AZ._toolbars=AR;AP.delegate("click",function(Ae){var Ac=this;var Ad=T.Widget.getByNode(Ae.currentTarget);if(Ad){var Ab=Ad.get("icon").split("-");if(!AB[Ab[0]]){Ac.execCommand(Ab[0],(Ab[1]?Ab[1]:""));Ac.focus();}}},"button",AQ);},addGroup:function(AL){var A=this;var AK=t[AL.type]||AL;A._addGroup(AL,AK);},addGroupType:function(AK,AL){var A=this;if(!t[AK]){t[AK]=AL;}},_addGroup:function(AN,AT,AX){var Aa=this;var AK=(AX==null&&AN.index!=null);AX=AX||AT.children;if(d(AX)){var AQ=Aa.get("host");var AP=Aa._contentBox;var AL=[];var AO;var AS={boundingBox:Aa._boundingBox,contentBox:AP};for(var AW=0;AW<AX.length;AW++){var A=AX[AW];if(!A.select){var Ac=YUI.AUI.defaults.EditorToolbar.STRINGS[A._titleKey];A.title=(Ac!=null?Ac:AA[A._titleKey]);AL.push(A);}}if(AL.length>0){AO=new T.Toolbar(T.merge(AT.config,AN.toolbar,{children:AL})).render(AP);}var AU=AT.generate;if(AU&&U(AU.init)){AU.init.call(Aa,AQ,AS);}AL=(AL.length>0?AL:AX);for(var AW=0;AW<AL.length;AW++){var AZ=AL[AW];var AY=AZ.icon;if(AU&&U(AU[AY])){var Ab=(AN.config?AN.config[AY]:null);AS.button=(AZ.select||!AO?null:AO.item(AW));AU[AY].call(Aa,AQ,AS,Ab);}}if(AK){var AR=AP.get("childNodes");var AV=AR.size();var AM=AN.index;if(AM<AV-1){AP.insert(AR.item(AV-1),AR.item(AM));}}return AO;}},_isGroupIncluded:function(AK,AM,AN){var A=this;for(var AL=0;AL<AM.length;AL++){if(AM[AL][AK]==AN){return AL;}}return -1;},_updateToolbar:function(A,AP){var AQ=this;if(A.changedNode){var AL=A.commands;var AR=AQ.toolbars;var AT=function(AV,AU,AX){var AW=!!(AL[AV.get("icon")]);AV.StateInteraction.set("active",AW);};if(AR){for(var AN=0;AN<AR.length;AN++){AR[AN].each(AT);}}var AK=A.fontFamily;var AO=AP._fontNameOptions;var AS=A.fontSize;var AM=AP._fontSizeOptions;if(AO){AO.item(0).set("selected",true);AO.each(function(AV,AU,AX){var AW=AV.get("value").toLowerCase();if(AW===AK.toLowerCase()){AV.set("selected",true);}});}if(AM){AS=AS.replace("px","");AM.item(0).set("selected",true);AM.each(function(AW,AV,AY){var AX=AW.get("value").toLowerCase();var AU=AW.get("text");if(AU===AS){AW.set("selected",true);}});}}}}});function E(AL){var A=this;var AN=AL.currentTarget;var AK=AN.get("className");var AM=AK.substring(AK.lastIndexOf("-")+1);var AO=AN.get("value");A.execCommand(AM,AO);A.focus();}j.generateOverlay=function(AM,AL,A){var AK=new T["OverlayContext"+(A?"Panel":"")](T.merge({align:{node:AM,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:AM},AL)).render();return AK;};j.generateColorPicker=function(AP,AM,AL,AQ){var AO=AM.button;var AK=AO.get("boundingBox");var A=new T.ColorPicker(T.merge({align:{node:AK,points:["tl","bl"]},trigger:AK},AL));if(AL&&AL.plugins){for(var AN=0;AN<AL.plugins.length;AN++){A.plug(AL.plugins[AN],AL);}}A.render(T.getBody());A.on("colorChange",function(AT){var AR=this;var AS=A.get("rgb");AP.execCommand(AQ,AS.hex);AP.focus();});};j.openOverlayToAlignNode=function(AL,AK,AM,A){var AO=AM.getXY();var AN=A.getXY();AO=[AO[0]+AN[0],AO[1]+AN[1]];AK.setStyle("width",A.get("offsetWidth"));AK.setStyle("height",A.get("offsetHeight"));AK.setXY(AO);AK.show();AL.set("align",{node:AK,points:["tl","bc"]});AL.show();};var AA={ALIGN:"Align",ALIGN_BLOCK:"Block",ALIGN_LEFT:"Left",ALIGN_INLINE:"Inline",ALIGN_RIGHT:"Right",BACKCOLOR:"Background Color",BOLD:"Bold",BORDER:"Border",DESCRIPTION:"Description",EDIT_IMAGE:"Edit Image",EDIT_LINK:"Edit Link",FORECOLOR:"Foreground Color",IMAGE_URL:"Image URL",INDENT:"Indent",INSERT:"Insert",INSERT_IMAGE:"Insert Image",INSERT_LINK:"Insert Link",INSERT_ORDERED_LIST:"Insert Numbered List",INSERT_UNORDERED_LIST:"Insert Bulleted List",ITALIC:"Italic",JUSTIFY_LEFT:"Justify Left",JUSTIFY_CENTER:"Justify Center",JUSTIFY_RIGHT:"Justify Right",LINE_THROUGH:"Line Through",LINK_URL:"Link URL",OPEN_IN_NEW_WINDOW:"Open in new window",OUTDENT:"Outdent",PADDING:"Padding",REMOVE_FORMAT:"Format Source",SAVE:"Save",SIZE:"Size",SOURCE:"Source",SUBSCRIPT:"Subscript",SUPERSCRIPT:"Superscript",STYLES:"Styles",UNDERLINE:"Underline"};
if(!YUI.AUI.defaults.EditorToolbar){YUI.AUI.defaults.EditorToolbar={STRINGS:{}};}T.mix(YUI.AUI.defaults.EditorToolbar.STRINGS,AA);var t={};t[X]={children:[{icon:"justifyleft",_titleKey:"JUSTIFY_LEFT"},{icon:"justifycenter",_titleKey:"JUSTIFY_CENTER"},{icon:"justifyright",_titleKey:"JUSTIFY_RIGHT"}]};t[k]={children:[{icon:"forecolor",_titleKey:"FORECOLOR"},{icon:"backcolor",_titleKey:"BACKCOLOR"}],generate:{forecolor:function(AM,AL,AK){var A=this;j.generateColorPicker(AM,AL,AK,"forecolor");},backcolor:function(AM,AL,AK){var A=this;j.generateColorPicker(AM,AL,AK,"backcolor");}}};t[Q]={children:[{icon:"fontname",select:true},{icon:"fontsize",select:true}],generate:{init:function(AM,AL){var A=this;var AK=AL.contentBox;AM.after("nodeChange",function(AO){var AN=this;switch(AO.changedType){case"keyup":case"mousedown":AN._updateToolbar(AO,AL);break;}},A);},fontname:function(AO,AN,AM){var A=this;var AK=AN.contentBox;var AP;var AQ=[V];if(AM&&AM.optionHtml){AQ[0]=AM.optionHtml;}AP=T.Node.create(AJ.sub(AF,AQ));AK.append(AP);AP.on("change",E,AO);var AL=AK.all("."+C+" option");AN._fontNameOptions=AL;return AP;},fontsize:function(AO,AN,AM){var A=this;var AK=AN.contentBox;var AP;var AQ=[o];if(AM&&AM.optionHtml){AQ[0]=AM.optionHtml;}AP=T.Node.create(AJ.sub(v,AQ));AK.append(AP);AP.on("change",E,AO);var AL=AK.all("."+AC+" option");AN._fontSizeOptions=AL;return AP;}}};t[AD]={children:[{icon:"indent",_titleKey:"INDENT"},{icon:"outdent",_titleKey:"OUTDENT"}]};t[r]={children:[{icon:"insertimage",_titleKey:"INSERT_IMAGE"},{icon:"insertlink",_titleKey:"INSERT_LINK"}],generate:{insertimage:function(AN,AW,Af){var Ad=this;var A=AW.button;var AQ=A.get("boundingBox");var Ac=j.generateOverlay(AQ,Af,true);var AZ=Ac.get("contentBox");var AU=new T.Panel({collapsible:false,title:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_IMAGE,icons:[{icon:B,handler:{fn:Ac.hide,context:Ac}}]}).render(AZ);AZ=AU.bodyNode;if(Af&&Af.dataBrowser){Af.dataBrowser.render(AZ);}else{var AR=AN.frame._iframe;var AP;var Ag;var Ae=new T.Form({cssClass:b,labelAlign:"left"}).render(AZ);var AT=[{labelText:"none",value:"none"}];for(var Aa=1;Aa<6;Aa++){AT.push({labelText:Aa+"px",value:Aa+"px solid"});}Ae.add([{id:"imageURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.IMAGE_URL},{id:"size",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.SIZE,type:"hidden"},{id:"width",labelText:false,cssClass:h},{id:"height",labelText:false,cssClass:h},{id:"padding",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.PADDING},new T.Select({id:"border",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.BORDER,options:AT}),{id:"align",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN,type:"hidden"},{id:"description",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.DESCRIPTION},{id:"linkURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);Ae.getField("width").get("boundingBox").placeAfter(l);var AO=Ae.get("contentBox");var Ab=T.Node.create(u);var AV=Ae.getField("openInNewWindow");var AY=new T.ButtonItem({icon:n,label:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT}).render(Ab);AY.on("click",function(Ai){var As=this;var Aj;var Am;var Aq;if(AP){Am=AP;Aq=AP.get("parentNode");if(Aq.get("tagName").toLowerCase()=="a"){Aj=Aq;}}else{Am=T.Node.create(f);}var Al=Ae.get("fieldValues");var Ar=Al.description;var An={src:Al.imageURL,title:Ar,alt:Ar};var Ap={border:Al.border};var At=parseInt(Al.height,10);var Ak=parseInt(Al.width,10);if(!isNaN(At)){An.height=At;}if(!isNaN(Ak)){An.width=Ak;}var Ao=parseInt(Al.padding,10);if(!isNaN(Ao)){Ap.padding=Ao;}AX.some(function(Aw,Av,Ay){var Au=this;var Ax=Aw.StateInteraction.get("active");if(Ax){Ap.display="";switch(Av){case 0:An.align="left";break;case 1:An.align="";break;case 2:An.align="center";Ap.display="block";break;case 3:An.align="right";break;}return true;}});Am.setAttrs(An);Am.setStyles(Ap);var Ah=Al.linkURL;if(Ah){if(!Aj){Aj=T.Node.create(P);if(AP){Aq.insert(Aj,AP);}Aj.append(Am);}Aj.setAttribute("href",Ah);Aj.setAttribute("target",(AV.get("node").get("checked")?"_blank":""));Am=Aj;}else{if(AP&&Aj){Aq.insert(AP,Aj);Aj.remove(true);}}if(!AP&&Ag&&Ag.anchorNode){Ag.anchorNode.append(Am);}Ac.hide();});var AS=T.Node.create(f);var AK=Ae.getField("height");var AL=Ae.getField("width");AS.on("load",function(Ai){var Ah=Ai.currentTarget;if(!AK.get("value")||!AL.get("value")){Ae.set("values",{height:Ah.get("height"),width:Ah.get("width")});}});Ae.getField("imageURL").get("node").on("blur",function(Ah){AS.set("src",this.val());});AO.append(Ab);var AX=new T.Toolbar({activeState:true,children:[{icon:e,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_LEFT},{icon:w,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_INLINE},{icon:W,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_BLOCK},{icon:AI,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_RIGHT}]});AX.after("buttonitem:click",function(Ai){var Ah=Ai.target;AX.each(function(Ak,Aj,Al){if(Ak!=Ah){Ak.StateInteraction.set("active",false);}});});AX.render(Ae.getField("align").get("contentBox"));Ac.on("show",function(Ah){if(!Ag||!Ag.anchorNode){var Ai=AN.getInstance();AN.focus();Ag=new Ai.Selection();}});Ac.after("hide",function(Ah){Ae.resetValues();AX.each(function(Aj,Ai,Ak){Aj.StateInteraction.set("active",false);});AV.get("node").set("checked",false);AU.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_IMAGE);AY.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT);AM.hide();Ac.set("align",{node:AQ,points:["tl","bl"]});AP=null;});var AM=T.Node.create(q);AM.hide();T.getBody().append(AM);AN.on("toolbar:ready",function(){var Ah=AN.frame._iframe;var Ai=AN.getInstance();Ah.on("mouseout",function(Aj){var Ak=AN.getInstance();Ag=new Ak.Selection();});Ai.one("body").delegate("click",function(Ao){var Aj=this;if(AP!=Ao.currentTarget){var Al=Ao.currentTarget;var An=Al.get("parentNode");var Ak=Al.getStyle("borderWidth");var Ap=Al.getStyle("padding");var Aq=(An.get("tagName").toLowerCase()=="a");
Ae.set("values",{border:(Ak?Ak+" solid":""),description:Al.get("alt"),height:Al.get("height"),imageURL:Al.get("src"),linkURL:(Aq?An.get("href"):""),width:Al.get("width"),padding:(Ap?parseInt(Ap):"")});var Am=1;switch(Al.getAttribute("align")){case"left":Am=0;break;case"center":Am=2;break;case"right":Am=3;break;}AX.item(Am).StateInteraction.set("active",true);AV.get("node").attr("checked",(Aq&&An.getAttribute("target")=="_blank"));AU.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.EDIT_IMAGE);AY.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.SAVE);AP=Al;j.openOverlayToAlignNode(Ac,AM,Ah,Al);}},"img");});}},insertlink:function(AL,AT,AZ){var AY=this;var A=AT.button;var AN=A.get("boundingBox");var AX=j.generateOverlay(AN,AZ,true);var AV=AX.get("contentBox");var AR=new T.Panel({collapsible:false,title:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_LINK,icons:[{icon:B,handler:{fn:AX.hide,context:AX}}]}).render(AV);AV=AR.bodyNode;var AO=AL.frame._iframe;var AM;var Aa;var AQ=new T.Form({cssClass:L,labelAlign:"left"}).render(AV);AQ.add([{id:"description",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.DESCRIPTION},{id:"linkURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);var AP=AQ.get("contentBox");var AW=T.Node.create(u);var AS=AQ.getField("openInNewWindow");var AU=new T.ButtonItem({icon:n,label:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT}).render(AW);AU.on("click",function(Ad){var Ab=this;var Ac=AQ.get("fieldValues");if(AM){AM.setAttribute("href",Ac.linkURL);AM.set("innerHTML",Ac.description);if(AS.get("node").get("checked")){AM.setAttribute("target","_blank");}else{AM.setAttribute("target","");}}else{AL.execCommand("inserthtml",AJ.sub(m,[Ac.linkURL,Ac.description,(AS.get("node").get("checked")?' target="_blank"':"")]));}AX.hide();});AP.append(AW);AX.after("hide",function(Ab){AQ.resetValues();AS.get("node").set("checked",false);AR.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.CREATE_LINK);AU.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT);AK.hide();AX.set("align",{node:AN,points:["tl","bl"]});AM=null;});var AK=T.Node.create(q);AK.hide();T.getBody().append(AK);AL.on("toolbar:ready",function(){var Ab=AL.getInstance();Ab.one("body").delegate("click",function(Af){var Ac=this;if(AM!=Af.currentTarget){var Ae=Af.currentTarget;if(!Ae.one("img")){var Ad=Ae.get("parentNode");AQ.set("values",{description:Ae.get("innerHTML"),linkURL:Ae.getAttribute("href"),});AS.get("node").attr("checked",(Ae.getAttribute("target")=="_blank"));AR.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.EDIT_LINK);AU.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.SAVE);AM=Ae;j.openOverlayToAlignNode(AX,AK,AO,Ae);}}},"a");});}}};t[s]={children:[{icon:"insertunorderedlist",_titleKey:"INSERT_UNORDERED_LIST"},{icon:"insertorderedlist",_titleKey:"INSERT_ORDERED_LIST"}],generate:{init:function(AK){var A=this;AK.plug(T.Plugin.EditorLists);}}};t[D]={children:[{icon:"format",_titleKey:"REMOVE_FORMAT"},{icon:"source",_titleKey:"SOURCE"}],generate:{format:function(AN,AL,AK){var A=this;var AO=AN.frame;var AM=AL.button;AM.on("click",function(AS){var AP=this;var AT=AP.getInstance();var AR=new AT.Selection();var AQ=AR.getSelected();if(!AR.isCollapsed&&AQ.size()){AQ.each(function(Aa,AW,Ab){var AU=this;Aa.removeAttribute("style");var AY=Aa.get("innerHTML");AY=AY.replace(/<([a-zA-Z0-9]*)\b[^>]*>/g,"<$1>");for(var AX=0;AX<a.length;AX++){var AV=new RegExp("(<"+a[AX]+">|<\\/"+a[AX]+">)","ig");AY=AY.replace(AV,"");}Aa.set("innerHTML",AY);var AZ=Aa.get("parentNode");if(!AZ.test("body")){AZ.removeAttribute("style");}});}},AN);},source:function(AN,AQ,AL){var AR=this;var AK=AN.frame;var A=AK.get("container");var AO=AQ.contentBox;var AM=AQ.button;var AP=T.Node.create(H);AP.hide();A.append(AP);AM._visible=false;AM.on("click",function(AV){var AT=AM._visible;if(AT){AN.set("content",AP.val());AP.hide();AP.val("");AK.show();}else{var AU=AK._iframe;AP.val(AN.getContent());var AS=AU.get("offsetHeight")-AP.getPadding("tb");AP.setStyle("height",AS);AK.hide();AP.show();}AT=!AT;AM._visible=AT;AO.all("select").attr("disabled",AT);AO.all("button").attr("disabled",AT);AM.get("contentBox").attr("disabled",false);});}}};t[N]={children:[{icon:"styles",_titleKey:"STYLES"}],generate:{styles:function(AO,AM,AL){var A=this;var AN=AM.button;var AK=AN.get("boundingBox");AO.plug(T.Plugin.EditorMenu);AO.menu.add(T.merge({align:{node:AK,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:AK},AL));}}};t[z]={children:[{icon:"subscript",_titleKey:"SUBSCRIPT"},{icon:"superscript",_titleKey:"SUPERSCRIPT"}]};t[y]={children:[{icon:"bold",_titleKey:"BOLD"},{icon:"italic",_titleKey:"ITALIC"},{icon:"underline",_titleKey:"UNDERLINE"},{icon:"strikethrough",_titleKey:"LINE_THROUGH"}]};T.namespace("Plugin").EditorToolbar=j;},"@VERSION@",{requires:["aui-base","aui-button-item","aui-color-picker","aui-editor-menu-plugin","aui-editor-tools-plugin","aui-form-select","aui-overlay-context-panel","aui-panel","aui-toolbar","createlink-base","editor-lists","editor-base","plugin"]});