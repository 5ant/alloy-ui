AUI.add("aui-image-viewer-gallery",function(r){var m=r.Lang,D=m.isBoolean,ag=m.isNumber,M=m.isObject,p=m.isString,o="autoPlay",V="body",N="content",e="currentIndex",P="delay",v=".",J="entry",g="handler",S="helper",Y="hidden",T="href",d="image-gallery",F="img",w="left",R="links",Q="offsetWidth",u="page",aj="paginator",E="paginatorEl",G="paginatorInstance",i="pause",C="paused",b="pausedLabel",aa="play",x="player",z="playing",n="playingLabel",ah="px",l="repeat",s="showPlayer",a=" ",ac="src",ab="thumb",W="toolbar",ai="totalLinks",t="useOriginalImage",H="viewportRegion",af="visible",B=function(){return Array.prototype.slice.call(arguments).join(a);},j=r.ClassNameManager.getClassName,K=j(d,aj),q=j(d,aj,N),O=j(d,aj,J),U=j(d,aj,R),ae=j(d,aj,ab),c=j(d,x),X=j(d,x,N),f=j(S,Y),al="(playing)",k='<div class="'+q+'">{PageLinks}</div>',y='<span class="'+O+'"><span class="'+ae+'"></span></span>',h='<div class="'+U+'"></div>',ak='<div class="'+B(f,K)+'"></div>',Z='<div class="'+c+'"></div>',ad='<span class="'+X+'"></span>';var I=r.Component.create({NAME:d,ATTRS:{autoPlay:{value:false,validator:D},delay:{value:7000,validator:ag},paginator:{value:{},setter:function(L){var A=this;var an=A.get(E);var am=A.get(ai);return r.merge({containers:an,pageContainerTemplate:h,pageLinkContent:r.bind(A._setThumbContent,A),pageLinkTemplate:y,template:k,total:am,on:{changeRequest:function(ao){A.fire("changeRequest",{state:ao.state});}}},L);},validator:M},paginatorEl:{readyOnly:true,valueFn:function(){return r.Node.create(ak);}},paginatorInstance:{value:null},paused:{value:false,validator:D},pausedLabel:{value:"",validator:p},playing:{value:false,validator:D},playingLabel:{value:al,validator:p},repeat:{value:true,validator:D},showPlayer:{value:true,validator:D},toolbar:{value:{},setter:function(L){var A=this;return r.merge({children:[{id:aa,icon:aa},{id:i,icon:i}]},L);},validator:M},useOriginalImage:{value:false,validator:D}},EXTENDS:r.ImageViewer,prototype:{toolbar:null,_timer:null,renderUI:function(){var A=this;I.superclass.renderUI.apply(this,arguments);A._renderPaginator();if(A.get(s)){A._renderPlayer();}},bindUI:function(){var A=this;I.superclass.bindUI.apply(this,arguments);A._bindToolbarUI();A.on("playingChange",A._onPlayingChange);A.on("pausedChange",A._onPausedChange);A.publish("changeRequest",{defaultFn:this._changeRequest});},destroy:function(){var A=this;I.superclass.destroy.apply(this,arguments);A.get(G).destroy();},hidePaginator:function(){var A=this;A.get(E).addClass(f);},pause:function(){var A=this;A.set(C,true);A.set(z,false);A._syncInfoUI();},play:function(){var A=this;A.set(C,false);A.set(z,true);A._syncInfoUI();},show:function(){var A=this;var am=A.getCurrentLink();if(am){A.showMask();r.ImageViewer.superclass.show.apply(this,arguments);var L=A.get(G);L.set(u,A.get(e)+1);L.changeRequest();}},showPaginator:function(){var A=this;A.get(E).removeClass(f);},_bindToolbarUI:function(){var A=this;if(A.get(s)){var L=A.toolbar;var an=L.item(aa);var am=L.item(i);if(an){an.set(g,r.bind(A.play,A));}if(am){am.set(g,r.bind(A.pause,A));}}},_cancelTimer:function(){var A=this;if(A._timer){A._timer.cancel();}},_renderPaginator:function(){var A=this;var am=A.get(E);r.one(V).append(am.hide());var L=new r.Paginator(A.get(aj)).render();A.set(G,L);},_renderPlayer:function(){var A=this;var am=A.get(E);var L=r.Node.create(ad);am.append(r.Node.create(Z).append(L));A.toolbar=new r.Toolbar(A.get(W)).render(L);},_startTimer:function(){var A=this;var L=A.get(P);A._cancelTimer();A._timer=r.later(L,A,A._syncSlideShow);},_syncControlsUI:function(){var A=this;I.superclass._syncControlsUI.apply(this,arguments);if(A.get(af)){A._syncSelectedThumbUI();A.showPaginator();}else{A.hidePaginator();A._cancelTimer();}},_syncSelectedThumbUI:function(){var A=this;var am=A.get(e);var L=A.get(G);var an=L.get(u)-1;if(am!=an){L.set(u,am+1);L.changeRequest();}},_syncSlideShow:function(){var A=this;if(!A.hasNext()){if(A.get(l)){A.set(e,-1);}else{A._cancelTimer();}}A.next();},_changeRequest:function(ap){var A=this;var am=ap.state.paginator;var ar=ap.state;var ao=ar.before;var aq=ar.page;if(!A.get(af)){return false;}var L=A.get(e);var an=aq-1;if(!ao||(ao&&ao.page!=aq)){A.set(e,an);am.setState(ar);A._processChangeRequest();}},_processChangeRequest:function(){var A=this;A.loadImage(A.getCurrentLink().attr(T));var am=A.get(C);var L=A.get(z);if(L&&!am){A._startTimer();}},_setThumbContent:function(ar,L){var A=this;var an=L-1;var ap=A.getLink(an);var aq=ar.one(v+ae);var ao=null;if(A.get(t)){ao=ap.attr(T);}else{var am=ap.one(F);if(am){ao=am.attr(ac);}}if(ao&&aq.getData("thumbSrc")!=ao){aq.setStyles({backgroundImage:"url("+ao+")"});aq.setData("thumbSrc",ao);}},_getInfoTemplate:function(L){var am;var A=this;var ao=A.get(C);var an=A.get(z);if(an){am=A.get(n);}else{if(ao){am=A.get(b);}}return B(I.superclass._getInfoTemplate.apply(this,arguments),am);},_afterVisibleChange:function(L){var A=this;I.superclass._afterVisibleChange.apply(this,arguments);if(L.newVal){if(A.get(o)){A.play();}}},_onPausedChange:function(L){var A=this;if(L.newVal){A._cancelTimer();}},_onPlayingChange:function(L){var A=this;if(L.newVal){A._startTimer();}}}});r.ImageGallery=I;},"@VERSION@",{requires:["aui-image-viewer-base","aui-paginator","aui-toolbar"],skinnable:true});