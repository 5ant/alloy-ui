AUI.add("aui-image-viewer-gallery",function(T){var O=T.Lang,h=O.isBoolean,AH=O.isNumber,p=O.isObject,R=O.isString,Q="autoPlay",x="body",q="content",F="currentIndex",s="delay",Y=".",n="entry",H="handler",z="hidden",v="href",E="image-gallery",j="img",Z="left",u="links",t="offsetWidth",V="overlay",X="page",AK="paginator",i="paginatorEl",k="paginatorInstance",J="pause",g="paused",C="pausedLabel",AB="play",a="player",d="playing",P="playingLabel",AI="px",N="repeat",U="showPlayer",B=" ",AD="src",AC="thumb",f="toolSet",c="toolSetInstance",AJ="totalLinks",W="useOriginalImage",l="viewportRegion",AG="visible",e=function(){return Array.prototype.slice.call(arguments).join(B);},K=T.ClassNameManager.getClassName,o=K(E,AK),S=K(E,AK,q),r=K(E,AK,n),w=K(E,AK,u),AF=K(E,AK,AC),D=K(E,a),y=K(E,a,q),G=K(V,z),AM="(playing)",M='<div class="'+S+'">{PageLinks}</div>',b='<span class="'+r+'"><span class="'+AF+'"></span></span>',I='<div class="'+w+'"></div>',AL='<div class="'+e(G,o)+'"></div>',AA='<div class="'+D+'"></div>',AE='<span class="'+y+'"></span>';function m(A){m.superclass.constructor.apply(this,arguments);}T.mix(m,{NAME:E,ATTRS:{autoPlay:{value:false,validator:h},delay:{value:7000,validator:AH},paginator:{value:{},setter:function(L){var A=this;var AO=A.get(i);var AN=A.get(AJ);return T.merge({containers:AO,pageContainerTemplate:I,pageLinkContent:T.bind(A._setThumbContent,A),pageLinkTemplate:b,template:M,total:AN,on:{changeRequest:function(AP){A.fire("changeRequest",{state:AP.state});}}},L);},validator:p},paginatorEl:{readyOnly:true,valueFn:function(){return T.Node.create(AL);}},paginatorInstance:{value:null},paused:{value:false,validator:h},pausedLabel:{value:"",validator:R},playing:{value:false,validator:h},playingLabel:{value:AM,validator:R},repeat:{value:true,validator:h},showPlayer:{value:true,validator:h},toolSet:{value:{},setter:function(L){var A=this;return T.merge({tools:[{id:AB,icon:AB},{id:J,icon:J}]},L);},validator:p},toolSetInstance:{value:null},useOriginalImage:{value:false,validator:h}}});T.extend(m,T.ImageViewer,{_timer:null,renderUI:function(){var A=this;m.superclass.renderUI.apply(this,arguments);A._renderPaginator();if(A.get(U)){A._renderPlayer();}},bindUI:function(){var A=this;m.superclass.bindUI.apply(this,arguments);A._bindToolSetUI();A.on("playingChange",A._onPlayingChange);A.on("pausedChange",A._onPausedChange);A.publish("changeRequest",{defaultFn:this._changeRequest});},destroy:function(){var A=this;m.superclass.destroy.apply(this,arguments);A.get(k).destroy();},hidePaginator:function(){var A=this;A.get(i).addClass(G);},pause:function(){var A=this;A.set(g,true);A.set(d,false);A._syncInfoUI();},play:function(){var A=this;A.set(g,false);A.set(d,true);A._syncInfoUI();},show:function(){var A=this;var AN=A.getCurrentLink();if(AN){A.showMask();T.ImageViewer.superclass.show.apply(this,arguments);var L=A.get(k);L.set(X,A.get(F)+1);L.changeRequest();}},showPaginator:function(){var A=this;A.get(i).removeClass(G);},_bindToolSetUI:function(){var A=this;if(A.get(U)){var L=A.get(c);var AO=L.item(AB);var AN=L.item(J);AO.set(H,T.bind(A.play,A));AN.set(H,T.bind(A.pause,A));}},_cancelTimer:function(){var A=this;if(A._timer){A._timer.cancel();}},_renderPaginator:function(){var A=this;var AN=A.get(i);T.one(x).append(AN.hide());var L=new T.Paginator(A.get(AK)).render();A.set(k,L);},_renderPlayer:function(){var A=this;var AO=A.get(i);var AN=T.Node.create(AE);AO.append(T.Node.create(AA).append(AN));var L=new T.ToolSet(A.get(f)).render(AN);A.set(c,L);},_startTimer:function(){var A=this;var L=A.get(s);A._cancelTimer();A._timer=T.later(L,A,A._syncSlideShow);},_syncControlsUI:function(){var A=this;m.superclass._syncControlsUI.apply(this,arguments);if(A.get(AG)){A._syncSelectedThumbUI();A.showPaginator();}else{A.hidePaginator();A._cancelTimer();}},_syncSelectedThumbUI:function(){var A=this;var AN=A.get(F);var L=A.get(k);var AO=L.get(X)-1;if(AN!=AO){L.set(X,AN+1);L.changeRequest();}},_syncSlideShow:function(){var A=this;if(!A.hasNext()){if(A.get(N)){A.set(F,-1);}else{A._cancelTimer();}}A.next();},_changeRequest:function(A){var AS=this;var AO=A.state.paginator;var AN=A.state;var AR=AN.before;var AQ=AN.page;if(!AS.get(AG)){return false;}var AP=AS.get(F);var L=AQ-1;if(!AR||(AR&&AR.page!=AQ)){AS.set(F,L);AS.loadImage(AS.getCurrentLink().attr(v));AO.setState(AN);var AU=AS.get(g);var AT=AS.get(d);if(AT&&!AU){AS._startTimer();}}},_setThumbContent:function(AS,L){var A=this;var AO=L-1;var AQ=A.getLink(AO);var AR=AS.one(Y+AF);var AP=null;if(A.get(W)){AP=AQ.attr(v);}else{var AN=AQ.one(j);if(AN){AP=AN.attr(AD);}}if(AP){AR.setStyles({backgroundImage:"url("+AP+")"});}},_getInfoTemplate:function(L){var AN;var A=this;var AP=A.get(g);var AO=A.get(d);if(AO){AN=A.get(P);}else{if(AP){AN=A.get(C);}}return e(m.superclass._getInfoTemplate.apply(this,arguments),AN);},_afterVisibleChange:function(L){var A=this;m.superclass._afterVisibleChange.apply(this,arguments);if(L.newVal){if(A.get(Q)){A.play();}}},_onPausedChange:function(L){var A=this;if(L.newVal){A._cancelTimer();}},_onPlayingChange:function(L){var A=this;if(L.newVal){A._startTimer();}}});T.ImageGallery=m;},"@VERSION@",{requires:["aui-image-viewer-base","aui-paginator","aui-tool-set"],skinnable:true});