AUI.add("aui-resize-constrain",function(U){var J=U.Lang,P=J.isBoolean,T=J.isNumber,R=J.isString,a=function(A){return(A instanceof U.Node);},d="borderBottomWidth",G="borderLeftWidth",Z="borderRightWidth",K="borderTopWidth",N="bottom",M="con",e="constrain",f="host",S="left",I="maxHeight",W="maxWidth",B="minHeight",L="minWidth",g="node",C="offsetHeight",O="offsetWidth",E="preserveRatio",Y="region",V="resizeConstrained",Q="right",F="tickX",D="tickY",X="top",c="view",b="viewportRegion";function H(){H.superclass.constructor.apply(this,arguments);}U.mix(H,{NAME:V,NS:M,ATTRS:{constrain:{setter:function(A){if(A&&(a(A)||R(A)||A.nodeType)){A=U.one(A);}return A;}},minHeight:{value:15,validator:T},minWidth:{value:15,validator:T},maxHeight:{value:Infinity,validator:T},maxWidth:{value:Infinity,validator:T},preserveRatio:{value:false,validator:P},tickX:{value:false},tickY:{value:false}}});U.extend(H,U.Plugin.Base,{constrainBorderInfo:null,initializer:function(){var A=this;var h=A.get(f);A.constrainBorderInfo={bottom:0,left:0,right:0,top:0};h.delegate.dd.plug(U.Plugin.DDConstrained,{tickX:A.get(F),tickY:A.get(D)});h.after("resize:align",U.bind(A._handleResizeAlignEvent,A));h.on("resize:start",U.bind(A._handleResizeStartEvent,A));},_checkConstrain:function(h,p,i){var n=this;var q=n.get(f);var A=q.info;var l=n._getConstrainRegion();if(l){var m=A[h]+A[i];var j=l[p]-n.constrainBorderInfo[p];if(m>=j){A[i]-=(m-j);}var k=A[h];var o=l[h]+n.constrainBorderInfo[h];if(k<=o){A[h]+=(o-k);A[i]-=(o-k);}}},_checkHeight:function(){var A=this;var i=A.get(f);var l=i.info;var k=i.originalInfo;var h=A.get(I);var j=A.get(B);A._checkConstrain(X,N,C);if(l.offsetHeight>h){i._checkSize(C,j);}if(l.offsetHeight<j){i._checkSize(C,h);}},_checkRatio:function(){var l=this;var n=l.get(f);var h=n.info;var j=n.originalInfo;var o=j.offsetWidth;var A=j.offsetHeight;var k=j.top;var p=j.left;var m=function(){return(h.offsetWidth/o);};var i=function(){return(h.offsetHeight/A);};if(n.changeHeightHandles){h.offsetWidth=o*i();l._checkWidth();h.offsetHeight=A*m();}else{if(n.changeWidthHandles){h.offsetHeight=A*m();l._checkHeight();h.offsetWidth=o*i();}}if(n.changeTopHandles){h.top=k+(A-h.offsetHeight);}if(n.changeLeftHandles){h.left=p+(o-h.offsetWidth);}},_checkRegion:function(){var A=this;var h=A.get(f);var i=A._getConstrainRegion();return U.DOM.inRegion(null,i,true,h.info);},_checkWidth:function(){var A=this;var j=A.get(f);var l=j.info;var k=j.originalInfo;var i=A.get(W);var h=A.get(L);A._checkConstrain(S,Q,O);if(l.offsetWidth<h){j._checkSize(O,h);}if(l.offsetWidth>i){j._checkSize(O,i);}},_getConstrainRegion:function(){var A=this;var i=A.get(f);var h=i.get(g);var k=A.get(e);var j=null;if(k){if(k==c){j=h.get(b);}else{if(a(k)){j=k.get(Y);}else{j=k;}}}return j;},_handleResizeAlignEvent:function(i){var A=this;var h=A.get(f);A._checkHeight();A._checkWidth();if(A.get(E)){A._checkRatio();}A._recalculateXY();if(A.get(e)&&!A._checkRegion()){h.info=h.lastInfo;}},_handleResizeStartEvent:function(h){var A=this;A._updateConstrainBorderInfo();},_recalculateXY:function(){var A=this;var h=A.get(f);var j=h.info;var i=h.originalInfo;j.left=i.left+(j.left-i.left);j.top=i.top+(j.top-i.top);},_updateConstrainBorderInfo:function(){var h=this;var i=h.get(e);if(a(i)){var A=function(j){return parseFloat(i.getStyle(j))||0;};h.constrainBorderInfo.bottom=A(d);h.constrainBorderInfo.left=A(G);h.constrainBorderInfo.right=A(Z);h.constrainBorderInfo.top=A(K);}}});U.namespace("Plugin");U.Plugin.ResizeConstrained=H;},"@VERSION@",{requires:["aui-resize-base","dd-constrain","plugin"],skinnable:false});