AUI.add("aui-resize-constrain",function(T){var G=T.Lang,E=G.isBoolean,g=G.isNumber,B=G.isString,Z=function(A){return(A instanceof T.Node);},W="borderBottomWidth",F="borderLeftWidth",b="borderRightWidth",J="borderTopWidth",N="bottom",I="con",V="constrain",c="host",S="left",L="maxHeight",e="maxWidth",R="minHeight",H="minWidth",f="node",Q="offsetHeight",D="offsetWidth",C="preserveRatio",a="region",d="resizeConstrained",P="right",M="tickX",O="tickY",U="top",Y="view",X="viewportRegion";function K(){K.superclass.constructor.apply(this,arguments);}T.mix(K,{NAME:d,NS:I,ATTRS:{constrain:{setter:function(A){if(A&&(Z(A)||B(A)||A.nodeType)){A=T.one(A);}return A;}},minHeight:{value:15,validator:g},minWidth:{value:15,validator:g},maxHeight:{value:Infinity,validator:g},maxWidth:{value:Infinity,validator:g},preserveRatio:{value:false,validator:E},tickX:{value:false},tickY:{value:false}}});T.extend(K,T.Plugin.Base,{constrainBorderInfo:null,initializer:function(){var A=this;var h=A.get(c);A.constrainBorderInfo={bottom:0,left:0,right:0,top:0};h.delegate.dd.plug(T.Plugin.DDConstrained,{tickX:A.get(M),tickY:A.get(O)});h.after("resize:align",T.bind(A._handleResizeAlignEvent,A));h.on("resize:start",T.bind(A._handleResizeStartEvent,A));},_checkConstrain:function(j,o,k){var m=this;var n=m.get(c);var i=n.info;var q=m._getConstrainRegion();if(q){var p=i[j]+i[k];var h=q[o]-m.constrainBorderInfo[o];if(p>=h){i[k]-=(p-h);}var A=i[j];var l=q[j]+m.constrainBorderInfo[j];if(A<=l){i[j]+=(l-A);i[k]-=(l-A);}}},_checkHeight:function(){var h=this;var j=h.get(c);var l=j.info;var k=j.originalInfo;var i=h.get(L);var A=h.get(R);h._checkConstrain(U,N,Q);if(l.offsetHeight>i){j._checkSize(Q,i);}if(l.offsetHeight<A){j._checkSize(Q,A);}},_checkRatio:function(){var w=this;var p=w.get(c);var u=p.info;var i=p.originalInfo;var A=i.offsetWidth;var x=i.offsetHeight;var l=i.top;var y=i.left;var r=i.bottom;var t=i.right;var j=function(){return(u.offsetWidth/A);};var h=function(){return(u.offsetHeight/x);};var q=p.changeHeightHandles;if(w.get(V)&&p.changeHeightHandles&&p.changeWidthHandles){var v=w._getConstrainRegion();var o=w.constrainBorderInfo;var m=(v.bottom-o.bottom)-r;var s=y-(v.left+o.left);var k=(v.right-o.right)-t;var n=l-(v.top+o.top);if(p.changeLeftHandles&&p.changeTopHandles){q=(n<s);}else{if(p.changeLeftHandles){q=(m<s);}else{if(p.changeTopHandles){q=(n<k);}else{q=(m<k);}}}}if(q){u.offsetWidth=A*h();w._checkWidth();u.offsetHeight=x*j();}else{u.offsetHeight=x*j();w._checkHeight();u.offsetWidth=A*h();}if(p.changeTopHandles){u.top=l+(x-u.offsetHeight);}if(p.changeLeftHandles){u.left=y+(A-u.offsetWidth);}T.each(u,function(AA,z){if(g(AA)){u[z]=Math.round(AA);}});},_checkRegion:function(){var A=this;var h=A.get(c);var i=A._getConstrainRegion();return T.DOM.inRegion(null,i,true,h.info);},_checkWidth:function(){var A=this;var j=A.get(c);var l=j.info;var k=j.originalInfo;var i=A.get(e);var h=A.get(H);A._checkConstrain(S,P,D);if(l.offsetWidth<h){j._checkSize(D,h);}if(l.offsetWidth>i){j._checkSize(D,i);}},_getConstrainRegion:function(){var A=this;var i=A.get(c);var h=i.get(f);var j=A.get(V);var k=null;if(j){if(j==Y){k=h.get(X);}else{if(Z(j)){k=j.get(a);}else{k=j;}}}return k;},_handleResizeAlignEvent:function(i){var A=this;var h=A.get(c);A._checkHeight();A._checkWidth();if(A.get(C)){A._checkRatio();}if(A.get(V)&&!A._checkRegion()){h.info=h.lastInfo;}},_handleResizeStartEvent:function(h){var A=this;A._updateConstrainBorderInfo();},_updateConstrainBorderInfo:function(){var h=this;var i=h.get(V);if(Z(i)){var A=function(j){return parseFloat(i.getStyle(j))||0;};h.constrainBorderInfo.bottom=A(W);h.constrainBorderInfo.left=A(F);h.constrainBorderInfo.right=A(b);h.constrainBorderInfo.top=A(J);}}});T.namespace("Plugin");T.Plugin.ResizeConstrained=K;},"@VERSION@",{skinnable:false,requires:["aui-resize-base","dd-constrain","plugin"]});