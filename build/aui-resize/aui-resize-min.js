AUI.add("aui-resize",function(Ae){var AO=Ae.Lang,F=AO.isArray,Aw=AO.isBoolean,AB=AO.isNumber,A0=AO.isString,As=AO.trim,V=Ae.Array.indexOf,AX=".",g=",",e=" ",d="active",z="activeHandle",AH="activeHandleEl",k="all",BA="auto",Ah="autoHide",An="bottom",Ai="className",w="constrain2node",AC="constrain2region",AI="constrain2view",Al="cursor",U="diagonal",Am="dotted",AY="dragCursor",D="grip",AR="gripsmall",m="handle",y="handles",AV="hidden",C="horizontal",AT="icon",j="inner",E="left",x="margin",a="maxHeight",A1="maxWidth",W="minHeight",AE="minWidth",c="node",q="nodeName",AM="none",t="offsetHeight",Az="offsetWidth",I="parentNode",Y="position",X="preserveRatio",Aq="proxy",l="proxyEl",AP="px",K="region",Q="relative",Af="resize",b="resizing",N="right",A5="static",Ar="tickX",Ao="tickY",P="top",Ac="vertical",Aj="wrap",A3="wrapper",Ab="wrapTypes",H="borderBottomWidth",AA="borderLeftWidth",n="borderRightWidth",o="borderTopWidth",u="resize:mouseUp",h="resize:resize",v="resize:end",AJ="resize:start",AQ="t",A4="tr",AS="r",Au="br",Ad="b",Ax="bl",AW="l",A6="tl",AF=function(A){return(A instanceof Ae.Node);},A7=function(A){return m+A.toUpperCase();},A2=function(){return Array.prototype.slice.call(arguments).join(e);},AG=Ae.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),p=Ae.ClassNameManager.getClassName,S=p(AT),Av=p(AT,AR,U,Au),Aa=p(AT,D,Am,C),AL=p(AT,D,Am,Ac),At=p(Af),Ak=p(Af,m),AU=p(Af,m,d),J=p(Af,m,j),r=p(Af,m,j,"{handle}"),A8=p(Af,m,"{handle}"),G=p(Af,AV,y),i=p(Af,Aq),Ay=p(Af,A3),AZ=A2(S,Av),Ap=A2(S,Aa),Z=A2(S,AL),M=/^(t|b)$/i,AK=/^(tl|l|bl)$/i,AD=/^(tl|t|tr)$/i,s=/^(bl|br|l|r|tl|tr)$/i,Ag='<div class="'+A2(Ak,A8)+'">'+'<div class="'+A2(J,r)+'"></div>'+"</div>",AN='<div class="'+i+'"></div>',A9='<div class="'+Ay+'"></div>',f=[AQ,A4,AS,Au,Ad,Ax,AW,A6];var O=Ae.Component.create({NAME:Af,ATTRS:{activeHandle:{value:null,validator:A0},activeHandleEl:{value:null,validator:AF},autoHide:{value:false,validator:Aw},constrain2node:{setter:Ae.one,value:null},constrain2region:{value:null},constrain2view:{value:false},handles:{setter:function(L){var A=this;var B=[];if(F(L)){B=L;}else{if(A0(L)){if(L.toLowerCase()==k){B=f;}else{Ae.each(L.split(g),function(T,R){var BB=As(T);if(V(f,BB)>-1){B.push(BB);}});}}}return B;},value:k},minHeight:{value:15,validator:AB},minWidth:{value:15,validator:AB},maxHeight:{value:Infinity,validator:AB},maxWidth:{value:Infinity,validator:AB},node:{setter:Ae.one},preserveRatio:{value:false,validator:Aw},proxy:{value:false,validator:Aw},proxyEl:{setter:Ae.one,valueFn:function(){return Ae.Node.create(AN);}},resizing:{value:false,validator:Aw},tickX:{value:false},tickY:{value:false},wrap:{setter:function(R){var A=this;var L=A.get(c);var T=L.get(q);var B=A.get(Ab);if(B.test(T)){R=true;}return R;},value:false,validator:Aw},wrapTypes:{readOnly:true,value:/canvas|textarea|input|select|button|img/i},wrapper:{setter:function(){var A=this;var B=A.get(c);var L=B;if(A.get(Aj)){L=Ae.Node.create(A9);B.placeBefore(L);L.append(B);A._copyStyles(B,L);B.setStyles({position:A5,left:0,top:0});}return L;},value:null,writeOnce:true}},EXTENDS:Ae.Base,prototype:{CSS_INNER_HANDLE_MAP:{r:Z,l:Z,t:Ap,b:Ap,br:AZ},changeHeightHandles:false,changeLeftHandles:false,changeTopHandles:false,changeWidthHandles:false,constrainBorderInfo:null,info:null,originalInfo:null,initializer:function(){var A=this;A.info={};A.originalInfo={};A.constrainBorderInfo={};A.get(c).addClass(At);A.renderer();},renderUI:function(){var A=this;A._renderHandles();A._renderProxy();},bindUI:function(){var A=this;A._createEvents();A._bindResize();A._bindDD();A._bindHandle();},syncUI:function(){var A=this;A._setHideHandlesUI(A.get(Ah));},destructor:function(){var A=this;var B=A.get(c);var L=A.get(A3);Ae.Event.purgeElement(L,true);A.eachHandle(function(T){var R=T.dd;if(R){R.destroy();}T.remove();});if(A.get(Aj)){B.setStyles({margin:L.getStyle(x),position:L.getStyle(Y)});L.placeBefore(B);L.remove();}B.removeClass(At);B.removeClass(G);},renderer:function(){this.renderUI();this.bindUI();this.syncUI();},_bindDD:function(){var A=this;A.on("drag:drag",A._handleResizeEvent);A.on("drag:dropmiss",A._handleMouseUpEvent);A.on("drag:end",A._handleResizeEndEvent);A.on("drag:start",A._handleResizeStartEvent);},_bindHandle:function(){var A=this;var B=A.get(A3);B.on("mouseenter",Ae.bind(A._onWrapperMouseEnter,A));B.on("mouseleave",Ae.bind(A._onWrapperMouseLeave,A));B.delegate("mouseenter",Ae.bind(A._onHandleMouseOver,A),AX+Ak);B.delegate("mouseleave",Ae.bind(A._onHandleMouseOut,A),AX+Ak);},_bindResize:function(){var A=this;A.after(h,A._afterResize);},_createEvents:function(){var A=this;var B=function(L,R){A.publish(L,{defaultFn:R,queuable:false,emitFacade:true,bubbles:true,prefix:Af});};B(AJ,this._defResizeStartFn);B(h,this._defResizeFn);B(v,this._defResizeEndFn);B(u,this._defMouseUpFn);},_renderHandles:function(){var A=this;var B=A.get(A3);A.eachHandle(function(L){B.append(L);});},_renderProxy:function(){var B=this;var A=B.get(l);B.get(A3).get(I).append(A.hide());},eachHandle:function(B){var A=this;Ae.each(A.get(y),function(T,L){var R=A.get(A7(T));B.apply(A,[R,T,L]);});},_buildHandle:function(L){var A=this;var B=Ae.Node.create(Ae.substitute(Ag,{handle:L}));B.one(AX+J).addClass(A.CSS_INNER_HANDLE_MAP[L]);A._setupHandleDD(L,B);return B;},_checkConstrain:function(B,BG,L){var BE=this;var A=BE.info;var BB=BE.get(w);if(BB){var BC=BB.get(K);var BD=A[B]+A[L];var R=BC[BG]-BE.constrainBorderInfo[BG];if(BD>=R){A[L]-=(BD-R);}var T=A[B];var BF=BC[B]+BE.constrainBorderInfo[B];if(T<=BF){A[B]+=(BF-T);A[L]-=(BF-T);}}},_checkHeight:function(){var B=this;var BB=B.info;var T=B.originalInfo;var L=B.get(a);var R=B.get(W);B._checkConstrain(P,An,t);var BC=(BB.offsetHeight>L);var A=(BB.offsetHeight<R);if(BC){BB.offsetHeight=L;if(B.changeTopHandles){BB.top=T.top+T.offsetHeight-L;}}if(A){BB.offsetHeight=R;if(B.changeTopHandles){BB.top=T.top+T.offsetHeight-R;}}},_checkRatio:function(){var BB=this;var B=BB.info;var R=BB.originalInfo;var BD=R.offsetWidth;var A=R.offsetHeight;var T=R.top;
var BE=R.left;var BC=function(){return(B.offsetWidth/BD);};var L=function(){return(B.offsetHeight/A);};if(BB.changeHeightHandles){B.offsetWidth=BD*L();BB._checkWidth();B.offsetHeight=A*BC();}else{if(BB.changeWidthHandles){B.offsetHeight=A*BC();BB._checkHeight();B.offsetWidth=BD*L();}}if(BB.changeTopHandles){B.top=T+(A-B.offsetHeight);}if(BB.changeLeftHandles){B.left=BE+(BD-B.offsetWidth);}},_checkRegion:function(){var A=this;var B=A.get(w).get(K);return Ae.DOM.inRegion(null,B,true,A.info);},_checkWidth:function(){var A=this;var BC=A.info;var BB=A.originalInfo;var T=A.get(A1);var R=A.get(AE);A._checkConstrain(E,N,Az);var L=(BC.offsetWidth>T);var B=(BC.offsetWidth<R);if(L){BC.offsetWidth=T;if(A.changeLeftHandles){BC.left=BB.left+BB.offsetWidth-T;}}if(B){BC.offsetWidth=R;if(A.changeLeftHandles){BC.left=BB.left+BB.offsetWidth-R;}}},_copyStyles:function(T,BB){var B=this;var A=T.getStyle(Y).toLowerCase();if(A==A5){A=Q;}var R={position:A};var L={};Ae.each([P,N,An,E],function(BD){var BC=x+AG(BD);L[BC]=BB.getStyle(BC);R[BC]=T.getStyle(BC);});BB.setStyles(R);T.setStyles(L);T.setStyles({margin:0});BB.set(t,T.get(t));BB.set(Az,T.get(Az));},_extractHandleName:Ae.cached(function(L){var B=L.get(Ai);var A=B.match(new RegExp(p(Af,m,"(\\w{1,2})\\b")));return A?A[1]:null;}),_getInfo:function(T,A){var BF=this,BB;var BD=A.dragEvent.target;if(A){BB=(BD.actXY.length?BD.actXY:BD.lastXY);}var BC=T.getXY();var R=BC[0];var L=BC[1];var B=T.get(t);var BE=T.get(Az);return{actXY:BB,bottom:(L+B),left:R,offsetHeight:B,offsetWidth:BE,right:(R+BE),top:L};},_recalculateXY:function(){var A=this;var L=A.info;var B=A.originalInfo;L.left=B.left+(L.left-B.left);L.top=B.top+(L.top-B.top);},_resize:function(){var A=this;var R=A.get(z);var BB=A.info;var T=A.originalInfo;var L=BB.actXY[0]-T.actXY[0];var B=BB.actXY[1]-T.actXY[1];var BC={t:function(){BB.top=T.top+B;BB.offsetHeight=T.offsetHeight-B;},r:function(){BB.offsetWidth=T.offsetWidth+L;},l:function(){BB.left=T.left+L;BB.offsetWidth=T.offsetWidth-L;},b:function(){BB.offsetHeight=T.offsetHeight+B;},tr:function(){this.t();this.r();},br:function(){this.b();this.r();},tl:function(){this.t();this.l();},bl:function(){this.b();this.l();}};BC[R](L,B);},_setupHandleDD:function(R,L){var B=this;var A=new Ae.DD.Drag({bubbleTargets:B,clickPixelThresh:0,clickTimeThresh:0,data:{handle:R,node:L},node:L,useShim:true,move:false});A.plug(Ae.Plugin.DDConstrained,{stickX:(R==AS||R==AW),stickY:(R==AQ||R==Ad),tickX:B.get(Ar),tickY:B.get(Ao)});},_setOffset:function(L,B,A){L.set(Az,B);L.set(t,A);},_syncUI:function(){var A=this;var L=A.info;var R=A.get(A3);var B=A.get(c);A._setOffset(R,L.offsetWidth,L.offsetHeight);if(A.changeLeftHandles||A.changeTopHandles){R.setXY([L.left,L.top]);}if(!R.compareTo(B)){A._setOffset(B,L.offsetWidth,L.offsetHeight);}if(Ae.UA.webkit){B.setStyle(Af,AM);}},_syncProxyUI:function(){var B=this;var R=B.info;var L=B.get(AH);var A=B.get(l);var T=L.getStyle(Al);A.show().setStyle(Al,T);L.dd.set(AY,T);B._setOffset(A,R.offsetWidth,R.offsetHeight);A.setXY([R.left,R.top]);},_updateChangeHandleInfo:function(B){var A=this;A.changeHeightHandles=M.test(B);A.changeLeftHandles=AK.test(B);A.changeTopHandles=AD.test(B);A.changeWidthHandles=s.test(B);},_updateConstrainBorderInfo:function(){var B=this;var L=B.get(w);if(L){var A=function(R){return parseFloat(L.getStyle(R))||0;};B.constrainBorderInfo.bottom=A(H);B.constrainBorderInfo.left=A(AA);B.constrainBorderInfo.right=A(n);B.constrainBorderInfo.top=A(o);}},_updateInfo:function(B){var A=this;A.info=A._getInfo(A.get(A3),B);},_setActiveHandlesUI:function(L){var A=this;var B=A.get(AH);if(B){if(L){A.eachHandle(function(R){R.removeClass(AU);});B.addClass(AU);}else{B.removeClass(AU);}}},_setHideHandlesUI:function(B){var A=this;var L=A.get(A3);if(!A.get(b)){if(B){L.addClass(G);}else{L.removeClass(G);}}},_defMouseUpFn:function(B){var A=this;A.set(b,false);},_defResizeFn:function(L){var A=this;var B=A.info;A._updateInfo(L);A._resize();A._checkHeight();A._checkWidth();if(A.get(X)){A._checkRatio();}A._recalculateXY();if(A.get(w)&&!A._checkRegion()){A.info=B;}},_defResizeEndFn:function(L){var A=this;var B=L.dragEvent.target;B.actXY=[];if(A.get(Aq)){A._syncProxyUI();A.get(l).hide();}A._syncUI();A.set(z,null);A.set(AH,null);A._setActiveHandlesUI(false);},_defResizeStartFn:function(B){var A=this;A.set(b,true);A.originalInfo=A._getInfo(A.get(A3),B);A._updateInfo(B);A._updateConstrainBorderInfo();},_afterResize:function(B){var A=this;if(A.get(Aq)){A._syncProxyUI();}else{A._syncUI();}},_handleMouseUpEvent:function(A){this.fire(u,{dragEvent:A,info:this.info});},_handleResizeEvent:function(A){this.fire(h,{dragEvent:A,info:this.info});},_handleResizeEndEvent:function(A){this.fire(v,{dragEvent:A,info:this.info});},_handleResizeStartEvent:function(A){this.fire(AJ,{dragEvent:A,info:this.info});},_onWrapperMouseEnter:function(B){var A=this;if(A.get(Ah)){A._setHideHandlesUI(false);}},_onWrapperMouseLeave:function(B){var A=this;if(A.get(Ah)){A._setHideHandlesUI(true);}},_onHandleMouseOver:function(L){var A=this;var B=L.currentTarget;var R=A._extractHandleName(B);if(!A.get(b)){A.set(z,R);A.set(AH,B);A._setActiveHandlesUI(true);A._updateChangeHandleInfo(R);}},_onHandleMouseOut:function(B){var A=this;if(!A.get(b)){A._setActiveHandlesUI(false);}}}});Ae.each(f,function(B,A){O.ATTRS[A7(B)]={setter:function(){return this._buildHandle(B);},value:null,writeOnce:true};});Ae.Resize=O;},"@VERSION@",{requires:["aui-base","dd-constrain","dd-drag","dd-drop","substitute"],skinnable:true});