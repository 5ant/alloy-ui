AUI.add("aui-carousel",function(n){var e=n.Lang,j="carousel",t=n.ClassNameManager.getClassName,k=t(j,"item"),d=t(j,"item","active"),s=t(j,"item","transition"),b=t(j,"menu","active"),p=t(j,"menu","index"),h=t(j,"menu","item"),c=t(j,"menu","next"),g=t(j,"menu","play"),o=t(j,"menu","pause"),a=t(j,"menu","prev"),l=['<li><a class="',h,p,'">'].join(" "),i=['<li><a class="',h,c,'">'].join(" "),m=['<li><a class="',h,g,'">'].join(" "),f=['<li><a class="',h,a,'">'].join(" "),r=n.Widget.UI_SRC;MAP_EVENT_INFO={src:r};var q=n.Component.create({NAME:j,ATTRS:{activeIndex:{value:0,setter:function(u){u=(u==="rand")?this._createIndexRandom():Math.max(Math.min(u,this.nodeSelection.size()),-1);return u;}},animationTime:{value:0.5},intervalTime:{value:0.75},itemSelector:{value:">*"},playing:{value:true}},prototype:{animation:null,nodeSelection:null,nodeMenu:null,initializer:function(){var u=this;u.animation=new n.Anim({duration:u.get("animationTime"),to:{opacity:1}});},renderUI:function(){var u=this;u._updateNodeSelection();u._renderMenu();},bindUI:function(){var u=this;u.after({activeIndexChange:u._afterActiveIndexChange,animationTimeChange:u._afterAnimationTimeChange,itemSelectorChange:u._afterItemSelectorChange,intervalTimeChange:u._afterIntervalTimeChange,playingChange:u._afterPlayingChange});u._bindMenu();if(u.get("playing")===true){u._afterPlayingChange({prevVal:false,newVal:true});}},syncUI:function(){var u=this;u._uiSetActiveIndex(u.get("activeIndex"));},item:function(u){this.set("activeIndex",u);},next:function(){this._updateIndexNext();},pause:function(){this.set("playing",false);},play:function(){this.set("playing",true);},prev:function(){this._updateIndexPrev();},_afterActiveIndexChange:function(u){this._uiSetActiveIndex(u.newVal,{prevVal:u.prevVal,animate:u.animate,src:u.src});},_afterAnimationTimeChange:function(u){this.animation.set("duration",u.newVal);},_afterItemSelectorChange:function(u){this._updateNodeSelection();},_afterIntervalTimeChange:function(v){var u=this;u._clearIntervalRotationTask();u._createIntervalRotationTask();},_afterPlayingChange:function(v){var u=this;var w=u.nodeMenu.get("children").item(0).get("children").item(0);if(v.newVal){u._createIntervalRotationTask();w.removeClass(g).addClass(o);}else{u._clearIntervalRotationTask();w.removeClass(o).addClass(g);}},_bindMenu:function(){var u=this,w=u.nodeMenu,v=w.get("children");v.each(function(y,x,z){if(x>1&&x!==z.size()-1){y.on("click",u._onMenuItemClick,u);}});v.item(0).on("click",u._onMenuPlayClick,u);v.item(1).on("click",u._updateIndexPrev,u);v.item(v.size()-1).on("click",u._updateIndexNext,u);},_clearIntervalRotationTask:function(){clearInterval(this._intervalRotationTask);},_createIndexRandom:function(){return Math.ceil(Math.random()*this.nodeSelection.size())-1;},_createIntervalRotationTask:function(){var u=this;u._clearIntervalRotationTask();u._intervalRotationTask=setInterval(function(){u._updateIndexNext({animate:true});},u.get("intervalTime")*1000);},_onAnimationEnd:function(w,x,v,u,y){if(v){v.removeClass(s);}x.setStyle("opacity","1");},_onAnimationStart:function(w,x,v,u,y){x.addClass(d);u.addClass(b);if(v){v.removeClass(d).addClass(s);}if(y){y.removeClass(b);}},_onMenuItemClick:function(v){v.preventDefault();var u=this;u.set("activeIndex",u.nodeMenu.all("li").indexOf(v.currentTarget)-2,MAP_EVENT_INFO);},_onMenuPlayClick:function(u){this.set("playing",!this.get("playing"));},_renderMenu:function(){var v=this,w=n.Node.create("<menu>"),u;u=n.Node.create(m);w.appendChild(u);u=n.Node.create(f);w.appendChild(u);v.nodeSelection.each(function(y,x,z){u=n.Node.create([l,""].join(x));w.appendChild(u);});u=n.Node.create(i);w.appendChild(u);v.get("contentBox").appendChild(w);v.nodeMenu=w;},_uiSetActiveIndex:function(w,z){var B=2;var C=this;var A=C.nodeSelection.item(w);var y=null;var x=null;var v=C.nodeMenu.get("children").item(w+B).get("children").item(0);var D=null;var u=null;C.animation.set("node",A);if(z&&!e.isUndefined(z.prevVal)){x=C.nodeMenu.get("children").item(z.prevVal+B).get("children").item(0);y=C.nodeSelection.item(z.prevVal);y.removeClass(d).addClass(s);C.animation.stop();}A.setStyle("opacity","0");D=C.animation.on("start",function(E){C._onAnimationStart(E,A,y,v,x);D.detach();});u=C.animation.on("end",function(E){C._onAnimationEnd(E,A,y,v,x);u.detach();});if(z){if(z.animate){C.animation.run();}else{C.animation.fire("start");C.animation.fire("end");}if(z.src==r){C._createIntervalRotationTask();}}},_updateIndexNext:function(v){var u=this;v.src=r;u.set("activeIndex",(u.get("activeIndex")+1)>(u.nodeSelection.size()-1)?0:u.get("activeIndex")+1,v);},_updateIndexPrev:function(v){var u=this;v.src=r;u.set("activeIndex",(u.get("activeIndex")-1)<0?(u.nodeSelection.size()-1):u.get("activeIndex")-1,v);},_updateNodeSelection:function(){var u=this;u.nodeSelection=u.get("contentBox").all(u.get("itemSelector")).addClass(k);},_intervalRotationTask:null}});n.Carousel=q;},"@VERSION@",{skinnable:true,requires:["aui-base","anim"]});