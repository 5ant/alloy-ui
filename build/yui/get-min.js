/*
Copyright (c) 2010, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 3.2.0
build: nightly
*/
YUI.add("get",function(F){var C=F.UA,B=F.Lang,A="text/javascript",E="text/css",D="stylesheet";F.Get=function(){var P,L,O,M={},N=0,U,W=function(a,X,b){var Y=b||F.config.win,c=Y.document,e=c.createElement(a),Z;for(Z in X){if(X[Z]&&X.hasOwnProperty(Z)){e.setAttribute(Z,X[Z]);}}return e;},T=function(Y,Z,X){var a={id:F.guid(),type:E,rel:D,href:Y};if(X){F.mix(a,X);}return W("link",a,Z);},S=function(Y,Z,X){var a={id:F.guid(),type:A};if(X){F.mix(a,X);}a.src=Y;return W("script",a,Z);},H=function(Y,Z,X){return{tId:Y.tId,win:Y.win,data:Y.data,nodes:Y.nodes,msg:Z,statusText:X,purge:function(){L(this.tId);}};},Q=function(b,a,Y){var X=M[b],Z;if(X&&X.onEnd){Z=X.context||X;X.onEnd.call(Z,H(X,a,Y));}},V=function(a,Z){var X=M[a],Y;if(X.timer){clearTimeout(X.timer);}if(X.onFailure){Y=X.context||X;X.onFailure.call(Y,H(X,Z));}Q(a,Z,"failure");},K=function(a){var X=M[a],Z,Y;if(X.timer){clearTimeout(X.timer);}X.finished=true;if(X.aborted){Z="transaction "+a+" was aborted";V(a,Z);return;}if(X.onSuccess){Y=X.context||X;X.onSuccess.call(Y,H(X));}Q(a,Z,"OK");},R=function(Z){var X=M[Z],Y;if(X.onTimeout){Y=X.context||X;X.onTimeout.call(Y,H(X));}Q(Z,"timeout","timeout");},J=function(Z,c){var Y=M[Z],a,i,g,e,b,X,j,f;if(Y.timer){clearTimeout(Y.timer);}if(Y.aborted){a="transaction "+Z+" was aborted";V(Z,a);return;}if(c){Y.url.shift();if(Y.varName){Y.varName.shift();}}else{Y.url=(B.isString(Y.url))?[Y.url]:Y.url;if(Y.varName){Y.varName=(B.isString(Y.varName))?[Y.varName]:Y.varName;}}i=Y.win;g=i.document;e=g.getElementsByTagName("head")[0];if(Y.url.length===0){K(Z);return;}X=Y.url[0];if(!X){Y.url.shift();return J(Z);}if(Y.timeout){Y.timer=setTimeout(function(){R(Z);},Y.timeout);}if(Y.type==="script"){b=S(X,i,Y.attributes);}else{b=T(X,i,Y.attributes);}O(Y.type,b,Z,X,i,Y.url.length);Y.nodes.push(b);f=Y.insertBefore||g.getElementsByTagName("base")[0];if(f){j=P(f,Z);if(j){j.parentNode.insertBefore(b,j);}}else{e.appendChild(b);}if((C.webkit||C.gecko)&&Y.type==="css"){J(Z,X);}},I=function(){if(U){return;}U=true;var X,Y;for(X in M){if(M.hasOwnProperty(X)){Y=M[X];if(Y.autopurge&&Y.finished){L(Y.tId);delete M[X];}}}U=false;},G=function(Y,X,Z){Z=Z||{};var c="q"+(N++),a,b=Z.purgethreshold||F.Get.PURGE_THRESH;if(N%b===0){I();}M[c]=F.merge(Z,{tId:c,type:Y,url:X,finished:false,nodes:[]});a=M[c];a.win=a.win||F.config.win;a.context=a.context||a;a.autopurge=("autopurge" in a)?a.autopurge:(Y==="script")?true:false;a.attributes=a.attributes||{};a.attributes.charset=Z.charset||a.attributes.charset||"utf-8";J(c);return{tId:c};};O=function(Y,e,d,X,c,b,Z){var a=Z||J;if(C.ie){e.onreadystatechange=function(){var f=this.readyState;if("loaded"===f||"complete"===f){e.onreadystatechange=null;a(d,X);}};}else{if(C.webkit){if(Y==="script"){e.addEventListener("load",function(){a(d,X);});}}else{e.onload=function(){a(d,X);};e.onerror=function(f){V(d,f+": "+X);};}}};P=function(X,a){var Y=M[a],Z=(B.isString(X))?Y.win.document.getElementById(X):X;if(!Z){V(a,"target node not found: "+X);}return Z;};L=function(e){var Y,a,j,c,k,b,Z,g,f,X=M[e];if(X){Y=X.nodes;a=Y.length;j=X.win.document;c=j.getElementsByTagName("head")[0];f=X.insertBefore||j.getElementsByTagName("base")[0];if(f){k=P(f,e);if(k){c=k.parentNode;}}for(b=0;b<a;b=b+1){Z=Y[b];if(Z.clearAttributes){Z.clearAttributes();}else{for(g in Z){if(Z.hasOwnProperty(g)){delete Z[g];}}}c.removeChild(Z);}}X.nodes=[];};return{PURGE_THRESH:20,_finalize:function(X){setTimeout(function(){K(X);},0);},abort:function(Y){var Z=(B.isString(Y))?Y:Y.tId,X=M[Z];if(X){X.aborted=true;}},script:function(X,Y){return G("script",X,Y);},css:function(X,Y){return G("css",X,Y);}};}();},"3.2.0",{requires:["yui-base"]});