AUI.add("aui-tree-node",function(ae){var Y=ae.Lang,aM=Y.isString,aD=Y.isBoolean,aU="alwaysShowHitArea",Q="",s="boundingBox",g="children",aI="clearfix",x="collapsed",a="container",ac="content",v="contentBox",j="expanded",p="helper",V="hidden",I="hitarea",f="hitAreaEl",U="icon",aT="iconEl",au="id",ak="label",W="labelEl",T="lastSelected",aH="leaf",q="node",am="over",Z="ownerTree",e="parentNode",aG="selected",t=" ",aB="radio",h="tree",J="tree-node",aQ=function(){return Array.prototype.slice.call(arguments).join(t);},aq=function(A){return(A instanceof ae.TreeNode);},aO=function(A){return(A instanceof ae.TreeView);},G=ae.getClassName,ah=G(p,aI),z=G(h,x),b=G(h,a),aW=G(h,j),u=G(h,V),aw=G(h,I),F=G(h,U),k=G(h,ak),E=G(h,q,ac),ay=G(h,q,V,I),i=G(h,q,aH),aL=G(h,q,am),K=G(h,q,aG),ad='<div class="'+aw+'"></div>',r='<div class="'+F+'"></div>',d='<div class="'+k+'"></div>',aS="<ul></ul>",w="<li></li>",aa='<div class="'+aQ(ah,E)+'"></div>';var O=ae.Component.create({NAME:J,ATTRS:{draggable:{value:true,validator:aD},ownerTree:{value:null},label:{value:Q,validator:aM},expanded:{value:false,validator:aD},id:{validator:aM},leaf:{value:true,setter:function(A){if(A&&this.get(g).length){return false;}return A;},validator:aD},nextSibling:{value:null,validator:aq},prevSibling:{value:null,validator:aq},parentNode:{value:null,validator:function(A){return aq(A)||aO(A);}},labelEl:{setter:ae.one,valueFn:function(){var A=this.get(ak);return ae.Node.create(d).html(A).unselectable();}},hitAreaEl:{setter:ae.one,valueFn:function(){return ae.Node.create(ad);}},alwaysShowHitArea:{value:true,validator:aD},iconEl:{setter:ae.one,valueFn:function(){return ae.Node.create(r);}},tabIndex:{value:null}},EXTENDS:ae.TreeData,UI_ATTRS:[j],prototype:{BOUNDING_TEMPLATE:w,CONTENT_TEMPLATE:aa,initializer:function(){var A=this;A._syncTreeNodeBBId();},bindUI:function(){var A=this;A.after("childrenChange",ae.bind(A._afterSetChildren,A));A.after("idChange",A._afterSetId,A);},_renderUI:function(A){this._renderBoxClassNames();},renderUI:function(){var A=this;A._renderBoundingBox();A._renderContentBox();},syncUI:function(){var A=this;A._syncHitArea(A.get(g));},_renderContentBox:function(a0){var A=this;var L=A.get(v);if(A.isLeaf()){L.addClass(i);}else{var aZ=A.get(j);L.addClass(aZ?aW:z);if(aZ){A.expand();}}return L;},_renderBoundingBox:function(){var A=this;var aZ=A.get(s);var L=A.get(v);var a0=null;if(!A.isLeaf()){L.append(A.get(f));a0=A._createNodeContainer();}L.append(A.get(aT));L.append(A.get(W));aZ.append(L);if(a0){if(!A.get(j)){a0.addClass(u);}aZ.append(a0);}return aZ;},_createNodeContainer:function(){var A=this;var L=A.get(a)||ae.Node.create(aS);L.addClass(b);A.set(a,L);A.eachChildren(function(aZ){A.appendChild(aZ);});return L;},_syncHitArea:function(L){var A=this;if(A.get(aU)||L.length){A.showHitArea();}else{A.hideHitArea();A.collapse();}},appendChild:function(){var A=this;if(!A.isLeaf()){ae.TreeNode.superclass.appendChild.apply(A,arguments);}},collapse:function(){var A=this;A.set(j,false);},collapseAll:function(){var A=this;ae.TreeNode.superclass.collapseAll.apply(A,arguments);A.collapse();},contains:function(A){return A.isAncestor(this);},expand:function(){var A=this;A.set(j,true);},expandAll:function(){var A=this;ae.TreeNode.superclass.expandAll.apply(A,arguments);A.expand();},getDepth:function(){var aZ=0;var L=this;var A=L.get(e);while(A){++aZ;A=A.get(e);}return aZ;},hasChildNodes:function(){var A=this;return(!A.isLeaf()&&ae.TreeNode.superclass.hasChildNodes.apply(this,arguments));},isSelected:function(){return this.get(v).hasClass(K);},isLeaf:function(){var A=this;return A.get(aH);},isAncestor:function(aZ){var L=this;var A=L.get(e);while(A){if(A===aZ){return true;}A=A.get(e);}return false;},insertAfter:function(aZ,L){var A=this;ae.TreeNode.superclass.insertAfter.apply(this,[aZ,A]);},insertBefore:function(L){var A=this;ae.TreeNode.superclass.insertBefore.apply(this,[L,A]);},removeChild:function(L){var A=this;if(!A.isLeaf()){ae.TreeNode.superclass.removeChild.apply(A,arguments);}},toggle:function(){var A=this;if(A.get(j)){A.collapse();}else{A.expand();}},select:function(){var A=this;var L=A.get(Z);if(L){L.set(T,A);}A.get(v).addClass(K);A.fire("select");},unselect:function(){var A=this;A.get(v).removeClass(K);A.fire("unselect");},over:function(){this.get(v).addClass(aL);},out:function(){this.get(v).removeClass(aL);},showHitArea:function(){var A=this;var L=A.get(f);L.removeClass(ay);},hideHitArea:function(){var A=this;var L=A.get(f);L.addClass(ay);},_syncTreeNodeBBId:function(L){var A=this;A.get(s).attr(au,A.get(au));},_afterSetChildren:function(L){var A=this;A._syncHitArea(L.newVal);},_uiSetExpanded:function(a0){var A=this;if(!A.isLeaf()){var aZ=A.get(a);var L=A.get(v);if(a0){L.replaceClass(z,aW);if(aZ){aZ.removeClass(u);}}else{L.replaceClass(aW,z);if(aZ){aZ.addClass(u);}}}}}});ae.TreeNode=O;var aA=Y.isFunction,H=Y.isObject,af=Y.isValue,aN="cache",av="end",al="io",aE="limit",aR="loaded",aX="loading",aj="paginator",ao="start",at="tree-node-io",c="paginatorClick",aC=G(h,q,aj),y=G(h,q,al,aX),az='<a class="'+aC+'" href="javascript:void(0);">Load more results</a>';var N=ae.Component.create({NAME:at,ATTRS:{io:{lazyAdd:false,value:null,setter:function(A){return this._setIO(A);}},loading:{value:false,validator:aD},loaded:{value:false,validator:aD},cache:{value:true,validator:aD},leaf:{value:false,validator:aD},paginator:{setter:function(A){return ae.merge({alwaysVisible:false,autoFocus:true,element:ae.Node.create(az),endParam:av,limitParam:aE,start:0,startParam:ao},A);},validator:H}},EXTENDS:ae.TreeNode,prototype:{bindUI:function(){var A=this;ae.TreeNodeIO.superclass.bindUI.apply(this,arguments);A._bindPaginatorUI();A._createEvents();},syncUI:function(){var A=this;ae.TreeNodeIO.superclass.syncUI.apply(this,arguments);A._syncPaginatorUI();},_bindPaginatorUI:function(){var A=this;var aZ=A.get(aj);if(aZ){var L=ae.bind(A._handlePaginatorClickEvent,A);aZ.element.on("click",L);}},createNodes:function(L){var A=this;ae.Array.each(ae.Array(L),function(a0){var aZ=A.createNode.apply(A,[a0]);
A.appendChild(aZ);});A._syncPaginatorUI(L);},expand:function(){var A=this;var L=A.get(aN);var a1=A.get(al);var aZ=A.get(aR);var a0=A.get(aX);if(!L){A.set(aR,false);}if(a1&&!aZ&&!a0&&!this.hasChildNodes()){if(!L){A.empty();}A.initIO();}else{ae.TreeNodeIO.superclass.expand.apply(this,arguments);}},initIO:function(){var L=this;var aZ=L.get(al);if(aA(aZ.cfg.data)){aZ.cfg.data=aZ.cfg.data.apply(L,[L]);}L._syncPaginatorIOData(aZ);if(aA(aZ.loader)){var A=ae.bind(aZ.loader,L);A(aZ.url,aZ.cfg,L);}else{ae.io.request(aZ.url,aZ.cfg);}},ioStartHandler:function(){var A=this;var L=A.get(v);A.set(aX,true);L.addClass(y);},ioCompleteHandler:function(){var A=this;var L=A.get(v);A.set(aX,false);A.set(aR,true);L.removeClass(y);},ioSuccessHandler:function(){var A=this;var a4=A.get(al);var aZ=Array.prototype.slice.call(arguments);var a1=aZ.length;var L=aZ[1];if(a1>=3){var a3=aZ[2];try{L=ae.JSON.parse(a3.responseText);}catch(a2){}}var a0=a4.formatter;if(a0){L=a0(L);}A.createNodes(L);A.expand();},ioFailureHandler:function(){var A=this;A.set(aX,false);A.set(aR,false);},_createEvents:function(){var A=this;A.publish(c,{defaultFn:A._defPaginatorClickFn,prefix:at});},_defPaginatorClickFn:function(L){var A=this;var aZ=A.get(aj);if(af(aZ.limit)){aZ.start+=aZ.limit;}if(A.get(al)){A.initIO();}},_handlePaginatorClickEvent:function(a0){var A=this;var aZ=A.get(Z);var L=A.getEventOutputMap(A);A.fire(c,L);if(aZ){aZ.fire(c,L);}a0.halt();},_inheritOwnerTreeAttrs:function(){var L=this;var aZ=L.get(Z);if(aZ){if(!L.get(al)){L.set(al,ae.clone(aZ.get(al)));}if(!L.get(aj)){var A=aZ.get(aj);if(A&&A.element){A.element=A.element.clone();}L.set(aj,A);}}},_setIO:function(aZ){var A=this;if(!aZ){return null;}else{if(aM(aZ)){aZ={url:aZ};}}aZ=aZ||{};aZ.cfg=aZ.cfg||{};aZ.cfg.on=aZ.cfg.on||{};var L={start:ae.bind(A.ioStartHandler,A),complete:ae.bind(A.ioCompleteHandler,A),success:ae.bind(A.ioSuccessHandler,A),failure:ae.bind(A.ioFailureHandler,A)};ae.each(L,function(a2,a0){var a3=aZ.cfg.on[a0];if(aA(a3)){var a1=function(){a2.apply(A,arguments);a3.apply(A,arguments);};aZ.cfg.on[a0]=ae.bind(a1,A);}else{aZ.cfg.on[a0]=a2;}});return aZ;},_syncPaginatorIOData:function(a0){var A=this;var aZ=A.get(aj);if(aZ&&af(aZ.limit)){var L=a0.cfg.data||{};L[aZ.limitParam]=aZ.limit;L[aZ.startParam]=aZ.start;L[aZ.endParam]=(aZ.start+aZ.limit);a0.cfg.data=L;}},_syncPaginatorUI:function(L){var A=this;var aZ=A.get(g);var a3=A.get(aj);if(a3){var a2=true;if(L){a2=(L.length>0);}var a0=a2&&(aZ.length>=a3.limit);if(a3.alwaysVisible||a0){A.get(a).append(a3.element.show());if(a3.autoFocus){try{a3.element.focus();}catch(a1){}}}else{a3.element.hide();}}}}});ae.TreeNodeIO=N;var l="checkbox",o="checked",ab="checkContainerEl",aJ="checkEl",P="checkName",X=".",m="name",B="tree-node-check",ai=G(h,q,l),ap=G(h,q,l,a),ar=G(h,q,o),S='<div class="'+ap+'"></div>',an='<input class="'+ai+'" type="checkbox" />';var aF=ae.Component.create({NAME:B,ATTRS:{checked:{value:false,validator:aD},checkName:{value:B,validator:aM},checkContainerEl:{setter:ae.one,valueFn:function(){return ae.Node.create(S);}},checkEl:{setter:ae.one,valueFn:function(){var A=this.get(P);return ae.Node.create(an).attr(m,A);}}},EXTENDS:ae.TreeNodeIO,UI_ATTRS:[o],prototype:{renderUI:function(){var L=this;ae.TreeNodeCheck.superclass.renderUI.apply(L,arguments);var aZ=L.get(W);var A=L.get(aJ);var a0=L.get(ab);A.hide();a0.append(A);aZ.placeBefore(a0);if(L.isChecked()){L.check();}},bindUI:function(){var A=this;var L=A.get(v);var aZ=A.get(W);ae.TreeNodeCheck.superclass.bindUI.apply(A,arguments);L.delegate("click",ae.bind(A.toggleCheck,A),X+ap);L.delegate("click",ae.bind(A.toggleCheck,A),X+k);aZ.swallowEvent("dblclick");},check:function(){var A=this;A.set(o,true);},uncheck:function(){var A=this;A.set(o,false);},toggleCheck:function(){var L=this;var A=L.get(aJ);var aZ=A.attr(o);if(!aZ){L.check();}else{L.uncheck();}},isChecked:function(){var A=this;return A.get(o);},_uiSetChecked:function(L){var A=this;if(L){A.get(v).addClass(ar);A.get(aJ).attr(o,o);}else{A.get(v).removeClass(ar);A.get(aJ).attr(o,Q);}}}});ae.TreeNodeCheck=aF;var C="child",R="tree-node-task",M="unchecked",aK=function(A){return A instanceof ae.TreeNodeCheck;},ag=G(h,q,C,M);var aY=ae.Component.create({NAME:R,EXTENDS:ae.TreeNodeCheck,prototype:{check:function(){var A=this;var L=A.get(v);if(!A.isLeaf()){A.eachChildren(function(aZ){if(aK(aZ)){aZ.check();}});}A.eachParent(function(aZ){if(aK(aZ)&&!aZ.isChecked()){aZ.get(v).addClass(ag);}});L.removeClass(ag);ae.TreeNodeTask.superclass.check.apply(this,arguments);},uncheck:function(){var A=this;var L=A.get(v);if(!A.isLeaf()){A.eachChildren(function(aZ){if(aZ instanceof ae.TreeNodeCheck){aZ.uncheck();}});}A.eachParent(function(aZ){if(aK(aZ)&&!aZ.isChecked()){aZ.get(v).removeClass(ag);}});L.removeClass(ag);ae.TreeNodeTask.superclass.uncheck.apply(this,arguments);}}});ae.TreeNodeTask=aY;var D="tree-node-radio",n=function(A){return A instanceof ae.TreeNodeRadio;},aV=G(h,aB,q),ax=G(h,aB,q,o);var aP=ae.Component.create({NAME:D,EXTENDS:ae.TreeNodeTask,prototype:{renderUI:function(){var A=this;ae.TreeNodeRadio.superclass.renderUI.apply(A,arguments);A.get(v).addClass(aV);},check:function(){var A=this;A._uncheckRadioNodes();ae.TreeNodeRadio.superclass.check.apply(this,arguments);},_uiSetChecked:function(L){var A=this;if(L){A.get(v).addClass(ax);A.get(aJ).attr(o,o);}else{A.get(v).removeClass(ax);A.get(aJ).attr(o,Q);}},_uncheckRadioNodes:function(a0){var A=this;var aZ;if(a0){aZ=a0.get(g);}else{var L=A.get(Z);if(L){aZ=L.get(g);}else{return;}}ae.Array.each(aZ,function(a2,a1,a3){if(!a2.isLeaf()){A._uncheckRadioNodes(a2);}if(n(a2)){a2.uncheck();}});}}});ae.TreeNodeRadio=aP;ae.TreeNode.nodeTypes={radio:ae.TreeNodeRadio,task:ae.TreeNodeTask,check:ae.TreeNodeCheck,node:ae.TreeNode,io:ae.TreeNodeIO};},"@VERSION@",{skinnable:false,requires:["aui-tree-data","aui-io","json","querystring-stringify"]});