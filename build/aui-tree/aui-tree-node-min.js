AUI.add("aui-tree-node",function(AD){var x=AD.Lang,Ag=x.isString,AX=x.isBoolean,An="alwaysShowHitArea",p="",T="boundingBox",H="children",Ac="clearfix",Z="collapsed",B="container",AB="content",X="contentBox",K="expanded",Q="helper",u="hidden",i="hitarea",G="hitAreaEl",t="icon",Am="iconEl",AR="id",AJ="label",v="labelEl",s="lastSelected",Ab="leaf",R="node",AL="over",y="ownerTree",F="parentNode",Aa="selected",U=" ",I="tree",j="tree-node",V=function(A){return AD.get(A);},Aj=function(){return Array.prototype.slice.call(arguments).join(U);},AO=function(A){return(A instanceof AD.TreeNode);},Ai=function(A){return(A instanceof AD.TreeView);},g=AD.ClassNameManager.getClassName,AG=g(Q,Ac),a=g(I,Z),C=g(I,B),Ao=g(I,K),W=g(I,u),AS=g(I,i),f=g(I,t),M=g(I,AJ),e=g(I,R,AB),AT=g(I,R,u,i),J=g(I,R,Ab),Af=g(I,R,AL),k=g(I,R,Aa),AC='<div class="'+AS+'"></div>',S='<div class="'+f+'"></div>',E='<div class="'+M+'"></div>',Al="<ul></ul>",Y="<li></li>",z='<div class="'+Aj(AG,e)+'"></div>';function n(A){n.superclass.constructor.apply(this,arguments);}AD.mix(n,{NAME:j,ATTRS:{draggable:{value:true,validator:AX},ownerTree:{value:null},label:{value:p,validator:Ag},expanded:{value:false,validator:AX},id:{validator:Ag},leaf:{value:true,setter:function(A){if(A&&this.get(H).length){return false;}return A;},validator:AX},nextSibling:{value:null,validator:AO},prevSibling:{value:null,validator:AO},parentNode:{value:null,validator:function(A){return AO(A)||Ai(A);}},labelEl:{setter:V,valueFn:function(){var A=this.get(AJ);return AD.Node.create(E).html(A).unselectable();}},hitAreaEl:{setter:V,valueFn:function(){return AD.Node.create(AC);}},alwaysShowHitArea:{value:true,validator:AX},iconEl:{setter:V,valueFn:function(){return AD.Node.create(S);}},tabIndex:{value:null}}});AD.extend(n,AD.TreeData,{BOUNDING_TEMPLATE:Y,CONTENT_TEMPLATE:z,initializer:function(){var A=this;A._syncTreeNodeBBId();n.superclass.initializer.apply(this,arguments);},bindUI:function(){var A=this;A.publish("collapse",{defaultFn:A._collapse});A.publish("expand",{defaultFn:A._expand});A.after("childrenChange",AD.bind(A._afterSetChildren,A));A.after("idChange",A._afterSetId,A);},_renderUI:function(A){this._renderBoxClassNames();},renderUI:function(){var A=this;A._renderBoundingBox();A._renderContentBox();},syncUI:function(){var A=this;A._syncHitArea(A.get(H));},_renderContentBox:function(As){var A=this;var L=A.get(X);if(A.isLeaf()){L.addClass(J);}else{var Ar=A.get(K);L.addClass(Ar?Ao:a);if(Ar){A.expand();}}return L;},_renderBoundingBox:function(){var A=this;var Ar=A.get(T);var L=A.get(X);var As=null;if(!A.isLeaf()){L.append(A.get(G));As=A._createNodeContainer();}L.append(A.get(Am));L.append(A.get(v));Ar.append(L);if(As){if(!A.get(K)){As.addClass(W);}Ar.append(As);}return Ar;},_createNodeContainer:function(){var A=this;var L=A.get(B)||AD.Node.create(Al);L.addClass(C);A.set(B,L);A.eachChildren(function(Ar){A.appendChild(Ar);});return L;},_syncHitArea:function(L){var A=this;if(A.get(An)||L.length){A.showHitArea();}else{A.hideHitArea();A.collapse();}},appendChild:function(){var A=this;if(!A.isLeaf()){n.superclass.appendChild.apply(A,arguments);}},collapse:function(){var A=this;if(A.get(K)){var L=A.getEventOutputMap(A);A.bubbleEvent("collapse",L);}},_collapse:function(As){if(As.stopActionPropagation){return false;}var A=this;if(!A.isLeaf()){var Ar=A.get(B);var L=A.get(X);L.replaceClass(Ao,a);if(Ar){Ar.addClass(W);}A.set(K,false);}},collapseAll:function(){var A=this;n.superclass.collapseAll.apply(A,arguments);A.collapse();},contains:function(A){return A.isAncestor(this);},expand:function(){var A=this;if(!A.get(K)){var L=A.getEventOutputMap(A);A.bubbleEvent("expand",L);}},_expand:function(As){if(As.stopActionPropagation){return false;}var A=this;if(!A.isLeaf()){var Ar=A.get(B);var L=A.get(X);L.replaceClass(a,Ao);if(Ar){Ar.removeClass(W);}A.set(K,true);}},expandAll:function(){var A=this;n.superclass.expandAll.apply(A,arguments);A.expand();},getDepth:function(){var Ar=0;var L=this;var A=L.get(F);while(A){++Ar;A=A.get(F);}return Ar;},hasChildNodes:function(){var A=this;return(!A.isLeaf()&&n.superclass.hasChildNodes.apply(this,arguments));},isSelected:function(){return this.get(X).hasClass(k);},isLeaf:function(){var A=this;return A.get(Ab);},isAncestor:function(Ar){var L=this;var A=L.get(F);while(A){if(A==Ar){return true;}A=A.get(F);}return false;},insertAfter:function(Ar,L){var A=this;n.superclass.insertAfter.apply(this,[Ar,A]);},insertBefore:function(L){var A=this;n.superclass.insertBefore.apply(this,[L,A]);},removeChild:function(L){var A=this;if(!A.isLeaf()){n.superclass.removeChild.apply(A,arguments);}},toggle:function(){var A=this;if(A.get(K)){A.collapse();}else{A.expand();}},select:function(){var A=this;var L=A.get(y);if(L){L.set(s,A);}A.get(X).addClass(k);A.fire("select");},unselect:function(){var A=this;A.get(X).removeClass(k);A.fire("unselect");},over:function(){this.get(X).addClass(Af);},out:function(){this.get(X).removeClass(Af);},showHitArea:function(){var A=this;var L=A.get(G);L.removeClass(AT);},hideHitArea:function(){var A=this;var L=A.get(G);L.addClass(AT);},_syncTreeNodeBBId:function(L){var A=this;A.get(T).attr(AR,A.get(AR));},_afterSetChildren:function(L){var A=this;A._syncHitArea(L.newVal);}});AD.TreeNode=n;var AV=x.isFunction,h=x.isObject,Ah="cache",AK="io",AY="limit",Ak="loaded",Ap="loading",AF="offset",AI="paginator",AQ="tree-node-io",D="paginatorClick",AW=g(I,R,AI),b=g(I,R,AK,Ap),AU='<a class="'+AW+'" href="javascript:void(0);">Load more results</a>';function m(A){m.superclass.constructor.apply(this,arguments);}AD.mix(m,{NAME:AQ,ATTRS:{io:{lazyAdd:false,value:null,setter:function(A){return this._setIO(A);}},loading:{value:false,validator:AX},loaded:{value:false,validator:AX},cache:{value:true,validator:AX},leaf:{value:false,validator:AX},paginator:{setter:function(A){return AD.merge({element:AD.Node.create(AU),limit:Infinity,limitParam:AY,offset:0,offsetParam:AF},A);},validator:h}}});AD.extend(m,AD.TreeNode,{renderUI:function(){var A=this;A._inheritOwnerTreeAttrs();
m.superclass.renderUI.apply(this,arguments);},bindUI:function(){var A=this;m.superclass.bindUI.apply(this,arguments);if(A.get(AI)){A._bindPaginatorUI();}A._createEvents();},_bindPaginatorUI:function(){var A=this;var Ar=A.get(AI);var L=AD.bind(A._handlePaginatorClickEvent,A);Ar.element.on("click",L);},createNode:function(L){var A=this;AD.each(L,function(As){var Ar=m.superclass.createNode.apply(A,[As]);A.appendChild(Ar);});if(A.get(AI)){A._syncPaginatorUI();}},expand:function(){var A=this;var L=A.get(Ah);var At=A.get(AK);var Ar=A.get(Ak);var As=A.get(Ap);if(!L){A.set(Ak,false);}if(!At||Ar){m.superclass.expand.apply(this,arguments);}else{if(!As){if(!L){A.empty();}A.initIO();}}},initIO:function(){var L=this;var Ar=L.get(AK);if(AV(Ar.cfg.data)){Ar.cfg.data=Ar.cfg.data.apply(L,[L]);}if(L.get(AI)){L._syncPaginatorIOData(Ar);}if(AV(Ar.loader)){var A=AD.bind(Ar.loader,L);A(Ar.url,Ar.cfg,L);}else{AD.io(Ar.url,Ar.cfg);}},ioStartHandler:function(){var A=this;var L=A.get(X);A.set(Ap,true);L.addClass(b);},ioCompleteHandler:function(){var A=this;var L=A.get(X);A.set(Ap,false);A.set(Ak,true);L.removeClass(b);},ioSuccessHandler:function(){var A=this;var Aw=A.get(AK);var Ar=Array.prototype.slice.call(arguments);var At=Ar.length;var L=Ar[0];if(At>=2){var Av=Ar[1];try{L=AD.JSON.parse(Av.responseText);}catch(Au){}}var As=Aw.formatter;if(As){L=As(L);}A.createNode(L);A.expand();},ioFailureHandler:function(){var A=this;A.set(Ap,false);A.set(Ak,false);},_createEvents:function(){var A=this;A.publish(D,{defaultFn:A._defPaginatorClickFn,prefix:AQ});},_defPaginatorClickFn:function(L){var A=this;var Ar=A.get(AI);Ar.offset+=Ar.limit;if(A.get(AK)){A.initIO();}},_handlePaginatorClickEvent:function(As){var A=this;var Ar=A.get(y);var L=A.getEventOutputMap(A);A.fire(D,L);if(Ar){Ar.fire(D,L);}As.halt();},_inheritOwnerTreeAttrs:function(){var L=this;var Ar=L.get(y);if(Ar){if(!L.get(AK)){L.set(AK,AD.clone(Ar.get(AK)));}if(!L.get(AI)){var A=Ar.get(AI);if(A&&A.element){A.element=A.element.cloneNode(true);}L.set(AI,A);}}},_setIO:function(Ar){var A=this;if(!Ar){return null;}else{if(Ag(Ar)){Ar={url:Ar};}}Ar=Ar||{};Ar.cfg=Ar.cfg||{};Ar.cfg.on=Ar.cfg.on||{};var L={start:AD.bind(A.ioStartHandler,A),complete:AD.bind(A.ioCompleteHandler,A),success:AD.bind(A.ioSuccessHandler,A),failure:AD.bind(A.ioFailureHandler,A)};AD.each(L,function(Au,As){var Av=Ar.cfg.on[As];if(AV(Av)){var At=function(){Au.apply(A,arguments);Av.apply(A,arguments);};Ar.cfg.on[As]=AD.bind(At,A);}else{Ar.cfg.on[As]=Au;}});return Ar;},_syncPaginatorIOData:function(As){var A=this;var L=As.cfg.data||{};var Ar=A.get(AI);L[Ar.limitParam]=Ar.limit;L[Ar.offsetParam]=Ar.offset;As.cfg.data=L;},_syncPaginatorUI:function(){var A=this;var Ar=A.get(H);var As=A.get(AI);var L=As.limit+As.offset;if(Ar.length>=L){A.get(B).append(As.element.show());}else{As.element.hide();}}});AD.TreeNodeIO=m;var N="checkbox",P="checked",AA="checkContainerEl",Ad="checkEl",o="checkName",w=".",O="name",c="tree-node-check",AH=g(I,R,N),AN=g(I,R,N,B),AP=g(I,R,P),r='<div class="'+AN+'"></div>',AM='<input class="'+AH+'" type="checkbox" />';function AZ(A){AZ.superclass.constructor.apply(this,arguments);}AD.mix(AZ,{NAME:c,ATTRS:{checked:{value:false,validator:AX},checkName:{value:c,validator:Ag},checkContainerEl:{setter:V,valueFn:function(){return AD.Node.create(r);}},checkEl:{setter:V,valueFn:function(){var A=this.get(o);return AD.Node.create(AM).attr(O,A);}}}});AD.extend(AZ,AD.TreeNodeIO,{renderUI:function(){var L=this;AZ.superclass.renderUI.apply(L,arguments);var Ar=L.get(v);var A=L.get(Ad);var As=L.get(AA);A.hide();As.append(A);Ar.placeBefore(As);if(L.isChecked()){L.check();}},bindUI:function(){var A=this;var L=A.get(X);var Ar=A.get(v);AZ.superclass.bindUI.apply(A,arguments);A.publish("check");A.publish("uncheck");L.delegate("click",AD.bind(A.toggleCheck,A),w+AN);L.delegate("click",AD.bind(A.toggleCheck,A),w+M);Ar.swallowEvent("dblclick");},check:function(){var L=this;var Ar=L.get(X);var A=L.get(Ad);Ar.addClass(AP);L.set(P,true);A.attr(P,P);L.fire("check");},uncheck:function(){var L=this;var Ar=L.get(X);var A=L.get(Ad);Ar.removeClass(AP);L.set(P,false);A.attr(P,p);L.fire("uncheck");},toggleCheck:function(){var L=this;var A=L.get(Ad);var Ar=A.attr(P);if(!Ar){L.check();}else{L.uncheck();}},isChecked:function(){var A=this;return A.get(P);}});AD.TreeNodeCheck=AZ;var d="child",q="tree-node-task",l="unchecked",Ae=function(A){return A instanceof AD.TreeNodeCheck;},AE=g(I,R,d,l);function Aq(A){Aq.superclass.constructor.apply(this,arguments);}AD.mix(Aq,{NAME:q});AD.extend(Aq,AD.TreeNodeCheck,{check:function(As){var L=this;var A=L.get(F);var Ar=L.get(X);Aq.superclass.check.apply(this,arguments);if(!As){Ar.removeClass(AE);L.eachParent(function(At){if(Ae(At)){var Au=false;At.check(true);At.get(X).addClass(AE);At.eachChildren(function(Av){if(Ae(Av)&&!Av.isChecked()){Au=true;}},true);if(!Au){At.get(X).removeClass(AE);}}});if(!L.isLeaf()){L.eachChildren(function(At){if(Ae(At)){At.check();}});}}},uncheck:function(){var A=this;var L=A.get(X);Aq.superclass.uncheck.apply(this,arguments);L.removeClass(AE);A.eachParent(function(Ar){if(Ae(Ar)&&Ar.isChecked()){Ar.get(X).addClass(AE);}});if(!A.isLeaf()){A.eachChildren(function(Ar){if(Ar instanceof AD.TreeNodeCheck){Ar.uncheck();}});}}});AD.TreeNodeTask=Aq;AD.TreeNode.nodeTypes={task:AD.TreeNodeTask,check:AD.TreeNodeCheck,node:AD.TreeNode,io:AD.TreeNodeIO};},"@VERSION@",{skinnable:false,requires:["aui-tree-data","io","json"]});