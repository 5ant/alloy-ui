AUI.add("aui-rating",function(W){var R=W.Lang,m=R.isBoolean,AE=R.isNumber,S=R.isString,d=function(A){return(A instanceof W.NodeList);},Q=function(A){return(A instanceof W.Node);},X="",AA="boundingBox",o="canReset",F="clearfix",h="contentBox",l="defaultSelected",k="disabled",e=".",s="element",I="elements",p="",u="helper",Z="hover",f="id",M="input",v="inputName",AC="label",AG="labelNode",n="name",U="off",a="on",Y="rating",O="ratingElement",C="selectedIndex",G="showTitle",g="size",q="title",y="value",B="itemClick",AF="itemSelect",D="itemOut",t="itemOver",K=W.ClassNameManager.getClassName,j=K(u,F),AD=K(Y,AC,s),E=K(Y,s),r=K(Y,s,Z),H=K(Y,s,U),c=K(Y,s,a),N='<div class="'+AD+'"></div>',V='<a href="javascript:;"></a>',P="<span></span>";var T=W.Component.create({NAME:"rating",ATTRS:{disabled:{value:false,validator:m},canReset:{value:true,validator:m},defaultSelected:{value:0,writeOnce:true,validator:AE},elements:{validator:d},hiddenInput:{validator:Q},inputName:{value:X,validator:S},label:{value:X,validator:S},labelNode:{valueFn:function(){return W.Node.create(N);},validator:Q},ratingElement:{valueFn:function(){var A=this;var L=W.Node.create(A.get(k)?P:V);return L.addClass(E);}},selectedIndex:{value:-1,validator:AE},showTitle:{value:true,validator:m},size:{value:5,validator:function(A){return AE(A)&&(A>0);}},title:null,value:null},HTML_PARSER:{elements:function(A){return A.all(e+E);},label:function(L){var A=L.one(e+AD);if(A){return A.html();}},labelNode:e+AD},prototype:{initializer:function(){var A=this;A.inputElementsData={};A.after("labelChange",this._afterSetLabel);},renderUI:function(){var A=this;var L=A.get(h);L.addClass(j);A._parseInputElements();A._renderLabel();A._renderElements();},bindUI:function(){var A=this;A._createEvents();A.on("click",A._handleClickEvent);A.on("mouseover",A._handleMouseOverEvent);A.on("mouseout",A._handleMouseOutEvent);},syncUI:function(){var A=this;A._syncElements();A._syncLabelUI();},destructor:function(){var A=this;var L=A.get(AA);L.detachAll();L.remove();},clearSelection:function(){var A=this;A.get(I).each(function(L){L.removeClass(c);L.removeClass(r);});},select:function(AI){var AN=this;var AJ=AN.get(C);var AL=AN.get(o);if(AL&&(AJ==AI)){AI=-1;}AN.set(C,AI);var L=AN.get(C);var AH=AN._getInputData(L);var AK=(q in AH)?AH.title:X;var AM=(y in AH)?AH.value:L;AN.fillTo(L);AN.set(q,AK);AN.set(y,AM);var A=AN.get("hiddenInput");A.setAttribute(q,AK);A.setAttribute(y,AM);},fillTo:function(L,AH){var A=this;A.clearSelection();if(L>=0){A.get(I).some(function(AJ,AI){AJ.addClass(AH||c);return(AI==Math.floor(L));});}},indexOf:function(L){var A=this;return A.get(I).indexOf(L);},_canFireCustomEvent:function(L){var A=this;var AH=L.domEvent.target;return !A.get(k)&&AH.hasClass(E);},_createElements:function(){var A=this;var AJ=[];var AI=A.get(O);for(var AH=0,L=this.get(g);AH<L;AH++){AJ.push(AI.cloneNode(true));}return new W.NodeList(AJ);},_createEvents:function(){var A=this;var L=function(AH,AI){A.publish(AH,{defaultFn:AI,queuable:false,emitFacade:true,bubbles:true});};L(B,this._defRatingItemClickFn);L(AF,this._defRatingItemSelectFn);L(t,this._defRatingItemOverFn);L(D,this._defRatingItemOutFn);},_defRatingItemClickFn:function(AH){var A=this;var L=AH.domEvent;A.fire(AF,{delegateEvent:AH,domEvent:L,ratingItem:L.target});},_defRatingItemSelectFn:function(L){var A=this;var AH=L.domEvent.target;A.select(A.indexOf(AH));},_defRatingItemOutFn:function(L){var A=this;A.fillTo(A.get(C));},_defRatingItemOverFn:function(AH){var A=this;var L=A.indexOf(AH.domEvent.target);A.fillTo(L,r);},_parseInputElements:function(){var A=this;var AI=A.get(AA);var L=AI.all(M);var AJ=L.size();var AH=A.get(v);var AK=W.Node.create('<input type="hidden" />');if(AJ>0){AH=AH||L.item(0).getAttribute(n);A.set(g,AJ);var AL=AI.all("label");L.each(function(AP,AO){var AQ=AP.get(f);var AN=p;if(AQ){var AM=AL.filter('[for="'+AQ+'"]');if(AM.size()){AN=AM.item(0).html();}}A.inputElementsData[AO]={content:AN,value:AP.getAttribute(y)||AO,title:AP.getAttribute(q)};});AL.remove();L.remove();}if(AH){AK.setAttribute(n,AH);AI.appendChild(AK);}A.set("hiddenInput",AK);},_renderLabel:function(){var A=this;A.get(h).append(A.get(AG));},_renderElements:function(AH){var A=this;var L=A.get(h);if(!A.get(I).size()){A.set(I,A._createElements());}A.get(I).each(function(AJ,AI){var AL=A._getInputData(AI);var AK=AL.content;var AM=AL.title||A.get(q)||AK;if(AK||AM){AJ.html(AK||AM);}if(AM&&A.get(G)){AJ.setAttribute(q,AM);}L.appendChild(AJ);});},_syncElements:function(){var L=this;var A=L.get(l)-1;L.set(C,A);L.select();},_syncLabelUI:function(){var A=this;var L=A.get(AC);A.get(AG).html(L);},_getInputData:function(L){var A=this;return A.inputElementsData[L]||{};},_handleClickEvent:function(L){var A=this;if(A._canFireCustomEvent(L)){A.fire(B,{delegateEvent:L,domEvent:L.domEvent});}},_handleMouseOutEvent:function(L){var A=this;if(A._canFireCustomEvent(L)){A.fire(D,{delegateEvent:L,domEvent:L.domEvent});}},_handleMouseOverEvent:function(L){var A=this;if(A._canFireCustomEvent(L)){A.fire(t,{delegateEvent:L,domEvent:L.domEvent});}},_afterSetLabel:function(A){this._syncLabelUI();}}});var i="down",z="thumb",AB="ThumbRating",b="up",x=K(Y,z,i),w=K(Y,z,b);var J=W.Component.create({NAME:AB,ATTRS:{size:{value:2,readOnly:true}},EXTENDS:T,prototype:{renderUI:function(){var A=this;J.superclass.renderUI.apply(this,arguments);var L=A.get(I);L.addClass(H);L.item(0).addClass(w);L.item(1).addClass(x);},fillTo:function(A,L){this.clearSelection();if(A>=0){this.get(I).item(A).addClass(L||c);}},_syncElements:function(){}}});W.Rating=T;W.StarRating=T;W.ThumbRating=J;},"@VERSION@",{requires:["aui-base"],skinnable:true});