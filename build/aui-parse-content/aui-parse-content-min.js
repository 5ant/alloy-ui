AUI.add("aui-parse-content",function(d){var l=d.Lang,c=l.isString,n="append",a="documentElement",p="firstChild",i="head",o="host",f="innerHTML",g="ParseContent",e="queue",k="script",m=";",h="src",j={"":1,"text/javascript":1};var b=d.Component.create({NAME:g,NS:g,ATTRS:{queue:{value:null}},EXTENDS:d.Plugin.Base,prototype:{initializer:function(){var q=this;b.superclass.initializer.apply(this,arguments);q.set(e,new d.AsyncQueue());q._bindAOP();},globalEval:function(s){var t=d.getDoc();var r=t.one(i)||t.get(a);var q=document.createElement(k);q.type="text/javascript";if(s){q.text=l.trim(s);}r.appendChild(q).remove();},parseContent:function(s){var q=this;var r=q._clean(s);q._dispatch(r);return r;},_addInlineScript:function(r){var q=this;q.get(e).add({args:r,context:q,fn:q.globalEval,timeout:0});},_bindAOP:function(){var r=this;var q=function(v){var u=Array.prototype.slice.call(arguments);var t=r.parseContent(v);u.splice(0,1,t.fragment);return new d.Do.AlterArgs(null,u);};this.doBefore("insert",q);this.doBefore("replaceChild",q);var s=function(u){var t=r.parseContent(u);return new d.Do.AlterArgs(null,[t.fragment]);};this.doBefore("replace",s);this.doBefore("setContent",s);},_clean:function(s){var q={};var r=d.Node.create("<div></div>");r.append("<div>_</div>");if(c(s)){d.DOM.addHTML(r,s,n);}else{r.append(s);}q.js=r.all(k).filter(function(t){return j[t.getAttribute("type").toLowerCase()];});q.js.each(function(u,t){u.remove();});r.get(p).remove();q.fragment=r.get("childNodes").toFrag();return q;},_dispatch:function(t){var r=this;var q=r.get(e);var s=[];t.js.each(function(v,u){var x=v.get(h);if(x){if(s.length){r._addInlineScript(s.join(m));s.length=0;}q.add({autoContinue:false,fn:function(){d.Get.script(x,{onEnd:function(y){y.purge();q.run();}});},timeout:0});}else{var w=v._node;s.push(w.text||w.textContent||w.innerHTML||"");}});if(s.length){r._addInlineScript(s.join(m));}q.run();}}});d.namespace("Plugin").ParseContent=b;},"@VERSION@",{skinnable:false,requires:["async-queue","aui-base","plugin"]});