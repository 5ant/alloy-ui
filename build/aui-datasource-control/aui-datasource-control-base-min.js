AUI.add("aui-datasource-control-base",function(E){var I=E.Lang,D=I.isFunction,C=I.isString,H="bindUI",J="json",K="renderUI",G="syncUI",B="xml";var F=function(){};F.ATTRS={dataSource:{value:null,setter:function(P){var A=this;var O=P;if(P){var M=O;var N=A.get("dataSourceType");if(!(O instanceof E.DataSource.Local)){if(!N){N="Local";if(D(M)){N="Function";}else{if(C(M)){N="IO";}}}O=new E.DataSource[N]({source:M});}N=O.name;if(N=="dataSourceIO"){O.on("request",function(S){var Q=this;var R=Q.get("uriFormatter");if(D(R)){var T=R.call(Q,Q.get("requestData"));if(T){O.set("source",T);}}},A);O.on("data",function(R){var Q=this;if(!R.error){Q.set("responseData",R.data);}},A);}var L=A._schema;if(L){O.plug(L);}A.set("dataSourceType",N);}return O;}},dataSourceType:{value:null},requestData:{value:null},responseData:{value:null,setter:function(L){var A=this;return this._setResponseData(L);}},schema:{value:null,lazyAdd:false,setter:function(P){var A=this;var O=A.get("dataSource");var N=A._schema;if(O&&N){O.unplug(N);N=null;A._schema=null;}if(P){if(!P.fn){var L=A.get("schemaType");var M={array:E.Plugin.DataSourceArraySchema,json:E.Plugin.DataSourceJSONSchema,text:E.Plugin.DataSourceTextSchema,xml:E.Plugin.DataSourceXMLSchema};L=L.toLowerCase()||"array";N={fn:M[L],cfg:{schema:P}};}else{N=P;P=P.cfg.schema;}}if(O&&N){O.plug(N);}A._schema=N;return P;}},schemaType:{value:"",validator:C},uriFormatter:{value:null}};F.prototype={initializer:function(){var A=this;A.publish(K);A.publish(H);A.publish(G);},renderUI:function(){var A=this;A.fire(K);},bindUI:function(){var A=this;A.publish("dataError");A.publish("dataRequest");A.publish("dataReturn");A.fire(H);},syncUI:function(){var A=this;A.fire(G);},_setResponseData:function(Q){var L=this;var O=null;if(Q){var M=L.get("schemaType");var R=Q.getResponseHeader("content-type");if((M==B)||(!M&&R.indexOf(B)>=0)){O=Q.responseXML;if(O.documentElement.tagName=="parsererror"){throw PARSE_ERROR;}}else{O=Q.responseText;}if(O===""){O=null;}if(M==J){try{O=E.JSON.parse(O);}catch(P){}}else{var A=L.get("selector");if(O&&A){var N;if(O.documentElement){N=E.one(O);}else{N=E.Node.create(O);}O=N.all(A);}}}return O;}};E.DataSourceControl=F;},"@VERSION@",{requires:["aui-base","datasource","dataschema"]});