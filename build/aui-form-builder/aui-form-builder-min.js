AUI.add("aui-form-builder-base",function(p){var k=p.Lang,n=k.isArray,o=k.isString,m=k.isObject,w=k.isValue,t=function(A){return(A instanceof p.Node);},s=function(A){return(A instanceof p.NodeList);},c=function(A){return(A instanceof p.FormBuilder);},q=function(A){return(A instanceof p.FormBuilderField);},e=p.DD.DDM,i="active",x="acceptChildren",r="autoSelectFields",z="availableFields",y="append",B="boundingBox",g="builder",d="button",j="buttons",l="buttonsNode",h="children",b="clonable-portal-layout",v="cloneNode",f=", ";COMPONENT="component",CONTENT="content",CONTENT_BOX="contentBox",CONTAINER="container",DELETE="delete",DD="dd",DEFAULT="default",DEFAULT_MESSAGE_NODE="defaultMessageNode",DOT=".",DUPLICATE="duplicate",DRAG="drag",DRAGGING="dragging",DRAG_CONTAINER="dragContainer",DRAG_CONTAINER_NODE="dragContainerNode",DRAG_NODES_LIST="dragNodesList",DRAG_PORTAL_LAYOUT="dragPortalLayout",DROP="drop",DROP_CONTAINER="dropContainer",DROP_CONTAINER_NODE="dropContainerNode",DROP_PORTAL_LAYOUT="dropPortalLayout",DROP_NODE="dropNode",DROP_ZONE_NODE="dropZoneNode",EDIT="edit",EMPTY_STR="",FIELD="field",FIELDS="fields",FIRST="first",FIRST_CHILD="firstChild",FOCUSED="focused",FORM="form",FORM_BUILDER="formBuilder",FORM_LAYOUT="form-layout",ID="id",ICON="icon",INPUT="input",ITEMS="items",LABEL="label",LABEL_NODE="labelNode",LAST="last",LAST_CHILD="lastChild",LIST="list",MESSAGE="message",NAME="name",NESTED_LIST="nestedList",NODE="node",OVER="over",PARENT="parent",PARENT_NODE="parentNode",PLACEHOLDER="placeholder",PLACE_AFTER="placeAfter",PLACE_BEFORE="placeBefore",PREPEND="prepend",HELPER="helper",HIDDEN="hidden",RENDER="render",SAVE="save",SELECTED="selected",SETTINGS="settings",SETTINGS_FORM_NODE="settingsFormNode",SETTINGS_BUTTONS_NODE="settingsButtonsNode",SRC_NODE="srcNode",SPACE=" ",STATE="state",STRINGS="strings",TABS="tabs",TABS_NODE="tabsNode",TABS_CONTENT_NODE="tabsContentNode",TABS_LIST_NODE="tabsListNode",TABVIEW="tabview",TARGET="target",TEMPLATE_NODE="templateNode",TEXT="text",TYPE="type",VALUE="value",VALUES="values",ZONE="zone",REGION="region",WIDGET="widget",STRING_EMPTY_SELECTION="stringEmptySelection",getCN=p.getClassName,CSS_BUTTON_INPUT=getCN(d,INPUT),CSS_COMPONENT=getCN(COMPONENT),CSS_DD_DRAGGING=getCN(DD,DRAGGING),CSS_HELPER_HIDDEN=getCN(HELPER,HIDDEN),CSS_FORM_BUILDER_BUTTON_DELETE=getCN(FORM,g,d,DELETE),CSS_FORM_BUILDER_BUTTON_DUPLICATE=getCN(FORM,g,d,DUPLICATE),CSS_FORM_BUILDER_BUTTON_EDIT=getCN(FORM,g,d,EDIT),CSS_FORM_BUILDER_BUTTON_SAVE=getCN(FORM,g,d,SAVE),CSS_FORM_BUILDER_DEFAULT_MESSAGE=getCN(FORM,g,DEFAULT,MESSAGE),CSS_FORM_BUILDER_DRAG_CONTAINER=getCN(FORM,g,DRAG,CONTAINER),CSS_FORM_BUILDER_DRAG_NODE=getCN(FORM,g,DRAG,NODE),CSS_FORM_BUILDER_DROP_ACTIVE=getCN(FORM,g,DROP,i),CSS_FORM_BUILDER_DROP_CONTAINER=getCN(FORM,g,DROP,CONTAINER),CSS_FORM_BUILDER_DROP_NODE=getCN(FORM,g,DROP,NODE),CSS_FORM_BUILDER_DROP_ZONE=getCN(FORM,g,DROP,ZONE),CSS_FORM_BUILDER_FIELD=getCN(FORM,g,FIELD),CSS_FORM_BUILDER_FIELD_BUTTONS=getCN(FORM,g,FIELD,j),CSS_FORM_BUILDER_FIELD_CONTENT=getCN(FORM,g,FIELD,CONTENT),CSS_FORM_BUILDER_FIELD_HIDDEN=getCN(FORM,g,FIELD,HIDDEN),CSS_FORM_BUILDER_FIELD_ICON=getCN(FORM,g,FIELD,ICON),CSS_FORM_BUILDER_FIELD_ICON_TEXT=getCN(FORM,g,FIELD,ICON,TEXT),CSS_FORM_BUILDER_FIELD_OVER=getCN(FORM,g,FIELD,OVER),CSS_FORM_BUILDER_FIELD_SELECTED=getCN(FORM,g,FIELD,SELECTED),CSS_FORM_BUILDER_HELPER=getCN(FORM,g,HELPER),CSS_FORM_BUILDER_ICON=getCN(FORM,g,ICON),CSS_FORM_BUILDER_LABEL=getCN(FORM,g,LABEL),CSS_FORM_BUILDER_PLACEHOLDER=getCN(FORM,g,PLACEHOLDER),CSS_FORM_BUILDER_SETTINGS=getCN(FORM,g,SETTINGS),CSS_FORM_BUILDER_SETTINGS_BUTTONS=getCN(FORM,g,SETTINGS,j),CSS_FORM_BUILDER_TABS_CONTAINER=getCN(FORM,g,TABS,CONTAINER),CSS_TABVIEW_CONTENT=getCN(TABVIEW,CONTENT),CSS_TABVIEW_LIST=getCN(TABVIEW,LIST),CSS_ICON=getCN(ICON),CSS_WIDGET=getCN(WIDGET),TPL_DEFAULT_MESSAGE='<li class="'+CSS_FORM_BUILDER_DEFAULT_MESSAGE+'"></li>',TPL_DRAG_CONTAINER='<ul class="'+CSS_FORM_BUILDER_DRAG_CONTAINER+'"></ul>',TPL_DRAG_NODE='<li class="'+[CSS_FORM_BUILDER_DRAG_NODE,CSS_FORM_BUILDER_FIELD].join(SPACE)+'" data-name="{name}">'+'<span class="'+[CSS_FORM_BUILDER_ICON,CSS_ICON].join(SPACE)+' {icon}"></span>'+'<span class="'+CSS_FORM_BUILDER_LABEL+'">{label}</span>'+"</li>",TPL_DROP_CONTAINER='<ul class="'+[CSS_FORM_BUILDER_DROP_CONTAINER].join(SPACE)+'"></ul>',TPL_FIELD_BOUNDING_BOX='<li class="'+[CSS_WIDGET,CSS_COMPONENT,CSS_FORM_BUILDER_FIELD,CSS_HELPER_HIDDEN].join(SPACE)+'"></li>',TPL_HELPER='<div class="'+CSS_FORM_BUILDER_HELPER+'"></div>',TPL_PLACEHOLDER='<li class="'+CSS_FORM_BUILDER_PLACEHOLDER+'"></li>',TPL_TABS='<div class="'+CSS_FORM_BUILDER_TABS_CONTAINER+'"></div>',TPL_TABS_CONTENT='<div class="'+CSS_TABVIEW_CONTENT+'"></div>',TPL_TABS_LIST='<ul class="'+CSS_TABVIEW_LIST+'"></ul>',TPL_SETTINGS='<form class="'+CSS_FORM_BUILDER_SETTINGS+'"></form>',TPL_SETTINGS_BUTTONS='<div class="yui3-aui-button-row">'+'<span class="yui3-aui-button yui3-aui-button-submit yui3-aui-state-positive yui3-aui-priority-primary">'+'<span class="yui3-aui-button-content">'+'<input type="button" value="Save" class="yui3-aui-button-input yui3-aui-form-builder-button-save">'+"</span>"+"</span>"+'<span class="yui3-aui-button yui3-aui-button-submit yui3-aui-state-positive yui3-aui-priority-secondary">'+'<span class="yui3-aui-button-content">'+'<input type="button" value="Close" class="yui3-aui-button-input yui3-aui-form-builder-button-close">'+"</span>"+"</span>"+"</div>",TAB_INDEX_DRAG=0,TAB_INDEX_SETTINGS=1,DEFAULT_ICON_CLASS=[CSS_FORM_BUILDER_FIELD_ICON,CSS_FORM_BUILDER_FIELD_ICON_TEXT].join(SPACE),INVALID_CLONE_ATTRS=p.Array([B,CONTENT_BOX,SRC_NODE,FIELDS,ID,SELECTED,TEMPLATE_NODE,LABEL_NODE,NAME]);var a=function(){};a.ATTRS={fields:{value:[],setter:"_setFields",getter:function(A){return A||[];},validator:n}};p.mix(a.prototype,{addField:function(D){var C=this;var A=C.get(FIELDS);A=C._removeFromParent(D);A.push(D);C.set(FIELDS,A);},addFields:function(C){var A=this;p.Array.each(A._normalizeFields(C),p.bind(A.addField,A));
},contains:function(G,D){var C=this;var A=C.get(FIELDS);if(D){for(var E=0;E<A.length;E++){var F=A[E];if((F==G)||F.contains(G,D)){return true;}}}return(C.indexOf(G)>-1);},getField:function(D){var C=this;var A=C.get(FIELDS);return A[D];},indexOf:function(D){var C=this;var A=C.get(FIELDS);return p.Array.indexOf(A,D);},insertField:function(D,E){var C=this;var A=C.get(FIELDS);A=C._removeFromParent(E);A.splice(D,0,E);C.set(FIELDS,A);},removeField:function(D){var C=this;var A=C.get(FIELDS);A=C._removeFromParent(D);D.removeTarget(C);C.set(FIELDS,A);},removeFields:function(C){var A=this;p.Array.each(A._normalizeFields(C),p.bind(A.removeField,A));},_normalizeFields:function(C){var A=this;var D=[];C=p.Array(C);p.Array.each(C,function(G,F){var E=A.get(FORM_BUILDER)||A;if(!q(G)){G=E._renderField(A,F,G);}if(G){D.push(G);G.addTarget(E);G.set(PARENT,A);}});return D;},_removeFromParent:function(E){var C=this;var A=C.get(FIELDS);if(q(E)){var D=E.get(PARENT);if(D&&D!=C){D.removeField(E);}else{if(C.contains(E)){p.Array.removeItem(A,E);}}}return A;},_setFields:function(C){var A=this;return A._normalizeFields(C);}});p.FormBuilderFieldSupport=a;var u=p.Component.create({NAME:FORM_BUILDER,ATTRS:{autoSelectFields:{value:false},availableFields:{setter:"_indexAvaliableFieldsTypes",value:[],validator:n,lazyAdd:false},nestedList:{setter:function(D){var A=this;var C=p.merge({dd:{plugins:[{cfg:{horizontal:false,scrollDelay:30},fn:p.Plugin.DDWinScroll}]},dropCondition:function(F){var G=false;var E=F.drop.get(NODE);var H=E.getData(FIELD);if(H&&H.get(x)){G=true;}return G;},dropOn:DOT+CSS_FORM_BUILDER_DROP_ZONE,placeholder:p.Node.create(TPL_PLACEHOLDER),sortCondition:function(F){var E=A.get(DROP_CONTAINER_NODE);return E.contains(F.drop.get(NODE));}},D);return C;},value:{}},strings:{value:{stringDefaultMessage:"Drop a field here",stringEmptySelection:"No field selected"}},defaultMessageNode:{valueFn:function(){return p.Node.create(TPL_DEFAULT_MESSAGE);}},dragContainerNode:{valueFn:function(){return p.Node.create(TPL_DRAG_CONTAINER);}},dragNodesList:{valueFn:"_valueDragNodesList"},dropContainerNode:{valueFn:function(){return p.Node.create(TPL_DROP_CONTAINER);}},settingsButtonsNode:{valueFn:function(){return p.Node.create(TPL_SETTINGS_BUTTONS);}},settingsFormNode:{valueFn:function(){return p.Node.create(TPL_SETTINGS);}},tabsNode:{valueFn:function(){return p.Node.create(TPL_TABS);}},tabsContentNode:{valueFn:function(){return p.Node.create(TPL_TABS_CONTENT);}},tabsListNode:{valueFn:function(){return p.Node.create(TPL_TABS_LIST);}}},AUGMENTS:[p.FormBuilderFieldSupport],HTML_PARSER:{defaultMessageNode:DOT+CSS_FORM_BUILDER_DEFAULT_MESSAGE,dragContainerNode:DOT+CSS_FORM_BUILDER_DRAG_CONTAINER,dragNodesList:function(C){var A=C.all(DOT+CSS_FORM_BUILDER_DRAG_NODE);return(A.size()<=0)?null:A;},dropContainerNode:DOT+CSS_FORM_BUILDER_DROP_CONTAINER,settingsFormNode:FORM+DOT+CSS_FORM_BUILDER_SETTINGS,settingsButtonsNode:DOT+CSS_FORM_BUILDER_SETTINGS_BUTTONS,tabsNode:DOT+CSS_FORM_BUILDER_TABS_CONTAINER,tabsContentNode:DOT+CSS_TABVIEW_CONTENT,tabsListNode:DOT+CSS_TABVIEW_LIST},EXTENDS:p.Widget,prototype:{initializer:function(){var A=this;A.boundingBox=A.get(B);A.dragContainerNode=A.get(DRAG_CONTAINER_NODE);A.dragNodesList=A.get(DRAG_NODES_LIST);A.dropContainerNode=A.get(DROP_CONTAINER_NODE);A.settingsButtonsNode=A.get(SETTINGS_BUTTONS_NODE);A.settingsFormNode=A.get(SETTINGS_FORM_NODE);A.tabsNode=A.get(TABS_NODE);A.tabsContentNode=A.get(TABS_CONTENT_NODE);A.tabsListNode=A.get(TABS_LIST_NODE);A._dragNestedList=new p.NestedList(A.get(NESTED_LIST));A._dropNestedList=new p.NestedList(A.get(NESTED_LIST));A._tabs=new p.TabView({boundingBox:A.tabsNode,contentNode:A.tabsContentNode,listNode:A.tabsListNode});if(!A.tabsContentNode.inDoc()){A._tabs.set(ITEMS,[{label:"Add a field",contentNode:A.dragContainerNode},{label:"Field settings",content:A.settingsFormNode}]);}},renderUI:function(){var A=this;A.dragContainerNode.setContent(A.dragNodesList);A._tabs.render();},bindUI:function(){var A=this;var D=A.boundingBox;var C=A.dropContainerNode;var E=A.settingsButtonsNode;A._dragNestedList.on("drag:end",p.bind(A._onDragEndDragNestedList,A));A._dragNestedList.on("drag:start",p.bind(A._onDragStartDragNestedList,A));A._dropNestedList.on("drag:end",p.bind(A._onDragEndDropNestedList,A));A._tabs.after("activeTabChange",p.bind(A._afterActiveTabChange,A));C.delegate("click",p.bind(A._onClickFieldDelete,A),DOT+CSS_FORM_BUILDER_BUTTON_DELETE);C.delegate("click",p.bind(A._onClickFieldDuplicate,A),DOT+CSS_FORM_BUILDER_BUTTON_DUPLICATE);C.delegate("click",p.bind(A._onClickFieldEdit,A),DOT+CSS_FORM_BUILDER_BUTTON_EDIT);C.delegate("dblclick",p.bind(A._onDbClickField,A),DOT+CSS_FORM_BUILDER_FIELD);C.delegate("mouseenter",p.bind(A._onMouseEnterField,A),DOT+CSS_FORM_BUILDER_FIELD);C.delegate("mouseleave",p.bind(A._onMouseLeaveField,A),DOT+CSS_FORM_BUILDER_FIELD);E.delegate("click",p.bind(A._onClickSettingsButton,A),DOT+CSS_BUTTON_INPUT);A.after("*:fieldsChange",p.bind(A._afterFieldsChange,A));A.after("*:selectedChange",p.bind(A._afterSelectedChange,A));},syncUI:function(){var A=this;A.syncFieldsUI();A._syncDefaultMessage();A._syncNestedList();},availableFieldsTypes:{},appendFields:function(C,D){var A=this;D.setContent(EMPTY_STR);p.each(C,function(F){var E=F.get(FIELDS);D.append(F.get(B));A.appendFields(E,F.get(DROP_ZONE_NODE));});},duplicateField:function(F){var A=this;var E=A._cloneField(F);var D=F.get(PARENT);var C=D.indexOf(F);D.insertField(++C,E);},selectField:function(D){var A=this;D.set(SELECTED,true);var C=A.settingsFormNode.one(INPUT);if(C){C.focus();C.select();}A._tabs.selectTab(TAB_INDEX_SETTINGS);},syncFieldsUI:function(E){var C=this;var A=C.get(FIELDS);var D=C.get(DROP_CONTAINER_NODE);if(E&&q(E.target)){var F=E.target;A=F.get(FIELDS);D=F.get(DROP_ZONE_NODE);}C.appendFields(A,D);},_afterActiveTabChange:function(G){var C=this;var F=C.selectedField;var D=C.get(SETTINGS_FORM_NODE);var E=C.get(SETTINGS_BUTTONS_NODE);var A=C.get(STRINGS);var H=C.contains(F,true);if(!H){D.setContent(A[STRING_EMPTY_SELECTION]);
}E.toggleClass(CSS_HELPER_HIDDEN,!H);},_afterFieldsChange:function(){var A=this;A.syncUI();},_afterSelectedChange:function(D){var A=this;var E=D.target;var C=A.selectedField;A._syncSelectedFieldUI(E);if(E.get(SELECTED)){A.selectedField=E;if(C&&C!=E){C.set(SELECTED,false);}E.renderSettings();}},_cloneField:function(F){var A=this;var E=F.get(TYPE);var C={};p.each(F.getAttrs(),function(H,G){if(INVALID_CLONE_ATTRS.indexOf(G)===-1&&!t(H)){C[G]=H;}});var D=[];p.each(F.get(FIELDS),function(G){D.push(A._cloneField(G));});C[FIELDS]=D;C[TYPE]=E;return C;},_dropField:function(D){var J=this;var E=D.get(PARENT_NODE);var A=E.all("> "+DOT+CSS_FORM_BUILDER_FIELD);var G=D.getData(FIELD);var C=J.get(DEFAULT_MESSAGE_NODE);if(C.inDoc()){C.remove();}var H=J._getFieldParentByNode(D);var F=A.indexOf(D);if(!G){D.remove();var I=D.getAttribute("data-name");G=J.availableFieldsTypes[I];}H.insertField(F,G);return H.getField(F);},_getFieldInstance:function(D,E){var A=this;var E=E||D.type;var C=p.FormBuilder.types;var F=o(E)?C[E]:E;if(F!==undefined){return new F(D);}else{p.log("The field type: ["+E+"] couldn't be found.");}return null;},_getFieldParentByNode:function(D){var C=this;var A=D.ancestor(DOT+CSS_FORM_BUILDER_FIELD);if(A){return A.getData(FIELD);}return C;},_getFieldParentNode:function(D){var A=this;var C=D.get(PARENT);if(q(C)){return C.get(B);}return A.get(DROP_CONTAINER_NODE);},_indexAvaliableFieldsTypes:function(C){var A=this;p.each(C,function(F,E,G){var D=(F.name||F.type||(F.type+(++p.Env._uidx)));A.availableFieldsTypes[D]=F;});},_onClickFieldDelete:function(E){var C=this;var G=E.currentTarget;var A=G.ancestor(DOT+CSS_FORM_BUILDER_FIELD);var F=A.getData(FIELD);if(F){var D=C.selectedField;if(F==D||F.contains(D,true)){C._tabs.selectTab(TAB_INDEX_DRAG);}F.set(SELECTED,false);F.get(PARENT).removeField(F);}},_onClickFieldDuplicate:function(D){var C=this;var F=D.currentTarget;var A=F.ancestor(DOT+CSS_FORM_BUILDER_FIELD);var E=A.getData(FIELD);if(E){C.duplicateField(E);}},_onClickFieldEdit:function(D){var C=this;var F=D.currentTarget;var A=F.ancestor(DOT+CSS_FORM_BUILDER_FIELD);var E=A.getData(FIELD);if(E){C.selectField(E);}},_onClickSettingsButton:function(D){var A=this;var E=D.currentTarget;if(E.hasClass(CSS_FORM_BUILDER_BUTTON_SAVE)){var C=A.selectedField;if(C){C.saveSettings();}}A._tabs.selectTab(TAB_INDEX_DRAG);},_onDbClickField:function(C){var A=this;var E=C.target;if(!E.getData(FIELD)){E=E.ancestor(DOT+CSS_FORM_BUILDER_FIELD);}if(E){var D=E.getData(FIELD);if(D){A.selectField(D);}}return false;},_onDragEndDragNestedList:function(F){var A=this;var E=F.target;var G=E.get(NODE);var D=A.dragContainerNode;var C=A.dropContainerNode;var I=C.one(DOT+CSS_FORM_BUILDER_DRAG_NODE);if(I){var H=A._dropField(I);if(A.get(r)){A.selectField(H);}}else{E.set(NODE,A.originalNode);}if(D.contains(G)&&D.contains(A.originalNode)){G.remove();}},_onDragEndDropNestedList:function(D){var A=this;var C=D.target;var E=C.get(NODE);if(E.hasClass(CSS_FORM_BUILDER_FIELD)){A._dropField(E);}},_onDragStartDragNestedList:function(E){var A=this;var D=E.target;var G=D.get(NODE);var F=G.clone();F.placeBefore(G);D.set(NODE,F);F.attr(ID,EMPTY_STR);F.show();G.removeClass(CSS_DD_DRAGGING);G.show();A.originalNode=G;var C=p.merge(A.get(NESTED_LIST),{nodes:F});(new p.NestedList(C));},_onMouseEnterField:function(D){var C=this;var A=D.currentTarget;var E=A.getData(FIELD);if(E){C._toggleFieldButtonsNode(E,true);}},_onMouseLeaveField:function(D){var C=this;var A=D.currentTarget;var E=A.getData(FIELD);var F=false;if(E){if(E.get(SELECTED)){F=true;}C._toggleFieldButtonsNode(E,F);}},_renderField:function(H,G,F){var C=this;var D=H.get(DROP_CONTAINER_NODE);if(q(H)){D=H.get(DROP_ZONE_NODE);}var E=p.Node.create(TPL_FIELD_BOUNDING_BOX);var A=H.get(FIELDS);if(A.length>0){D.insert(E,G);}else{D.append(E);}F=p.merge(F,{boundingBox:E,formBuilder:C,after:{render:function(){E.removeClass(CSS_HELPER_HIDDEN);}}});return C._getFieldInstance(F).render();},_syncDefaultMessage:function(){var C=this;if(!C.dropContainerNode.hasChildNodes()){var A=C.get(STRINGS);var D=C.get(DEFAULT_MESSAGE_NODE);D.setContent(A["stringDefaultMessage"]);C.dropContainerNode.append(D);}},_syncNestedList:function(){var A=this;A._syncNodes();A._dragNestedList.addAll(A.dragNodes);A._dropNestedList.addAll(A.dropNodes);},_syncNodes:function(){var A=this;var D=A.dragContainerNode;var C=A.dropContainerNode;A.dragNodes=D.all(DOT+CSS_FORM_BUILDER_FIELD);A.dropNodes=C.all([DOT+CSS_FORM_BUILDER_FIELD,DOT+CSS_FORM_BUILDER_DEFAULT_MESSAGE].join(f));},_syncSelectedFieldUI:function(F){var C=this;var E=F.get(SELECTED);var A=F.get(B);var D=C.selectedField;A.toggleClass(CSS_FORM_BUILDER_FIELD_SELECTED,E);if(!E&&F.contains(D)){E=true;}C._toggleFieldButtonsNode(F,E);},_toggleFieldButtonsNode:function(C,D){var A=this;var E=C.get(l);if(E){E.toggleClass(CSS_HELPER_HIDDEN,!D);}},_valueDragNodesList:function(){var A=this;var D=A.availableFieldsTypes;var C=[];p.each(D,function(F,E,G){C.push(p.substitute(TPL_DRAG_NODE,{icon:F.iconClass||DEFAULT_ICON_CLASS,label:F.label,name:E,type:F.type}));});return p.NodeList.create(C.join(EMPTY_STR));}}});p.FormBuilder=u;p.FormBuilder.types={};},"@VERSION@",{requires:["aui-base","aui-button-item","aui-nested-list","aui-tabs","substitute"],skinnable:true});AUI.add("aui-form-builder-field",function(bL){var bC=bL.Lang,aL=bC.isArray,by=bC.isString,h="acceptChildren",aF="boundingBox",bS="builder",bX="button",F="buttons",v="buttonsNode",ax="checkbox",G="checked",o="children",bU="clearfix",aG="close",aH="component",b3="contentBox",aA="container",bV="default",aM="delete",bu=".",a0="drag",au="dragContainer",t="dragContainerNode",bG="dragNodesList",aq="drop",a5="dropContainer",ba="dropContainerNode",bM="dropNode",bc="dropZone",aR="dropZoneNode",av="duplicate",M="edit",bn="",bb="field",g="fields",bt="for",q="form",a1="formBuilder",aw="form-builder-field",n="helper",am="hidden",r="icon",bT="id",ad="label",bH="labelNode",a3="metadata",at="name",b7="node",b="panel",aX="portalLayout",aD="predefinedValue",bd="proxy",ai="required",bm="state",aO="settings",al="settingsFormNode",R="showLabel",an="size",S=" ",bx="string",X="templateNode",bz="zone",a7="widget",x=bL.getClassName,a9=x(aH),az=x(bb,ad),p=x(n,bU),Z=x(n,am),bv=x(bm,bV),y=x(q,bS,bX),bq=x(q,bS,bX,aM),aT=x(q,bS,bX,av),P=x(q,bS,bX,M),b6=x(q,bS,r),j=x(q,bS,r,aM),u=x(q,bS,r,av),ae=x(q,bS,r,M),bs=x(q,bS,bb),bi=x(q,bS,bb,F),aS=x(q,bS,aq,b7),ag=x(q,bS,aq,bz),C=x(a7),bI='<li class="'+[C,a9,bs].join(S)+'"></li>',a='<div class="'+[bi,Z].join(S)+'">'+'<a class="'+[y,P].join(S)+'" href="javascript:;" title="Edit">'+'<div class="'+[b6,ae].join(S)+'"></div>'+"</a>"+'<a class="'+[y,aT].join(S)+'" href="javascript:;" title="Duplicate">'+'<div class="'+[b6,u].join(S)+'"></div>'+"</a>"+'<a class="'+[y,bq].join(S)+'" href="javascript:;" title="Delete">'+'<div class="'+[b6,j].join(S)+'"></div>'+"</a>"+"</div>",z='<div class="'+p+'"></div>',aV='<label class="'+az+'"></label>',V='<ul class="'+ag+'"></ul>';
var s=bL.Component.create({NAME:aw,ATTRS:{acceptChildren:{value:true},dataType:{value:bx},formBuilder:{value:undefined},id:{value:bn},icon:{value:bn},label:{value:bn},name:{valueFn:function(){var A=this;return A.get(T)+(++bL.Env._uidx);}},parent:{value:null},predefinedValue:{value:bn},required:{setter:bL.DataType.Boolean.parse,value:false},selected:{setter:bL.DataType.Boolean.parse,value:false},showLabel:{setter:bL.DataType.Boolean.parse,value:true},template:{value:bn},type:{value:bn},buttonsNode:{valueFn:function(){return bL.Node.create(a);}},dropZoneNode:{valueFn:function(){return bL.Node.create(V);}},labelNode:{valueFn:function(){return bL.Node.create(aV);}},templateNode:{valueFn:"getNode"}},AUGMENTS:[bL.FormBuilderFieldSupport],UI_ATTRS:[h,aD,ad,at,R],HTML_PARSER:{buttonsNode:bu+bi,dropZoneNode:bu+ag,labelNode:ad+bu+az},prototype:{BOUNDING_TEMPLATE:bI,initializer:function(){var A=this;A.get(aF).setData(bb,A);},bindUI:function(){var A=this;},renderUI:function(){var A=this;var ca=A.get(aF);var cc=A.get(v);var L=A.get(b3);var b9=A.get(bH);var cb=A.get(X);if(!ca.contains(cc)){ca.prepend(cc);}if(!L.contains(b9)){L.append(b9);b9.setAttribute(bt,cb.get(bT));}if(!L.contains(cb)){L.append(cb);}},saveSettings:function(){var A=this;var L=A.get(a1);var b9=L.get(al);bL.Array.each(bL.io._serialize(b9._node).split("&"),function(cb){var ca=cb.split("=");A.set(ca[0],decodeURIComponent(ca[1]));});},renderSettings:function(){var A=this;var L=A.get(a1);var cb=L.get(al);if(!A.fieldSettingsNode){A.fieldSettingsNode=bL.Node.create(z);var cc=bL.Node.create(z);A.labelField=new bL.Field({type:"text",name:ad,labelText:"Label",value:A.get(ad)}).render(cc);A.labelField.get(b7).on({keyup:bL.bind(A._onLabelKeyUp,A)});A.showLabelField=new bL.Field({type:"checkbox",name:R,labelText:"Show label",labelAlign:"left",value:A.get(R)}).render(cc);var ca=A.showLabelField.get(b7);ca.set(G,A.get(R));ca.on({change:bL.bind(A._onSettingsFieldChange,A)});A._renderSettingsFields([{type:"text",name:at,labelText:"Name",value:A.get(at)},{type:"text",name:aD,labelText:"Default value",value:A.get(aD)}],cc);A.requiredField=new bL.Field({type:"checkbox",name:ai,labelText:"Required",labelAlign:"left",value:ai}).render(cc);var b9=A.requiredField.get(b7);b9.set(G,A.get(ai));b9.on({change:bL.bind(A._onSettingsFieldChange,A)});A.propertiesPanel=new bL.Panel({bodyContent:cc,collapsible:true,title:"Properties"}).render();A.fieldSettingsNode.append(A.propertiesPanel.get(aF));}cb.setContent(A.fieldSettingsNode);},getHTML:function(){},getNode:function(){},_onLabelKeyUp:function(L){var A=this;var ca=L.target;var b9=ca.val();A.set(ad,b9);},_onSettingsFieldChange:function(L){var A=this;var ca=L.target;var b9=ca.val();if(ca.get(T)==ax){b9=ca.get(G);}A.set(ca.get(at),b9);},_renderSettingsFields:function(L,b9){var A=this;bL.each(L,function(cb){var cc=new bL.Field(cb).render(b9);var ca=cc.get(b7);if(cb.type==ax){ca.set(G,cb.value);}A[cb.name+"Field"]=cc;});},_uiSetAcceptChildren:function(cb){var A=this;var L=A.get(aF);var ca=A.get(aR);var b9=L.one(bu+ag);if(cb&&!b9){L.append(ca);}else{if(!cb&&b9){b9.remove();}else{if(cb&&b9){A.set(aR,b9);}}}},_uiSetLabel:function(b9){var A=this;var L=A.get(bH);L.setContent(b9);},_uiSetName:function(b9){var A=this;var L=A.get(X);L.set(at,b9);},_uiSetPredefinedValue:function(b9){var A=this;var L=A.get(X);L.val(b9);},_uiSetShowLabel:function(b9){var A=this;var L=A.get(bH);L.toggleClass(Z,!b9);}}});bL.FormBuilderField=s;bL.FormBuilder.types["field"]=bL.FormBuilderField;var bC=bL.Lang,aL=bC.isArray,ar=bC.isNumber,by=bC.isString,bg=function(A){return(A instanceof bL.Node);},aU=function(A){return(A instanceof bL.NodeList);},aW=bL.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),aF="boundingBox",bX="button",bW="buttonType",b3="contentBox",aA="container",bu=".",a0="drag",au="dragContainer",t="dragContainerNode",bG="dragNodesList",aq="drop",a5="dropContainer",ba="dropContainerNode",bn="",bb="field",g="fields",aw="form-builder-field",bA="form-builder-button-field",bT="id",r="icon",aP="input",ad="label",at="name",b7="node",N="option",Y="options",aX="portalLayout",aD="predefinedValue",bd="proxy",bw="reset",a2="selected",bD="selectedIndex",ap="submit",S=" ",bE="strings",ay="template",X="templateNode",bp="text",T="type",m="value",x=bL.getClassName,bf=x(bb,aP),K=x(bb,aP,bp),bs=x(aw),bO=x(aw,b7),bv=x(bm,bV),bo='<input id="{id}" class="'+[bO,bf].join(S)+'" name="{name}" type="{type}" value="{value}" />',b8=[ap,bw,bX];var bN=bL.Component.create({NAME:bA,ATTRS:{acceptChildren:{value:false,readOnly:true},buttonType:{value:ap,validator:function(A){return bL.Array(b8).indexOf(A.toLowerCase())>-1;}},predefinedValue:{value:aW(ap)},showLabel:{value:false},strings:{value:{button:"Button",reset:"Reset",submit:"Submit"}},template:{valueFn:function(){return bo;}}},UI_ATTRS:[h,aD,ad,at,bW,R],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderField,prototype:{getHTML:function(){var A=this;var cb=A.get(ay);var cd=A.get(bT);var ca=A.get(ad);var b9=A.get(at);var L=A.get(bW);var cc=A.get(aD);return bL.substitute(cb,{id:cd,label:ca,name:b9,type:L,value:cc});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());},renderSettings:function(){var ce=this;var cc=ce.get(a1);var A=cc.get(al);var cb=ce.get(bW);var cf=ce.get(bE);bL.FormBuilderButtonField.superclass.renderSettings.apply(ce,arguments);if(!ce._renderedButtonSettings){ce._renderedButtonSettings=true;var b9=ce.propertiesPanel.get(e);var cd=[];bL.each(b8,function(ch){cd.push({labelText:cf[ch],value:ch});});var cg=new bL.Select({labelText:"Button type",name:bW,options:cd}).render(b9.item(0));var L=cg.get(b7);L.on({change:bL.bind(ce._onButtonTypeChange,ce)});var ca=bL.Array(b8).indexOf(cb);L.all(N).item(ca).set(a2,true);}},_onButtonTypeChange:function(L){var A=this;var b9=L.target;A.set(bW,b9.get(m));},_uiSetButtonType:function(b9){var A=this;var L=A.get(X);L.set(T,b9);}}});bL.FormBuilderButtonField=bN;bL.FormBuilder.types["button"]=bL.FormBuilderButtonField;
var bC=bL.Lang,aL=bC.isArray,aN=bC.isBoolean,ar=bC.isNumber,by=bC.isString,aJ="boolean",aF="boundingBox",e="bodyContent",ax="checkbox",G="checked",ao="choice",b3="contentBox",aA="container",bu=".",a0="drag",au="dragContainer",t="dragContainerNode",bG="dragNodesList",aq="drop",a5="dropContainer",ba="dropContainerNode",bn="",bb="field",g="fields",aw="form-builder-field",b0="form-builder-checkbox-field",bT="id",r="icon",a6="inline",ad="label",c="labels",at="name",b7="node",aX="portalLayout",aD="predefinedValue",bd="proxy",an="size",S=" ",ay="template",X="templateNode",m="value",x=bL.getClassName,d=x(bb),ah=x(bb,ax),bJ=x(bb,ao),bs=x(aw),b1=x(aw,ax),bO=x(aw,b7),bv=x(bm,bV),bF=x(bb,c,a6),bI='<li class="'+[C,a9,bs,b1].join(S)+'"></li>',aI='<input id="{id}" class="'+[bO,d,ah,bJ].join(S)+'" name="{name}" type="checkbox" value="{value}" {checked} />';var W=bL.Component.create({NAME:b0,ATTRS:{dataType:{value:aJ},predefinedValue:{setter:bL.DataType.Boolean.parse,value:false},template:{valueFn:function(){return aI;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[h,aD,ad,at,R],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderField,prototype:{BOUNDING_TEMPLATE:bI,bindUI:function(){var A=this;bL.FormBuilderCheckBoxField.superclass.bindUI.apply(A,arguments);var L=A.get(X);L.on({"change":bL.bind(A._onValueChange,A)});},renderUI:function(){var A=this;var L=A.get(b3);var ca=A.get(X);var b9=A.get(bH);bL.FormBuilderCheckBoxField.superclass.renderUI.apply(A,arguments);b9.insert(ca,b9,"before");},getHTML:function(){var A=this;var ca=A.get(ay);var cb=A.get(G);var cd=A.get(bT);var b9=A.get(ad);var L=A.get(at);var cc=A.get(aD);return bL.substitute(ca,{checked:cb?'checked="checked"':bn,id:cd,label:b9,name:L,value:cc});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());},renderSettings:function(){var A=this;var L=A.get(a1);var cb=L.get(al);bL.FormBuilderCheckBoxField.superclass.renderSettings.apply(A,arguments);if(!A._renderedCheckboxSettings){A._renderedCheckboxSettings=true;A.predefinedValueField.destroy();var ca=A.propertiesPanel.get(e);var b9=new bL.Field({type:"checkbox",name:aD,labelText:"Checked",labelAlign:"left"}).render(ca.item(0));A.checkedFieldNode=b9.get(b7);A.checkedFieldNode.on({change:bL.bind(A._onValueChange,A)});A.checkedFieldNode.set(G,A.get(aD));}},_onValueChange:function(L){var A=this;var b9=L.target;A.set(aD,b9.get(G));},_uiSetPredefinedValue:function(ca){var A=this;var b9=A.get(X);var L=A.checkedFieldNode;if(L){L.set(G,ca);}b9.set(G,ca);}}});bL.FormBuilderCheckBoxField=W;bL.FormBuilder.types["checkbox"]=bL.FormBuilderCheckBoxField;var bC=bL.Lang,aL=bC.isArray,ar=bC.isNumber,by=bC.isString,bg=function(A){return(A instanceof bL.Node);},aU=function(A){return(A instanceof bL.NodeList);},aF="boundingBox",b3="contentBox",aA="container",bu=".",aq="drop",bn="",bb="field",g="fields",aw="form-builder-field",D="form-builder-fieldset-field",bT="id",r="icon",ad="label",at="name",b7="node",aD="predefinedValue",S=" ",ay="template",X="templateNode",bp="text",m="value",bz="zone",x=bL.getClassName,bs=x(aw),bO=x(aw,b7),ag=x(q,bS,aq,bz),aC='<fieldset id="{id}" class="'+[bO].join(S)+'"></fieldset>',k='<legend class="'+az+'"></legend>';var w=bL.Component.create({NAME:D,ATTRS:{acceptChildren:{value:true,readOnly:true},dataType:{value:undefined},template:{valueFn:function(){return aC;}},labelNode:{valueFn:function(){return bL.Node.create(k);}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[h,ad,R],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderField,prototype:{CONTENT_TEMPLATE:aC,renderUI:function(){var A=this;var ca=A.get(aF);var cc=A.get(v);var L=A.get(b3);var b9=A.get(bH);var cb=A.get(X);if(!ca.contains(cc)){ca.prepend(cc);}if(!L.contains(b9)){L.append(b9);}},getHTML:function(){var A=this;var L=A.get(ay);var b9=A.get(bT);return bL.substitute(L,{id:b9});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());},renderSettings:function(){var A=this;var L=A.get(a1);var ca=L.get(al);if(!A._renderedFieldsetSettings){A._renderedFieldsetSettings=true;A.fieldSettingsNode=bL.Node.create(z);var cb=bL.Node.create(z);A.labelField=new bL.Field({type:"text",name:ad,labelText:"Label",value:A.get(ad)}).render(cb);A.labelField.get(b7).on({keyup:bL.bind(A._onLabelKeyUp,A)});A.showLabelField=new bL.Field({type:"checkbox",name:R,labelText:"Show label",labelAlign:"left",value:A.get(R)}).render(cb);var b9=A.showLabelField.get(b7);b9.set(G,A.get(R));b9.on({change:bL.bind(A._onSettingsFieldChange,A)});A.propertiesPanel=new bL.Panel({bodyContent:cb,collapsible:true,title:"Properties"}).render();A.fieldSettingsNode.append(A.propertiesPanel.get(aF));}ca.setContent(A.fieldSettingsNode);},_uiSetAcceptChildren:function(cb){var A=this;var L=A.get(b3);var ca=A.get(aR);var b9=L.one(bu+ag);if(cb&&!b9){L.append(ca);}else{if(!cb&&b9){b9.remove();}else{if(cb&&b9){A.set(aR,b9);}}}},}});bL.FormBuilderFieldsetField=w;bL.FormBuilder.types["fieldset"]=bL.FormBuilderFieldsetField;var bC=bL.Lang,aL=bC.isArray,ar=bC.isNumber,by=bC.isString,bg=function(A){return(A instanceof bL.Node);},aU=function(A){return(A instanceof bL.NodeList);},aF="boundingBox",b3="contentBox",aA="container",bu=".",bn="",bb="field",g="fields",aw="form-builder-field",b2="form-builder-file-upload-field",bT="id",r="icon",ad="label",at="name",b7="node",aD="predefinedValue",S=" ",ay="template",X="templateNode",bp="text",m="value",x=bL.getClassName,bs=x(aw),bO=x(aw,b7),bv=x(bm,bV),bk='<input id="{id}" class="'+[bO].join(S)+'" name="{name}" type="file" value="{value}" />';var H=bL.Component.create({NAME:b2,ATTRS:{template:{valueFn:function(){return bk;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[h,aD,ad,at,R],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderField,prototype:{getHTML:function(){var A=this;var cb=A.get(ay);var cd=A.get(bT);var b9=A.get(ad);var L=A.get(at);var ca=A.get(an);var cc=A.get(aD);return bL.substitute(cb,{id:cd,label:b9,name:L,value:cc});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());
},renderSettings:function(){var A=this;var L=A.get(a1);var ca=L.get(al);if(!A._renderedFileUploadSettings){A._renderedFileUploadSettings=true;A.fieldSettingsNode=bL.Node.create(z);var cb=bL.Node.create(z);A.labelField=new bL.Field({type:"text",name:ad,labelText:"Label",value:A.get(ad)}).render(cb);A.labelField.get(b7).on({keyup:bL.bind(A._onLabelKeyUp,A)});A.showLabelField=new bL.Field({type:"checkbox",name:R,labelText:"Show label",labelAlign:"left",value:A.get(R)}).render(cb);var b9=A.showLabelField.get(b7);b9.set(G,A.get(R));b9.on({change:bL.bind(A._onSettingsFieldChange,A)});A._renderSettingsFields([{type:"text",name:at,labelText:"Name",value:A.get(at)},{type:"checkbox",name:ai,labelText:"Required",labelAlign:"left",value:A.get(ai)}],cb);A.propertiesPanel=new bL.Panel({bodyContent:cb,collapsible:true,title:"Properties"}).render();A.fieldSettingsNode.append(A.propertiesPanel.get(aF));}ca.setContent(A.fieldSettingsNode);}}});bL.FormBuilderFileUploadField=H;bL.FormBuilder.types["fileupload"]=bL.FormBuilderFileUploadField;var bC=bL.Lang,aL=bC.isArray,ar=bC.isNumber,by=bC.isString,bg=function(A){return(A instanceof bL.Node);},aU=function(A){return(A instanceof bL.NodeList);},aW=bL.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),O="add",bB="addNode",aF="boundingBox",bX="button",bW="buttonType",b3="contentBox",aA="container",bV="default",a4="defaultName",b4="defaultOptions",B="defaultValue",bu=".",a0="drag",au="dragContainer",t="dragContainerNode",bG="dragNodesList",aq="drop",a5="dropContainer",ba="dropContainerNode",bn="",bb="field",g="fields",aw="form-builder-field",I="form-builder-multiple-choice-field",r="icon",bT="id",aP="input",ac="item",ad="label",bY="multiple",at="name",b7="node",N="option",bj="optionTemplate",Y="options",aD="predefinedValue",bd="proxy",b5="remove",bw="reset",ap="submit",S=" ",ay="template",X="templateNode",bp="text",T="type",m="value",x=bL.getClassName,bf=x(bb,aP),K=x(bb,aP,bp),l=x(bb,Y,O),bR=x(bb,Y,ac),bQ=x(bb,Y,ac,aP),br=x(bb,Y,ac,aP,at),aa=x(bb,Y,ac,aP,m),aY=x(bb,Y,ac,b5),bs=x(aw),bO=x(aw,b7),bv=x(bm,bV),ak='<div class="'+[bR,bF,p].join(S)+'">'+'<input type="text" class="'+[bQ,br,bf,K].join(S)+'" value="{name}" />'+'<input type="text" class="'+[bQ,aa,bf,K].join(S)+'" value="{value}" />'+'<a href="javascript:;" class="'+aY+'">&nbsp;</a>'+"</div>";TPL_ADD='<a class="'+l+'" href="javascript:;">Add an option</a>',ENTER="ENTER";var a8=bL.Component.create({NAME:Y,ATTRS:{allowClear:{value:false},defaultName:{value:bn},defaultValue:{value:bn},options:{value:[],getter:"_getOptions",validator:aL},addNode:{valueFn:function(){return bL.Node.create(TPL_ADD);}}},HTML_PARSER:{addNode:bu+l},UI_ATTRS:[Y],EXTENDS:bL.Widget,prototype:{renderUI:function(){var A=this;var L=A.get(aF);var b9=A.get(bB);if(!b9.inDoc()){L.append(b9);}},bindUI:function(){var A=this;var L=A.get(aF);var b9=A.get(bB);b9.on("click",bL.bind(A._onClickAdd,A));L.delegate("click",bL.bind(A._onClickOptionRemove,A),bu+aY);L.delegate("keypress",bL.bind(A._onKeyPressOption,A),bu+bQ);},add:function(b9){var A=this;var L=A.get(Y);L.push(b9);A.set(Y,L);},clear:function(){var A=this;if(A.get(ALLOW_CLEAR)){A.set(Y,[]);}},remove:function(b9){var A=this;var L=A.get(b3);var ca=A._getOptionNode(b9);if(ca){ca.remove();}A.items=L.all(bu+bR);},_addNewOption:function(){var L=this;var b9=L.get(b3);var ca=L._createOption({name:L.get(a4),value:L.get(B)});ca=bL.Node.create(ca);b9.append(ca);var A=ca.one(aP);A.focus();A.select();L.items=b9.all(bu+bR);return ca;},_createOption:function(L){var A=this;return bL.substitute(ak,L);},_getOptionNode:function(L){var A=this;return A.items.item(L);},_getOptions:function(b9){var A=this;var L=[];if(A.items){bL.each(A.items,function(ca){var cb=ca.one(bu+br);var cc=ca.one(bu+aa);L.push({name:cb.val(),value:cc.val()});});}else{L=b9;}return L;},_indexOfTarget:function(b9){var A=this;var L=b9.ancestor(bu+bR);return A.items.indexOf(L);},_onClickAdd:function(L){var A=this;A._addNewOption();},_onClickOptionRemove:function(ca){var A=this;var b9=A.get(Y);var L=A._indexOfTarget(ca.target);A.remove(L);},_onKeyPressOption:function(cb){var A=this;var ca=A.get(Y);var cc=cb.currentTarget;var L=A.items;if(cb.isKey(ENTER)){var b9=A._indexOfTarget(cc);var cd=cc.hasClass(aa);if((b9==L.size()-1)&&cd){A._addNewOption();}}},_uiSetOptions:function(ca){var A=this;var b9=[];var L=A.get(b3);L.empty();bL.each(ca,function(cb){L.append(A._createOption(cb));});A.items=L.all(bu+bR);}}});var f=bL.Component.create({NAME:I,ATTRS:{acceptChildren:{value:false,readOnly:true},options:{value:[{name:"option 1",value:"value 1"},{name:"option 2",value:"value 2"},{name:"option 3",value:"value 3"}]},optionTemplate:{value:'<option value="{value}">{name}</option>'},},UI_ATTRS:[h,aD,ad,at,Y,R],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderField,prototype:{initializer:function(){var A=this;bL.FormBuilderMultipleChoiceField.superclass.initializer.apply(A,arguments);},getNode:function(){var A=this;return bL.FormBuilderMultipleChoiceField.superclass.getNode.apply(A,arguments);},renderSettings:function(){var A=this;bL.FormBuilderMultipleChoiceField.superclass.renderSettings.apply(A,arguments);if(!A._renderedMultipleChoiceSettings){A._renderedMultipleChoiceSettings=true;var L=bL.Node.create(z);A.optionsPanel=new bL.Panel({bodyContent:L,collapsible:true,title:"Options"}).render();A.options=new a8({options:A.get(Y)}).render(L);A.fieldSettingsNode.append(A.optionsPanel.get(aF));}},saveSettings:function(){var A=this;bL.FormBuilderMultipleChoiceField.superclass.saveSettings.apply(A,arguments);A.set(Y,A.options.get(Y));},_uiSetOptions:function(b9){var A=this;var L=A.get(X);L.empty();bL.each(b9,function(ca){L.append(bL.substitute(A.get(bj),ca));});}}});bL.FormBuilderMultipleChoiceField=f;bL.FormBuilder.types["multiple-choice"]=bL.FormBuilderMultipleChoiceField;var bC=bL.Lang,aL=bC.isArray,aN=bC.isBoolean,ar=bC.isNumber,by=bC.isString,aF="boundingBox",e="bodyContent",G="checked",ao="choice",b3="contentBox",aA="container",bu=".",bn="",bb="field",g="fields",aw="form-builder-field",aZ="form-builder-radio-field",bT="id",r="icon",a6="inline",ad="label",c="labels",at="name",b7="node",E="optionsContainerNode",aD="predefinedValue",Q="radio",an="size",S=" ",ay="template",X="templateNode",m="value",x=bL.getClassName,d=x(bb),bJ=x(bb,ao),bs=x(aw),aE=x(aw,Q),bO=x(aw,b7),bP=x(aw,Y,aA),bv=x(bm,bV),bF=x(bb,c,a6),bI='<li class="'+[C,a9,bs,aE].join(S)+'"></li>',U='<div class="'+bP+'"></div>',aK='<input id="{id}" class="'+[bO,d,bJ].join(S)+'" name="{name}" type="radio" value="{value}" {checked} />';
var i=bL.Component.create({NAME:aZ,ATTRS:{name:{value:Q},optionTemplate:{value:aK},template:{valueFn:function(){return aK;}},optionsContainerNode:{valueFn:function(){return bL.Node.create(U);}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[h,aD,ad,at,R,Y],CSS_PREFIX:bs,HTML_PARSER:{optionsContainerNode:bu+bP,templateNode:bu+bO},EXTENDS:bL.FormBuilderMultipleChoiceField,prototype:{BOUNDING_TEMPLATE:bI,renderUI:function(){var A=this;var ca=A.get(aF);var cc=A.get(v);var L=A.get(b3);var b9=A.get(bH);if(!ca.contains(cc)){ca.prepend(cc);}if(!L.contains(b9)){L.append(b9);}var cb=A.get(E);if(!L.contains(cb)){L.append(cb);}},getHTML:function(){var A=this;var ca=A.get(ay);var cb=A.get(G);var cd=A.get(bT);var b9=A.get(ad);var L=A.get(at);var cc=A.get(aD);return bL.substitute(ca,{checked:cb?'checked="checked"':bn,id:cd,label:b9,name:L,value:cc});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());},_onFieldChange:function(L){var A=this;var b9=L.target;A.set(aD,b9.val());},_uiSetOptions:function(cb){var A=this;var L=A.get(b3);var ca=A.get(E);var b9=A.get(X);ca.empty();bL.each(cb,function(ce){var cd=new bL.Field({type:Q,name:A.get(at),labelText:ce.name,labelAlign:"left",value:ce.value}).render(ca);var cc=cd.get(b7);if(ce.value==A.get(aD)){cc.set(G,true);}cc.on({change:bL.bind(A._onFieldChange,A)});});},_uiSetPredefinedValue:function(cb){var A=this;var L=A.get(a1);var b9=L.get(al);var ca=b9.one("input[name=predefinedValue]");if(ca){ca.val(cb);}}}});bL.FormBuilderRadioField=i;bL.FormBuilder.types["radio"]=bL.FormBuilderRadioField;var bC=bL.Lang,aL=bC.isArray,ar=bC.isNumber,by=bC.isString,bg=function(A){return(A instanceof bL.Node);},aU=function(A){return(A instanceof bL.NodeList);},aW=bL.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),aF="boundingBox",bX="button",bW="buttonType",b3="contentBox",aA="container",b4="defaultOptions",bu=".",a0="drag",au="dragContainer",t="dragContainerNode",bG="dragNodesList",aq="drop",a5="dropContainer",ba="dropContainerNode",bn="",bb="field",g="fields",aw="form-builder-field",bK="form-builder-select-field",bT="id",r="icon",aP="input",ad="label",bY="multiple",at="name",b7="node",N="option",Y="options",aX="portalLayout",aD="predefinedValue",bd="proxy",bw="reset",bD="selectedIndex",ap="submit",S=" ",ay="template",X="templateNode",bp="text",T="type",m="value",x=bL.getClassName,bf=x(bb,aP),K=x(bb,aP,bp),bs=x(aw),bO=x(aw,b7),bv=x(bm,bV),bl='<select id="{id}" class="'+[bO].join(S)+'" name="{name}" value="{value}"></select>';var ab=bL.Component.create({NAME:bK,ATTRS:{multiple:{setter:bL.DataType.Boolean.parse,value:false},template:{valueFn:function(){return bl;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[h,aD,ad,at,Y,R,bY],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderMultipleChoiceField,prototype:{getHTML:function(){var A=this;var ca=A.get(ay);var cc=A.get(bT);var b9=A.get(ad);var L=A.get(at);var cb=A.get(aD);return bL.substitute(ca,{id:cc,label:b9,name:L,value:cb});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());},renderSettings:function(){var A=this;var L=A.get(a1);var cc=L.get(al);bL.FormBuilderSelectField.superclass.renderSettings.apply(A,arguments);if(!A._renderedSelectSettings){A._renderedSelectSettings=true;var cb=A.propertiesPanel.get(e);var ca=new bL.Field({type:"checkbox",name:bY,labelText:"Multiple",labelAlign:"left"}).render(cb.item(0));var b9=ca.get(b7);b9.on({change:bL.bind(A._onSettingsFieldChange,A)});b9.set(G,A.get(bY));}},_uiSetMultiple:function(b9){var A=this;var L=A.get(X);if(b9){L.setAttribute(bY,bY);}else{L.removeAttribute(bY);}}}});bL.FormBuilderSelectField=ab;bL.FormBuilder.types["select"]=bL.FormBuilderSelectField;var bC=bL.Lang,aL=bC.isArray,ar=bC.isNumber,by=bC.isString,bg=function(A){return(A instanceof bL.Node);},aU=function(A){return(A instanceof bL.NodeList);},aF="boundingBox",b3="contentBox",aA="container",bu=".",a0="drag",au="dragContainer",t="dragContainerNode",bG="dragNodesList",aq="drop",a5="dropContainer",ba="dropContainerNode",bn="",bb="field",g="fields",aw="form-builder-field",aQ="form-builder-input-field",bT="id",r="icon",aP="input",ad="label",at="name",b7="node",aX="portalLayout",aD="predefinedValue",bd="proxy",S=" ",ay="template",X="templateNode",bp="text",m="value",x=bL.getClassName,bf=x(bb,aP),K=x(bb,aP,bp),bs=x(aw),bO=x(aw,b7),bv=x(bm,bV),bo='<input id="{id}" class="'+[bO,bf,K].join(S)+'" name="{name}" type="text" value="{value}" />';var bh=bL.Component.create({NAME:aQ,ATTRS:{template:{valueFn:function(){return bo;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[h,aD,ad,at,R],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderField,prototype:{bindUI:function(){var A=this;bL.FormBuilderTextField.superclass.bindUI.apply(A,arguments);var L=A.get(X);L.on({"keyup":bL.bind(A._onValueKeyUp,A)});},getHTML:function(){var A=this;var cb=A.get(ay);var cd=A.get(bT);var b9=A.get(ad);var L=A.get(at);var ca=A.get(an);var cc=A.get(aD);return bL.substitute(cb,{id:cd,label:b9,name:L,value:cc});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());},renderSettings:function(){var A=this;var L=A.get(a1);var b9=L.get(al);bL.FormBuilderTextField.superclass.renderSettings.apply(A,arguments);if(!A._renderedInputSettings){A._renderedInputSettings=true;var ca=b9.one("input[name=predefinedValue]");ca.on({"keyup":bL.bind(A._onValueKeyUp,A)});}},_onValueKeyUp:function(L){var A=this;var b9=L.target;A.set(aD,b9.val());},_uiSetPredefinedValue:function(cc){var A=this;var L=A.get(a1);var ca=L.get(al);var cb=ca.one("input[name=predefinedValue]");var b9=A.get(X);b9.val(cc);if(cb&&A.get(a2)){cb.val(cc);}}}});bL.FormBuilderTextField=bh;bL.FormBuilder.types["text"]=bL.FormBuilderTextField;var bC=bL.Lang,aL=bC.isArray,ar=bC.isNumber,by=bC.isString,aF="boundingBox",b3="contentBox",aA="container",bu=".",a0="drag",au="dragContainer",t="dragContainerNode",bG="dragNodesList",aq="drop",a5="dropContainer",ba="dropContainerNode",bn="",bb="field",g="fields",aw="form-builder-field",bZ="form-builder-textarea-field",bT="id",r="icon",ad="label",at="name",b7="node",aX="portalLayout",aD="predefinedValue",bd="proxy",an="size",S=" ",ay="template",X="templateNode",bp="text",aj="textarea",m="value",x=bL.getClassName,d=x(bb),be=x(bb,bp),J=x(bb,aj),bs=x(aw),bO=x(aw,b7),bv=x(bm,bV),af='<textarea id="{id}" class="'+[bO,d,be,J].join(S)+'" name="{name}">{value}</textarea>';
var aB=bL.Component.create({NAME:bZ,ATTRS:{template:{valueFn:function(){return af;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[h,aD,ad,at,R],CSS_PREFIX:bs,HTML_PARSER:{templateNode:bu+bO},EXTENDS:bL.FormBuilderField,prototype:{bindUI:function(){var A=this;bL.FormBuilderTextAreaField.superclass.bindUI.apply(A,arguments);var L=A.get(X);L.on({"keyup":bL.bind(A._onValueKeyUp,A)});},getHTML:function(){var A=this;var cb=A.get(ay);var cd=A.get(bT);var b9=A.get(ad);var L=A.get(at);var ca=A.get(an);var cc=A.get(aD);return bL.substitute(cb,{id:cd,label:b9,name:L,value:cc});},getNode:function(){var A=this;return bL.Node.create(A.getHTML());},renderSettings:function(){var A=this;var L=A.get(a1);var b9=L.get(al);bL.FormBuilderTextAreaField.superclass.renderSettings.apply(A,arguments);if(!A._renderedTextareaSettings){A._renderedTextareaSettings=true;var ca=b9.one("input[name=predefinedValue]");ca.on({"keyup":bL.bind(A._onValueKeyUp,A)});}},_onValueKeyUp:function(L){var A=this;var b9=L.target;A.set(aD,b9.val());},_uiSetPredefinedValue:function(cc){var A=this;var L=A.get(a1);var ca=L.get(al);var cb=ca.one("input[name=predefinedValue]");var b9=A.get(X);b9.val(cc);if(cb&&A.get(a2)){cb.val(cc);}}}});bL.FormBuilderTextAreaField=aB;bL.FormBuilder.types["textarea"]=bL.FormBuilderTextAreaField;},"@VERSION@",{requires:["aui-datatype","aui-form","aui-panel","io","substitute"],skinnable:true});AUI.add("aui-form-builder",function(a){},"@VERSION@",{skinnable:true,use:["aui-form-builder-base","aui-form-builder-field"]});