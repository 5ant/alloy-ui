AUI.add("aui-form-builder-base",function(p){var m=p.Lang,n=m.isArray,c=m.isString,f=m.isObject,u=m.isValue,v=function(A){return(A instanceof p.Node);},q=function(A){return(A instanceof p.NodeList);},o=function(A){return(A instanceof p.FormBuilder);},z=function(A){return(A instanceof p.FormBuilderField);},g=p.DD.DDM,j="active",r="acceptChildren",y="autoSelectFields",x="availableFields",w="append",B="boundingBox",i="builder",d="button",l="buttons",e="buttonsNode",h="children",b="clonable-portal-layout",t="cloneNode",k=", ";COMPONENT="component",CONTENT="content",CONTENT_BOX="contentBox",CONTAINER="container",DELETE="delete",DD="dd",DEFAULT="default",DEFAULT_MESSAGE_NODE="defaultMessageNode",DOT=".",DUPLICATE="duplicate",DRAG="drag",DRAGGING="dragging",DRAG_CONTAINER="dragContainer",DRAG_CONTAINER_NODE="dragContainerNode",DRAG_NODES_LIST="dragNodesList",DRAG_PORTAL_LAYOUT="dragPortalLayout",DROP="drop",DROP_CONTAINER="dropContainer",DROP_CONTAINER_NODE="dropContainerNode",DROP_PORTAL_LAYOUT="dropPortalLayout",DROP_NODE="dropNode",DROP_ZONE_NODE="dropZoneNode",EDIT="edit",EMPTY_STR="",FIELD="field",FIELDS="fields",FIELD_ID="fieldId",FIRST="first",FIRST_CHILD="firstChild",FOCUSED="focused",FORM="form",FORM_BUILDER="formBuilder",FORM_LAYOUT="form-layout",ID="id",ICON="icon",INACTIVE="inactive",INDEX="index",INPUT="input",ITEMS="items",LABEL="label",LABEL_NODE="labelNode",LAST="last",LAST_CHILD="lastChild",LIST="list",MESSAGE="message",NAME="name",NESTED_LIST="nestedList",NODE="node",OVER="over",PARENT="parent",PARENT_NODE="parentNode",PLACEHOLDER="placeholder",PLACE_AFTER="placeAfter",PLACE_BEFORE="placeBefore",PREPEND="prepend",HELPER="helper",HIDDEN="hidden",RENDER="render",SAVE="save",SELECTED="selected",SETTINGS="settings",SETTINGS_FORM_NODE="settingsFormNode",SETTINGS_BUTTONS_NODE="settingsButtonsNode",SRC_NODE="srcNode",SPACE=" ",STATE="state",STRINGS="strings",TABS="tabs",TABS_NODE="tabsNode",TABS_CONTENT_NODE="tabsContentNode",TABS_LIST_NODE="tabsListNode",TABVIEW="tabview",TARGET="target",TEMPLATE_NODE="templateNode",TEXT="text",TYPE="type",UNIQUE="unique",VALUE="value",VALUES="values",ZONE="zone",REGION="region",WIDGET="widget",STRING_EMPTY_SELECTION="stringEmptySelection",getCN=p.getClassName,CSS_BUTTON_INPUT=getCN(d,INPUT),CSS_COMPONENT=getCN(COMPONENT),CSS_DD_DRAGGING=getCN(DD,DRAGGING),CSS_HELPER_HIDDEN=getCN(HELPER,HIDDEN),CSS_FORM_BUILDER_BUTTON_DELETE=getCN(FORM,i,d,DELETE),CSS_FORM_BUILDER_BUTTON_DUPLICATE=getCN(FORM,i,d,DUPLICATE),CSS_FORM_BUILDER_BUTTON_EDIT=getCN(FORM,i,d,EDIT),CSS_FORM_BUILDER_BUTTON_SAVE=getCN(FORM,i,d,SAVE),CSS_FORM_BUILDER_DEFAULT_MESSAGE=getCN(FORM,i,DEFAULT,MESSAGE),CSS_FORM_BUILDER_DRAG_CONTAINER=getCN(FORM,i,DRAG,CONTAINER),CSS_FORM_BUILDER_DRAG_NODE=getCN(FORM,i,DRAG,NODE),CSS_FORM_BUILDER_DROP_ACTIVE=getCN(FORM,i,DROP,j),CSS_FORM_BUILDER_DROP_CONTAINER=getCN(FORM,i,DROP,CONTAINER),CSS_FORM_BUILDER_DROP_NODE=getCN(FORM,i,DROP,NODE),CSS_FORM_BUILDER_DROP_ZONE=getCN(FORM,i,DROP,ZONE),CSS_FORM_BUILDER_FIELD=getCN(FORM,i,FIELD),CSS_FORM_BUILDER_FIELD_BUTTONS=getCN(FORM,i,FIELD,l),CSS_FORM_BUILDER_FIELD_CONTENT=getCN(FORM,i,FIELD,CONTENT),CSS_FORM_BUILDER_FIELD_HIDDEN=getCN(FORM,i,FIELD,HIDDEN),CSS_FORM_BUILDER_FIELD_ICON=getCN(FORM,i,FIELD,ICON),CSS_FORM_BUILDER_FIELD_ICON_TEXT=getCN(FORM,i,FIELD,ICON,TEXT),CSS_FORM_BUILDER_FIELD_OVER=getCN(FORM,i,FIELD,OVER),CSS_FORM_BUILDER_FIELD_SELECTED=getCN(FORM,i,FIELD,SELECTED),CSS_FORM_BUILDER_HELPER=getCN(FORM,i,HELPER),CSS_FORM_BUILDER_ICON=getCN(FORM,i,ICON),CSS_FORM_BUILDER_INACTIVE=getCN(FORM,i,INACTIVE),CSS_FORM_BUILDER_LABEL=getCN(FORM,i,LABEL),CSS_FORM_BUILDER_PLACEHOLDER=getCN(FORM,i,PLACEHOLDER),CSS_FORM_BUILDER_SETTINGS=getCN(FORM,i,SETTINGS),CSS_FORM_BUILDER_SETTINGS_BUTTONS=getCN(FORM,i,SETTINGS,l),CSS_FORM_BUILDER_TABS_CONTAINER=getCN(FORM,i,TABS,CONTAINER),CSS_TABVIEW_CONTENT=getCN(TABVIEW,CONTENT),CSS_TABVIEW_LIST=getCN(TABVIEW,LIST),CSS_ICON=getCN(ICON),CSS_WIDGET=getCN(WIDGET),TPL_DEFAULT_MESSAGE='<li class="'+CSS_FORM_BUILDER_DEFAULT_MESSAGE+'"></li>',TPL_DRAG_CONTAINER='<ul class="'+CSS_FORM_BUILDER_DRAG_CONTAINER+'"></ul>',TPL_DRAG_NODE='<li class="'+[CSS_FORM_BUILDER_DRAG_NODE,CSS_FORM_BUILDER_FIELD].join(SPACE)+'" data-fieldId="{fieldId}">'+'<span class="'+[CSS_FORM_BUILDER_ICON,CSS_ICON].join(SPACE)+' {icon}"></span>'+'<span class="'+CSS_FORM_BUILDER_LABEL+'">{label}</span>'+"</li>",TPL_DROP_CONTAINER='<ul class="'+[CSS_FORM_BUILDER_DROP_CONTAINER].join(SPACE)+'"></ul>',TPL_FIELD_BOUNDING_BOX='<li class="'+[CSS_WIDGET,CSS_COMPONENT,CSS_FORM_BUILDER_FIELD,CSS_HELPER_HIDDEN].join(SPACE)+'"></li>',TPL_HELPER='<div class="'+CSS_FORM_BUILDER_HELPER+'"></div>',TPL_PLACEHOLDER='<li class="'+CSS_FORM_BUILDER_PLACEHOLDER+'"></li>',TPL_TABS='<div class="'+CSS_FORM_BUILDER_TABS_CONTAINER+'"></div>',TPL_TABS_CONTENT='<div class="'+CSS_TABVIEW_CONTENT+'"></div>',TPL_TABS_LIST='<ul class="'+CSS_TABVIEW_LIST+'"></ul>',TPL_SETTINGS='<form class="'+CSS_FORM_BUILDER_SETTINGS+'"></form>',TPL_SETTINGS_BUTTONS='<div class="yui3-aui-button-row">'+'<span class="yui3-aui-button yui3-aui-button-submit yui3-aui-state-positive yui3-aui-priority-primary">'+'<span class="yui3-aui-button-content">'+'<input type="button" value="Save" class="yui3-aui-button-input yui3-aui-form-builder-button-save">'+"</span>"+"</span>"+'<span class="yui3-aui-button yui3-aui-button-submit yui3-aui-state-positive yui3-aui-priority-secondary">'+'<span class="yui3-aui-button-content">'+'<input type="button" value="Close" class="yui3-aui-button-input yui3-aui-form-builder-button-close">'+"</span>"+"</span>"+"</div>",TAB_INDEX_DRAG=0,TAB_INDEX_SETTINGS=1,DEFAULT_ICON_CLASS=[CSS_FORM_BUILDER_FIELD_ICON,CSS_FORM_BUILDER_FIELD_ICON_TEXT].join(SPACE),INVALID_CLONE_ATTRS=[B,CONTENT_BOX,SRC_NODE,FIELDS,ID,SELECTED,TEMPLATE_NODE,LABEL_NODE,NAME],INVALID_DBCLICK_TARGETS="button,input,label,select,textarea";var a=function(){};a.ATTRS={fields:{value:[],setter:"_setFields",getter:function(A){return A||[];},validator:n}};p.mix(a.prototype,{addField:function(D){var A=this;
var C=A.get(FIELDS);C=A._removeFromParent(D);C.push(D);A.set(FIELDS,C);},addFields:function(C){var A=this;p.Array.each(A._normalizeFields(C),p.bind(A.addField,A));},contains:function(G,C){var A=this;var F=A.get(FIELDS);if(C){for(var D=0;D<F.length;D++){var E=F[D];if((E==G)||E.contains(G,C)){return true;}}}return(A.indexOf(G)>-1);},getField:function(C){var A=this;var D=A.get(FIELDS);return D[C];},indexOf:function(D){var A=this;var C=A.get(FIELDS);return p.Array.indexOf(C,D);},insertField:function(C,E){var A=this;var D=A.get(FIELDS);D=A._removeFromParent(E);D.splice(C,0,E);A.set(FIELDS,D);},removeField:function(D){var A=this;var C=A.get(FIELDS);C=A._removeFromParent(D);D.removeTarget(A);A.set(FIELDS,C);},removeFields:function(C){var A=this;p.Array.each(A._normalizeFields(C),p.bind(A.removeField,A));},_getFormBuilder:function(){return(this.get(FORM_BUILDER)||this);},_getRenderedField:function(C,E){var A=this;var D=A._getFormBuilder();if(!z(E)){E=D._renderField(A,C,E);}E.addTarget(D);E.set(PARENT,A);return E;},_normalizeFields:function(F){var A=this;var D=[];var E=A._getFormBuilder();var G=E.get(x);var C=E.uniqueFields;F=p.Array(F);p.Array.each(F,function(J,H){J=A._getRenderedField(H,J);var I=J.get(FIELD_ID);var K=J.get(UNIQUE);if(K&&!C.containsKey(I)){C.add(I,J);}if(K&&C.contains(J)){D.push(J);}else{if(K&&!C.contains(J)){J.destroy();}else{D.push(J);}}});return D;},_removeFromParent:function(E){var A=this;var D=A.get(FIELDS);if(z(E)){var C=E.get(PARENT);if(C&&C!=A){C.removeField(E);}else{if(A.contains(E)){p.Array.removeItem(D,E);}}}return D;},_setFields:function(C){var A=this;return A._normalizeFields(C);}});p.FormBuilderFieldSupport=a;var s=p.Component.create({NAME:FORM_BUILDER,ATTRS:{autoSelectFields:{value:false},availableFields:{lazyAdd:false,value:[],validator:n,setter:function(A){p.each(A,function(D,C){D.fieldId=D.fieldId||C;});return A;}},nestedList:{setter:function(D){var A=this;var C=p.merge({dd:{plugins:[{cfg:{horizontal:false,scrollDelay:30},fn:p.Plugin.DDWinScroll}]},dropCondition:function(F){var G=false;var E=F.drop.get(NODE);var H=E.getData(FIELD);if(H&&H.get(r)){G=true;}return G;},dropOn:DOT+CSS_FORM_BUILDER_DROP_ZONE,placeholder:p.Node.create(TPL_PLACEHOLDER),sortCondition:function(F){var E=A.get(DROP_CONTAINER_NODE);return E.contains(F.drop.get(NODE));}},D);return C;},value:{}},strings:{value:{stringDefaultMessage:"Drop a field here",stringEmptySelection:"No field selected"}},defaultMessageNode:{valueFn:function(){return p.Node.create(TPL_DEFAULT_MESSAGE);}},dragContainerNode:{valueFn:function(){return p.Node.create(TPL_DRAG_CONTAINER);}},dragNodesList:{setter:function(A){p.each(A,function(D,C){D.setData(INDEX,C);});},valueFn:"_valueDragNodesList"},dropContainerNode:{valueFn:function(){return p.Node.create(TPL_DROP_CONTAINER);}},settingsButtonsNode:{valueFn:function(){return p.Node.create(TPL_SETTINGS_BUTTONS);}},settingsFormNode:{valueFn:function(){return p.Node.create(TPL_SETTINGS);}},tabsNode:{valueFn:function(){return p.Node.create(TPL_TABS);}},tabsContentNode:{valueFn:function(){return p.Node.create(TPL_TABS_CONTENT);}},tabsListNode:{valueFn:function(){return p.Node.create(TPL_TABS_LIST);}}},AUGMENTS:[p.FormBuilderFieldSupport],HTML_PARSER:{defaultMessageNode:DOT+CSS_FORM_BUILDER_DEFAULT_MESSAGE,dragContainerNode:DOT+CSS_FORM_BUILDER_DRAG_CONTAINER,dragNodesList:function(C){var A=C.all(DOT+CSS_FORM_BUILDER_DRAG_NODE);return(A.size()<=0)?null:A;},dropContainerNode:DOT+CSS_FORM_BUILDER_DROP_CONTAINER,settingsFormNode:FORM+DOT+CSS_FORM_BUILDER_SETTINGS,settingsButtonsNode:DOT+CSS_FORM_BUILDER_SETTINGS_BUTTONS,tabsNode:DOT+CSS_FORM_BUILDER_TABS_CONTAINER,tabsContentNode:DOT+CSS_TABVIEW_CONTENT,tabsListNode:DOT+CSS_TABVIEW_LIST},EXTENDS:p.Widget,prototype:{initializer:function(){var A=this;A.boundingBox=A.get(B);A.dragContainerNode=A.get(DRAG_CONTAINER_NODE);A.dragNodesList=A.get(DRAG_NODES_LIST);A.dropContainerNode=A.get(DROP_CONTAINER_NODE);A.settingsButtonsNode=A.get(SETTINGS_BUTTONS_NODE);A.settingsFormNode=A.get(SETTINGS_FORM_NODE);A.tabsNode=A.get(TABS_NODE);A.tabsContentNode=A.get(TABS_CONTENT_NODE);A.tabsListNode=A.get(TABS_LIST_NODE);A._dragNestedList=new p.NestedList(A.get(NESTED_LIST));A._dropNestedList=new p.NestedList(A.get(NESTED_LIST));A._tabs=new p.TabView({boundingBox:A.tabsNode,contentNode:A.tabsContentNode,listNode:A.tabsListNode});if(!A.tabsContentNode.inDoc()){A._tabs.set(ITEMS,[{label:"Add a field",contentNode:A.dragContainerNode},{label:"Field settings",content:A.settingsFormNode}]);}},renderUI:function(){var A=this;A.dragNodesList.appendTo(A.dragContainerNode);A._tabs.render();},bindUI:function(){var A=this;var D=A.boundingBox;var C=A.dropContainerNode;var E=A.settingsButtonsNode;A._dragNestedList.on("drag:end",p.bind(A._onDragEndDragNestedList,A));A._dragNestedList.on("drag:start",p.bind(A._onDragStartDragNestedList,A));A._dropNestedList.on("drag:end",p.bind(A._onDragEndDropNestedList,A));A._tabs.after("activeTabChange",p.bind(A._afterActiveTabChange,A));A.uniqueFields.after("add",p.bind(A._afterUniqueFieldsAdd,A));A.uniqueFields.after("remove",p.bind(A._afterUniqueFieldsRemove,A));C.delegate("click",p.bind(A._onClickFieldDelete,A),DOT+CSS_FORM_BUILDER_BUTTON_DELETE);C.delegate("click",p.bind(A._onClickFieldDuplicate,A),DOT+CSS_FORM_BUILDER_BUTTON_DUPLICATE);C.delegate("click",p.bind(A._onClickFieldEdit,A),DOT+CSS_FORM_BUILDER_BUTTON_EDIT);C.delegate("dblclick",p.bind(A._onDbClickField,A),DOT+CSS_FORM_BUILDER_FIELD);C.delegate("mouseenter",p.bind(A._onMouseEnterField,A),DOT+CSS_FORM_BUILDER_FIELD);C.delegate("mouseleave",p.bind(A._onMouseLeaveField,A),DOT+CSS_FORM_BUILDER_FIELD);E.delegate("click",p.bind(A._onClickSettingsButton,A),DOT+CSS_BUTTON_INPUT);A.after("*:fieldsChange",p.bind(A._afterFieldsChange,A));A.after("*:selectedChange",p.bind(A._afterSelectedChange,A));},syncUI:function(){var A=this;A.syncFieldsUI();A._syncDefaultMessage();A._syncNestedList();},uniqueFields:new p.DataSet(),appendFields:function(D,C){var A=this;C.setContent(EMPTY_STR);
p.each(D,function(F){var E=F.get(FIELDS);C.append(F.get(B));A.appendFields(E,F.get(DROP_ZONE_NODE));});},duplicateField:function(F){var A=this;var C=F.get(PARENT);var D=C.indexOf(F);var E=A._cloneField(F);C.insertField(++D,E);},selectField:function(D){var A=this;D.set(SELECTED,true);var C=A.settingsFormNode.one(INPUT);if(C){C.focus();C.select();}A._tabs.selectTab(TAB_INDEX_SETTINGS);},syncFieldsUI:function(D){var A=this;var E=A.get(FIELDS);var C=A.get(DROP_CONTAINER_NODE);if(D&&z(D.target)){var F=D.target;E=F.get(FIELDS);C=F.get(DROP_ZONE_NODE);}A.appendFields(E,C);},_afterActiveTabChange:function(F){var A=this;var E=A.selectedField;var C=A.get(SETTINGS_FORM_NODE);var D=A.get(SETTINGS_BUTTONS_NODE);var G=A.get(STRINGS);var H=A.contains(E,true);if(!H){C.setContent(G[STRING_EMPTY_SELECTION]);}D.toggleClass(CSS_HELPER_HIDDEN,!H);},_afterFieldsChange:function(){var A=this;A._syncUniqueFields();A.syncUI();},_afterSelectedChange:function(D){var A=this;var E=D.target;var C=A.selectedField;A._syncSelectedFieldUI(E);if(E.get(SELECTED)){A.selectedField=E;if(C&&C!=E){C.set(SELECTED,false);}E.renderSettings();}},_afterUniqueFieldsAdd:function(E){var C=this;var D=E.attrName;var F=C.get(DRAG_NODES_LIST);var A=F.item(D);A.addClass(CSS_FORM_BUILDER_INACTIVE);A.unselectable();},_afterUniqueFieldsRemove:function(E){var C=this;var D=E.attrName;var F=C.get(DRAG_NODES_LIST);var A=F.item(D);A.removeClass(CSS_FORM_BUILDER_INACTIVE);A.selectable();},_cloneField:function(F){var A=this;var E=F.get(TYPE);var D={};p.each(F.getAttrs(),function(H,G){if(p.Array.indexOf(INVALID_CLONE_ATTRS)===-1&&!v(H)){D[G]=H;}});var C=[];p.each(F.get(FIELDS),function(G){C.push(A._cloneField(G));});D[FIELDS]=C;D[TYPE]=E;return D;},_dropField:function(D){var I=this;var E=D.get(PARENT_NODE);var A=E.all("> "+DOT+CSS_FORM_BUILDER_FIELD);var H=D.getData(FIELD);var C=I.get(DEFAULT_MESSAGE_NODE);if(C.inDoc()){C.remove();}var J=I._getFieldParentByNode(D);var F=A.indexOf(D);if(!H){var G=I.get(x);H=G[D.getData(INDEX)];D.remove();}J.insertField(F,H);return J.getField(F);},_getFieldInstance:function(C,E){var A=this;var E=E||C.type;var D=p.FormBuilder.types;var F=c(E)?D[E]:E;if(F!==undefined){return new F(C);}else{p.log("The field type: ["+E+"] couldn't be found.");}return null;},_getFieldParentByNode:function(C){var A=this;var D=C.ancestor(DOT+CSS_FORM_BUILDER_FIELD);if(D){return D.getData(FIELD);}return A;},_getFieldParentNode:function(D){var A=this;var C=D.get(PARENT);if(z(C)){return C.get(B);}return A.get(DROP_CONTAINER_NODE);},_onClickFieldDelete:function(D){var A=this;var G=D.currentTarget;var E=G.ancestor(DOT+CSS_FORM_BUILDER_FIELD);var F=E.getData(FIELD);if(z(F)){var C=A.selectedField;if(F==C||F.contains(C,true)){A._tabs.selectTab(TAB_INDEX_DRAG);}F.set(SELECTED,false);F.get(PARENT).removeField(F);}},_onClickFieldDuplicate:function(C){var A=this;var F=C.currentTarget;var D=F.ancestor(DOT+CSS_FORM_BUILDER_FIELD);var E=D.getData(FIELD);if(E){A.duplicateField(E);}},_onClickFieldEdit:function(C){var A=this;var F=C.currentTarget;var D=F.ancestor(DOT+CSS_FORM_BUILDER_FIELD);var E=D.getData(FIELD);if(E){A.selectField(E);}},_onClickSettingsButton:function(D){var A=this;var E=D.currentTarget;if(E.hasClass(CSS_FORM_BUILDER_BUTTON_SAVE)){var C=A.selectedField;if(C){C.saveSettings();}}A._tabs.selectTab(TAB_INDEX_DRAG);},_onDbClickField:function(C){var A=this;var E=C.target;if(E.test(INVALID_DBCLICK_TARGETS)){C.stopPropagation();return false;}if(!E.getData(FIELD)){E=E.ancestor(DOT+CSS_FORM_BUILDER_FIELD);}if(E){var D=E.getData(FIELD);if(D){A.selectField(D);}}return false;},_onDragEndDragNestedList:function(G){var C=this;var F=G.target;var A=F.get(NODE);var E=C.dragContainerNode;var D=C.dropContainerNode;var I=D.one(DOT+CSS_FORM_BUILDER_DRAG_NODE);if(I){var H=C._dropField(I);if(C.get(y)){C.selectField(H);}}else{F.set(NODE,C.originalNode);}if(E.contains(A)&&E.contains(C.originalNode)){A.remove();}},_onDragEndDropNestedList:function(E){var C=this;var D=E.target;var A=D.get(NODE);if(A.hasClass(CSS_FORM_BUILDER_FIELD)){C._dropField(A);}},_onDragStartDragNestedList:function(G){var C=this;var F=G.target;var A=F.get(NODE);var D=A.getData(INDEX);var H=A.clone();A.placeBefore(H);H.setData(INDEX,D);F.set(NODE,H);H.attr(ID,EMPTY_STR);H.hide();A.removeClass(CSS_DD_DRAGGING);A.show();C.originalNode=A;var E=p.merge(C.get(NESTED_LIST),{nodes:H});(new p.NestedList(E));},_onMouseEnterField:function(C){var A=this;var D=C.currentTarget;var E=D.getData(FIELD);if(E){A._toggleFieldButtonsNode(E,true);}},_onMouseLeaveField:function(C){var A=this;var D=C.currentTarget;var E=D.getData(FIELD);var F=false;if(E){if(E.get(SELECTED)){F=true;}A._toggleFieldButtonsNode(E,F);}},_renderField:function(C,D,F){var A=this;var G=C.get(DROP_CONTAINER_NODE);if(z(C)){G=C.get(DROP_ZONE_NODE);}var E=p.Node.create(TPL_FIELD_BOUNDING_BOX);var H=C.get(FIELDS);if(H.length>0){G.insert(E,D);}else{G.append(E);}F=p.merge(F,{boundingBox:E,fieldId:F.fieldId,formBuilder:A,render:true,after:{render:function(){E.removeClass(CSS_HELPER_HIDDEN);}}});return A._getFieldInstance(F);},_syncDefaultMessage:function(){var A=this;if(!A.dropContainerNode.hasChildNodes()){var C=A.get(STRINGS);var D=A.get(DEFAULT_MESSAGE_NODE);D.setContent(C["stringDefaultMessage"]);A.dropContainerNode.append(D);}},_syncNestedList:function(){var A=this;var D=A.get(x);var C=A.uniqueFields;A._syncNodes();A.dragNodes.each(function(F,E){var G=D[E];if(!C.containsKey(G.fieldId)){A._dragNestedList.add(F);}});A._dropNestedList.addAll(A.dropNodes);},_syncNodes:function(){var A=this;var D=A.dragContainerNode;var C=A.dropContainerNode;A.dragNodes=D.all(DOT+CSS_FORM_BUILDER_FIELD);A.dropNodes=C.all([DOT+CSS_FORM_BUILDER_FIELD,DOT+CSS_FORM_BUILDER_DEFAULT_MESSAGE].join(k));},_syncSelectedFieldUI:function(F){var A=this;var E=F.get(SELECTED);var D=F.get(B);var C=A.selectedField;D.toggleClass(CSS_FORM_BUILDER_FIELD_SELECTED,E);if(!E&&F.contains(C)){E=true;}A._toggleFieldButtonsNode(F,E);},_syncUniqueFields:function(){var A=this;var C=A.uniqueFields;C.each(function(D,E){if(!A.contains(D,true)){C.remove(D);
}});},_toggleFieldButtonsNode:function(D,E){var A=this;var C=D.get(e);if(C){C.toggleClass(CSS_HELPER_HIDDEN,!E);}},_valueDragNodesList:function(){var A=this;var D=A.get(x);var C=[];p.each(D,function(F,E,G){C.push(p.substitute(TPL_DRAG_NODE,{icon:F.iconClass||DEFAULT_ICON_CLASS,label:F.label,fieldId:F.fieldId||E,type:F.type,unique:F.unique}));});return p.NodeList.create(C.join(EMPTY_STR));}}});p.FormBuilder=s;p.FormBuilder.types={};},"@VERSION@",{requires:["aui-base","aui-button-item","aui-nested-list","aui-tabs","substitute"],skinnable:true});AUI.add("aui-form-builder-field",function(bI){var bC=bI.Lang,aD=bC.isArray,af=bC.isString,c="acceptChildren",aw="boundingBox",bQ="builder",bY="button",B="buttons",b3="buttonsNode",bc="checkbox",C="checked",b7="children",bU="clearfix",ax="close",az="component",b2="contentBox",a8="container",x="default",aF="delete",bw=".",aP="drag",bg="dragContainer",b4="dragContainerNode",ab="dragNodesList",ao="drop",aH="dropContainer",a2="dropContainerNode",V="dropNode",ay="dropZone",aW="dropZoneNode",be="duplicate",F="edit",bl="",a3="field",f="fields",bs="for",q="form",aN="formBuilder",bb="form-builder-field",n="helper",aj="hidden",p="icon",bT="id",Z="label",X="labelNode",aU="metadata",ap="name",b9="node",a="panel",aO="portalLayout",a6="predefinedValue",a4="proxy",ah="required",bm="state",aZ="settings",ai="settingsFormNode",bM="showLabel",al="size",O=" ",ag="string",bK="templateNode",bd="unique",bz="zone",aG="widget",v=bI.getClassName,a1=v(az),a9=v(a3,Z),b6=v(n,bU),U=v(n,aj),bv=v(bm,x),w=v(q,bQ,bY),ak=v(q,bQ,bY,aF),aT=v(q,bQ,bY,be),G=v(q,bQ,bY,F),b8=v(q,bQ,p),i=v(q,bQ,p,aF),s=v(q,bQ,p,be),bE=v(q,bQ,p,F),br=v(q,bQ,a3),bf=v(q,bQ,a3,B),aX=v(q,bQ,ao,b9),bA=v(q,bQ,ao,bz),bn=v(q,bQ,bd),bS=v(aG),bG='<li class="'+[bS,a1,br].join(O)+'"></li>',l='<div class="'+[bf,U].join(O)+'">'+'<a class="'+[w,G].join(O)+'" href="javascript:;" title="Edit">'+'<div class="'+[b8,bE].join(O)+'"></div>'+"</a>"+'<a class="'+[w,aT].join(O)+'" href="javascript:;" title="Duplicate">'+'<div class="'+[b8,s].join(O)+'"></div>'+"</a>"+'<a class="'+[w,ak].join(O)+'" href="javascript:;" title="Delete">'+'<div class="'+[b8,i].join(O)+'"></div>'+"</a>"+"</div>",bV='<div class="'+b6+'"></div>',aL='<label class="'+a9+'"></label>',T='<ul class="'+bA+'"></ul>';var b5=bI.Component.create({NAME:bb,ATTRS:{acceptChildren:{value:true},dataType:{value:ag},fieldId:{value:bl},formBuilder:{value:undefined},id:{value:bl},icon:{value:bl},label:{value:bl},name:{valueFn:function(){var A=this;return A.get(N)+(++bI.Env._uidx);}},parent:{value:null},predefinedValue:{value:bl},required:{setter:bI.DataType.Boolean.parse,value:false},selected:{setter:bI.DataType.Boolean.parse,value:false},showLabel:{setter:bI.DataType.Boolean.parse,value:true},template:{value:bl},type:{value:bl},unique:{setter:bI.DataType.Boolean.parse,value:false},buttonsNode:{valueFn:function(){return bI.Node.create(l);}},dropZoneNode:{valueFn:function(){return bI.Node.create(T);}},labelNode:{valueFn:function(){return bI.Node.create(aL);}},templateNode:{valueFn:"getNode"}},AUGMENTS:[bI.FormBuilderFieldSupport],UI_ATTRS:[c,a6,Z,ap,bM,bd],HTML_PARSER:{buttonsNode:bw+bf,dropZoneNode:bw+bA,labelNode:Z+bw+a9},prototype:{BOUNDING_TEMPLATE:bG,initializer:function(){var A=this;A.get(aw).setData(a3,A);},bindUI:function(){var A=this;},renderUI:function(){var A=this;var cd=A.get(aw);var ce=A.get(b3);var L=A.get(b2);var cc=A.get(X);var cb=A.get(bK);if(!cd.contains(ce)){cd.prepend(ce);}if(!L.contains(cc)){L.append(cc);cc.setAttribute(bs,cb.get(bT));}if(!L.contains(cb)){L.append(cb);}},saveSettings:function(){var A=this;var L=A.get(aN);var cb=L.get(ai);bI.Array.each(bI.io._serialize(cb._node).split("&"),function(cc){var cd=cc.split("=");A.set(cd[0],decodeURIComponent(cd[1]));});},renderSettings:function(){var A=this;var cc=A.get(aN);var cd=cc.get(ai);if(!A.fieldSettingsNode){A.fieldSettingsNode=bI.Node.create(bV);var ce=bI.Node.create(bV);A.labelField=new bI.Field({type:"text",name:Z,labelText:"Label",value:A.get(Z)}).render(ce);A.labelField.get(b9).on({keyup:bI.bind(A._onLabelKeyUp,A)});A.showLabelField=new bI.Field({type:"checkbox",name:bM,labelText:"Show label",labelAlign:"left",value:A.get(bM)}).render(ce);var L=A.showLabelField.get(b9);L.set(C,A.get(bM));L.on({change:bI.bind(A._onSettingsFieldChange,A)});A._renderSettingsFields([{type:"text",name:ap,labelText:"Name",value:A.get(ap)},{type:"text",name:a6,labelText:"Default value",value:A.get(a6)}],ce);A.requiredField=new bI.Field({type:"checkbox",name:ah,labelText:"Required",labelAlign:"left",value:ah}).render(ce);var cb=A.requiredField.get(b9);cb.set(C,A.get(ah));cb.on({change:bI.bind(A._onSettingsFieldChange,A)});A.propertiesPanel=new bI.Panel({bodyContent:ce,collapsible:true,title:"Properties"}).render();A.fieldSettingsNode.append(A.propertiesPanel.get(aw));}cd.setContent(A.fieldSettingsNode);},getHTML:function(){},getNode:function(){},_onLabelKeyUp:function(L){var A=this;var cc=L.target;var cb=cc.val();A.set(Z,cb);},_onSettingsFieldChange:function(L){var A=this;var cc=L.target;var cb=cc.val();if(cc.get(N)==bc){cb=cc.get(C);}A.set(cc.get(ap),cb);},_renderSettingsFields:function(cb,L){var A=this;bI.each(cb,function(cd){var ce=new bI.Field(cd).render(L);var cc=ce.get(b9);if(cd.type==bc){cc.set(C,cd.value);}A[cd.name+"Field"]=ce;});},_uiSetAcceptChildren:function(cd){var A=this;var cb=A.get(aw);var cc=A.get(aW);var L=cb.one(bw+bA);if(cd&&!L){cb.append(cc);}else{if(!cd&&L){L.remove();}else{if(cd&&L){A.set(aW,L);}}}},_uiSetLabel:function(cb){var A=this;var L=A.get(X);L.setContent(cb);},_uiSetName:function(cb){var A=this;var L=A.get(bK);L.set(ap,cb);},_uiSetPredefinedValue:function(cb){var A=this;var L=A.get(bK);L.val(cb);},_uiSetShowLabel:function(cb){var A=this;var L=A.get(X);L.toggleClass(U,!cb);},_uiSetUnique:function(cc){var A=this;var L=A.get(aw);var cb=A.get(b3);L.toggleClass(bn,cc);cb.one(bw+aT).toggleClass(U,cc);}}});bI.FormBuilderField=b5;bI.FormBuilder.types["field"]=bI.FormBuilderField;var bC=bI.Lang,aD=bC.isArray,bi=bC.isNumber,af=bC.isString,ar=function(A){return(A instanceof bI.Node);
},aM=function(A){return(A instanceof bI.NodeList);},aS=bI.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),aw="boundingBox",bY="button",bW="buttonType",b2="contentBox",a8="container",bw=".",aP="drag",bg="dragContainer",b4="dragContainerNode",ab="dragNodesList",ao="drop",aH="dropContainer",a2="dropContainerNode",bl="",a3="field",f="fields",bb="form-builder-field",ae="form-builder-button-field",bT="id",p="icon",aI="input",Z="label",ap="name",b9="node",bN="option",bL="options",aO="portalLayout",a6="predefinedValue",a4="proxy",bx="reset",aV="selected",bB="selectedIndex",bk="submit",O=" ",ac="strings",ba="template",bK="templateNode",bo="text",N="type",m="value",v=bI.getClassName,at=v(a3,aI),bP=v(a3,aI,bo),br=v(bb),P=v(bb,b9),bv=v(bm,x),bp='<input id="{id}" class="'+[P,at].join(O)+'" name="{name}" type="{type}" value="{value}" />',ca=[bk,bx,bY];var R=bI.Component.create({NAME:ae,ATTRS:{acceptChildren:{value:false,readOnly:true},buttonType:{value:bk,validator:function(A){return bI.Array(ca).indexOf(A.toLowerCase())>-1;}},predefinedValue:{value:aS(bk)},showLabel:{value:false},strings:{value:{button:"Button",reset:"Reset",submit:"Submit"}},template:{valueFn:function(){return bp;}}},UI_ATTRS:[c,a6,Z,ap,bW,bM],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderField,prototype:{getHTML:function(){var A=this;var cb=A.get(ba);var cf=A.get(bT);var cd=A.get(Z);var cc=A.get(ap);var L=A.get(bW);var ce=A.get(a6);return bI.substitute(cb,{id:cf,label:cd,name:cc,type:L,value:ce});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());},renderSettings:function(){var cf=this;var L=cf.get(aN);var A=L.get(ai);var ce=cf.get(bW);var cg=cf.get(ac);bI.FormBuilderButtonField.superclass.renderSettings.apply(cf,arguments);if(!cf._renderedButtonSettings){cf._renderedButtonSettings=true;var cd=cf.propertiesPanel.get(d);var ci=[];bI.each(ca,function(cj){ci.push({labelText:cg[cj],value:cj});});var ch=new bI.Select({labelText:"Button type",name:bW,options:ci}).render(cd.item(0));var cb=ch.get(b9);cb.on({change:bI.bind(cf._onButtonTypeChange,cf)});var cc=bI.Array(ca).indexOf(ce);cb.all(bN).item(cc).set(aV,true);}},_onButtonTypeChange:function(L){var A=this;var cb=L.target;A.set(bW,cb.get(m));},_uiSetButtonType:function(cb){var A=this;var L=A.get(bK);L.set(N,cb);}}});bI.FormBuilderButtonField=R;bI.FormBuilder.types["button"]=bI.FormBuilderButtonField;var bC=bI.Lang,aD=bC.isArray,a0=bC.isBoolean,bi=bC.isNumber,af=bC.isString,aB="boolean",aw="boundingBox",d="bodyContent",bc="checkbox",C="checked",an="choice",b2="contentBox",a8="container",bw=".",aP="drag",bg="dragContainer",b4="dragContainerNode",ab="dragNodesList",ao="drop",aH="dropContainer",a2="dropContainerNode",bl="",a3="field",f="fields",bb="form-builder-field",bZ="form-builder-checkbox-field",bT="id",p="icon",aJ="inline",Z="label",g="labels",ap="name",b9="node",aO="portalLayout",a6="predefinedValue",a4="proxy",al="size",O=" ",ba="template",bK="templateNode",m="value",v=bI.getClassName,b=v(a3),by=v(a3,bc),bF=v(a3,an),br=v(bb),b0=v(bb,bc),P=v(bb,b9),bv=v(bm,x),aa=v(a3,g,aJ),bG='<li class="'+[bS,a1,br,b0].join(O)+'"></li>',aA='<input id="{id}" class="'+[P,b,by,bF].join(O)+'" name="{name}" type="checkbox" value="{value}" {checked} />';var S=bI.Component.create({NAME:bZ,ATTRS:{dataType:{value:aB},predefinedValue:{setter:bI.DataType.Boolean.parse,value:false},template:{valueFn:function(){return aA;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[c,a6,Z,ap,bM],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderField,prototype:{BOUNDING_TEMPLATE:bG,bindUI:function(){var A=this;bI.FormBuilderCheckBoxField.superclass.bindUI.apply(A,arguments);var L=A.get(bK);L.on({"change":bI.bind(A._onValueChange,A)});},renderUI:function(){var A=this;var L=A.get(b2);var cb=A.get(bK);var cc=A.get(X);bI.FormBuilderCheckBoxField.superclass.renderUI.apply(A,arguments);cc.insert(cb,cc,"before");},getHTML:function(){var A=this;var L=A.get(ba);var cd=A.get(C);var cf=A.get(bT);var cc=A.get(Z);var cb=A.get(ap);var ce=A.get(a6);return bI.substitute(L,{checked:cd?'checked="checked"':bl,id:cf,label:cc,name:cb,value:ce});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());},renderSettings:function(){var L=this;var cc=L.get(aN);var cd=cc.get(ai);bI.FormBuilderCheckBoxField.superclass.renderSettings.apply(L,arguments);if(!L._renderedCheckboxSettings){L._renderedCheckboxSettings=true;L.predefinedValueField.destroy();var A=L.propertiesPanel.get(d);var cb=new bI.Field({type:"checkbox",name:a6,labelText:"Checked",labelAlign:"left"}).render(A.item(0));L.checkedFieldNode=cb.get(b9);L.checkedFieldNode.on({change:bI.bind(L._onValueChange,L)});L.checkedFieldNode.set(C,L.get(a6));}},_onValueChange:function(L){var A=this;var cb=L.target;A.set(a6,cb.get(C));},_uiSetPredefinedValue:function(cc){var A=this;var cb=A.get(bK);var L=A.checkedFieldNode;if(L){L.set(C,cc);}cb.set(C,cc);}}});bI.FormBuilderCheckBoxField=S;bI.FormBuilder.types["checkbox"]=bI.FormBuilderCheckBoxField;var bC=bI.Lang,aD=bC.isArray,bi=bC.isNumber,af=bC.isString,ar=function(A){return(A instanceof bI.Node);},aM=function(A){return(A instanceof bI.NodeList);},aw="boundingBox",b2="contentBox",a8="container",bw=".",ao="drop",bl="",a3="field",f="fields",bb="form-builder-field",z="form-builder-fieldset-field",bT="id",p="icon",Z="label",ap="name",b9="node",a6="predefinedValue",O=" ",ba="template",bK="templateNode",bo="text",m="value",bz="zone",v=bI.getClassName,br=v(bb),P=v(bb,b9),bA=v(q,bQ,ao,bz),a5='<fieldset id="{id}" class="'+[P].join(O)+'"></fieldset>',j='<legend class="'+a9+'"></legend>';var t=bI.Component.create({NAME:z,ATTRS:{acceptChildren:{value:true,readOnly:true},dataType:{value:undefined},template:{valueFn:function(){return a5;}},labelNode:{valueFn:function(){return bI.Node.create(j);}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[c,Z,bM],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderField,prototype:{CONTENT_TEMPLATE:a5,renderUI:function(){var A=this;
var cd=A.get(aw);var ce=A.get(b3);var L=A.get(b2);var cc=A.get(X);var cb=A.get(bK);if(!cd.contains(ce)){cd.prepend(ce);}if(!L.contains(cc)){L.append(cc);}},getHTML:function(){var A=this;var L=A.get(ba);var cb=A.get(bT);return bI.substitute(L,{id:cb});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());},renderSettings:function(){var A=this;var cb=A.get(aN);var cc=cb.get(ai);if(!A._renderedFieldsetSettings){A._renderedFieldsetSettings=true;A.fieldSettingsNode=bI.Node.create(bV);var cd=bI.Node.create(bV);A.labelField=new bI.Field({type:"text",name:Z,labelText:"Label",value:A.get(Z)}).render(cd);A.labelField.get(b9).on({keyup:bI.bind(A._onLabelKeyUp,A)});A.showLabelField=new bI.Field({type:"checkbox",name:bM,labelText:"Show label",labelAlign:"left",value:A.get(bM)}).render(cd);var L=A.showLabelField.get(b9);L.set(C,A.get(bM));L.on({change:bI.bind(A._onSettingsFieldChange,A)});A.propertiesPanel=new bI.Panel({bodyContent:cd,collapsible:true,title:"Properties"}).render();A.fieldSettingsNode.append(A.propertiesPanel.get(aw));}cc.setContent(A.fieldSettingsNode);},_uiSetAcceptChildren:function(cd){var A=this;var L=A.get(b2);var cc=A.get(aW);var cb=L.one(bw+bA);if(cd&&!cb){L.append(cc);}else{if(!cd&&cb){cb.remove();}else{if(cd&&cb){A.set(aW,cb);}}}}}});bI.FormBuilderFieldsetField=t;bI.FormBuilder.types["fieldset"]=bI.FormBuilderFieldsetField;var bC=bI.Lang,aD=bC.isArray,bi=bC.isNumber,af=bC.isString,ar=function(A){return(A instanceof bI.Node);},aM=function(A){return(A instanceof bI.NodeList);},aw="boundingBox",b2="contentBox",a8="container",bw=".",bl="",a3="field",f="fields",bb="form-builder-field",b1="form-builder-file-upload-field",bT="id",p="icon",Z="label",ap="name",b9="node",a6="predefinedValue",O=" ",ba="template",bK="templateNode",bo="text",m="value",v=bI.getClassName,br=v(bb),P=v(bb,b9),bv=v(bm,x),bj='<input id="{id}" class="'+[P].join(O)+'" name="{name}" type="file" value="{value}" />';var D=bI.Component.create({NAME:b1,ATTRS:{template:{valueFn:function(){return bj;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[c,a6,Z,ap,bM],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderField,prototype:{getHTML:function(){var A=this;var L=A.get(ba);var cf=A.get(bT);var cc=A.get(Z);var cb=A.get(ap);var cd=A.get(al);var ce=A.get(a6);return bI.substitute(L,{id:cf,label:cc,name:cb,value:ce});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());},renderSettings:function(){var A=this;var cb=A.get(aN);var cc=cb.get(ai);if(!A._renderedFileUploadSettings){A._renderedFileUploadSettings=true;A.fieldSettingsNode=bI.Node.create(bV);var cd=bI.Node.create(bV);A.labelField=new bI.Field({type:"text",name:Z,labelText:"Label",value:A.get(Z)}).render(cd);A.labelField.get(b9).on({keyup:bI.bind(A._onLabelKeyUp,A)});A.showLabelField=new bI.Field({type:"checkbox",name:bM,labelText:"Show label",labelAlign:"left",value:A.get(bM)}).render(cd);var L=A.showLabelField.get(b9);L.set(C,A.get(bM));L.on({change:bI.bind(A._onSettingsFieldChange,A)});A._renderSettingsFields([{type:"text",name:ap,labelText:"Name",value:A.get(ap)},{type:"checkbox",name:ah,labelText:"Required",labelAlign:"left",value:A.get(ah)}],cd);A.propertiesPanel=new bI.Panel({bodyContent:cd,collapsible:true,title:"Properties"}).render();A.fieldSettingsNode.append(A.propertiesPanel.get(aw));}cc.setContent(A.fieldSettingsNode);}}});bI.FormBuilderFileUploadField=D;bI.FormBuilder.types["fileupload"]=bI.FormBuilderFileUploadField;var bC=bI.Lang,aD=bC.isArray,bi=bC.isNumber,af=bC.isString,ar=function(A){return(A instanceof bI.Node);},aM=function(A){return(A instanceof bI.NodeList);},aS=bI.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),H="add",ad="addNode",aw="boundingBox",bY="button",bW="buttonType",b2="contentBox",a8="container",x="default",aY="defaultName",r="defaultOptions",y="defaultValue",bw=".",aP="drag",bg="dragContainer",b4="dragContainerNode",ab="dragNodesList",ao="drop",aH="dropContainer",a2="dropContainerNode",bl="",a3="field",f="fields",bb="form-builder-field",E="form-builder-multiple-choice-field",p="icon",bT="id",aI="input",Y="item",Z="label",bX="multiple",ap="name",b9="node",bN="option",bh="optionTemplate",bL="options",a6="predefinedValue",a4="proxy",o="remove",bx="reset",bk="submit",O=" ",ba="template",bK="templateNode",bo="text",N="type",m="value",v=bI.getClassName,at=v(a3,aI),bP=v(a3,aI,bo),k=v(a3,bL,H),K=v(a3,bL,Y),J=v(a3,bL,Y,aI),bq=v(a3,bL,Y,aI,ap),bJ=v(a3,bL,Y,aI,m),aR=v(a3,bL,Y,o),br=v(bb),P=v(bb,b9),bv=v(bm,x),bu='<div class="'+[K,aa,b6].join(O)+'">'+'<input type="text" class="'+[J,bq,at,bP].join(O)+'" value="{name}" />'+'<input type="text" class="'+[J,bJ,at,bP].join(O)+'" value="{value}" />'+'<a href="javascript:;" class="'+aR+'">&nbsp;</a>'+"</div>";TPL_ADD='<a class="'+k+'" href="javascript:;">Add an option</a>',ENTER="ENTER";var aE=bI.Component.create({NAME:bL,ATTRS:{allowClear:{value:false},defaultName:{value:bl},defaultValue:{value:bl},options:{value:[],getter:"_getOptions",validator:aD},addNode:{valueFn:function(){return bI.Node.create(TPL_ADD);}}},HTML_PARSER:{addNode:bw+k},UI_ATTRS:[bL],EXTENDS:bI.Widget,prototype:{renderUI:function(){var A=this;var L=A.get(aw);var cb=A.get(ad);if(!cb.inDoc()){L.append(cb);}},bindUI:function(){var A=this;var L=A.get(aw);var cb=A.get(ad);cb.on("click",bI.bind(A._onClickAdd,A));L.delegate("click",bI.bind(A._onClickOptionRemove,A),bw+aR);L.delegate("keypress",bI.bind(A._onKeyPressOption,A),bw+J);},add:function(L){var A=this;var cb=A.get(bL);cb.push(L);A.set(bL,cb);},clear:function(){var A=this;if(A.get(ALLOW_CLEAR)){A.set(bL,[]);}},remove:function(cb){var A=this;var L=A.get(b2);var cc=A._getOptionNode(cb);if(cc){cc.remove();}A.items=L.all(bw+K);},_addNewOption:function(){var L=this;var cb=L.get(b2);var cc=L._createOption({name:L.get(aY),value:L.get(y)});cc=bI.Node.create(cc);cb.append(cc);var A=cc.one(aI);A.focus();A.select();L.items=cb.all(bw+K);return cc;},_createOption:function(L){var A=this;return bI.substitute(bu,L);},_getOptionNode:function(L){var A=this;
return A.items.item(L);},_getOptions:function(cb){var A=this;var L=[];if(A.items){bI.each(A.items,function(cc){var cd=cc.one(bw+bq);var ce=cc.one(bw+bJ);L.push({name:cd.val(),value:ce.val()});});}else{L=cb;}return L;},_indexOfTarget:function(cb){var A=this;var L=cb.ancestor(bw+K);return A.items.indexOf(L);},_onClickAdd:function(L){var A=this;A._addNewOption();},_onClickOptionRemove:function(cc){var A=this;var cb=A.get(bL);var L=A._indexOfTarget(cc.target);A.remove(L);},_onKeyPressOption:function(cd){var A=this;var cc=A.get(bL);var cf=cd.currentTarget;var L=A.items;if(cd.isKey(ENTER)){var cb=A._indexOfTarget(cf);var ce=cf.hasClass(bJ);if((cb==L.size()-1)&&ce){A._addNewOption();}}},_uiSetOptions:function(cc){var A=this;var cb=[];var L=A.get(b2);L.empty();bI.each(cc,function(cd){L.append(A._createOption(cd));});A.items=L.all(bw+K);}}});var e=bI.Component.create({NAME:E,ATTRS:{acceptChildren:{value:false,readOnly:true},options:{value:[{name:"option 1",value:"value 1"},{name:"option 2",value:"value 2"},{name:"option 3",value:"value 3"}]},optionTemplate:{value:'<option value="{value}">{name}</option>'}},UI_ATTRS:[c,a6,Z,ap,bL,bM],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderField,prototype:{initializer:function(){var A=this;bI.FormBuilderMultipleChoiceField.superclass.initializer.apply(A,arguments);},getNode:function(){var A=this;return bI.FormBuilderMultipleChoiceField.superclass.getNode.apply(A,arguments);},renderSettings:function(){var A=this;bI.FormBuilderMultipleChoiceField.superclass.renderSettings.apply(A,arguments);if(!A._renderedMultipleChoiceSettings){A._renderedMultipleChoiceSettings=true;var L=bI.Node.create(bV);A.optionsPanel=new bI.Panel({bodyContent:L,collapsible:true,title:"Options"}).render();A.options=new aE({options:A.get(bL)}).render(L);A.fieldSettingsNode.append(A.optionsPanel.get(aw));}},saveSettings:function(){var A=this;bI.FormBuilderMultipleChoiceField.superclass.saveSettings.apply(A,arguments);A.set(bL,A.options.get(bL));},_uiSetOptions:function(cb){var A=this;var L=A.get(bK);L.empty();bI.each(cb,function(cc){L.append(bI.substitute(A.get(bh),cc));});}}});bI.FormBuilderMultipleChoiceField=e;bI.FormBuilder.types["multiple-choice"]=bI.FormBuilderMultipleChoiceField;var bC=bI.Lang,aD=bC.isArray,a0=bC.isBoolean,bi=bC.isNumber,af=bC.isString,aw="boundingBox",d="bodyContent",C="checked",an="choice",b2="contentBox",a8="container",bw=".",bl="",a3="field",f="fields",bb="form-builder-field",aQ="form-builder-radio-field",bT="id",p="icon",aJ="inline",Z="label",g="labels",ap="name",b9="node",bR="optionsContainerNode",a6="predefinedValue",I="radio",al="size",O=" ",ba="template",bK="templateNode",m="value",v=bI.getClassName,b=v(a3),bF=v(a3,an),br=v(bb),av=v(bb,I),P=v(bb,b9),M=v(bb,bL,a8),bv=v(bm,x),aa=v(a3,g,aJ),bG='<li class="'+[bS,a1,br,av].join(O)+'"></li>',Q='<div class="'+M+'"></div>',aC='<input id="{id}" class="'+[P,b,bF].join(O)+'" name="{name}" type="radio" value="{value}" {checked} />';var h=bI.Component.create({NAME:aQ,ATTRS:{name:{value:I},optionTemplate:{value:aC},template:{valueFn:function(){return aC;}},optionsContainerNode:{valueFn:function(){return bI.Node.create(Q);}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[c,a6,Z,ap,bM,bL],CSS_PREFIX:br,HTML_PARSER:{optionsContainerNode:bw+M,templateNode:bw+P},EXTENDS:bI.FormBuilderMultipleChoiceField,prototype:{BOUNDING_TEMPLATE:bG,renderUI:function(){var A=this;var cc=A.get(aw);var ce=A.get(b3);var L=A.get(b2);var cb=A.get(X);if(!cc.contains(ce)){cc.prepend(ce);}if(!L.contains(cb)){L.append(cb);}var cd=A.get(bR);if(!L.contains(cd)){L.append(cd);}},getHTML:function(){var A=this;var L=A.get(ba);var cd=A.get(C);var cf=A.get(bT);var cc=A.get(Z);var cb=A.get(ap);var ce=A.get(a6);return bI.substitute(L,{checked:cd?'checked="checked"':bl,id:cf,label:cc,name:cb,value:ce});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());},_onFieldChange:function(L){var A=this;var cb=L.target;A.set(a6,cb.val());},_uiSetOptions:function(cd){var A=this;var L=A.get(b2);var cc=A.get(bR);var cb=A.get(bK);cc.empty();bI.each(cd,function(cg){var ce=new bI.Field({type:I,name:A.get(ap),labelText:cg.name,labelAlign:"left",value:cg.value}).render(cc);var cf=ce.get(b9);if(cg.value==A.get(a6)){cf.set(C,true);}cf.on({change:bI.bind(A._onFieldChange,A)});});},_uiSetPredefinedValue:function(cd){var A=this;var L=A.get(aN);var cb=L.get(ai);var cc=cb.one("input[name=predefinedValue]");if(cc){cc.val(cd);}}}});bI.FormBuilderRadioField=h;bI.FormBuilder.types["radio"]=bI.FormBuilderRadioField;var bC=bI.Lang,aD=bC.isArray,bi=bC.isNumber,af=bC.isString,ar=function(A){return(A instanceof bI.Node);},aM=function(A){return(A instanceof bI.NodeList);},aS=bI.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),aw="boundingBox",bY="button",bW="buttonType",b2="contentBox",a8="container",r="defaultOptions",bw=".",aP="drag",bg="dragContainer",b4="dragContainerNode",ab="dragNodesList",ao="drop",aH="dropContainer",a2="dropContainerNode",bl="",a3="field",f="fields",bb="form-builder-field",bH="form-builder-select-field",bT="id",p="icon",aI="input",Z="label",bX="multiple",ap="name",b9="node",bN="option",bL="options",aO="portalLayout",a6="predefinedValue",a4="proxy",bx="reset",bB="selectedIndex",bk="submit",O=" ",ba="template",bK="templateNode",bo="text",N="type",m="value",v=bI.getClassName,at=v(a3,aI),bP=v(a3,aI,bo),br=v(bb),P=v(bb,b9),bv=v(bm,x),am='<select id="{id}" class="'+[P].join(O)+'" name="{name}" value="{value}"></select>';var W=bI.Component.create({NAME:bH,ATTRS:{multiple:{setter:bI.DataType.Boolean.parse,value:false},template:{valueFn:function(){return am;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[c,a6,Z,ap,bL,bM,bX],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderMultipleChoiceField,prototype:{getHTML:function(){var A=this;var L=A.get(ba);var ce=A.get(bT);var cc=A.get(Z);var cb=A.get(ap);var cd=A.get(a6);return bI.substitute(L,{id:ce,label:cc,name:cb,value:cd});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());
},renderSettings:function(){var L=this;var cd=L.get(aN);var ce=cd.get(ai);bI.FormBuilderSelectField.superclass.renderSettings.apply(L,arguments);if(!L._renderedSelectSettings){L._renderedSelectSettings=true;var A=L.propertiesPanel.get(d);var cb=new bI.Field({type:"checkbox",name:bX,labelText:"Multiple",labelAlign:"left"}).render(A.item(0));var cc=cb.get(b9);cc.on({change:bI.bind(L._onSettingsFieldChange,L)});cc.set(C,L.get(bX));}},_uiSetMultiple:function(cb){var A=this;var L=A.get(bK);if(cb){L.setAttribute(bX,bX);}else{L.removeAttribute(bX);}}}});bI.FormBuilderSelectField=W;bI.FormBuilder.types["select"]=bI.FormBuilderSelectField;var bC=bI.Lang,aD=bC.isArray,bi=bC.isNumber,af=bC.isString,ar=function(A){return(A instanceof bI.Node);},aM=function(A){return(A instanceof bI.NodeList);},aw="boundingBox",b2="contentBox",a8="container",bw=".",aP="drag",bg="dragContainer",b4="dragContainerNode",ab="dragNodesList",ao="drop",aH="dropContainer",a2="dropContainerNode",bl="",a3="field",f="fields",bb="form-builder-field",aK="form-builder-input-field",bT="id",p="icon",aI="input",Z="label",ap="name",b9="node",aO="portalLayout",a6="predefinedValue",a4="proxy",O=" ",ba="template",bK="templateNode",bo="text",m="value",v=bI.getClassName,at=v(a3,aI),bP=v(a3,aI,bo),br=v(bb),P=v(bb,b9),bv=v(bm,x),bp='<input id="{id}" class="'+[P,at,bP].join(O)+'" name="{name}" type="text" value="{value}" />';var aq=bI.Component.create({NAME:aK,ATTRS:{template:{valueFn:function(){return bp;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[c,a6,Z,ap,bM],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderField,prototype:{bindUI:function(){var A=this;bI.FormBuilderTextField.superclass.bindUI.apply(A,arguments);var L=A.get(bK);L.on({"keyup":bI.bind(A._onValueKeyUp,A)});},getHTML:function(){var A=this;var L=A.get(ba);var cf=A.get(bT);var cc=A.get(Z);var cb=A.get(ap);var cd=A.get(al);var ce=A.get(a6);return bI.substitute(L,{id:cf,label:cc,name:cb,value:ce});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());},renderSettings:function(){var A=this;var L=A.get(aN);var cb=L.get(ai);bI.FormBuilderTextField.superclass.renderSettings.apply(A,arguments);if(!A._renderedInputSettings){A._renderedInputSettings=true;var cc=cb.one("input[name=predefinedValue]");cc.on({"keyup":bI.bind(A._onValueKeyUp,A)});}},_onValueKeyUp:function(L){var A=this;var cb=L.target;A.set(a6,cb.val());},_uiSetPredefinedValue:function(ce){var A=this;var cb=A.get(aN);var cc=cb.get(ai);var cd=cc.one("input[name=predefinedValue]");var L=A.get(bK);L.val(ce);if(cd&&A.get(aV)){cd.val(ce);}}}});bI.FormBuilderTextField=aq;bI.FormBuilder.types["text"]=bI.FormBuilderTextField;var bC=bI.Lang,aD=bC.isArray,bi=bC.isNumber,af=bC.isString,aw="boundingBox",b2="contentBox",a8="container",bw=".",aP="drag",bg="dragContainer",b4="dragContainerNode",ab="dragNodesList",ao="drop",aH="dropContainer",a2="dropContainerNode",bl="",a3="field",f="fields",bb="form-builder-field",u="form-builder-textarea-field",bT="id",p="icon",Z="label",ap="name",b9="node",aO="portalLayout",a6="predefinedValue",a4="proxy",al="size",O=" ",ba="template",bK="templateNode",bo="text",bt="textarea",m="value",v=bI.getClassName,b=v(a3),a7=v(a3,bo),bO=v(a3,bt),br=v(bb),P=v(bb,b9),bv=v(bm,x),bD='<textarea id="{id}" class="'+[P,b,a7,bO].join(O)+'" name="{name}">{value}</textarea>';var au=bI.Component.create({NAME:u,ATTRS:{template:{valueFn:function(){return bD;}},templateNode:{valueFn:"getNode"}},UI_ATTRS:[c,a6,Z,ap,bM],CSS_PREFIX:br,HTML_PARSER:{templateNode:bw+P},EXTENDS:bI.FormBuilderField,prototype:{bindUI:function(){var A=this;bI.FormBuilderTextAreaField.superclass.bindUI.apply(A,arguments);var L=A.get(bK);L.on({"keyup":bI.bind(A._onValueKeyUp,A)});},getHTML:function(){var A=this;var L=A.get(ba);var cf=A.get(bT);var cc=A.get(Z);var cb=A.get(ap);var cd=A.get(al);var ce=A.get(a6);return bI.substitute(L,{id:cf,label:cc,name:cb,value:ce});},getNode:function(){var A=this;return bI.Node.create(A.getHTML());},renderSettings:function(){var A=this;var L=A.get(aN);var cb=L.get(ai);bI.FormBuilderTextAreaField.superclass.renderSettings.apply(A,arguments);if(!A._renderedTextareaSettings){A._renderedTextareaSettings=true;var cc=cb.one("input[name=predefinedValue]");cc.on({"keyup":bI.bind(A._onValueKeyUp,A)});}},_onValueKeyUp:function(L){var A=this;var cb=L.target;A.set(a6,cb.val());},_uiSetPredefinedValue:function(ce){var A=this;var cb=A.get(aN);var cc=cb.get(ai);var cd=cc.one("input[name=predefinedValue]");var L=A.get(bK);L.val(ce);if(cd&&A.get(aV)){cd.val(ce);}}}});bI.FormBuilderTextAreaField=au;bI.FormBuilder.types["textarea"]=bI.FormBuilderTextAreaField;},"@VERSION@",{requires:["aui-datatype","aui-form","aui-panel","io","substitute"],skinnable:true});AUI.add("aui-form-builder",function(a){},"@VERSION@",{skinnable:true,use:["aui-form-builder-base","aui-form-builder-field"]});