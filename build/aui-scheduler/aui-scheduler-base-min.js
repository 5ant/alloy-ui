AUI.add("aui-scheduler-base",function(AI){var u=AI.Lang,Af=u.isString,g=u.isObject,C=u.isArray,G=u.isDate,o=u.isNumber,Y=function(A){return(A instanceof AI.SchedulerView);},AF=function(A){return(A instanceof AI.SchedulerEvent);},a=function(A){return(AI.SchedulerCalendar&&(A instanceof AI.SchedulerCalendar));},L=AI.DataType.DateMath,AB=AI.WidgetStdMod,Ad="-",z=".",T="",U=" ",W="scheduler-base",AO="data-view-name",m="activeView",S="boundingBox",Ae="clearfix",l="controls",AQ="controlsNode",AT="current",AH="currentDate",AD="currentDateNode",AP="date",AG="dateFormat",AZ="day",AN="endDate",Ag="events",i="firstDayOfWeek",Al="hd",Ac="headerNode",Q="helper",x="icon",N="iconNextNode",AY="iconPrevNode",Aj="locale",I="month",P="name",v="nav",r="navNode",R="next",F="nextDate",Ab="prev",AR="prevDate",Ak="rendered",q="scheduler",AU="srcNode",Ai="startDate",j="strings",AW="template",H="today",AJ="todayNode",b="triggerNode",e="view",Am="views",AC="viewsNode",t="week",X="year",AX="navigationDateFormat",s="eventRecorder",f=AI.ClassNameManager.getClassName,AK=f(Q,Ae),M=f(x),AV=f(W,l),y=f(W,AT,AP),K=f(W,Al),AA=f(W,x,R),h=f(W,x,Ab),Ah=f(W,v),d=f(W,H),AE=f(W,e),V=f(W,Am),J=f(W,e,T),Z=f(W,e,AZ),B=f(W,e,I),D=f(W,e,t),AM=f(W,e,X),k=f(q,e,T),AS='<div class="'+AV+'"></div>',c='<div class="'+y+'"></div>',E='<div class="'+K+'"></div>',An='<a href="#" class="'+[M,AA].join(U)+'">Next</a>',AL='<a href="#" class="'+[M,h].join(U)+'">Prev</a>',O='<div class="'+Ah+'"></div>',w='<a href="#" class="'+d+'">{today}</a>',Aa='<a href="#" class="'+[AE,J].join(U)+'{name}" data-view-name="{name}">{label}</a>',p='<div class="'+V+'"></div>';var n=AI.Component.create({NAME:W,ATTRS:{activeView:{validator:Y},eventRecorder:{setter:"_setEventRecorder"},events:{value:[],setter:"_setEvents",validator:C},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(Ap){var A=this;var Ao=A.get(m);if(Ao){return Ao.get(AX);}return Ap;},value:"%A - %d %b %Y",validator:Af},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:G},firstDayOfWeek:{value:0,validator:o},controlsNode:{valueFn:function(){return AI.Node.create(AS);}},currentDateNode:{valueFn:function(){return AI.Node.create(c);}},headerNode:{valueFn:function(){return AI.Node.create(E);}},iconNextNode:{valueFn:function(){return AI.Node.create(An);}},iconPrevNode:{valueFn:function(){return AI.Node.create(AL);}},navNode:{valueFn:function(){return AI.Node.create(O);}},todayNode:{valueFn:function(){return AI.Node.create(this._processTemplate(w));}},viewsNode:{valueFn:function(){return AI.Node.create(p);}}},HTML_PARSER:{controlsNode:z+AV,currentDateNode:z+y,headerNode:z+K,iconNextNode:z+AA,iconPrevNode:z+h,navNode:z+Ah,todayNode:z+d,viewsNode:z+V},UI_ATTRS:[AH],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(AQ);A.currentDateNode=A.get(AD);A.iconNextNode=A.get(N);A.iconPrevNode=A.get(AY);A.navNode=A.get(r);A.schedulerHeaderNode=A.get(Ac);A.todayNode=A.get(AJ);A.viewsNode=A.get(AC);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},addEvent:function(Ao){var A=this;var Ap=A.get(Ag);if(AI.Array.indexOf(Ap,Ao)>-1){AI.Array.removeItem(Ap,Ao);}Ap.push(Ao);A.set(Ag,Ap);},addEvents:function(Ao){var A=this;AI.Array.each(A._normalizeEvents(Ao),AI.bind(A.addEvent,A));},removeEvent:function(Ao){var A=this;var Ap=A.get(Ag);AI.Array.removeItem(Ap,Ao);A.set(Ag,Ap);},removeEvents:function(Ao){var A=this;AI.Array.each(A._normalizeEvents(Ao),AI.bind(A.removeEvent,A));},flushEvents:function(){var A=this;AI.Array.each(A.get(Ag),function(Ao,Ap){Ao.eachRepeatedEvent(function(Ar,Aq){delete Ar._filtered;});delete Ao._filtered;});},getEventsByDay:function(Ao){var A=this;Ao=L.safeClearTime(Ao);return A._getEvents(Ao,function(Ap){return L.compare(Ap.getClearStartDate(),Ao);});},getIntersectEvents:function(Ao){var A=this;Ao=L.safeClearTime(Ao);return A._getEvents(Ao,function(Aq){var Ap=Aq.getClearStartDate();var Ar=Aq.getClearEndDate();return(L.compare(Ao,Ap)||L.compare(Ao,Ar)||L.between(Ao,Ap,Ar));});},sortEventsByDateAsc:function(Ao){var A=this;Ao.sort(function(As,Aq){var Ar=As.get(AN);var Ap=Aq.get(AN);var Au=As.get(Ai);var At=Aq.get(Ai);if(L.after(Au,At)||L.compare(Au,At)&&L.before(Ar,Ap)){return 1;}else{return -1;}});},getViewByName:function(Ao){var A=this;return A.viewStack[Ao];},getStrings:function(){var A=this;return A.get(j);},getString:function(Ao){var A=this;return A.getStrings()[Ao];},renderView:function(Ao){var A=this;if(Ao){Ao.show();if(!Ao.get(Ak)){var Ap=Ao.get(P);if(!A.bodyNode){A.setStdModContent(AB.BODY,T);}Ao.render(A.bodyNode);}}},plotViewEvents:function(Ao){var A=this;Ao.plotEvents(A.get(Ag));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(m));},_afterActiveViewChange:function(Aq){var Ao=this;if(Ao.get(Ak)){var Ap=Aq.newVal;var A=Aq.prevVal;if(A){A.hide();}Ao.renderView(Ap);}},_afterRender:function(Ao){var A=this;A.renderView(A.get(m));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,z+AE,A);A.controlsNode.delegate("click",A._onClickPrevIcon,z+h,A);A.controlsNode.delegate("click",A._onClickNextIcon,z+AA,A);A.controlsNode.delegate("click",A._onClickToday,z+d,A);},_createViewTriggerNode:function(Ao){var A=this;if(!Ao.get(b)){var Ap=Ao.get(P);Ao.set(b,AI.Node.create(AI.substitute(Aa,{name:Ap,label:(A.getString(Ap)||Ap)})));}return Ao.get(b);},_getEvents:function(Ao,Aq){var A=this;var Ap=A.get(Ag);var Ar=[];AI.Array.each(Ap,function(As,At){if(Aq.apply(A,[As])){Ar.push(As);}else{if(As.isRepeatableDate(Ao)){var Au=As.repeatByDate(Ao);Ar.push(Au);}}});A.sortEventsByDateAsc(Ar);return Ar;},_normalizeEvents:function(Ap){var A=this;var Ao=[];Ap=AI.Array(Ap);AI.Array.each(Ap,function(Aq,Ar){if(AF(Aq)){Ao.push(Aq);}else{if(a(Aq)){Ao=Ao.concat(A._normalizeEvents(Aq.get(Ag)));}else{Ao.push(new AI.SchedulerEvent(Aq));
}}});return Ao;},_onClickToday:function(Ao){var A=this;A.set(AH,A.get(m).getToday());Ao.preventDefault();},_onClickNextIcon:function(Ao){var A=this;A.set(AH,A.get(m).get(F));Ao.preventDefault();},_onClickPrevIcon:function(Ao){var A=this;A.set(AH,A.get(m).get(AR));Ao.preventDefault();},_onClickViewTrigger:function(Ap){var A=this;var Aq=Ap.currentTarget;var Ar=Aq.attr(AO);var Ao=A.getViewByName(Ar);A.set(m,Ao);Ap.preventDefault();},_processTemplate:function(Ao){var A=this;return AI.substitute(Ao,A.getStrings());},_setEventRecorder:function(Ao){var A=this;if(Ao){Ao.set(q,A);}},_setEvents:function(Ao){var A=this;return A._normalizeEvents(Ao);},_setViews:function(Ap){var A=this;var Ao=[];AI.Array.each(Ap,function(Aq){if(Y(Aq)&&!Aq.get(Ak)){Aq.set(q,A);Ao.push(Aq);A.viewStack[Aq.get(P)]=Aq;}});if(!A.get(m)){A.set(m,Ap[0]);}return Ao;},syncStdContent:function(){var A=this;var Ao=A.get(Am);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);AI.Array.each(Ao,function(Ap){A.viewsNode.append(A._createViewTriggerNode(Ap));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(AK);A.setStdModContent(AB.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(As){var Ap=this;var Ao=Ap.get(AX);var A=Ap.get(Aj);var Ar=AI.DataType.Date.format(As,{format:Ao,locale:A});Ap.currentDateNode.html(Ar);if(Ap.get(Ak)){var Aq=Ap.get(m);if(Aq){Aq._uiSetCurrentDate(As);}Ap.syncEventsUI();}}}});AI.Scheduler=AI.Base.create(W,n,[AI.WidgetStdMod]);},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});