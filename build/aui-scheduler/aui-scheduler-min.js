AUI.add("aui-scheduler-base",function(AH){var t=AH.Lang,Ae=t.isString,f=t.isObject,C=t.isArray,G=t.isDate,n=t.isNumber,Y=function(A){return(A instanceof AH.SchedulerView);},AE=function(A){return(A instanceof AH.SchedulerEvent);},L=AH.DataType.DateMath,AA=AH.WidgetStdMod,Ac="-",y=".",T="",U=" ",W="scheduler-base",AN="data-view-name",l="activeView",S="boundingBox",Ad="clearfix",k="controls",AP="controlsNode",AS="current",AG="currentDate",AC="currentDateNode",AO="date",AF="dateFormat",AY="day",AM="endDate",Af="events",h="firstDayOfWeek",Ak="hd",Ab="headerNode",Q="helper",w="icon",N="iconNextNode",AX="iconPrevNode",Ai="locale",I="month",P="name",u="nav",q="navNode",R="next",F="nextDate",Aa="prev",AQ="prevDate",Aj="rendered",p="scheduler",AT="srcNode",Ag="startDate",i="strings",AV="template",H="today",AI="todayNode",a="triggerNode",d="view",Al="views",AB="viewsNode",s="week",X="year",AW="navigationDateFormat",r="eventRecorder",e=AH.ClassNameManager.getClassName,AJ=e(Q,Ad),M=e(w),AU=e(W,k),x=e(W,AS,AO),K=e(W,Ak),z=e(W,w,R),g=e(W,w,Aa),Ah=e(W,u),c=e(W,H),AD=e(W,d),V=e(W,Al),J=e(W,d,T),Z=e(W,d,AY),B=e(W,d,I),D=e(W,d,s),AL=e(W,d,X),j=e(p,d,T),AR='<div class="'+AU+'"></div>',b='<div class="'+x+'"></div>',E='<div class="'+K+'"></div>',Am='<a href="#" class="'+[M,z].join(U)+'">Next</a>',AK='<a href="#" class="'+[M,g].join(U)+'">Prev</a>',O='<div class="'+Ah+'"></div>',v='<a href="#" class="'+c+'">{today}</a>',AZ='<a href="#" class="'+[AD,J].join(U)+'{name}" data-view-name="{name}">{label}</a>',o='<div class="'+V+'"></div>';var m=AH.Component.create({NAME:W,ATTRS:{activeView:{validator:Y},eventRecorder:{setter:"_setEventRecorder"},events:{value:[],setter:"_setEvents",validator:C},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(Ao){var A=this;var An=A.get(l);if(An){return An.get(AW);}return Ao;},value:"%A - %d %b %Y",validator:Ae},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:G},firstDayOfWeek:{value:0,validator:n},controlsNode:{valueFn:function(){return AH.Node.create(AR);}},currentDateNode:{valueFn:function(){return AH.Node.create(b);}},headerNode:{valueFn:function(){return AH.Node.create(E);}},iconNextNode:{valueFn:function(){return AH.Node.create(Am);}},iconPrevNode:{valueFn:function(){return AH.Node.create(AK);}},navNode:{valueFn:function(){return AH.Node.create(O);}},todayNode:{valueFn:function(){return AH.Node.create(this._processTemplate(v));}},viewsNode:{valueFn:function(){return AH.Node.create(o);}}},HTML_PARSER:{controlsNode:y+AU,currentDateNode:y+x,headerNode:y+K,iconNextNode:y+z,iconPrevNode:y+g,navNode:y+Ah,todayNode:y+c,viewsNode:y+V},UI_ATTRS:[AG],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(AP);A.currentDateNode=A.get(AC);A.iconNextNode=A.get(N);A.iconPrevNode=A.get(AX);A.navNode=A.get(q);A.schedulerHeaderNode=A.get(Ab);A.todayNode=A.get(AI);A.viewsNode=A.get(AB);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},addEvent:function(An){var A=this;var Ao=A.get(Af);if(AH.Array.indexOf(Ao,An)>-1){AH.Array.removeItem(Ao,An);}Ao.push(An);A.set(Af,Ao);},removeEvent:function(An){var A=this;var Ao=A.get(Af);AH.Array.removeItem(Ao,An);A.set(Af,Ao);},flushEvents:function(){var A=this;AH.Array.each(A.get(Af),function(An,Ao){An.eachRepeatedEvent(function(Aq,Ap){delete Aq._filtered;});delete An._filtered;});},getEventsByDay:function(An){var A=this;An=L.safeClearTime(An);return A._getEvents(An,function(Ao){return L.compare(Ao.getClearStartDate(),An);});},getIntersectEvents:function(An){var A=this;An=L.safeClearTime(An);return A._getEvents(An,function(Ap){var Ao=Ap.getClearStartDate();var Aq=Ap.getClearEndDate();return(L.compare(An,Ao)||L.compare(An,Aq)||L.between(An,Ao,Aq));});},sortEventsByDateAsc:function(An){var A=this;An.sort(function(Ar,Ap){var Aq=Ar.get(AM);var Ao=Ap.get(AM);var At=Ar.get(Ag);var As=Ap.get(Ag);if(L.after(At,As)||L.compare(At,As)&&L.before(Aq,Ao)){return 1;}else{return -1;}});},getViewByName:function(An){var A=this;return A.viewStack[An];},getStrings:function(){var A=this;return A.get(i);},getString:function(An){var A=this;return A.getStrings()[An];},renderView:function(An){var A=this;if(An){An.show();if(!An.get(Aj)){var Ao=An.get(P);if(!A.bodyNode){A.setStdModContent(AA.BODY,T);}An.render(A.bodyNode);}}},plotViewEvents:function(An){var A=this;An.plotEvents(A.get(Af));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(l));},_afterActiveViewChange:function(Ap){var An=this;if(An.get(Aj)){var Ao=Ap.newVal;var A=Ap.prevVal;if(A){A.hide();}An.renderView(Ao);}},_afterRender:function(An){var A=this;A.renderView(A.get(l));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,y+AD,A);A.controlsNode.delegate("click",A._onClickPrevIcon,y+g,A);A.controlsNode.delegate("click",A._onClickNextIcon,y+z,A);A.controlsNode.delegate("click",A._onClickToday,y+c,A);},_createViewTriggerNode:function(An){var A=this;if(!An.get(a)){var Ao=An.get(P);An.set(a,AH.Node.create(AH.substitute(AZ,{name:Ao,label:(A.getString(Ao)||Ao)})));}return An.get(a);},_getEvents:function(An,Ap){var A=this;var Ao=A.get(Af);var Aq=[];AH.Array.each(Ao,function(Ar,As){if(Ap.apply(A,[Ar])){Aq.push(Ar);}else{if(Ar.isRepeatableDate(An)){var At=Ar.repeatByDate(An);Aq.push(At);}}});A.sortEventsByDateAsc(Aq);return Aq;},_onClickToday:function(An){var A=this;A.set(AG,A.get(l).getToday());An.preventDefault();},_onClickNextIcon:function(An){var A=this;A.set(AG,A.get(l).get(F));An.preventDefault();},_onClickPrevIcon:function(An){var A=this;A.set(AG,A.get(l).get(AQ));An.preventDefault();},_onClickViewTrigger:function(Ao){var A=this;var Ap=Ao.currentTarget;var Aq=Ap.attr(AN);var An=A.getViewByName(Aq);A.set(l,An);Ao.preventDefault();},_processTemplate:function(An){var A=this;return AH.substitute(An,A.getStrings());
},_setEventRecorder:function(An){var A=this;if(An){An.set(p,A);}},_setEvents:function(Ao){var A=this;var An=[];AH.Array.each(Ao,function(Ap,Aq){if(!AE(Ap)){Ap=new AH.SchedulerEvent(Ap);}Ap.set(p,A);An.push(Ap);});return An;},_setViews:function(Ao){var A=this;var An=[];AH.Array.each(Ao,function(Ap){if(Y(Ap)&&!Ap.get(Aj)){Ap.set(p,A);An.push(Ap);A.viewStack[Ap.get(P)]=Ap;}});if(!A.get(l)){A.set(l,Ao[0]);}return An;},syncStdContent:function(){var A=this;var An=A.get(Al);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);AH.Array.each(An,function(Ao){A.viewsNode.append(A._createViewTriggerNode(Ao));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(AJ);A.setStdModContent(AA.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(Ar){var Ao=this;var An=Ao.get(AW);var A=Ao.get(Ai);var Aq=AH.DataType.Date.format(Ar,{format:An,locale:A});Ao.currentDateNode.html(Aq);if(Ao.get(Aj)){var Ap=Ao.get(l);if(Ap){Ap._uiSetCurrentDate(Ar);}Ao.syncEventsUI();}}}});AH.Scheduler=AH.Base.create(W,m,[AH.WidgetStdMod]);},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(B2){var CJ=B2.Lang,Ca=CJ.isObject,Br=CJ.isString,At=CJ.isBoolean,Af=CJ.isNumber,BD=function(A){return A==0?0:(A<0?-1:1);},Aj=function(A,AM){return Math.max(Math.abs(A),AM)*BD(A);},Be=function(A){return parseFloat(A)||0;},Bg=function(AM,A){return Math.round(AM/A)*A;},AQ=B2.DataType.DateMath,By=B2.WidgetStdMod,Ak=AQ.WEEK_LENGTH,Bi="scheduler-view",Ae="scheduler-view-day",B6="scheduler-view-week",CT="scheduler-view-month",Bd="activeView",A5="am",V="borderLeftWidth",CA="borderRightWidth",Ap="boundingBox",R="children",BV="childNodes",AF="col",h="colblank",Z="coldata",Ah="colday",B="colgrid",BQ="colmonth",v="colspan",N="coltime",CO="columnNode",AW="colDaysNode",B4="colHeaderDaysNode",An="container",Al="content",CQ="contentBox",AU="createDocumentFragment",BA="currentDate",BW="data",A9="dateFormat",CG="day",t="days",w="div",BI="division",AA="down",B8="dragNode",Bq="duration",AZ="endDate",A1="event",Bw="events",Cc="eventRecorder",T="eventWidth",Ag="first",B7="firstDayOfWeek",A7="grid",Cb="hd",B0="header",A8="headerDateFormat",CX="headerTableNode",Bl="height",Ao="host",Ad="hourHeight",W="icon",AJ="isoTime",BE="labelAM",Ab="labelPM",Aq="left",AX="locale",AB="marker",A3="markercell",Aw="markercellsNode",Bj="markercellNode",k="markers",Bb="month",A6="monthContainerNode",BZ="navigationDateFormat",Am="next",Bh="nextDate",Cd="node",AI="nomonth",AR="noscroll",Bz="offsetHeight",j="offsetTop",B1="offsetWidth",CE="ownerDocument",B3="pad",CL="parentEvent",q="parentNode",AN="pm",z="prevDate",BP="proxy",AG="px",Ar="rendered",Bx="repeated",Ax="right",BN="row",S="scheduler",Ac="scheduler-event",x="scrollable",s="shim",B5="startDate",As="table",CR="tableColNode",K="tableDataNode",d="tableGridNode",BT="tableNode",Bs="tableTimeNode",BR="tbody",F="td",BK="time",AH="timesNode",H="title",AK="today",BO="top",CY="tr",a="trigger",CM="week",BX="width",Bf="-",L="a",Bk=".",Bc="",BY="%",u=" ",e=B2.ClassNameManager.getClassName,BJ=e(Bi,AR),AC=e(Bi,x);var Av=B2.Component.create({NAME:Bi,ATTRS:{bodyContent:{value:Bc},height:{value:600},isoTime:{value:false,validator:At},name:{value:Bc,validator:Br},navigationDateFormat:{value:"%A - %d %b %Y",validator:Br},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:At},triggerNode:{setter:B2.one},visible:{value:false}},BIND_UI_ATTRS:[x],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);Ce.set(BA,AM);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return AQ.clearTime(new Date());},limitDate:function(AM,Ce){var A=this;if(AQ.after(AM,Ce)){AM=AQ.clone(Ce);}return AM;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(Ce){var A=this;var AM=A.get(S);A.adjustCurrentDate();A._uiSetScrollable(A.get(x));},_setScheduler:function(Ce){var A=this;var AM=A.get(S);if(AM){A.removeTarget(AM);}if(Ce){A.addTarget(Ce);Ce.after("eventsChange",B2.bind(A.flushViewCache,A));}return Ce;},_uiSetScrollable:function(Ce){var A=this;var AM=A.bodyNode;if(AM){AM.toggleClass(AC,Ce);AM.toggleClass(BJ,!Ce);}},_uiSetVisible:function(AM){var A=this;Av.superclass._uiSetVisible.apply(this,arguments);if(AM&&A.get(Ar)){A.adjustCurrentDate();}}}});B2.SchedulerView=B2.Base.create(Bi,Av,[B2.WidgetStdMod]);var n=function(A,AM){return function(Cf){var Ce=Cf.all(A);return(Ce.size()>=AM)?Ce:null;};},Ai=e(Ac),Bn=e(Ac,BP),b=e(Bi,Z),D=e(Bi,B),p=e(S,AK),AP=e(S,AK,Cb),CB=e(Bi,A7),CC=e(Bi,A7,An),CF=e(Bi,A3),l=e(Bi,k),BH=e(Bi,AB,BI),BU=e(Bi,As),CI=e(Bi,CG,B0,As),U=e(Bi,CG,B0,CG),BG=e(Bi,CG,B0,CG,B3,Ax),Bp=e(Bi,CG,B0,CG,Ag),A0=e(Bi,CG,B0,AF),CV=e(Bi,As,AF),Aa=e(Bi,As,AF,s),o=e(Bi,As,h),g=e(Bi,As,Ah),O=e(Bi,As,Ah,B0),CN=e(Bi,As,N),BM=e(Bi,As,BK),AD='<div class="'+CF+'">'+'<div class="'+BH+'"></div>'+"</div>",AT='<table class="'+BU+'">'+"<tbody>"+'<tr class="'+D+'" height="1">'+'<td height="0" class="'+[CV,o].join(u)+'"></td>'+'<td class="'+CC+'" colspan="1">'+'<div class="'+CB+'">'+'<div class="'+l+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+b+'">'+'<td class="'+[CV,CN].join(u)+'"></td>'+"</tr>"+"</tbody>"+"</table>",BC='<td class="'+[CV,g].join(u)+'">'+'<div class="'+Aa+'"></div>'+"</td>",J='<div class="'+BM+'">{hour}</div>',AV='<table class="'+CI+'">'+"<tbody>"+'<tr class="'+A0+'"></tr>'+"</tbody>"+"</table>",BF='<th class="'+U+'"><a href="#">&nbsp;</a></th>',AS='<td class="'+[U,Bp].join(u)+'"></td>',X='<th class="'+[U,BG].join(u)+'">&nbsp;</th>';
var CW=B2.Component.create({NAME:Ae,ATTRS:{bodyContent:{value:Bc},days:{value:1,validator:Af},headerDateFormat:{value:"%a %d/%m",validator:Br},name:{value:CG},hourHeight:{value:52,validator:Af},eventWidth:{value:95,validator:Af},headerTableNode:{valueFn:function(){return B2.Node.create(AV);}},tableNode:{valueFn:function(){return B2.Node.create(AT);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:n(Bk+U,2),colDaysNode:n(Bk+g,1),markercellsNode:n(Bk+CF,24),timesNode:n(Bk+BM,24),headerTableNode:Bk+CI,tableNode:Bk+BU},EXTENDS:B2.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(AW);A.colHeaderDaysNode=A.get(B4);A.headerTableNode=A.get(CX);A.markercellsNode=A.get(Aw);A.tableNode=A.get(BT);A.timesNode=A.get(AH);A.colShimNodes=A.colDaysNode.all(Bk+Aa);A.colDataNode=A.tableNode.one(Bk+b);A.colTimeNode=A.tableNode.one(Bk+CN);A.dayHeaderColNode=A.headerTableNode.one(Bk+A0);A.gridContainer=A.tableNode.one(Bk+CC);A.markersNode=A.tableNode.one(Bk+l);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",B2.bind(A._onClickDaysHeader,A),Bk+U);A.colDataNode.delegate("mousedown",B2.bind(A._onMouseDownTableCol,A),Bk+CV);A.colDataNode.delegate("mouseup",B2.bind(A._onMouseUpTableCol,A),Bk+CV);A.colDataNode.delegate("mousemove",B2.bind(A._onMouseMoveTableCol,A),Bk+CV);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;CW.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(v,A.get(t));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(By.BODY,A.tableNode.getDOM());A.setStdModContent(By.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(Cf){var AM=this;var A=AM.get(Ad);var Ce=Cf.getHours();var Cg=Cf.getMinutes();var Ch=Cf.getSeconds();return((Ce*60)+Cg+(Ch/60))*(A/60);},calculateHoursByTop:function(Cg){var AM=this;var A=AM.get(Ad);var Ci=Be((Cg/A).toFixed(2));var Ch=0;var Cf=Math.floor((Ci*100)%100*0.6);var Ce=Math.floor(Ci);return[Ce,Cf,Ch];},getNextDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);return AQ.add(AM,AQ.DAY,1);},getPrevDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);return AQ.subtract(AM,AQ.DAY,1);},getColumnByDate:function(Ce){var A=this;var Cf=A.get(S);var AM=AQ.safeClearTime(Cf.get(BA));var Cg=AQ.getDayOffset(AQ.safeClearTime(Ce),AM);return A.colDaysNode.item(Cg);},getDateByColumn:function(Ce){var A=this;var Cf=A.get(S);var AM=AQ.safeClearTime(Cf.get(BA));return AQ.add(AM,AQ.DAY,Ce);},plotEvents:function(Ce){var A=this;var AM=A.get(S);A.colShimNodes.each(function(Ci,Ch){var Cg=A.getDateByColumn(Ch);var Cf=AM.getEventsByDay(Cg);Ci.empty();B2.Array.each(Cf,function(Cj,Ck){if(!Cj.isDayOverlapEvent()){Ci.append(Cj.get(Cd));Cj.set(CO,Ci.get(q));A.syncEventTopUI(Cj);A.syncEventHeightUI(Cj);}});A.syncEventsIntersectionUI(Cf);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(Cf,Ce){var AM=A.getDateByColumn(Ce);Cf.toggleClass(p,AQ.isToday(AM));});},syncDaysHeaderUI:function(){var Ce=this;var Cg=Ce.get(S);var Cf=Cg.get(BA);var AM=Ce.get(A8);var A=Ce.get(AX);Ce.colHeaderDaysNode.all(L).each(function(Cj,Ci){var Ch=AQ.add(Cf,AQ.DAY,Ci);var Ck=B2.DataType.Date.format(Ch,{format:AM,locale:A});Cj.toggleClass(AP,AQ.isToday(Ch));Cj.html(Ck);});},syncEventsIntersectionUI:function(AM){var A=this;var Ce=A.get(S);var Cf=A.get(T);Ce.flushEvents();B2.Array.each(AM,function(Ch,Ci){var Ck=A.findEventIntersections(Ch,AM);var Cj=Ck.length;var Cg=(Cf/Cj);B2.Array.each(Ck,function(Cm,Cn){var Cl=Cm.get(Cd);var Cp=Cg*Cn;var Co=Cg*1.7;if(Cn==(Cj-1)){Co=Cf-Cp;}Cl.setStyle(BX,Co+BY);Cl.setStyle(Aq,Cp+BY);var Cq=Cl.get(q);if(Cq){Cq.insert(Cl,Cn);}Cm._filtered=true;});});},syncEventHeightUI:function(Ce){var AM=this;var A=AM.get(Ad);var Cg=AM.calculateTopByDate(Ce.get(B5));var Cf=AM.calculateTopByDate(Ce.get(AZ));Ce.get(Cd).set(Bz,Math.max(Cf-Cg,A/2));},syncEventRecorderUI:function(Cf){var A=this;var Ce=A.get(S);var Cg=Ce.get(Cc);var AM=Cg.get(Cd);if(Cf&&!AM.inDoc()){Cf.append(AM);}A.syncEventTopUI(Cg);A.syncEventHeightUI(Cg);},syncEventTopUI:function(Ce){var AM=this;var A=Ce.get(Cd);var Cf=AM.calculateTopByDate(Ce.get(B5));A.setStyle(BO,Cf+AG);},findEventIntersections:function(AM,Ce){var A=this;var Cf=[];B2.Array.each(Ce,function(Ch,Cg){if(!AM._filtered&&!Ch.isDayOverlapEvent()&&AM.intersectHours(Ch)){Cf.push(Ch);}});return Cf;},_createEvents:function(){var A=this;var AM=function(Ce,Cf){A.publish(Ce,{defaultFn:Cf,queuable:false,emitFacade:true,bubbles:true,prefix:Bi});};},_dragTickAlignX:function(AM){var Cm=this;var Cn=AM.target.get(Ao);var Co=Cm._getColumnRefWidth();var Cg=Cn.get(Cd);var Cj=Cm.proxyEvt;var Ck=Cg.getData(Ac);var Cl=(Cn.actXY[0]-Cm.bodyNode.getX()-Cm.colTimeNode.get(B1));var Ce=Math.floor(Cl/Co);var Ci=Cm.colDaysNode.item(Ce);var Ch=Cm.getDateByColumn(Ce);var A=AQ.clone(Ch);var Cf=AQ.clone(Ch);AQ.copyHours(Cf,Cj.get(AZ));AQ.copyHours(A,Cj.get(B5));Cj.set(AZ,Cf);Cj.set(B5,A);},_dragTickAlignY:function(Ce){var Cj=this;var Ck=Ce.target.get(Ao);var Cg=Ck.get(Cd);var Ch=Cj.proxyEvt;var Ci=Cg.getData(Ac);var AM=AQ.clone(Ch.get(B5));var A=Cj.calculateHoursByTop(Be(Ck.get(B8).getComputedStyle(BO)));Cj._setTickedHours(AM,A);var Cf=AQ.clone(AM);Ch.set(AZ,AQ.add(Cf,AQ.MINUTES,Cj._currentEvtDuration));Ch.set(B5,AM);Ch.syncNodeTitleUI();},_getXYDelta:function(AM){var A=this;var Cf=AM.currentTarget;var Ce=Cf.getXY(),Cg=[AM.pageX,AM.pageY];return B2.Array.map(Ce,function(Ci,Ch){return(Cg[Ch]-Ci);});},_getTickY:function(){var A=this;return Bg(Math.ceil(A.get(Ad)/2),10);
},_getColumnRefWidth:function(){var A=this;var AM=A.colDaysNode.item(0);return Be(AM.getStyle(BX))-Be(AM.getStyle(CA))-Be(AM.getStyle(V));},_setupDragDrop:function(){var Ce=this;var Cf=Ce.get(Ap);if(!Ce.proxyEvt){var Cg=Ce.get(S);Ce.proxyEvt=new B2.SchedulerEvent({scheduler:Cg});Ce.proxyEvt.removeTarget(Cg);Ce.proxyEvt.get(Cd).addClass(Bn);}if(!Ce.delegate){Ce.delegate=new B2.DD.Delegate({bubbleTargets:Ce,container:Cf,nodes:Bk+Ai});}var AM=Ce.delegate.dd;var Ch=Ce.proxyEvt;var Ci=Ce.get(Ad)/2;var A=Ce._getColumnRefWidth();AM.unplug(B2.Plugin.DDConstrained);AM.unplug(B2.Plugin.DDNodeScroll);AM.plug(B2.Plugin.DDConstrained,{bubbleTargets:Ce,constrain:Ce.bodyNode,tickX:A,tickY:Ci});AM.plug(B2.Plugin.DDNodeScroll,{node:Ce.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(AM){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(Cf){var A=this;var Ce=A.get(S);if(Cf.target.test(L)){var Cg=Ce.getViewByName(CG);var AM=A.colHeaderDaysNode.indexOf(Cf.currentTarget)-1;if(Cg){Ce.set(BA,A.getDateByColumn(AM));Ce.set(Bd,Cg);}}Cf.preventDefault();},_onEventDragEnd:function(A){var Cj=this;var Cg=Cj.get(S);var Cf=Cj.get(Ap);var Ck=Cj.delegate.dd;var Ce=Ck.get(Cd);var Ch=Cj.proxyEvt;var AM=Ch.get(Cd);var Ci=Ce.getData(Ac);Ce.show();AM.hide();Cf.selectable();Ci.copyDates(Ch);Cg.syncEventsUI();},_onEventDragStart:function(A){var Cj=this;var Cg=Cj.get(Ap);var Ck=Cj.delegate.dd;var Cf=Ck.get(Cd);var Ch=Cj.proxyEvt;var Ci=Cf.getData(Ac);var Ce=Be(Cf.getComputedStyle(Aq));if(Ce){Ck.deltaXY[0]=(Ce+Be(Ck.deltaXY[0]));}if(Ci){var Cl=Ci.get(CO);var AM=Ch.get(Cd);Ck.set(B8,AM);Cl.append(AM);Ch.copyPropagateAttrValues(Ci);Cj.syncEventTopUI(Ch);Cj.syncEventHeightUI(Ch);AM.show();Cj._currentEvtDuration=Ci.getMinutesDuration();}Cf.hide();Cg.unselectable();},_onMouseDownTableCol:function(Cf){var A=this;var Ce=A.get(S);var Cg=Ce.get(Cc);if(Cg){Cg.hideOverlay();if(Cf.target.test(Bk+Aa)){var AM=A.colDaysNode.indexOf(Cf.currentTarget);A.dragXY=A.startXY=A._getXYDelta(Cf);A.ddStartDate=A.getDateByColumn(AM);A.ddEndDate=AQ.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=AQ.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);Cg.set(B5,A.ddStartDate);Cg.set(AZ,A.limitDate(Cg.get(AZ),A.ddMaxDate));Cf.halt();}}},_onMouseMoveTableCol:function(Cg){var A=this;var Cf=A.get(S);var Cj=Cf.get(Cc);var Ch=A.ddStartDate;if(Ch){A.dragXY=A._getXYDelta(Cg);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var Ci=AQ.getMinutesOffset(A.ddEndDate,Ch);if((A.dragXY[1]-A.startXY[1])>0){Ci=Aj(Ci,Cj.get(Bq));}var AM=A.limitDate(AQ.add(Ch,AQ.MINUTES,Ci),A.ddMaxDate);if(Ci>0){Cj.set(AZ,AM);}else{var Ce=Cj.get(AZ);Cj.set(B5,AM);Cj.set(AZ,Ce);}A.syncEventRecorderUI(Cg.currentTarget);}},_onMouseUpTableCol:function(Ce){var A=this;var AM=A.get(S);var Cf=AM.get(Cc);if(Cf){if(A.ddStartDate){A.syncEventRecorderUI(Ce.currentTarget);Cf.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(AM,Ce){var A=this;AM.setHours(Ce[0],Bg(Ce[1],A._getTickY()),Ce[2]);},_valueColDaysNode:function(){var A=this;var Ce=A.get(t);var AM=[];while(Ce--){AM.push(BC);}return B2.NodeList.create(AM.join(Bc));},_valueColHeaderDaysNode:function(){var A=this;var Ce=A.get(t);var AM=[];AM.push(AS);while(Ce--){AM.push(BF);}AM.push(X);return B2.NodeList.create(AM.join(Bc));},_valueMarkercellsNode:function(){var A=this;var AM=[];for(var Ce=0;Ce<=23;Ce++){AM.push(AD);}return B2.NodeList.create(AM.join(Bc));},_valueTimesNode:function(){var A=this;var Cf=A.get(AJ);var Ce=[];for(var AM=0;AM<=23;AM++){Ce.push(B2.substitute(J,{hour:Cf?AQ.toIsoTimeString(AM):AQ.toUsTimeString(AM,false,true)}));}return B2.NodeList.create(Ce.join(Bc));}}});B2.SchedulerDayView=CW;var AL=B2.Component.create({NAME:B6,ATTRS:{bodyContent:{value:Bc},days:{value:7},name:{value:CM}},EXTENDS:B2.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BA);var Ce=Cf.get(B7);Cf.set(BA,AQ.getFirstDayOfWeek(AM,Ce));},getNextDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);var Cf=A._firstDayOfWeek(AM);return AQ.add(Cf,AQ.WEEK,1);},getPrevDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);var Cf=A._firstDayOfWeek(AM);return AQ.subtract(Cf,AQ.WEEK,1);},getToday:function(){var A=this;var AM=AL.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(AM);},_firstDayOfWeek:function(Ce){var A=this;var Cf=A.get(S);var AM=Cf.get(B7);return AQ.getFirstDayOfWeek(Ce,AM);}}});B2.SchedulerWeekView=AL;var I=e(Bi,Bb,An),A2=e(Bi,Bb,B0,AF),Y=e(Bi,Bb,B0,CG),CS=e(Bi,Bb,B0,As),Bu=e(Bi,Bb,BN),AO=e(Bi,Bb,BN,An),G=e(W),M=e(W,"arrowstop-1-l"),CP=e(W,"arrowstop-1-r"),Bv=e(Bi,Bb,B),C=e(Bi,Bb,B,AK),P=e(Bi,Bb,B,Ag),Ba=e(Bi,Bb,As,BW),Ay=e(Bi,Bb,As,BW,Ag),Bt=e(Bi,Bb,As,BW,AF),B9=e(Bi,Bb,As,BW,AF,Ag),Az=e(Bi,Bb,As,BW,AF,AI),Au=e(Bi,Bb,As,BW,AF,H),r=e(Bi,Bb,As,BW,AF,H,AK),AE=e(Bi,Bb,As,BW,AF,H,Ag),c=e(Bi,Bb,As,BW,AF,H,Am),CU=e(Bi,Bb,As,BW,AF,H,AA),BL=e(Bi,Bb,As,BW,A1),E=e(Bi,Bb,As,BW,A1,Aq),Bm=e(Bi,Bb,As,BW,A1,Ax),Q=e(Bi,Bb,As,BW,A1,Bx),BB=e(Bi,Bb,As,A7),CK=e(Bi,Bb,As,A7,Ag),CZ=e(Bi,As,BQ,B0),f='<table class="'+CS+'">'+"<tbody>"+'<tr class="'+A2+'"></tr>'+"</tbody>"+"</table>",m='<th class="'+Y+'"><div>&nbsp;</div></th>',CH='<div class="'+I+'">'+'<div class="'+AO+'">'+'<div class="'+Bu+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+Bu+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+Bu+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+Bu+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+Bu+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+Bu+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",BS='<table cellspacing="0" cellpadding="0" class="'+BB+'">'+"<tbody>"+"<tr>"+'<td class="'+[Bv,P].join(u)+'">&nbsp;</td>'+'<td class="'+Bv+'">&nbsp;</td>'+'<td class="'+Bv+'">&nbsp;</td>'+'<td class="'+Bv+'">&nbsp;</td>'+'<td class="'+Bv+'">&nbsp;</td>'+'<td class="'+Bv+'">&nbsp;</td>'+'<td class="'+Bv+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",Bo='<table cellspacing="0" cellpadding="0" class="'+Ba+'">'+"<tbody></tbody>"+"</table>",CD="<tr></tr>",A4='<td class="'+Bt+'"><div></div></td>',y='<span class="'+[G,M].join(u)+'"></span>',i='<span class="'+[G,CP].join(u)+'"></span>';
var AY=B2.Component.create({NAME:CT,ATTRS:{bodyContent:{value:Bc},name:{value:Bb},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return B2.Node.create(CH);}},headerTableNode:{valueFn:function(){return B2.Node.create(f);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:n(Bk+BB,7),colHeaderDaysNode:n(Bk+Y,7),monthContainerNode:Bk+I,headerTableNode:Bk+CS},EXTENDS:B2.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var AM=A.get(S);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(B4);A.headerTableNode=A.get(CX);A.monthContainerNode=A.get(A6);A.tableGridNode=A.get(d);A.dayHeaderColNode=A.headerTableNode.one(Bk+A2);A.monthRows=A.monthContainerNode.all(Bk+Bu);A.tableGridCols=A.tableGridNode.all(F);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(Cf,Ce){var AM=A.tableGridNode.item(Ce);Cf.append(AM.toggleClass(CK,(Ce==0)));});},buildEventsTable:function(AM,Ci){var Co=this;var Cl=5;var Cf=AQ.clearTime(Co._findCurrentMonthEnd());var Cn=AQ.clearTime(Co._findCurrentMonthStart());var Ck=String(Cn.getTime()).concat(AM.getTime()).concat(Ci.getTime());var Cj=Co.evtDataTableStack[Ck];if(!Cj){Cj=B2.Node.create(Bo);var Cm=Cj.one(BR);var Cg=B2.Node.create(CD);Co.loopDates(AM,Ci,function(Cq,Cp){var Cr=B2.Node.create(A4);Cr.addClass(Au).toggleClass(AE,(Cp==0)).toggleClass(r,AQ.isToday(Cq)).toggleClass(c,AQ.isToday(AQ.subtract(Cq,AQ.DAY,1))).toggleClass(CU,AQ.isToday(AQ.subtract(Cq,AQ.WEEK,1)));if(AQ.before(Cq,Cn)||AQ.after(Cq,Cf)){Cr.addClass(Az);}Cg.append(Cr.setContent(Cq.getDate()));});Cm.append(Cg);for(var A=0;A<Cl;A++){var Ch=0;var Ce=B2.Node.create(CD);Co.loopDates(AM,Ci,function(Cu,Cs){if(Ch<=Cs){var Ct=Co.getIntersectEvents(Cu),Cq=Ct[A];var Cv=B2.Node.create(A4);if(Cq){var Cp=Cv.one(w);var Cr=Co._getEvtSplitInfo(Cq,AM,Ci);Cv.attr(v,Cr.colspan);Cp.addClass(BL).setContent(Co._getEvtLabel(Cq));if(Cr.left){Cp.addClass(E).prepend(y);}if(Cr.right){Cp.addClass(Bm).append(i);}if(Cq.get(CL)){Cp.addClass(Q);}Ch+=Cr.colspan;}else{Ch++;}Ce.append(Cv);}});Cm.append(Ce);}Co.evtDataTableStack[Ck]=Cj;}return Cj;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(AM){var A=this;var Cf=A.get(S);var Ce=String(AM.getTime());if(!A.evtDateStack[Ce]){A.evtDateStack[Ce]=Cf.getIntersectEvents(AM);}return A.evtDateStack[Ce];},loopDates:function(A,Cf,Ci,Cj,Ch){var Ck=this;var AM=AQ.clone(A);var Ce=Cf.getTime();for(var Cg=0;AM.getTime()<=Ce;Cg++){Ci.apply(Ck,[AM,Cg]);AM=AQ.add(AM,(Cj||AQ.DAY),(Ch||1));}},plotEvents:function(){var AM=this;var Ce=AM._findCurrentMonthStart();var A=AQ.safeClearTime(AM._findFirstDayOfWeek(Ce));AM.bodyNode.all(Bk+Ba).remove();AM.monthRows.each(function(Ci,Cg){var Cf=AQ.add(A,AQ.WEEK,Cg);var Cj=AQ.add(Cf,AQ.DAY,Ak-1);var Ch=AM.buildEventsTable(Cf,Cj);if(Cg==0){Ch.addClass(Ay);}Ci.append(Ch);});},syncStdContent:function(){var A=this;A.setStdModContent(By.BODY,A.monthContainerNode.getDOM());A.setStdModContent(By.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var Ck=this;var Ce=Ck.getToday();var AM=Ck.get(S);Ck.tableGridCols.removeClass(C);if(AQ.isSameMonth(Ce,AM.get(BA))){var A=AM.get(B7);var Ce=Ck.getToday();var Cg=Ck._findCurrentMonthStart();var Ci=Ck._findFirstDayOfWeek(Ce);var Cf=AQ.getWeekNumber(Ce,A)-AQ.getWeekNumber(Cg,A);var Cj=(Ce.getDate()-Ci.getDate());var Ch=Ck.tableGridNode.item(Cf).all(F).item(Cj);if(Ch){Ch.addClass(C);}}},adjustCurrentDate:function(){var A=this;var AM=A.get(S);AM.set(BA,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);return AQ.add(AM,AQ.MONTH,1);},getPrevDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);return AQ.subtract(AM,AQ.MONTH,1);},syncDaysHeaderUI:function(){var Ce=this;var Ch=Ce.get(S);var Cf=Ch.get(BA);var AM=Ce.get(A8);var A=Ce.get(AX);var Cg=Ce._findFirstDayOfWeek(Cf);Ce.colHeaderDaysNode.all(w).each(function(Ck,Cj){var Ci=AQ.add(Cg,AQ.DAY,Cj);var Cl=B2.DataType.Date.format(Ci,{format:AM,locale:A});Ck.html(Cl);});},_findCurrentMonthEnd:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);return AQ.findMonthEnd(AM);},_findCurrentMonthStart:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(BA);return AQ.findMonthStart(AM);},_findFirstDayOfWeek:function(Ce){var A=this;var Cf=A.get(S);var AM=Cf.get(B7);return AQ.getFirstDayOfWeek(Ce,AM);},_getEvtLabel:function(Ce){var AM=this;var Cf=Ce.get(AZ);var A=Ce.get(B5);return[A.getHours(),Bf,Cf.getHours(),u,Ce.get(Al)].join(Bc);},_getEvtSplitInfo:function(Cj,A,Ch){var Ck=this;var AM=Cj.getClearStartDate();var Ci=Cj.getClearEndDate();var Cg=Cj.getDaysDuration();var Cf={};var Ce=1;if(AQ.after(AM,A)){Ce=Math.min(Cg,Math.abs(AQ.getDayOffset(Ch,AM))+1);if(Ce>1){Cf.right=true;}}else{Ce=Math.abs(AQ.getDayOffset(Ci,A)+1);if(Ce>1){Cf.left=true;}}Cf.colspan=Math.min(Ce,Ak);if(Ce>=Ak){Cf.right=true;Cf.left=true;}return Cf;},_uiSetCurrentDate:function(AM){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(Ak,m);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(Ak,BS);},_valueNodeList:function(Cf,Ce){var A=this;var AM=[];while(Cf--){AM.push(Ce);}return B2.NodeList.create(AM.join(Bc));}}});B2.SchedulerMonthView=AY;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","substitute","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(AV){var AG=AV.Lang,A6=AG.isString,I=AG.isDate,Aw=AG.isFunction,l=AG.isObject,Ay=AG.isBoolean,v=AG.isNumber,An=AV.ColorUtil,O=AV.DataType.DateMath,At=AV.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),A3="-",AL=".",U="",V=" ",R="_",Aa="_propagateSet",q="activeView",BF="borderWidth",Aj="colorBrightnessFactor",A1="colorSaturationFactor",m="Change",As="color",AR="content",AB="contentNode",Ap="duration",Ad="endDate",A7="events",Ar="id",Al="isoTime",BE="locale",S="node",L="overlay",AX="parentEvent",BH="recorder",Ab="repeat",A5="repeated",p="repeatedEvents",AA="scheduler",AJ="scheduler-event",AK="scheduler-event-recorder",A9="startDate",Av="template",Ai="title",H="titleDateFormat",j="titleNode",AT="borderStyle",G="%H:%M",Au="%I:%M",h=AV.ClassNameManager.getClassName,W=h(AJ),AH=h(AJ,BH),Ae=h(AJ,AR),AN=h(AJ,A5),e=h(AJ,Ai),AY='<div class="'+W+'">'+'<div class="'+e+'"></div>'+'<div class="'+Ae+'"></div>'+"</div>";
var r=AV.Component.create({NAME:AJ,ATTRS:{borderStyle:{value:"solid",validator:A6},borderWidth:{value:"1px",validator:A6},colorBrightnessFactor:{value:0.75,validator:v},colorSaturationFactor:{value:1.5,validator:v},content:{value:"(no title)",validator:A6},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:A6},titleDateFormat:{getter:"_getTitleDateFormat",validator:A6},endDate:{valueFn:function(){var A=O.clone(this.get(A9));A.setHours(A.getHours()+1);return A;},validator:I},columnNode:{setter:AV.one},node:{valueFn:function(){return AV.Node.create(AY).setData(AJ,this);},setter:AV.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:I}},EXTENDS:AV.Base,PROPAGATE_ATTRS:[A9,Ad,AR,As,Aj,A1,AT,BF,H],prototype:{eventStack:null,initializer:function(){var A=this;var BC=A.get(S);A.eventStack={};A.nodeStack={};AV.Array.each(AV.SchedulerEvent.PROPAGATE_ATTRS,function(BD){A.after(BD+m,A._propagateAttrChange);});A.contentNode=BC.one(AL+Ae);A.titleNode=BC.one(AL+e);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(BC,BD){BC.destroy();});A.eventStack={};A.get(S).remove(true);},copyDates:function(BC){var A=this;A.set(Ad,O.clone(BC.get(Ad)));A.set(A9,O.clone(BC.get(A9)));},copyPropagateAttrValues:function(BC,BD){var A=this;A.copyDates(BC);AV.Array.each(AV.SchedulerEvent.PROPAGATE_ATTRS,function(BK){if(!(BK in (BD||{}))){var BL=BC.get(BK);if(!l(BL)){A.set(BK,BL);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return O.getDayOffset(A.get(Ad),A.get(A9));},getHoursDuration:function(){var A=this;return O.getHoursOffset(A.get(Ad),A.get(A9));},getMinutesDuration:function(){var A=this;return O.getMinutesOffset(A.get(Ad),A.get(A9));},getSecondsDuration:function(){var A=this;return O.getSecondsOffset(A.get(Ad),A.get(A9));},sameEndDate:function(BC){var A=this;return O.compare(A.get(Ad),BC.get(Ad));},sameStartDate:function(BC){var A=this;return O.compare(A.get(A9),BC.get(A9));},isAfter:function(BK){var BD=this;var BC=BD.get(A9);var A=BK.get(A9);return O.after(BC,A);},isBefore:function(BK){var BD=this;var BC=BD.get(A9);var A=BK.get(A9);return O.before(BC,A);},repeatByDate:function(BD){var A=this;var BK=A.uidByDate(BD);if(!A.eventStack[BK]){var BC=O.clone(BD);var BL=O.clone(BD);O.copyHours(BC,A.get(A9));O.copyHours(BL,A.get(Ad));var BM=new AV.SchedulerEvent({endDate:BL,parentEvent:A,scheduler:A.get(AA),startDate:BC});BM.copyPropagateAttrValues(A);A.eventStack[BK]=BM;}return A.eventStack[BK];},intersects:function(BK){var BD=this;var BL=BD.get(Ad);var BC=BD.get(A9);var A=BK.get(A9);return(BD.sameStartDate(BK)||O.between(A,BC,BL));},intersectHours:function(BD){var BC=this;var BL=BC.get(Ad);var A=BC.get(A9);var BK=O.clone(A);O.copyHours(BK,BD.get(A9));return(O.compare(A,BK)||O.between(BK,A,BL));},isDayOverlapEvent:function(){var A=this;return O.isDayOverlap(A.get(A9),A.get(Ad));},isRepeatableDate:function(BC){var A=this;var BD=A.get(Ab);return(BD&&BD.validate(A,BC));},getClearEndDate:function(){var A=this;return O.safeClearTime(A.get(Ad));},getClearStartDate:function(){var A=this;return O.safeClearTime(A.get(A9));},uidByDate:function(BC){var A=this;BC=I(BC)?O.safeClearTime(BC):A.getClearStartDate();return[AJ,BC.getTime()].join(R);},setContent:function(BD,BC){var A=this;A._setContent(AB,BD,BC);},setTitle:function(BD,BC){var A=this;A._setContent(j,BD,BC);},syncNodeUI:function(BC){var A=this;A.get(S).toggleClass(AN,!!(A.get(AX)));A.syncNodeColorUI(BC);A.syncNodeTitleUI(BC);A.syncNodeContentUI(BC);},syncNodeColorUI:function(BC){var A=this;var BD=A.get(S);var BK=A.getBorderColor();if(BD){BD.setStyles({borderWidth:A.get(BF),borderColor:BK,backgroundColor:A.get(As),borderStyle:A.get(AT)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:BK});}if(BC){A.eachRepeatedEvent(function(BL,BM){BL.syncNodeColorUI();});}},syncNodeContentUI:function(BC){var A=this;A.setContent(A.get(AR),BC);},syncNodeTitleUI:function(BC){var A=this;var BD=A._formatDate(A.get(A9));var BK=A._formatDate(A.get(Ad));A.setTitle([BD,BK].join(V+A3+V),BC);},eachRepeatedEvent:function(BC){var A=this;AV.each(A.eventStack,BC,A);},unlink:function(){var A=this;if(A.get(AX)){A.set(AX,null);}else{A.eachRepeatedEvent(function(BC,BD){BC.unlink();});}A.eventStack={};A.syncNodeUI();},_propagateAttrChange:function(BK){var A=this;var BD=BK.attrName;var BC=BK.newVal;A.eachRepeatedEvent(function(BL,BM){var BN=BL[Aa+At(BD)];if(BN){BN.apply(A,[BL,BD,BC]);}else{BL.set(BD,BK.newVal);}BL.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,BC,BK){var BD=O.clone(A.get(Ad));O.copyHours(BD,BK);A.set(Ad,BD);},_propagateSetStartDate:function(BC,BD,BK){var A=O.clone(BC.get(A9));O.copyHours(A,BK);BC.set(A9,A);},_setColor:function(BC){var A=this;A.hsbColor=An.rgb2hsb(An.getRGB(BC));A.borderColor=AV.clone(A.hsbColor);A.borderColor.b*=A.get(Aj);A.borderColor.s*=A.get(A1);A.borderColorRGB=An.hsb2rgb(A.borderColor);return BC;},_setContent:function(BD,BL,BC){var A=this;var BK=A[BD];if(BK){BK.setContent(BL);}if(BC){A.eachRepeatedEvent(function(BM,BN){BM[BD].setContent(BL);});}},_setRepeat:function(BC){var A=this;if(A6(BC)){BC=AV.SchedulerEventRepeat[BC];}return BC;},_setScheduler:function(BD){var A=this;var BC=A.get(AA);if(BC){A.removeTarget(BC);}A.addTarget(BD);return BD;},_formatDate:function(BD,BK){var BC=this;var A=BC.get(BE);BK=BK||BC.get(H);return AV.DataType.Date.format(BD,{format:BK,locale:A});},_getTitleDateFormat:function(BD){var A=this;if(!A6(BD)){var BC=A.get(AA);BD=(BC&&BC.get(q).get(Al))?G:Au;}return BD;}}});AV.SchedulerEvent=r;AV.SchedulerEventRepeat={dayly:{description:"Every day",validate:function(A,BC){return true;},value:"dayly"},monthly:{description:"Every month",validate:function(BC,BD){var BK=BC.get(Ad);var A=BC.get(A9);return(A.getDate()===BD.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,BC){return O.isMonWedOrFri(BC);
},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,BC){return O.isTueOrThu(BC);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,BC){return O.isWeekDay(BC);},value:"weekDays"},weekly:{description:"Every week",validate:function(BC,BD){var BK=BC.get(Ad);var A=BC.get(A9);return(A.getDay()===BC.getDay());},value:"weekly"}};var q="activeView",BB="bc",BA="bd",AM="bodyContent",T="boundingBox",AW="button",F="column",AR="content",AS="dateFormat",AP="dblclick",Aq="desc",AO="disk",BI="event",Ax="field",AZ="fieldset",AQ="form",AC="hint",AF="input",Al="isoTime",Ac="label",X="layout",Ah="menu",f="overlayContextPanel",P="pencil",Ab="repeat",Q="row",AA="scheduler",u="select",o="strings",B="tc",i="text",t="when",K="trigger",AD="auiSchedulerEventRecorderWhen",A2="auiSchedulerEventRecorderDesc",Ao="auiSchedulerEventRecorderSelect",d="auiSchedulerEventRecorderButtonRow",z="scheduler-event-recorder:cancel",b="scheduler-event-recorder:edit",AU="scheduler-event-recorder:save",A3="-",g="#",BJ=h(AJ,BH,L),A0=h(AJ,BH,AQ),Y=h(AQ),M=h(X,AR),A4=h(X,AZ),AI=h(X,AZ,BA),y=h(X,AZ,AR),c=h(X,"w100"),N=h(F),Af=h(F,AR),C=h(Ax),Z=h(Ax,Ah),Ag=h(Ax,u),A8=h(Ax,AR),E=h(Ax,Ac),Am=h(Ax,i),J=h(AW,Q),Az=h(Ax,AF),AE=h(Ax,AF,u),a=h(Ax,AF,i),Ak=h(AJ,BH,Ac,t),D=h(AJ,BH,Aq),n=h(AJ,BH,Ax,AC),x=h(AJ,BH,Ab),w=h(AJ,BH,AW,Q),k="<option></option>",BG='<form id="auiSchedulerEventRecorderForm" class="'+[A0,M,Y].join(V)+'">'+'<div class="'+[A4,c,N].join(V)+'">'+'<div class="'+[y,Af].join(V)+'aui-fieldset-content aui-column-content">'+'<div class="'+AI+'">'+'<span class="'+[C,Am].join(V)+'">'+'<span class="'+A8+'">'+'<label class="'+E+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+Ak+'"></span>'+"</span>"+"</span>"+'<span class="'+[C,Am].join(V)+'">'+'<span class="'+A8+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[Az,a,D].join(V)+'" size="30" type="text" />'+'<div class="'+n+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[C,Z,Ag].join(V)+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[Az,AE,x].join(V)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[C,J,w].join(V)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var s=AV.Component.create({NAME:AK,ATTRS:{content:{value:U},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:A6},event:{},strings:{value:{},setter:function(A){return AV.merge({save:"Save",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",when:"When","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat"},A||{});},validator:l},overlayContextPanel:{value:{},setter:function(BC){var A=this;var BD=AV.Node.create(AV.substitute(BG,A.get(o)));return AV.merge({align:{points:[BB,B]},anim:false,bodyContent:BD,hideOn:AP,trigger:A.get(S),visible:false,zIndex:9999},BC||{});}}},EXTENDS:AV.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.after("schedulerChange",A._afterSchedulerChange);A.on("startDateChange",A._onStartDateChange);A.get(S).addClass(AH);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(BC){var A=this;var BK=A.overlayDescNode.val();var BD=A.get(BI);if(!BD){BD=new AV.SchedulerEvent({endDate:A.get(Ad),scheduler:A.get(AA),startDate:A.get(A9)});BD.copyPropagateAttrValues(A,{content:true});}BD.set(Ab,A.overlaySelectNode.val());if(BK){BD.set(AR,BK);}return BD;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},loadFormValues:function(){var A=this;var BK=U;var BD=U;var BC=A.get(BI);if(BC){var BL=BC.get(Ab);if(BL){BK=BL.value;}BD=BC.get(AR);}A.overlaySelectNode.val(BK);A.overlayWhenNode.setContent(A._getWhenFormattedDt());setTimeout(function(){A.overlayDescNode.val(BD).selectText();},0);},_afterSchedulerChange:function(BK){var A=this;var BD=BK.newVal;var BC=BD.get(T);BC.delegate("click",AV.bind(A._onClickSchedulerEvent,A),AL+W);},_createEvents:function(){var A=this;var BC=function(BD,BK){A.publish(BD,{defaultFn:BK,queuable:false,emitFacade:true,bubbles:true,prefix:AK});};BC(AU,this._defSaveEventFn);BC(b,this._defEditEventFn);BC(z,this._defCancelEventFn);},_initOverlay:function(){var BC=this;var A=BC.get(o);BC.overlay=new AV.OverlayContextPanel(BC.get(f));var BK=BC.overlay;var BD=BK.get(T);var BL=BK.get(AM);BC.overlayButtonRowNode=BL.one(g+d);BC.overlayDescNode=BL.one(g+A2);BC.overlaySelectNode=BL.one(g+Ao);BC.overlayWhenNode=BL.one(g+AD);BC.overlaySaveBtn=new AV.ButtonItem({label:A.save,icon:AO,render:BC.overlayButtonRowNode,handler:{fn:BC._handleSaveEvent,context:BC}});BC.overlayEditBtn=new AV.ButtonItem({label:A.edit,icon:P,render:BC.overlayButtonRowNode,handler:{fn:BC._handleEditEvent,context:BC}});BC.overlayCancelBtn=new AV.ButtonItem({label:A.cancel,render:BC.overlayButtonRowNode,handler:{fn:BC._handleCancelEvent,context:BC}});AV.each(AV.SchedulerEventRepeat,function(BN,BM){BC.overlaySelectNode.append(AV.Node.create(k).val(BN.value||BM).setContent(BN.description));});BK.on("hide",AV.bind(BC._onOverlayHide,BC));BK.on("show",AV.bind(BC._onOverlayShow,BC));BL.on("submit",AV.bind(BC._handleSaveEvent,BC));BD.addClass(BJ);},_defCancelEventFn:function(BC){var A=this;A.hideOverlay();},_defEditEventFn:function(BC){var A=this;A.hideOverlay();},_defSaveEventFn:function(BD){var A=this;var BC=A.get(AA);BC.addEvent(BD.newSchedulerEvent);A.hideOverlay();BC.syncEventsUI();},_getWhenFormattedDt:function(){var BD=this;var BC=BD.get(AS);var BL=(BD.get(BI)||BD);var BN=BL.get(Ad);var BM=BL.get(AA);var A=BL.get(A9);var BK=(BM.get(q).get(Al)?O.toIsoTimeString:O.toUsTimeString);return[BL._formatDate(A,BC),BK(A),A3,BK(BN)].join(V);},_handleEditEvent:function(BC){var A=this;A.fire(b,{newSchedulerEvent:A.getEventCopy()});
BC.preventDefault();},_handleSaveEvent:function(BC){var A=this;A.fire(AU,{newSchedulerEvent:A.getEventCopy()});BC.preventDefault();},_handleCancelEvent:function(BC){var A=this;A.fire(z);BC.preventDefault();},_onClickSchedulerEvent:function(BD){var A=this;var BC=BD.currentTarget.getData(AJ);if(BC){if(!A.overlay){A._initOverlay();}A.set(BI,BC);A.overlay.set(K,BC.get(S));A.showOverlay();}},_onOverlayHide:function(BD){var A=this;var BC=A.get(S);if(A.overlay){A.set(BI,null);A.overlay.set(K,BC);}BC.remove();},_onOverlayShow:function(BC){var A=this;var BD=A.overlayEditBtn;if(A.get(BI)){BD.show();}else{BD.hide();}A.loadFormValues();},_onStartDateChange:function(BC){var A=this;var BD=A.get(Ap);A.set(Ad,O.add(BC.newVal,O.MINUTES,BD));}}});AV.SchedulerEventRecorder=s;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel","substitute"]});AUI.add("aui-scheduler-calendar",function(D){var H=D.Lang,J=H.isArray,C=H.isString,G=function(A){return(A instanceof D.SchedulerEvent);},E="scheduler-calendar",B="color",I="pallete";var F=D.Component.create({NAME:E,ATTRS:{events:{lazyAdd:false,value:[],setter:"_setEvents",validator:J},color:{valueFn:function(){var K=this;var L=K.get(I);var A=Math.ceil(Math.random()*L.length)-1;return L[A];},validator:C},name:{value:"(no name)",validator:C},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:J}},EXTENDS:D.Base,prototype:{_setEvents:function(L){var A=this;var K=[];D.Array.each(L,function(M,N){if(!G(M)){M=new D.SchedulerEvent(M);}M.set(B,A.get(B));K.push(M);});return K;}}});D.SchedulerCalendar=F;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(B){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event"],skinnable:true});