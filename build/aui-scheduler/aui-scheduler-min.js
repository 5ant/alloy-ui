AUI.add("aui-scheduler-base",function(aR){var ax=aR.Lang,d=ax.isArray,bj=ax.isBoolean,k=ax.isDate,be=ax.isFunction,aj=ax.isNumber,U=ax.isObject,bq=ax.isString,a8=aR.ColorUtil,o=aR.DataType.DateMath,aK=aR.WidgetStdMod,bc=":",aG=".",x="",E="&ndash;",y=" ",ah=function(A){return(A instanceof aR.Scheduler);},aN=function(A){return(A instanceof aR.SchedulerEvent);},F=function(A){return(A instanceof aR.SchedulerView);},G=function(A){return(aR.SchedulerCalendar&&(A instanceof aR.SchedulerCalendar));},i="%H:%M",aa="%l",bB="%M",ay=function(A){var bE=[aa];if(A.getMinutes()>0){bE.push(bc);bE.push(bB);}if(A.getHours()>=12){bE.push("p");}return bE.join(x);},a0="data-view-name",D="scheduler-base",W="scheduler-calendar",aL="scheduler-view",ad="activeView",K="all",Z="allDay",ae="borderColor",aW="borderColorRGB",aQ="borderStyle",by="borderWidth",aS="button",bo="clearfix",a9="color",a2="colorBrightnessFactor",bl="colorSaturationFactor",aP="content",ac="controls",a5="controlsNode",a3="date",bg="day",J="disabled",aX="endDate",aZ="eventClass",ar="eventRecorder",br="events",bA="hd",L="header",bm="headerNode",t="helper",aE="hidden",V="hsbColor",aD="icon",q="iconNextNode",bd="iconPrevNode",ai="icons",au="inherit",a4="isoTime",bx="locale",bv="meeting",s="name",az="nav",aq="navNode",f="navigationDateFormatter",u="next",h="nextDate",w="node",av="noscroll",al="pallete",bk="prev",a6="prevDate",bf="radio",an="reminder",bz="rendered",bp="repeated",ap="scheduler",aF="scheduler-event",bu="scrollable",a="short",bt="startDate",ab="strings",a1="title",j="titleDateFormat",l="today",aT="todayNode",I="triggerNode",T="view",Y="viewDateNode",at="viewStack",bC="views",aJ="viewsNode",aB="visible",S=aR.getClassName,aU=S(t,bo),p=S(aD),ba=S(D,ac),n=S(D,bA),aI=S(D,aD,u),X=S(D,aD,bk),bs=S(D,az),Q=S(D,l),aM=S(D,T),m=S(D,T,x),O=S(D,T,a3),C=S(aL,av),c=S(aL,bu),ak="yui3-button-selected",B=S(D,bC),z=S(aF),R=S(aF,K,bg),aY=S(aF,aP),bn=S(aF,J),M=S(aF,aE),H=S(aF,aD,J),P=S(aF,aD,bv),aC=S(aF,aD,an),e=S(aF,aD,bp),bw=S(aF,ai),b=S(aF,bv),v=S(aF,an),aH=S(aF,bp),aw=S(aF,a),N=S(aF,a1),a7='<div class="'+ba+'"></div>',g='<div class="'+n+'"></div>',bD='<button type="button" class="'+[p,aI].join(y)+' yui3-button">Next</button>',aV='<button type="button" class="'+[p,X].join(y)+' yui3-button">Prev</button>',r='<div class="'+bs+'"></div>',aA='<button type="button" class="'+Q+' yui3-button">{today}</button>',bi='<button type="button" class="'+[aM,m].join(y)+'{name}" data-view-name="{name}">{label}</button>',aO='<div class="'+O+'"></div>',am='<div class="'+B+'"></div>';var ao=function(){};ao.ATTRS={eventClass:{valueFn:function(){return aR.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:d}};aR.mix(ao.prototype,{addEvent:function(bE){var A=this;A.addEvents([bE]);},addEvents:function(bE){var A=this,bG=A.get(br),bF=bG.concat();bE=A._normalizeEvents(bE);aR.Array.each(bE,function(bH){if(aR.Array.indexOf(bF,bH)===-1){bF.push(bH);}});if(bF.length!==bG.length){A.set(br,bF);}},eachEvent:function(bF){var A=this;var bE=A.getEvents(function(){return true;});aR.Array.each(bE,bF,A);},flushEvents:function(){var A=this;aR.Array.each(A.get(br),function(bE){delete bE._filtered;});},getEventsByDay:function(bE,bF){var A=this;bE=o.safeClearTime(bE);return A.getEvents(function(bG){return o.compare(bG.getClearStartDate(),bE)||(bF&&o.compare(bG.getClearEndDate(),bE));});},getEvents:function(bG){var A=this;var bF=A.get(br);var bE=[];aR.Array.each(bF,function(bH){if(bG.call(A,bH)){bE.push(bH);}});A.sortEventsByDateAsc(bE);return bE;},getIntersectEvents:function(bE){var A=this;bE=o.safeClearTime(bE);return A.getEvents(function(bG){var bF=bG.getClearStartDate();var bH=bG.getClearEndDate();return(bG.get(aB)&&(o.compare(bE,bF)||o.compare(bE,bH)||o.between(bE,bF,bH)));});},removeEvent:function(bE){var A=this;A.removeEvents([bE]);},removeEvents:function(bE){var A=this,bG=A.get(br),bF=bG.concat();if(!bG.length){return;}bE=A._normalizeEvents(bE);aR.Array.each(bE,function(bH){aR.Array.removeItem(bF,bH);});if(bF.length!==bG.length){A.set(br,bF);}},sortEventsByDateAsc:function(bE){var A=this;bE.sort(function(bI,bG){var bH=bI.get(aX);var bF=bG.get(aX);var bK=bI.get(bt);var bJ=bG.get(bt);if(o.after(bK,bJ)||(o.compare(bK,bJ)&&o.before(bH,bF))){return 1;}else{return -1;}});},_normalizeEvents:function(bF){var A=this;var bE=[];bF=aR.Array(bF);aR.Array.each(bF,function(bG){if(aN(bG)){bE.push(bG);}else{if(G(bG)){bE=bE.concat(A._normalizeEvents(bG.get(br)));}else{bG=new (A.get(aZ))(bG);bE.push(bG);}}var bH=A;if(!ah(bH)){bH=A.get(ap);}if(bH){bG.setAttrs({eventClass:A.get(aZ),scheduler:bH},{silent:true});}});return bE;},_setEvents:function(bE){var A=this;return A._normalizeEvents(bE);}});aR.SchedulerEventSupport=ao;var ag=aR.Component.create({NAME:D,ATTRS:{activeView:{validator:F},date:{value:new Date(),validator:k},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(bE){var A=this;return aR.DataType.Date.format(bE,{format:"%B %d, %Y",locale:A.get(bx)});},validator:be},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:aj},controlsNode:{valueFn:function(){return aR.Node.create(a7);}},viewDateNode:{valueFn:function(){return aR.Node.create(aO);}},headerNode:{valueFn:function(){return aR.Node.create(g);}},iconNextNode:{valueFn:function(){return aR.Node.create(bD);}},iconPrevNode:{valueFn:function(){return aR.Node.create(aV);}},navNode:{valueFn:function(){return aR.Node.create(r);}},todayNode:{valueFn:function(){return aR.Node.create(this._processTemplate(aA));}},viewsNode:{valueFn:function(){return aR.Node.create(am);}}},HTML_PARSER:{controlsNode:aG+ba,viewDateNode:aG+O,headerNode:aG+n,iconNextNode:aG+aI,iconPrevNode:aG+X,navNode:aG+bs,todayNode:aG+Q,viewsNode:aG+B},UI_ATTRS:[a3,ad],AUGMENTS:[aR.SchedulerEventSupport,aR.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[at]={};A[a5]=A.get(a5);A[Y]=A.get(Y);
A[L]=A.get(bm);A[q]=A.get(q);A[bd]=A.get(bd);A[aq]=A.get(aq);A[aT]=A.get(aT);A[aJ]=A.get(aJ);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},getViewByName:function(bE){var A=this;return A[at][bE];},getStrings:function(){var A=this;return A.get(ab);},getString:function(bE){var A=this;return A.getStrings()[bE];},renderView:function(bE){var A=this;if(bE){bE.show();if(!bE.get(bz)){if(!A.bodyNode){A.setStdModContent(aK.BODY,x);}bE.render(A.bodyNode);}}},plotViewEvents:function(bE){var A=this;bE.plotEvents(A.get(br));},syncEventsUI:function(){var A=this,bE=A.get(ad);if(bE){A.plotViewEvents(bE);}},renderButtonGroup:function(){var A=this;A.buttonGroup=new aR.ButtonGroup({srcNode:A[aJ],type:bf,on:{selectionChange:aR.bind(A._onButtonGroupSelectionChange,A)}}).render();},syncStdContent:function(){var A=this;var bE=A.get(bC);A[aq].append(A[bd]);A[aq].append(A[q]);A[a5].append(A[aT]);A[a5].append(A[aq]);A[a5].append(A[Y]);aR.Array.each(bE,function(bF){A[aJ].append(A._createViewTriggerNode(bF));});A[L].append(A[a5]);A[L].append(A[aJ]);A[L].addClass(aU);A.setStdModContent(aK.HEADER,A[L].getDOM());},_afterActiveViewChange:function(bG){var bE=this;if(bE.get(bz)){var bF=bG.newVal;var A=bG.prevVal;if(A){A.hide();}bE.renderView(bF);var bH=bE.get(ar);if(bH){bH.hideOverlay();}bE._uiSetDate(bE.get(a3));}},_afterRender:function(bF){var A=this,bE=A.get(ad);A.renderView(bE);A.renderButtonGroup();A._uiSetDate(A.get(a3));A._uiSetActiveView(bE);},_bindDelegate:function(){var A=this;A[a5].delegate("click",A._onClickPrevIcon,aG+X,A);A[a5].delegate("click",A._onClickNextIcon,aG+aI,A);A[a5].delegate("click",A._onClickToday,aG+Q,A);},_createViewTriggerNode:function(bE){var A=this;if(!bE.get(I)){var bF=bE.get(s);bE.set(I,aR.Node.create(ax.sub(bi,{name:bF,label:(A.getString(bF)||bF)})));}return bE.get(I);},_getViewDate:function(){var A=this,bE=A.get(a3),bF=A.get(ad);if(bF){bE=bF.getAdjustedViewDate(bE);}return bE;},_onClickToday:function(bF){var A=this,bE=A.get(ad);if(bE){A.set(a3,bE.getToday());}bF.preventDefault();},_onClickNextIcon:function(bF){var A=this,bE=A.get(ad);if(bE){A.set(a3,bE.get(h));}bF.preventDefault();},_onClickPrevIcon:function(bF){var A=this,bE=A.get(ad);if(bE){A.set(a3,bE.get(a6));}bF.preventDefault();},_onButtonGroupSelectionChange:function(bE){var A=this,bF=bE.originEvent.target.attr(a0);A.set(ad,A.getViewByName(bF));bE.preventDefault();},_processTemplate:function(bE){var A=this;return ax.sub(bE,A.getStrings());},_setEventRecorder:function(bE){var A=this;if(bE){bE.setAttrs({scheduler:A,eventClass:A.get(aZ)},{silent:true});}},_setViews:function(bF){var A=this;var bE=[];aR.Array.each(bF,function(bG){if(F(bG)&&!bG.get(bz)){bG.setAttrs({scheduler:A,eventClass:A.get(aZ)});bE.push(bG);A[at][bG.get(s)]=bG;}});if(!A.get(ad)){A.set(ad,bF[0]);}return bE;},_uiSetActiveView:function(bG){var A=this;if(bG){var bF=bG.get(s),bE=A[aJ].one(aG+m+bF);if(bE){A[aJ].all(aS).removeClass(ak);bE.addClass(ak);}}},_uiSetDate:function(bH){var bE=this;var bG=bE.get(f);var A=bG.call(bE,bH);if(bE.get(bz)){var bF=bE.get(ad);if(bF){bF._uiSetDate(bH);bG=bF.get(f);A=bG.call(bF,bH);}bE[Y].html(A);bE.syncEventsUI();}}}});aR.Scheduler=ag;var bb=aR.Component.create({NAME:W,ATTRS:{color:{valueFn:function(){var bE=this;var bF=bE.get(al);var A=Math.ceil(Math.random()*bF.length)-1;return bF[A];},validator:bq},disabled:{value:false,validator:bj},name:{value:"(no name)",validator:bq},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:d},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:bj}},EXTENDS:aR.Base,AUGMENTS:aR.SchedulerEventSupport,prototype:{initializer:function(){var A=this;A.after("colorChange",A._afterColorChange);A.after("disabledChange",A._afterDisabledChange);A.after("eventsChange",A._afterEventsChange);A.after("visibleChange",A._afterVisibleChange);A.on("eventsChange",A._onEventsChange);A._uiSetEvents(A.get(br));A._uiSetColor(A.get(a9));A._uiSetDisabled(A.get(J));A._uiSetVisible(A.get(aB));},_afterColorChange:function(bE){var A=this;A._uiSetColor(bE.newVal);},_afterDisabledChange:function(bE){var A=this;A._uiSetDisabled(bE.newVal);},_afterEventsChange:function(bE){var A=this;A._uiSetEvents(bE.newVal);},_afterVisibleChange:function(bE){var A=this;A._uiSetVisible(bE.newVal);},_onEventsChange:function(bF){var A=this;var bE=A.get(ap);if(bE){bE.removeEvents(A);}},_propagateAttrs:function(bE,bF){var A=this;A.eachEvent(function(bG){bG.setAttrs(bE,bF);});},_setScheduler:function(bF){var A=this;var bE=A.get(ap);if(bE){A.removeTarget(bE);}A.addTarget(bF);return bF;},_uiSetColor:function(bE){var A=this;A._propagateAttrs({color:A.get(a9)});},_uiSetDisabled:function(bE){var A=this;A._propagateAttrs({disabled:bE});},_uiSetEvents:function(bF){var A=this;var bE=A.get(ap);A._propagateAttrs({color:A.get(a9),disabled:A.get(J),visible:A.get(aB)},{silent:true});if(bE){bE.addEvents(bF);bE.syncEventsUI();}},_uiSetVisible:function(bE){var A=this;A._propagateAttrs({visible:bE});}}});aR.SchedulerCalendar=bb;var af=aR.Component.create({NAME:aF,ATTRS:{allDay:{setter:aR.DataType.Boolean.parse,value:false},borderStyle:{value:"solid",validator:bq},borderWidth:{value:"1px",validator:bq},colorBrightnessFactor:{value:0.75,validator:aj},colorSaturationFactor:{value:1.5,validator:aj},content:{validator:bq},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bq},titleDateFormat:{getter:"_getTitleDateFormat",value:function(){var A=this,bE=A.get(ap),bF=bE&&bE.get(ad).get(a4),bG={endDate:E+y+i,startDate:i};if(!bF){bG.endDate=E+y+ay(A.get(aX));
bG.startDate=ay(A.get(bt));}if(A.getMinutesDuration()<=30){delete bG.endDate;}else{if(A.get(Z)){bG={};}}return bG;}},endDate:{setter:"_setDate",valueFn:function(){var A=o.clone(this.get(bt));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aR.SchedulerEvent;}},disabled:{value:false,validator:bj},meeting:{value:false,validator:bj},node:{valueFn:function(){return aR.NodeList.create(aR.Node.create(this.EVENT_NODE_TEMPLATE).setData(aF,this));}},reminder:{value:false,validator:bj},repeated:{value:false,validator:bj},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bj}},EXTENDS:aR.Model,PROPAGATE_ATTRS:[Z,bt,aX,aP,a9,a2,bl,aQ,by,j,aB,J],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+z+'">'+'<div class="'+N+'"></div>'+'<div class="'+aY+'"></div>'+'<div class="'+bw+'">'+'<span class="'+[p,H].join(y)+'"></span>'+'<span class="'+[p,P].join(y)+'"></span>'+'<span class="'+[p,aC].join(y)+'"></span>'+'<span class="'+[p,e].join(y)+'"></span>'+"</div>"+"</div>",initializer:function(){var A=this;var bE=A.get(w);A.bindUI();A.syncUI();},bindUI:function(){var A=this;A.after({allDayChange:A._afterAllDayChange,colorChange:A._afterColorChange,disabledChange:A._afterDisabledChange,endDateChange:A._afterEndDateChange,meetingChange:A._afterMeetingChange,reminderChange:A._afterReminderChange,repeatedChange:A._afterRepeatedChange,visibleChange:A._afterVisibleChange});},syncUI:function(){var A=this;A._uiSetAllDay(A.get(Z));A._uiSetColor(A.get(a9));A._uiSetDisabled(A.get(J));A._uiSetEndDate(A.get(aX));A._uiSetMeeting(A.get(bv));A._uiSetReminder(A.get(an));A._uiSetRepeated(A.get(bp));A._uiSetVisible(A.get(aB));A.syncNodeTitleUI();A.syncNodeContentUI();},destroy:function(){var A=this;A.get(w).remove(true);},addPaddingNode:function(){var A=this;A.get(w).push(aR.Node.create(A.EVENT_NODE_TEMPLATE).setData(aF,A));A.syncUI();},clone:function(){var bE=this,A=new (bE.get(aZ))();A.copyPropagateAttrValues(bE,null,{silent:true});return A;},copyDates:function(bE,bF){var A=this;A.setAttrs({endDate:o.clone(bE.get(aX)),startDate:o.clone(bE.get(bt))},bF);},copyPropagateAttrValues:function(bF,bH,bG){var A=this,bE={};A.copyDates(bF,bG);aR.Array.each(A.get(aZ).PROPAGATE_ATTRS,function(bI){if(!((bH||{}).hasOwnProperty(bI))){var bJ=bF.get(bI);if(!U(bJ)){bE[bI]=bJ;}}});A.setAttrs(bE,bG);},getBorderColor:function(){var A=this;return A[aW].hex;},getDaysDuration:function(){var A=this;return o.getDayOffset(A.get(aX),A.get(bt));},getHoursDuration:function(){var A=this;return o.getHoursOffset(A.get(aX),A.get(bt));},getMinutesDuration:function(){var A=this;return o.getMinutesOffset(A.get(aX),A.get(bt));},getSecondsDuration:function(){var A=this;return o.getSecondsOffset(A.get(aX),A.get(bt));},sameEndDate:function(bE){var A=this;return o.compare(A.get(aX),bE.get(aX));},sameStartDate:function(bE){var A=this;return o.compare(A.get(bt),bE.get(bt));},isAfter:function(bG){var bF=this;var bE=bF.get(bt);var A=bG.get(bt);return o.after(bE,A);},isBefore:function(bG){var bF=this;var bE=bF.get(bt);var A=bG.get(bt);return o.before(bE,A);},intersects:function(bG){var bF=this;var bH=bF.get(aX);var bE=bF.get(bt);var A=bG.get(bt);return(bF.sameStartDate(bG)||o.between(A,bE,bH));},intersectHours:function(bF){var bE=this;var bH=bE.get(aX);var A=bE.get(bt);var bG=o.clone(A);o.copyHours(bG,bF.get(bt));return(o.compare(A,bG)||o.between(bG,A,bH));},isDayBoundaryEvent:function(){var A=this;return o.isDayBoundary(A.get(bt),A.get(aX));},isDayOverlapEvent:function(){var A=this;return o.isDayOverlap(A.get(bt),A.get(aX));},getClearEndDate:function(){var A=this;return o.safeClearTime(A.get(aX));},getClearStartDate:function(){var A=this;return o.safeClearTime(A.get(bt));},move:function(bF,bE){var A=this;var bG=A.getMinutesDuration();A.setAttrs({endDate:o.add(o.clone(bF),o.MINUTES,bG),startDate:bF},bE);},setContent:function(bE){var A=this;A.get(w).each(function(bG){var bF=bG.one(aG+aY);bF.setContent(bE);});},setTitle:function(bE){var A=this;A.get(w).each(function(bF){var bG=bF.one(aG+N);bG.setContent(bE);});},syncNodeContentUI:function(){var A=this;A.setContent(A.get(aP));},syncNodeTitleUI:function(){var bE=this,bG=bE.get(j),A=bE.get(bt),bF=bE.get(aX),bH=[];if(bG.startDate){bH.push(bE._formatDate(A,bG.startDate));}if(bG.endDate){bH.push(bE._formatDate(bF,bG.endDate));}bE.setTitle(bH.join(y));},split:function(){var A=this,bF=o.clone(A.get(bt)),bG=o.clone(A.get(aX));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var bE=o.clone(bF);bE.setHours(24,0,0,0);return[[bF,o.toMidnight(o.clone(bF))],[bE,o.clone(bG)]];}return[[bF,bG]];},_afterAllDayChange:function(bE){var A=this;A._uiSetAllDay(bE.newVal);},_afterColorChange:function(bE){var A=this;A._uiSetColor(bE.newVal);},_afterDisabledChange:function(bE){var A=this;A._uiSetDisabled(bE.newVal);},_afterEndDateChange:function(bE){var A=this;A._uiSetEndDate(bE.newVal);},_afterMeetingChange:function(bE){var A=this;A._uiSetMeeting(bE.newVal);},_afterReminderChange:function(bE){var A=this;A._uiSetReminder(bE.newVal);},_afterRepeatedChange:function(bE){var A=this;A._uiSetRepeated(bE.newVal);},_afterVisibleChange:function(bE){var A=this;A._uiSetVisible(bE.newVal);},_setColor:function(bE){var A=this;A[V]=a8.rgb2hsb(a8.getRGB(bE));A[ae]=aR.clone(A[V]);A[ae].b*=A.get(a2);A[ae].s*=A.get(bl);A[aW]=a8.hsb2rgb(A[ae]);return bE;},_setDate:function(bE){var A=this;if(aj(bE)){bE=new Date(bE);}return bE;},_setScheduler:function(bF){var A=this;var bE=A.get(ap);if(bE){A.removeTarget(bE);}A.addTarget(bF);return bF;},_formatDate:function(bF,bG){var bE=this;var A=bE.get(bx);return aR.DataType.Date.format(bF,{format:bG,locale:A});},_getTitleDateFormat:function(bE){var A=this;if(bq(bE)){bE={endDate:bE,startDate:bE};}else{if(be(bE)){bE=bE.call(A);}}return bE;},_uiSetAllDay:function(bE){var A=this;A.get(w).toggleClass(R,!!bE);},_uiSetColor:function(bG){var A=this;var bF=A.get(w);var bH=A.getBorderColor();if(bF){var bE={borderWidth:A.get(by),borderColor:bH,backgroundColor:bG,borderStyle:A.get(aQ),color:au};
bF.setStyles(bE);}},_uiSetDisabled:function(bE){var A=this;A.get(w).toggleClass(bn,!!bE);},_uiSetEndDate:function(bE){var A=this;A.get(w).toggleClass(aw,A.getMinutesDuration()<=30);},_uiSetMeeting:function(bE){var A=this;A.get(w).toggleClass(b,!!bE);},_uiSetReminder:function(bE){var A=this;A.get(w).toggleClass(v,!!bE);},_uiSetRepeated:function(bE){var A=this;A.get(w).toggleClass(aH,!!bE);},_uiSetVisible:function(bE){var A=this;A.get(w).toggleClass(M,!bE);}}});aR.SchedulerEvent=af;var bh=aR.Component.create({NAME:aL,AUGMENTS:[aR.WidgetStdMod],ATTRS:{bodyContent:{value:x},eventClass:{valueFn:function(){return aR.SchedulerEvent;}},filterFn:{validator:be,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bj},name:{value:x,validator:bq},navigationDateFormatter:{value:function(bE){var A=this;var bF=A.get(ap);return aR.DataType.Date.format(bE,{format:"%A, %d %B, %Y",locale:bF.get(bx)});},validator:be},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bj},triggerNode:{setter:aR.one},visible:{value:false}},BIND_UI_ATTRS:[bu],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},getAdjustedViewDate:function(bE){var A=this;return bE;},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return o.clearTime(new Date());},limitDate:function(bE,bF){var A=this;if(o.after(bE,bF)){bE=o.clone(bF);}return bE;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetDate:function(A){},_afterRender:function(bF){var A=this;var bE=A.get(ap);A._uiSetScrollable(A.get(bu));},_setScheduler:function(bF){var A=this;var bE=A.get(ap);if(bE){A.removeTarget(bE);}if(bF){A.addTarget(bF);bF.after("eventsChange",aR.bind(A.flushViewCache,A));}return bF;},_uiSetScrollable:function(bF){var A=this;var bE=A.bodyNode;if(bE){bE.toggleClass(c,bF);bE.toggleClass(C,!bF);}}}});aR.SchedulerView=bh;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","button-group","model","model-list","widget-stdmod"]});AUI.add("aui-scheduler-view-day",function(bu){var bD=bu.Lang,ax=bD.isBoolean,r=bD.isFunction,aj=bD.isNumber,bK=bD.isObject,bn=bD.isString,X=bu.DataType.DateMath,br=bu.WidgetStdMod,e="a",aR=",",bg=".",a9="",a5="%",J=" ",o="data-colnumber",bf="scheduler-view",ai="scheduler-view-day",f=bu.cached(function(){var bQ=bu.config.doc,bO=bQ.createElement("div"),A=bQ.getElementsByTagName("body")[0],bP=0.1;if(A){bO.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";bO.appendChild(bQ.createElement("p")).style.height="1px";A.insertBefore(bO,A.firstChild);bP=bO.offsetWidth-bO.clientWidth;A.removeChild(bO);}return bP;},null,0.1),C=function(A,bO){return function(bQ){var bP=bQ.all(A);return(bP.size()>=bO)?bP:null;};},be=function(bO,A){return Math.round(bO/A)*A;},bc=function(A){return parseFloat(A)||0;},aH="activeColumn",bb="activeView",D="allDay",at="boundingBox",R="col",ac="colDaysNode",bw="colHeaderDaysNode",y="colblank",q="coldata",al="colday",a="colgrid",L="colspan",h="coltime",aT="columnData",aw="columnDayHeader",am="columnShims",aK="columnTime",aq="container",M="creationStartDate",a0="date",ba="viewDate",bB="day",I="days",t="delegateConfig",a8="disabled",aS="division",bG="dotted",v="draggingEvent",bl="duration",ae="endDate",bF="eventClass",a7="eventPlaceholder",bM="eventRecorder",l="eventWidth",bq="filterFn",ak="first",aJ="grid",aZ="gridContainer",aD="grip",bL="hd",bt="header",aF="headerDateFormatter",bJ="headerTableNode",aA="headerView",aQ="headerViewConfig",ao="headerViewLabelNode",bi="height",aG="horizontal",ar="host",ah="hourHeight",n="icon",U="isoTime",N="label",au="left",ad="locale",g="marginRight",O="marker",aE="markercell",ay="markercellsNode",z="markers",a6="markersNode",bN="node",bs="offsetHeight",bv="pad",G="parentNode",aX="proxy",S="px",P="region",bh="resizer",bo="resizerNode",bd="resizing",az="right",k="scheduler",af="scheduler-event",H="shim",bx="startDate",K="startXY",bp="strings",av="table",a1="tableNode",aU="time",T="timesNode",V="today",aV="top",aY="view",ab="visible",a4="width",a3="data",u=bu.getClassName,c=u(n),w=u(n,aD,bG,aG),aB=u(bf,av,a3),an=u(af),aN=u(af,a8),bk=u(af,aX),E=u(k,V),W=u(k,V,bL),s=u(bf,q),b=u(bf,a),by=u(bf,aJ),bz=u(bf,aJ,aq),aC=u(bf,bB,bt,R),m=u(bf,bB,bt,bB),bm=u(bf,bB,bt,bB,ak),aO=u(bf,bB,bt,bB,bv,az),bC=u(bf,bB,bt,av),aI=u(bf,bB,bt,aY,N),aP=u(bf,O,aS),bA=u(bf,aE),B=u(bf,z),bj=u(bf,bB,bh),ap=u(bf,bB,bh,n),a2=u(bf,bB,av),bH=u(bf,bB,av,R),ag=u(bf,bB,av,R,H),F=u(bf,bB,av,y),x=u(bf,bB,av,al),bE=u(bf,bB,av,h),aW=u(bf,bB,av,aU),j='<div class="'+bj+'">'+'<div class="'+[c,w,ap].join(J)+'"></div>'+"</div>",Q='<div class="'+bA+'">'+'<div class="'+aP+'"></div>'+"</div>",i='<span class="'+aI+'">{label}</span>',Z='<table cellspacing="0" cellpadding="0" class="'+a2+'">'+"<tbody>"+'<tr class="'+b+'" height="1">'+'<td height="0" class="'+[bH,F].join(J)+'"></td>'+'<td class="'+bz+'" colspan="1">'+'<div class="'+by+'">'+'<div class="'+B+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+s+'">'+'<td class="'+[bH,bE].join(J)+'"></td>'+"</tr>"+"</tbody>"+"</table>",aL='<td class="'+[bH,x].join(J)+'" data-colnumber="{colNumber}">'+'<div class="'+ag+'"></div>'+"</td>",d='<div class="'+aW+'">{hour}</div>',aa='<table cellspacing="0" cellpadding="0" class="'+bC+'">'+"<tbody>"+'<tr class="'+aC+'"></tr>'+"</tbody>"+"</table>",aM='<th class="'+m+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',Y='<td class="'+[m,bm].join(J)+'"></td>',p='<th class="'+[m,aO].join(J)+'">&nbsp;</th>';var bI=bu.Component.create({NAME:ai,ATTRS:{bodyContent:{value:a9},days:{value:1,validator:aj},delegateConfig:{value:{},setter:function(bO){var A=this;return bu.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(at),nodes:bg+an,invalid:"input, select, button, a, textarea, "+bg+aN},bO||{});
},validator:bK},eventWidth:{value:95,validator:aj},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(D));}},headerDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%d %A",locale:bP.get(ad)});},validator:bn},headerView:{value:true,validator:ax},headerViewConfig:{setter:function(bO){var A=this;return bu.merge({displayDaysInterval:1,displayRows:6,filterFn:function(bP){return((bP.getHoursDuration()>24)||bP.get(D));},height:"auto",visible:true},bO||{});},value:{}},hourHeight:{value:52,validator:aj},name:{value:bB},navigationDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%A, %B %d, %Y",locale:bP.get(ad)});},validator:r},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return bu.Node.create(aa);}},headerViewLabelNode:{valueFn:function(){var bO=this;var A=bO.get(bp);return bu.Node.create(bD.sub(i,{label:A[D]}));}},resizerNode:{valueFn:function(){return bu.Node.create(j);}},tableNode:{valueFn:function(){return bu.Node.create(Z);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:C(bg+x,1),colHeaderDaysNode:C(bg+m,2),headerTableNode:bg+bC,headerViewLabelNode:bg+aI,markercellsNode:C(bg+bA,24),resizerNode:bg+bj,tableNode:bg+a2,timesNode:C(bg+aW,24)},EXTENDS:bu.SchedulerView,prototype:{initializer:function(){var A=this;A[ac]=A.get(ac);A[bw]=A.get(bw);A[bJ]=A.get(bJ);A[ay]=A.get(ay);A[bo]=A.get(bo);A[a1]=A.get(a1);A[T]=A.get(T);A[aH]=null;A[aT]=A[a1].one(bg+s);A[aw]=A.headerTableNode.one(bg+aC);A[am]=A[ac].all(bg+ag);A[aK]=A[a1].one(bg+bE);A[aZ]=A[a1].one(bg+bz);A[a6]=A[a1].one(bg+B);if(A.get(aA)){A[aA]=new bu.SchedulerTableView(A.get(aQ));}},renderUI:function(){var A=this;A[aK].setContent(A[T]);A[a6].setContent(A[ay]);A[ac].appendTo(A[aT]);A[bw].appendTo(A[aw]);if(A[aA]){A[aA].set(k,A.get(k));A[aA].render();}},bindUI:function(){var A=this;A[bJ].delegate("click",bu.bind(A._onClickDaysHeader,A),bg+m);A[aT].delegate("mousedown",bu.bind(A._onMouseDownTableCol,A),bg+bH);A[aT].delegate("mouseenter",bu.bind(A._onMouseEnterEvent,A),bg+an);A[aT].delegate("mouseleave",bu.bind(A._onMouseLeaveEvent,A),bg+an);A[aT].delegate("mousemove",bu.bind(A._onMouseMoveTableCol,A),bg+x);A[aT].delegate("mouseup",bu.bind(A._onMouseUpTableCol,A),bg+bH);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;bI.superclass.syncUI.apply(this,arguments);A[aZ].attr(L,A.get(I));A._setupDragDrop();},syncStdContent:function(){var bO=this;bO.setStdModContent(br.BODY,bO[a1].getDOM());var A=bu.NodeList.create(bO[bJ]);if(bO[aA]){A.push(bO[aA].get(at));A.push(bO.get(ao));}bO.setStdModContent(br.HEADER,A);},calculateEventHeight:function(bP){var bO=this;var A=bO.get(ah);return Math.max(bP*(A/60),A/2);},calculateTop:function(bO){var A=this;return((bO.getHours()*60)+bO.getMinutes()+(bO.getSeconds()/60))*(A.get(ah)/60);},getNextDate:function(){var A=this;var bO=A.get(k).get(a0);return X.add(bO,X.DAY,1);},getPrevDate:function(){var A=this;var bO=A.get(k).get(a0);return X.subtract(bO,X.DAY,1);},getColumnByDate:function(bO){var A=this;return A[ac].item(A.getDateDaysOffset(bO));},getColumnShimByDate:function(bO){var A=this;return A[am].item(A.getDateDaysOffset(bO));},getDateByColumn:function(bO){var A=this;var bP=X.safeClearTime(A.get(k).get(ba));return X.add(bP,X.DAY,bO);},getDateDaysOffset:function(bO){var A=this;var bP=X.safeClearTime(A.get(k).get(ba));return X.getDayOffset(X.safeClearTime(bO),bP);},getYCoordTime:function(bR){var bO=this;var A=bO.get(ah);var bS=bc((bR/A).toFixed(2));var bQ=Math.floor((bS*100)%100*0.6);var bP=Math.floor(bS);return[bP,bQ,0];},plotEvent:function(bP){var A=this;var bQ=bP.get(bN);if(bQ.size()<2){bP.addPaddingNode();}var bS=bP.get(bN).item(0);var bO=bP.get(bN).item(1);var bR=A.getColumnShimByDate(bP.get(ae));var bT=A.getColumnShimByDate(bP.get(bx));if(bT){bT.append(bS);if(bP.get(ab)){bS.show();}}else{bS.hide();}if(bR){if(bR.compareTo(bT)||bP.isDayBoundaryEvent()){bO.hide();}else{bR.append(bO);if(bP.get(ab)){bO.show();}}}else{bO.hide();}bP.syncUI();A.syncEventTopUI(bP);A.syncEventHeightUI(bP);},plotEvents:function(){var A=this;var bO=A.get(k);var bP=A.get(bq);A[am].each(function(bT,bS){var bQ=bO.getEventsByDay(A.getDateByColumn(bS),true);var bR=[];bT.empty();bu.Array.each(bQ,function(bU){if(bP.apply(A,[bU])){A.plotEvent(bU);bR.push(bU);}});A.syncEventsIntersectionUI(bR);});if(A.get(aA)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[ac].each(function(bQ,bP){var bO=A.getDateByColumn(bP);bQ.toggleClass(E,X.isToday(bO));});},syncDaysHeaderUI:function(){var bO=this;var bQ=bO.get(k).get(ba);var bP=bO.get(aF);var A=bO.get(ad);bO[bw].all(e).each(function(bT,bS){var bR=X.add(bQ,X.DAY,bS);bT.toggleClass(W,X.isToday(bR));bT.html(bP.call(bO,bR));});},syncEventsIntersectionUI:function(bO){var A=this;var bP=A.get(l);A.get(k).flushEvents();bu.Array.each(bO,function(bR){var bT=A.findEventIntersections(bR,bO);var bS=bT.length;var bQ=(bP/bS);bu.Array.each(bT,function(bV,bW){var bU=bV.get(bN).item(0);var bY=bQ*bW;var bX=bQ*1.7;if(bW===(bS-1)){bX=bP-bY;}bU.setStyle(a4,bX+a5);bU.setStyle(au,bY+a5);var bZ=bU.get(G);if(bZ){bZ.insert(bU,bW);}bV._filtered=true;});});},syncEventHeightUI:function(bQ){var bO=this;var bU=bQ.get(ae);var A=bQ.get(bx);var bR=X.clone(A);bR.setHours(24,0,0);var bS=X.getMinutesOffset(bO.limitDate(bU,bR),A);bQ.get(bN).item(0).set(bs,bO.calculateEventHeight(bS));var bP=bQ.get(bN).item(1);if(bP.inDoc()){var bT=X.getMinutesOffset(bU,X.toMidnight(bQ.getClearEndDate()));bP.set(bs,bO.calculateEventHeight(bT));}},syncEventTopUI:function(bO){var A=this;bO.get(bN).item(0).setStyle(aV,A.calculateTop(bO.get(bx))+S);bO.get(bN).item(1).setStyle(aV,0);
},syncHeaderViewUI:function(){var bO=this;if(bO.get(aA)){var bQ=bO[aA];bQ.plotEvents();var bR=bQ.get(at);bR.setStyle(g,f());var bP=bR.one(bg+aB);var A=Math.max(bP.get(bs),40);bQ.set(bi,A);bO._fillHeight();}},calculateYDelta:function(bP,bO){var A=this;return(bO[1]-bP[1])/(A.get(ah)/2)*30;},findEventIntersections:function(bO,bP){var A=this;var bQ=[];bu.Array.each(bP,function(bR){if(!bO._filtered&&bR.get(ab)&&bO.intersectHours(bR)){bQ.push(bR);}});return bQ;},getXYDelta:function(bO){var A=this;var bP=bO.currentTarget.getXY(),bQ=[bO.pageX,bO.pageY];return bu.Array.map(bP,function(bS,bR){return(bQ[bR]-bS);});},getTickY:function(){var A=this;return be(Math.ceil(A.get(ah)/2),10);},roundToNearestHour:function(bO,bP){var A=this;bO.setHours(bP[0],be(bP[1],A.getTickY()),bP[2]);},_afterDragAlign:function(bP){var bO=this;var A=bP.target;if(!bO[K]){bO[K]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(bP){var bO=this;var bS=bO[v];if(bS&&!bO[bd]){var bQ=bO[a7];var bR=bc(bP.attr(o))-bO.startColNumber;bO.draggingEventStartDate=X.add(bS.get(bx),X.DAY,bR);var A=X.clone(bO.draggingEventStartDate);X.copyHours(A,bQ.get(bx));bQ.move(A,{silent:true});bO.plotEvent(bQ);}},_dragTickAlignY:function(A){var bT=this;var bO=bT.get(k);var bV=bO.get(bM);var bQ=bT[v];if(bQ){var bU=A.target.get(ar);var bR=bT[a7];var bS=bT.calculateYDelta(bT[K],bU.actXY);if(bT[bd]){var bP=X.add(bT.draggingEventEndDate,X.MINUTES,bS);if(X.getMinutesOffset(bP,bT.draggingEventStartDate)<30){return;}bR.set(ae,bP,{silent:true});}else{bR.move(X.add(bT.draggingEventStartDate,X.MINUTES,bS),{silent:true});}bT.plotEvent(bR);}},_setupDragDrop:function(){var bO=this,bR=bO[a7];if(!bR){var bP=bO.get(k);bR=new (bO.get(bF))({scheduler:bP});bR.removeTarget(bP);bR.get(bN).addClass(bk);bR.set(ab,false,{silent:true});bO[a7]=bR;}if(!bO.delegate){bO.delegate=new bu.DD.Delegate(bO.get(t));}var A=bO.delegate.dd;A.unplug(bu.Plugin.DDConstrained);A.unplug(bu.Plugin.DDNodeScroll);var bQ=bO.bodyNode.get(P);bQ.bottom=Infinity;bQ.top=-Infinity;A.plug(bu.Plugin.DDConstrained,{bubbleTargets:bO,constrain:bQ,stickY:true,tickY:bO.get(ah)/2});A.plug(bu.Plugin.DDNodeScroll,{node:bO.bodyNode,scrollDelay:150});},_uiSetDate:function(bO){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(bQ){var A=this;var bP=A.get(k);if(bQ.target.test(e)){var bR=bP.getViewByName(bB);if(bR){var bO=bc(bQ.currentTarget.attr(o));bP.set(ba,A.getDateByColumn(bO));bP.set(bb,bR);}}bQ.preventDefault();},_onEventDragEnd:function(bO){var A=this;var bQ=A[v];if(bQ){var bP=A[a7];bP.set(ab,false,{silent:true});bQ.set(ab,true,{silent:true});bQ.copyDates(bP);A.get(k).syncEventsUI();}A[K]=null;A[v]=null;},_onEventDragStart:function(bP){var A=this;var bR=A[v]=A.delegate.dd.get(bN).getData(af);if(bR){var bQ=A[a7];bQ.copyPropagateAttrValues(bR,null,{silent:true});A.plotEvent(bQ);bR.set(ab,false,{silent:true});A.draggingEventStartDate=X.clone(bR.get(bx));A.draggingEventEndDate=X.clone(bR.get(ae));var bO=A.getColumnByDate(bR.get(bx));A.startColNumber=bO?bc(bO.attr(o)):0;}},_onMouseDownTableCol:function(bO){var bT=this;var bS=bO.target;var bQ=bT.get(k);var bU=bQ.get(bM);if(bU&&!bQ.get(a8)){bU.hideOverlay();if(bS.test(bg+ag)){bT[K]=[bO.pageX,bO.pageY];var bV=bc(bO.currentTarget.attr(o));var bP=bT.getDateByColumn(bV);var A=bT.getXYDelta(bO);bT.roundToNearestHour(bP,bT.getYCoordTime(A[1]));var bR=X.add(bP,X.MINUTES,bU.get(bl));bU.move(bP,{silent:true});bU.setAttrs({allDay:false,endDate:bR},{silent:true});bT[M]=bP;bO.halt();}else{if(bS.test([bg+bj,bg+ap].join(aR))){bT[bd]=true;}}}bT.get(at).unselectable();},_onMouseEnterEvent:function(bP){var A=this;var bQ=bP.currentTarget;var bO=bQ.getData(af);if(bO&&!bO.get(a8)){A[bo].appendTo(bQ);}},_onMouseLeaveEvent:function(bO){var A=this;if(!A[bd]){A._removeResizer();}},_onMouseMoveTableCol:function(bR){var bO=this;var bQ=bR.currentTarget;var bP=bO.get(k).get(bM);if(bO[aH]!==bQ){bO[aH]=bQ;bO._dragTickAlignX(bO[aH]);}var bS=bO[M];if(bS){var bU=be(bO.calculateYDelta(bO[K],[bR.pageX,bR.pageY]),bO.getTickY());var bT=(bU>=bO._delta);if(bO._delta!==bU){if(bU>0){var A=bT?Math.max(bU,bP.get(bl)):bU;bP.set(ae,X.add(bS,X.MINUTES,A),{silent:true});}else{bP.set(bx,X.add(bS,X.MINUTES,bU),{silent:true});}bO.plotEvent(bP);bO._delta=bU;}}},_onMouseUpTableCol:function(bQ){var A=this;var bP=A.get(k);var bO=bP.get(bM);if(bO&&!bP.get(a8)){if(A[M]){A.plotEvent(bO);bO.showOverlay([bQ.pageX,bQ.pageY]);}}A[M]=null;A[bd]=false;A[K]=null;A._removeResizer();A.get(at).selectable();},_onSchedulerChange:function(bO){var A=this;if(A[aA]){A[aA].set(k,bO.newVal);}},_removeResizer:function(){var A=this;A[bo].remove();},_valueColDaysNode:function(){var A=this;var bQ=A.get(I);var bO=[],bP=0;while(bQ--){bO.push(bu.Lang.sub(aL,{colNumber:bP++}));}return bu.NodeList.create(bO.join(a9));},_valueColHeaderDaysNode:function(){var A=this;var bQ=A.get(I);var bO=[],bP=0;bO.push(Y);while(bQ--){bO.push(bu.Lang.sub(aM,{colNumber:bP++}));}bO.push(p);return bu.NodeList.create(bO.join(a9));},_valueMarkercellsNode:function(){var A=this;var bO=[],bP;for(bP=0;bP<=23;bP++){bO.push(Q);}return bu.NodeList.create(bO.join(a9));},_valueTimesNode:function(){var A=this;var bQ=A.get(U);var bP=[],bO;for(bO=0;bO<=23;bO++){bP.push(bD.sub(d,{hour:bQ?X.toIsoTimeString(bO):X.toUsTimeString(bO,false,true)}));}return bu.NodeList.create(bP.join(a9));}}});bu.SchedulerDayView=bI;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-view-week",function(g){var j=g.Lang,f=j.isFunction,o="",k="&mdash;",m=" ",h=g.DataType.DateMath,i=h.WEEK_LENGTH,b="scheduler-view-week",e="date",n="days",d="firstDayOfWeek",l="locale",p="scheduler",a="week";var c=g.Component.create({NAME:b,ATTRS:{bodyContent:{value:o},days:{value:7},headerViewConfig:{value:{displayDaysInterval:i}},name:{value:a},navigationDateFormatter:{valueFn:function(){return this._valueNavigationDateFormatter;},validator:f}},EXTENDS:g.SchedulerDayView,prototype:{getAdjustedViewDate:function(t){var q=this;
var s=q.get(p);var r=s.get(d);return h.getFirstDayOfWeek(t,r);},getNextDate:function(){var q=this;var s=q.get(p);var r=s.get(e);var t=q._firstDayOfWeek(r);return h.add(t,h.WEEK,1);},getPrevDate:function(){var q=this;var s=q.get(p);var r=s.get(e);var t=q._firstDayOfWeek(r);return h.subtract(t,h.WEEK,1);},getToday:function(){var q=this;var r=c.superclass.getToday.apply(this,arguments);return q._firstDayOfWeek(r);},_firstDayOfWeek:function(s){var q=this;var t=q.get(p);var r=t.get(d);return h.getFirstDayOfWeek(s,r);},_valueNavigationDateFormatter:function(t){var s=this;var u=s.get(p);var r=u.get(l);var q=s._firstDayOfWeek(t);var v=g.DataType.Date.format(q,{format:"%B %d",locale:r});var x=h.add(q,h.DAY,s.get(n)-1);var w=g.DataType.Date.format(x,{format:(h.isMonthOverlapWeek(t)?"%B %d":"%d")+", %Y",locale:r});return[v,k,w].join(m);}}});g.SchedulerWeekView=c;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-day"]});AUI.add("aui-scheduler-view-table",function(ao){var aa=ao.Lang,aI=aa.isFunction,aS=aa.isString,p=ao.DataType.DateMath,aj=ao.WidgetStdMod,a0=p.WEEK_LENGTH,aP="-",ai=".",w="",x=" ",am="scheduler-view",aw="scheduler-view-table",a8=function(A,a9){return function(bb){var ba=bb.all(A);return(ba.size()>=a9)?ba:null;};},ax="body",f="close",ap="col",I="colHeaderDaysNode",v="colgrid",aE="colspan",J="columnDayHeader",K="columnTableGrid",a="container",an="content",aA="data",aJ="day",i="displayDaysInterval",V="displayRows",ad="div",aB="down",at="endDate",a6="event",aT="events",P="eventsOverlay",aN="filterFn",C="first",M="firstDayOfWeek",j="grid",D="header",d="headerDateFormatter",B="headerTableNode",af="icon",c="left",aX="locale",aM="more",s="next",u="node",n="overlay",l="right",r="row",Q="rowsContainerNode",U="scheduler",ag="scheduler-event",aW="showMore",aU="startDate",N="strings",m="table",aC="tableGridNode",t="tableRowContainer",o="tableRows",aR="tbody",ay="title",a4="tl",k="today",aV="tr",W="viewDate",ac="visible",L=ao.getClassName,q=L(af),a5=L(af,"arrowstop-1-l"),g=L(af,"arrowstop-1-r"),ar=L(am,m,v),a7=L(am,m,v,C),aK=L(am,m,v,k),al=L(am,m,a),T=L(am,m,aT,n,u),b=L(am,m,aT,n,u,ax),aH=L(am,m,aT,n,u,f),ae=L(am,m,D,ap),az=L(am,m,D,aJ),X=L(am,m,D,m),ak=L(am,m,aM),aZ=L(am,m,r),aO=L(am,m,r,a),H=L(am,m,aA),F=L(am,m,aA,ap),Z=L(am,m,aA,ap,ay),a3=L(am,m,aA,ap,ay,aB),ab=L(am,m,aA,ap,ay,C),O=L(am,m,aA,ap,ay,s),R=L(am,m,aA,ap,ay,k),y=L(am,m,aA,a6),aQ=L(am,m,aA,a6,c),a1=L(am,m,aA,a6,l),S=L(am,m,aA,C),ah=L(am,m,j),G=L(am,m,j,C),aY='<div class="'+al+'">'+'<div class="'+aO+'"></div>'+"</div>",aq='<div class="'+T+'">'+'<div class="'+b+'"></div>'+'<a href="javascript:;" class="'+aH+'">{label}</a>'+"</div>",aL='<td class="'+ar+'">&nbsp;</td>',a2='<th class="'+az+'"><div>&nbsp;</div></th>',h='<table cellspacing="0" cellpadding="0" class="'+X+'">'+"<tbody>"+'<tr class="'+ae+'"></tr>'+"</tbody>"+"</table>",aG='<a href="javascript:;" class="'+ak+'">{label} {count}</a>',aD='<div class="'+aZ+'" style="top: {top}%; height: {height}%;"></div>',Y='<table cellspacing="0" cellpadding="0" class="'+H+'">'+"<tbody></tbody>"+"</table>",aF='<table cellspacing="0" cellpadding="0" class="'+ah+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",z='<span class="'+[q,a5].join(x)+'"></span>',av='<span class="'+[q,g].join(x)+'"></span>',E='<td class="'+F+'"><div></div></td>',au="<tr></tr>";var e=ao.Component.create({NAME:aw,ATTRS:{bodyContent:{value:w},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:m},headerDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return ao.DataType.Date.format(a9,{format:"%A",locale:ba.get(aX)});},validator:aS},navigationDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return ao.DataType.Date.format(a9,{format:"%b %Y",locale:ba.get(aX)});},validator:aI},scrollable:{value:false},strings:{value:{close:"Close",showMore:"Show more"}},headerTableNode:{valueFn:function(){return ao.Node.create(h);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return ao.Node.create(aY);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:a8(ai+az,7),headerTableNode:ai+X,rowsContainerNode:ai+al,tableGridNode:a8(ai+ah,7)},EXTENDS:ao.SchedulerView,prototype:{evtDateStack:null,evtRenderedStack:null,rowDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};A[I]=A.get(I);A[B]=A.get(B);A[Q]=A.get(Q);A[aC]=A.get(aC);A[J]=A.headerTableNode.one(ai+ae);A[K]=ao.NodeList.create();A[t]=A[Q].one(ai+aO);A[o]=ao.NodeList.create();},bindUI:function(){var A=this;A[Q].delegate("click",ao.bind(A._onClickMore,A),ai+ak);},renderUI:function(){var A=this,a9=A._getDisplayRowsCount(),ba;for(ba=0;ba<a9;ba++){A[o].push(A.buildGridRowNode(ba));}A._renderEventsOverlay();A[I].appendTo(A[J]);A[o].appendTo(A[t]);},buildEventsRow:function(a9,be,bd){var A=this;var ba=A.get(V);var bc=0;var bb=ao.Node.create(au);A.loopDates(a9,be,function(bn,bj){if(bc>bj){return;}var bo=A.getIntersectEvents(bn);var bl=A._getRenderableEvent(bo,a9,be,bn);var bh=ao.Node.create(E);var bg=bh.one(ad);if((ba<bo.length)&&(bd===(ba-1))){var bm=A.get(N);var bi=ao.Node.create(aa.sub(aG,{count:(bo.length-(ba-1)),label:bm[aW]}));bi.setData(aT,bo);bg.append(bi);}else{if(bl){var bf=A._getEvtSplitInfo(bl,bn,a9,be);bh.attr(aE,bf.colspan);bc+=(bf.colspan-1);A._syncEventNodeContainerUI(bl,bg,bf);A._syncEventNodeUI(bl,bg,bn);var bk=String(bn.getTime());A.evtRenderedStack[bk].push(bl);}}bc++;bb.append(bh);});return bb;},buildEventsTable:function(A,bc){var bi=this,bg=bi.get(V),bf=p.clearTime(bi._findCurrentIntervalStart()),be=String(bf.getTime()).concat(A.getTime()).concat(bc.getTime()),bh=bi.rowDataTableStack[be],bd;if(!bh){bh=ao.Node.create(Y);var bb=bh.one(aR);var ba=bi.buildEventsTitleRow(bh,A,bc);bb.append(ba);for(bd=0;bd<bg;bd++){var a9=bi.buildEventsRow(A,bc,bd);bb.append(a9);}bi.rowDataTableStack[be]=bh;}return bh;},buildEventsTitleRow:function(ba,a9,bc){var A=this;var bb=ao.Node.create(au);A.loopDates(a9,bc,function(be,bd){var bf=ao.Node.create(E);
bf.addClass(Z).toggleClass(ab,(bd===0)).toggleClass(R,p.isToday(be)).toggleClass(O,p.isToday(p.subtract(be,p.DAY,1))).toggleClass(a3,p.isToday(p.subtract(be,p.WEEK,1)));bb.append(bf.setContent(be.getDate()));});return bb;},buildGridRowNode:function(bd){var ba=this;var bb=ba._getDisplayRowsCount();var a9=100/bb;var A=ba._getTableGridNode(bd);var bc=ao.Node.create(aa.sub(aD,{height:a9,top:a9*bd}));bc.append(A.toggleClass(G,(bd===0)));return bc;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};},getIntersectEvents:function(a9){var A=this;var bc=A.get(U);var bb=String(a9.getTime());if(!A.evtDateStack[bb]){var ba=bc.getIntersectEvents(a9);A.evtDateStack[bb]=ba.filter(A.get(aN));}return A.evtDateStack[bb];},getNextDate:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return p.add(bb,p.DAY,a9);},getPrevDate:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return p.subtract(bb,p.DAY,a9);},hideEventsOverlay:function(){var A=this;A[P].set(ac,false);},loopDates:function(A,bb,be,bf,bd){var bg=this;var a9=p.clone(A);var ba=bb.getTime();var bc;for(bc=0;a9.getTime()<=ba;bc++){be.apply(bg,[a9,bc]);a9=p.add(a9,(bf||p.DAY),(bd||1));}},plotEvents:function(){var a9=this;var bc=a9._findCurrentIntervalStart();var A=p.safeClearTime(bc);a9.flushViewCache();a9.hideEventsOverlay();a9.bodyNode.all(ai+H).remove();var ba=a9.get(i);var bb=Math.min(ba,a0);a9[o].each(function(bg,be){var bd=p.add(A,p.DAY,bb*be);var bh=p.add(bd,p.DAY,bb-1);var bf=a9.buildEventsTable(bd,bh);if(be===0){bf.addClass(S);}bg.append(bf);});},syncDaysHeaderUI:function(){var a9=this;var bc=a9.get(U);var bd=bc.get(W);var bb=a9.get(d);var A=a9.get(aX);var ba=a9._findFirstDayOfWeek(bd);a9.colHeaderDaysNode.all(ad).each(function(bg,bf){var be=p.add(ba,p.DAY,bf);bg.html(bb.call(a9,be));});},syncGridUI:function(){var bi=this;var bc=bi.getToday();var a9=bi.get(U);bi[K].removeClass(aK);var bb=bi._findCurrentIntervalStart();var be=bi._findCurrentIntervalEnd();if(p.between(bc,bb,be)){var A=a9.get(M);var bg=bi._findFirstDayOfWeek(bc);var bd=p.getWeekNumber(bc,A)-p.getWeekNumber(bb,A);var bh=(bc.getDate()-bg.getDate());var ba=bi._getCellIndex([bh,bd]);var bf=bi[K].item(ba);if(bf){bf.addClass(aK);}}},syncStdContent:function(){var A=this;A.setStdModContent(aj.BODY,A[Q].getDOM());A.setStdModContent(aj.HEADER,A[B].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return p.add(bb,p.DAY,a9);},_findCurrentIntervalStart:function(){var A=this;var a9=A.get(U);return a9.get(W);},_findFirstDayOfWeek:function(ba){var A=this;var bb=A.get(U);var a9=bb.get(M);return p.getFirstDayOfWeek(ba,a9);},_getCellIndex:function(a9){var A=this;return a9[1]*a0+a9[0];},_getDisplayRowsCount:function(){var A=this;var a9=A.get(i);return Math.ceil(a9/a0);},_getDisplayRowDaysCount:function(){var A=this;var a9=A.get(i);return Math.min(a9,a0);},_getEvtLabel:function(ba){var a9=this;var bb=ba.get(at);var A=ba.get(aU);return[A.getHours(),aP,bb.getHours(),x,ba.get(an)].join(w);},_getEvtSplitInfo:function(bd,bg,A,bb){var be=this;var a9=bd.getClearStartDate();var bc=bd.getClearEndDate();var bf=p.getDayOffset(bb,bg);var ba={colspan:Math.min(p.getDayOffset(bc,bg),bf)+1,left:p.before(a9,A),right:p.after(bc,bb)};return ba;},_getRenderableEvent:function(bh,A,bb,bi){var bg=this,be=String(bi.getTime()),ba;if(!bg.evtRenderedStack[be]){bg.evtRenderedStack[be]=[];}for(ba=0;ba<bh.length;ba++){var bf=bh[ba];var a9=bf.get(aU);var bd=p.after(bi,a9)&&!p.isDayOverlap(bi,A);var bc=!p.isDayOverlap(a9,bi);var bj=ao.Array.indexOf(bg.evtRenderedStack[be],bf)>-1;if(!bj&&(bc||bd)){return bf;}}return null;},_getTableGridNode:function(be){var a9=this,bb=a9.get(i),A=a9[aC].item(be),bd=A.one(aV),ba;for(ba=0;ba<Math.min(bb,a0);ba++){var bc=ao.Node.create(aL);bd.append(bc);if(ba===0){bc.addClass(a7);}a9[K].push(bc);}return A;},_onClickMore:function(ba){var A=this;var bb=ba.target;var a9=bb.getData(aT);var bc=ao.NodeList.create();ao.Array.each(a9,function(be){var bd=be.get(u).item(0).clone();bd.setData(ag,be);bd.setStyles({height:"auto",left:0,position:"relative",top:0,width:"auto"});bc.push(bd);});A[P].bodyNode.one(ai+b).setContent(bc);A[P].setAttrs({visible:true,xy:bb.getXY()});},_renderEventsOverlay:function(){var a9=this;var A=a9.get(N);a9[P]=new ao.Overlay({align:{points:[a4,a4]},bodyContent:aa.sub(aq,{label:A[f]}),render:a9[Q],visible:false,width:250,zIndex:450});a9[P].bodyNode.delegate("click",ao.bind(a9.hideEventsOverlay,a9),ai+aH);},_syncEventNodeContainerUI:function(a9,bb,ba){var A=this;bb.addClass(y);if(ba.left){bb.addClass(aQ).prepend(z);}if(ba.right){bb.addClass(a1).append(av);}},_syncEventNodeUI:function(bh,a9,bj){var bi=this;var bc=bi.get(U);var A=bc.get(M);var bb=bh.get(u);var ba=bh.get(aU);var bg=p.clearTime(bi._findCurrentIntervalStart());var bd=p.getFirstDayOfWeek(new Date(Math.max(ba,bg)),A);var bf=Math.floor(p.getDayOffset(bj,bd)/a0);if(bb.size()<=bf){bh.addPaddingNode();}var be=bb.item(bf);be.setStyles({height:"auto",left:0,top:0,width:"auto"});be.appendTo(a9);bh.syncUI();},_uiSetDate:function(a9){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,a0);return A._valueNodeList(ba,a2);},_valueTableGridNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,a0);return A._valueNodeList(ba,aF);},_valueNodeList:function(bb,ba){var A=this;var a9=[];while(bb--){a9.push(ba);}return ao.NodeList.create(a9.join(w));}}});ao.SchedulerTableView=e;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-base","overlay"]});AUI.add("aui-scheduler-view-table-dd",function(j){var S=j.Lang,G=S.isObject,f=j.DataType.DateMath,K=f.WEEK_LENGTH,p=".",F="scheduler-event",z="scheduler-view",M="boundingBox",C="col",g="colgrid",H="content",h="data",b="dd",i="delegate",w="delegateConfig",y="disabled",B="displayDaysInterval",e="dragNode",c="dragging",l="draggingEvent",E="eventRecorder",m="lasso",P="node",I="offsetHeight",J="offsetWidth",R="proxy",L="proxyNode",u="region",r="rowsContainerNode",s="scheduler",N="startDate",t="table",Q="visible",d=j.getClassName,q=d(F),O=d(F,y),o=d(z,t,g),x=d(z,t,c),k=d(z,t,m),a=d(z,t,R,P),D=d(z,t,h,C),v='<div class="'+k+'"></div>',n='<div class="'+a+'"></div>';
j.SchedulerTableViewDD=function(){};j.SchedulerTableViewDD.ATTRS={delegateConfig:{value:{},setter:function(T){var A=this;return j.merge({dragConfig:{offsetNode:false,useShim:false},bubbleTargets:A,container:A.get(M),nodes:p+q,invalid:"input, select, button, a, textarea, "+p+O},T||{});},validator:G}};j.mix(j.SchedulerTableViewDD.prototype,{initializer:function(){var A=this;A[L]=j.Node.create(n);A.after(A.viewDDBindUI,A,"bindUI");A.after(A.viewDDRenderUI,A,"renderUI");A.after(A.viewDDSyncUI,A,"syncUI");},viewDDBindUI:function(){var A=this;var T=A.get(s).get(E);if(T){T.on({cancel:j.bind(A.removeLasso,A),save:j.bind(A.removeLasso,A)});}A[r].on({mousedown:j.bind(A._onMouseDownGrid,A),mousemove:j.bind(A._onMouseMoveGrid,A),mouseup:j.bind(A._onMouseUpGrid,A)});A.after("drag:align",A._afterDragAlign);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);},viewDDRenderUI:function(){var A=this;},viewDDSyncUI:function(){var A=this;A._setupDragDrop();},removeLasso:function(){var A=this;if(A[m]){A[m].remove();}},removeProxy:function(){var A=this;if(A[L]){A[L].remove();}},renderLasso:function(Z,T){var af=this;var W=Z;var Y=T;if(Z[1]>T[1]){W=T;Y=Z;}var ag=W[0],ab=W[1],U=Y[0],A=Y[1],V;af.removeLasso();af.lasso=j.NodeList.create();for(V=ab;V<=A;V++){var X=af.gridCellHeight,ae=af.gridCellWidth,ac=0,aa=(X*V);if(V===ab){if(ab===A){ac+=Math.min(ag,U)*ae;ae*=Math.abs(U-ag)+1;}else{ac+=ag*ae;ae*=K-ag;}}else{if(V===A){ae*=U+1;}else{ae*=K;}}var ad=j.Node.create(v);af.lasso.push(ad);af[r].append(ad);ad.sizeTo(ae,X);ad.setXY(af._offsetXY([ac,aa],1));}},_afterDragAlign:function(A){var Z=this;var aa=A.target;var W=Z.bodyNode.get(u);var X={bottom:A.pageY,left:A.pageX,right:A.pageX,top:A.pageY};if(!j.DOM.inRegion(null,W,true,X)){return;}var Y=Z[l];var T=[A.pageX,A.pageY];var V=Z._findPosition(Z._offsetXY(T,-1));if(Y&&Z._hasLassoChanged(V)){Z.lassoLastPosition=V;var U=f.add(Z._getPositionDate(V),f.MINUTES,Y.getMinutesDuration());Z.renderLasso(V,Z._getDatePosition(U));}},_findPosition:function(V){var A=this;var U=Math.floor(V[0]/A.gridCellWidth);var T=Math.floor(V[1]/A.gridCellHeight);return[U,T];},_getDatePosition:function(U){var T=this;var V=T._findCurrentIntervalStart();var W=f.getDayOffset(U,V);var A=[];A[1]=Math.floor(W/K);A[0]=W%K;return A;},_getPositionDate:function(U){var T=this;var W=T._findCurrentIntervalStart();var A=f.safeClearTime(T._findFirstDayOfWeek(W));var V=f.add(A,f.DAY,T._getCellIndex(U));V.setHours(0,0,0,0);return V;},_hasLassoChanged:function(T){var A=this;var U=A.lassoLastPosition||A.lassoStartPosition;return U&&((T[0]!==U[0])||(T[1]!==U[1]));},_offsetXY:function(V,U){var A=this;var T=A[r].getXY();return[V[0]+T[0]*U,V[1]+T[1]*U];},_onEventDragEnd:function(T){var A=this;var V=A[l];if(V){var U=A._getPositionDate(A.lassoLastPosition);f.copyHours(U,V.get(N));V.move(U);V.set(Q,true,{silent:true});A[r].removeClass(x).unselectable();T.target.set(e,A.originalDragNode);A.removeLasso();A.removeProxy();A.get(s).syncEventsUI();}A[l]=null;},_onEventDragStart:function(W){var A=this;var X=A[l]=A[i][b].get(P).getData(F);if(X){A._syncCellDimensions();var U=[W.pageX,W.pageY];var V=A._findPosition(A._offsetXY(U,-1));var T=f.add(A._getPositionDate(V),f.MINUTES,X.getMinutesDuration());A.renderLasso(V,A._getDatePosition(T));X.set(Q,false,{silent:true});A._syncProxyNodeUI(X);A.lassoStartPosition=A.lassoLastPosition=V;A[r].addClass(x).unselectable();A.originalDragNode=W.target.get(e);W.target.set(e,A[L]);}},_onMouseDownGrid:function(W){var A=this;var V=A.get(s);var U=V.get(E);var X=W.target;if(U&&X.test([p+o,p+D].join())){A._recording=true;A._syncCellDimensions();var T=A._offsetXY([W.pageX,W.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(T);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[r].unselectable();}},_onMouseMoveGrid:function(V){var T=this;var W=V.currentTarget;var U=[V.pageX,V.pageY];var A=T._findPosition(T._offsetXY(U,-1));if(T._recording&&T._hasLassoChanged(A)){T.lassoLastPosition=A;T.renderLasso(T.lassoStartPosition,A);}},_onMouseUpGrid:function(Y){var T=this;var X=T.get(s);var V=X.get(E);if(V&&T._recording&&!X.get(y)){var W=T._getPositionDate(T.lassoStartPosition);var U=T._getPositionDate(T.lassoLastPosition);var A=new Date(Math.min(W,U));A.setHours(0,0,0);var Z=new Date(Math.max(W,U));Z.setHours(23,59,59);V.setAttrs({allDay:true,endDate:Z,startDate:A},{silent:true});V.showOverlay([Y.pageX,Y.pageY]);T._recording=false;}},_setupDragDrop:function(){var T=this;if(!T[i]){T[i]=new j.DD.Delegate(T.get(w));}var A=T[i][b];A.unplug(j.Plugin.DDConstrained);A.unplug(j.Plugin.DDNodeScroll);A.unplug(j.Plugin.DDProxy);A.plug(j.Plugin.DDConstrained,{bubbleTargets:T,constrain:T.bodyNode});A.plug(j.Plugin.DDNodeScroll,{node:T.bodyNode,scrollDelay:150});A.plug(j.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false});},_syncCellDimensions:function(){var A=this;var U=A.get(B);var T=Math.ceil(U/K);var V=Math.min(U,K);A.gridCellHeight=A[r].get(I)/T;A.gridCellWidth=A[r].get(J)/V;},_syncProxyNodeUI:function(T){var A=this;var U=T.get(P).item(0);A[L].setStyles({backgroundColor:U.getStyle("backgroundColor"),display:"block",width:"200px"});A[L].appendTo(A[r]);A[L].setContent(T.get(H));}});j.Base.mix(j.SchedulerTableView,[j.SchedulerTableViewDD]);},"@VERSION@",{skinnable:false,requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-view-month",function(o){var f=o.Lang,a=f.isFunction,c=o.DataType.DateMath,p=".",h="col",g="data",d="date",v="firstDayOfWeek",e="locale",m="month",w="nomonth",i="scheduler",j="table",u="tableRowContainer",n="title",r="viewDate",q="scheduler-view",l="scheduler-view-month",t=o.getClassName,s=t(l,j,g,h,w),k=t(q,j,g,h,n);var b=o.Component.create({NAME:l,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:m},navigationDateFormatter:{value:function(y){var x=this;var z=x.get(i);return o.DataType.Date.format(y,{format:"%B %Y",locale:z.get(e)});},validator:a}},EXTENDS:o.SchedulerTableView,prototype:{getAdjustedViewDate:function(y){var x=this;
return c.findMonthStart(y);},getNextDate:function(){var x=this;var z=x.get(i);var y=z.get(d);return c.add(y,c.MONTH,1);},getPrevDate:function(){var x=this;var z=x.get(i);var y=z.get(d);return c.subtract(y,c.MONTH,1);},plotEvents:function(){var x=this;o.SchedulerMonthView.superclass.plotEvents.apply(x,arguments);var y=x.get(i);var C=y.get(r);var B=c.findMonthEnd(C);var A=c.findMonthStart(C);var z=x._findCurrentIntervalStart();var D=x[u].all(p+k);D.each(function(G,E){var F=c.add(z,c.DAY,E);if(c.before(F,A)||c.after(F,B)){G.addClass(s);}});},_findCurrentIntervalStart:function(){var x=this;var y=x.get(i);var z=y.get(r);return x._findFirstDayOfWeek(z);},_findFirstDayOfWeek:function(z){var x=this;var A=x.get(i);var y=A.get(v);return c.getFirstDayOfWeek(z,y);}}});o.SchedulerMonthView=b;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-table"]});AUI.add("aui-scheduler-event-recorder",function(x){var aq=x.Lang,F=aq.isArray,R=aq.isObject,p=aq.isString,B=aq.isUndefined,ag=x.IO.prototype._serialize,o=x.DataType.DateMath,I="-",D=".",b=" ",Q="scheduler-event",ao="scheduler-event-recorder",e="activeView",M="arrow",Z="body",u="bodyContent",K="bottom",ah="boundingBox",O="cancel",W="click",t="constrain",S="content",r="date",Y="dateFormat",s="delete",an="endDate",h="event",k="footerContent",d="form",L="header",af="isoTime",ap="node",T="offsetHeight",X="offsetWidth",C="overlay",ak="overlayOffset",am="recorder",ae="rendered",al="right",V="save",G="scheduler",ad="schedulerChange",q="shadow",aj="startDate",a="strings",f="submit",j="template",P="title",ac="toolbar",ab="visibleChange",n=x.getClassName,E=n(Q),aa=n(Q,P),w=n(Q,am),v=n(G,h,am,C),c=n(G,h,am,C,M),l=n(G,h,am,C,M,K),J=n(G,h,am,C,M,al),U=n(G,h,am,C,M,q),N=n(G,h,am,C,Z),H=n(G,h,am,C,S),m=n(G,h,am,C,r),ai=n(G,h,am,C,d),z=n(G,h,am,C,L),y=new x.Template('<div class="',U," ",c,'"></div>','<div class="',c,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',z,'">','<input class="',H,'" name="content" value="{content}" />',"</div>",'<div class="',N,'">','<label class="',m,'">{date}</label>',"</div>"),i='<form class="'+ai+'" id="schedulerEventRecorderForm"></form>';var g=x.Component.create({NAME:ao,ATTRS:{allDay:{value:false},content:{},duration:{value:60},dateFormat:{validator:p,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return x.SchedulerEvent;}},strings:{value:{},setter:function(A){return x.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's",cancel:"Cancel",description:"Description",edit:"Edit",save:"Save",when:"When"},A||{});},validator:R},overlay:{validator:R,value:{constrain:null,visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:F},template:{value:y},toolbar:{setter:function(at){var ar=this;var A=ar.get(a);return x.merge({children:[{handler:x.bind(ar._handleSaveEvent,ar),label:A[V]},{handler:x.bind(ar._handleCancelEvent,ar),label:A[O]},{handler:x.bind(ar._handleDeleteEvent,ar),label:A[s]}]},at||{});},validator:R,value:{}}},EXTENDS:x.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(ap).addClass(w);A.publish("cancel",{defaultFn:A._defCancelEventFn});A.publish("delete",{defaultFn:A._defDeleteEventFn});A.publish("edit",{defaultFn:A._defEditEventFn});A.publish("save",{defaultFn:A._defSaveEventFn});A.after(ad,A._afterSchedulerChange);A[C]=new x.Overlay(A.get(C));A[ac]=new x.Toolbar(A.get(ac));},getOverlayContentNode:function(){var A=this;var ar=A[C].get(ah);return ar.one(D+H);},getUpdatedSchedulerEvent:function(at){var A=this,au=A.get(h),ar={silent:!au},av=A.serializeForm();if(!au){au=A.clone();}au.set(G,A.get(G),{silent:true});au.setAttrs(x.merge(av,at),ar);return au;},_afterSchedulerChange:function(au){var A=this;var at=au.newVal;var ar=at.get(ah);A[C].set(t,ar);ar.delegate(W,x.bind(A._onClickSchedulerEvent,A),D+E);},_defCancelEventFn:function(ar){var A=this;A.get(ap).remove();A.hideOverlay();},_defDeleteEventFn:function(at){var A=this;var ar=A.get(G);ar.removeEvent(A.get(h));A.hideOverlay();ar.syncEventsUI();},_defEditEventFn:function(at){var A=this;var ar=A.get(G);A.hideOverlay();ar.syncEventsUI();},_defSaveEventFn:function(at){var A=this;var ar=A.get(G);ar.addEvent(at.newSchedulerEvent);A.hideOverlay();ar.syncEventsUI();},_handleCancelEvent:function(ar){var A=this;A.fire("cancel");ar.preventDefault();},_handleDeleteEvent:function(ar){var A=this;A.fire("delete",{schedulerEvent:A.get(h)});ar.preventDefault();},_handleSaveEvent:function(at){var A=this,ar=A.get(h)?"edit":"save";A.fire(ar,{newSchedulerEvent:A.getUpdatedSchedulerEvent()});at.preventDefault();},_onClickSchedulerEvent:function(at){var A=this;var ar=at.currentTarget.getData(Q);if(ar){A.set(h,ar,{silent:true});A.showOverlay([at.pageX,at.pageY]);A.get(ap).remove();}},_onOverlayVisibleChange:function(ar){var A=this;if(ar.newVal){A.populateForm();if(!A.get(h)){var at=A.getOverlayContentNode();if(at){setTimeout(function(){at.selectText();},0);}}}else{A.set(h,null,{silent:true});A.get(ap).remove();}},_onSubmitForm:function(ar){var A=this;A._handleSaveEvent(ar);},_renderOverlay:function(){var ar=this;var A=ar.get(a);ar[C].render();ar[ac].render();var at=ar[C].get(ah);at.addClass(v);ar[C].set(k,ar[ac].get(ah));ar[C].on(ab,x.bind(ar._onOverlayVisibleChange,ar));ar.formNode=x.Node.create(i);ar[C].set(u,ar.formNode);ar.formNode.on(f,x.bind(ar._onSubmitForm,ar));},getFormattedDate:function(){var at=this;var ar=at.get(Y);var av=(at.get(h)||at);var ax=av.get(an);var aw=av.get(G);var A=av.get(aj);var au=(aw.get(e).get(af)?o.toIsoTimeString:o.toUsTimeString);return[av._formatDate(A,ar),au(A),I,au(ax)].join(b);},getTemplateData:function(){var ar=this,A=ar.get(a),at=ar.get(h)||ar,au=at.get(S);if(B(au)){au=A["description-hint"];}return{content:au,date:ar.getFormattedDate(),endDate:at.get(an).getTime(),startDate:at.get(aj).getTime()};},hideOverlay:function(){var A=this;A[C].hide();},populateForm:function(){var A=this;A.formNode.setContent(A.get(j).parse(A.getTemplateData()));
},serializeForm:function(){var A=this;return x.QueryString.parse(ag(A.formNode.getDOM()));},showOverlay:function(aC,at){var aB=this,az=aB[C].get(t),au=aB.get(ak),ax=aC.concat([]);if(!aB[C].get(ae)){aB._renderOverlay();}aB[C].show();if(!aC){var ay=(aB.get(h)||aB).get(ap);var ar=ay.one(D+aa);at=[au[0]+ar.get(X),au[1]+ar.get(T)/2];aC=ar.getXY();}at=at||au;aC[0]+=at[0];aC[1]+=at[1];var A=aB[C].get(ah),aw=A.get(X),av=A.one(D+z),aA=A.all(D+c);if((aC[0]+aw)>=az.get(X)){aA.addClass(J);aC[0]-=aw+aA.item(0).get(X);}aB[C].set("xy",aC);if(ax[1]>=(av.get(T)+av.getY())){aA.addClass(l);}else{aA.removeClass(l);}}}});x.SchedulerEventRecorder=g;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-base","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler",function(a){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view-day","aui-scheduler-view-week","aui-scheduler-view-table","aui-scheduler-view-table-dd","aui-scheduler-view-month","aui-scheduler-event-recorder"],skinnable:false});