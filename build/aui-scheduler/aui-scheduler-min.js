AUI.add("aui-scheduler-base",function(AK){var w=AK.Lang,Ah=w.isString,g=w.isObject,C=w.isArray,G=w.isDate,p=w.isNumber,o=function(A){return(A instanceof AK.Scheduler);},Y=function(A){return(A instanceof AK.SchedulerView);},AH=function(A){return(A instanceof AK.SchedulerEvent);},a=function(A){return(AK.SchedulerCalendar&&(A instanceof AK.SchedulerCalendar));},L=AK.DataType.DateMath,AD=AK.WidgetStdMod,Af="-",AB=".",T="",U=" ",W="scheduler-base",AQ="data-view-name",m="activeView",S="boundingBox",Ag="clearfix",l="controls",AS="controlsNode",AV="current",AJ="currentDate",AF="currentDateNode",AR="date",AI="dateFormat",Ab="day",AP="endDate",Ai="events",i="firstDayOfWeek",An="hd",Ae="headerNode",Q="helper",z="icon",N="iconNextNode",Aa="iconPrevNode",Al="locale",I="month",P="name",x="nav",t="navNode",R="next",F="nextDate",Ad="prev",AT="prevDate",Am="rendered",s="scheduler",AW="srcNode",Ak="startDate",j="strings",AY="template",H="today",AL="todayNode",b="triggerNode",e="view",Ao="views",AE="viewsNode",v="week",X="year",AZ="navigationDateFormat",u="eventRecorder",f=AK.ClassNameManager.getClassName,AM=f(Q,Ag),M=f(z),AX=f(W,l),AA=f(W,AV,AR),K=f(W,An),AC=f(W,z,R),h=f(W,z,Ad),Aj=f(W,x),d=f(W,H),AG=f(W,e),V=f(W,Ao),J=f(W,e,T),Z=f(W,e,Ab),B=f(W,e,I),D=f(W,e,v),AO=f(W,e,X),k=f(s,e,T),AU='<div class="'+AX+'"></div>',c='<div class="'+AA+'"></div>',E='<div class="'+K+'"></div>',Ap='<a href="#" class="'+[M,AC].join(U)+'">Next</a>',AN='<a href="#" class="'+[M,h].join(U)+'">Prev</a>',O='<div class="'+Aj+'"></div>',y='<a href="#" class="'+d+'">{today}</a>',Ac='<a href="#" class="'+[AG,J].join(U)+'{name}" data-view-name="{name}">{label}</a>',q='<div class="'+V+'"></div>';var r=function(){};r.ATTRS={events:{value:[],setter:"_setEvents",validator:C}};AK.mix(r.prototype,{addEvent:function(Aq){var A=this;var Ar=A.get(Ai);if(AK.Array.indexOf(Ar,Aq)>-1){AK.Array.removeItem(Ar,Aq);}Ar.push(Aq);A.set(Ai,Ar);},addEvents:function(Aq){var A=this;AK.Array.each(A._normalizeEvents(Aq),AK.bind(A.addEvent,A));},removeEvent:function(Aq){var A=this;var Ar=A.get(Ai);AK.Array.removeItem(Ar,Aq);A.set(Ai,Ar);},removeEvents:function(Aq){var A=this;AK.Array.each(A._normalizeEvents(Aq),AK.bind(A.removeEvent,A));},_normalizeEvents:function(Ar){var A=this;var Aq=[];Ar=AK.Array(Ar);AK.Array.each(Ar,function(As,At){if(AH(As)){Aq.push(As);}else{if(a(As)){Aq=Aq.concat(A._normalizeEvents(As.get(Ai)));}else{As=new AK.SchedulerEvent(As);Aq.push(As);}}if(o(A)){As.set(s,A);}});return Aq;},_setEvents:function(Aq){var A=this;return A._normalizeEvents(Aq);}});AK.SchedulerEventSupport=r;var n=AK.Component.create({NAME:W,ATTRS:{activeView:{validator:Y},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(Ar){var A=this;var Aq=A.get(m);if(Aq){return Aq.get(AZ);}return Ar;},value:"%A - %d %b %Y",validator:Ah},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:G},firstDayOfWeek:{value:0,validator:p},controlsNode:{valueFn:function(){return AK.Node.create(AU);}},currentDateNode:{valueFn:function(){return AK.Node.create(c);}},headerNode:{valueFn:function(){return AK.Node.create(E);}},iconNextNode:{valueFn:function(){return AK.Node.create(Ap);}},iconPrevNode:{valueFn:function(){return AK.Node.create(AN);}},navNode:{valueFn:function(){return AK.Node.create(O);}},todayNode:{valueFn:function(){return AK.Node.create(this._processTemplate(y));}},viewsNode:{valueFn:function(){return AK.Node.create(q);}}},HTML_PARSER:{controlsNode:AB+AX,currentDateNode:AB+AA,headerNode:AB+K,iconNextNode:AB+AC,iconPrevNode:AB+h,navNode:AB+Aj,todayNode:AB+d,viewsNode:AB+V},UI_ATTRS:[AJ],AUGMENTS:[AK.SchedulerEventSupport,AK.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(AS);A.currentDateNode=A.get(AF);A.iconNextNode=A.get(N);A.iconPrevNode=A.get(Aa);A.navNode=A.get(t);A.schedulerHeaderNode=A.get(Ae);A.todayNode=A.get(AL);A.viewsNode=A.get(AE);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;AK.Array.each(A.get(Ai),function(Aq,Ar){Aq.eachRepeatedEvent(function(At,As){delete At._filtered;});delete Aq._filtered;});},getEventsByDay:function(Aq){var A=this;Aq=L.safeClearTime(Aq);return A._getEvents(Aq,function(Ar){return L.compare(Ar.getClearStartDate(),Aq);});},getIntersectEvents:function(Aq){var A=this;Aq=L.safeClearTime(Aq);return A._getEvents(Aq,function(As){var Ar=As.getClearStartDate();var At=As.getClearEndDate();return(L.compare(Aq,Ar)||L.compare(Aq,At)||L.between(Aq,Ar,At));});},sortEventsByDateAsc:function(Aq){var A=this;Aq.sort(function(Au,As){var At=Au.get(AP);var Ar=As.get(AP);var Aw=Au.get(Ak);var Av=As.get(Ak);if(L.after(Aw,Av)||L.compare(Aw,Av)&&L.before(At,Ar)){return 1;}else{return -1;}});},getViewByName:function(Aq){var A=this;return A.viewStack[Aq];},getStrings:function(){var A=this;return A.get(j);},getString:function(Aq){var A=this;return A.getStrings()[Aq];},renderView:function(Aq){var A=this;if(Aq){Aq.show();if(!Aq.get(Am)){var Ar=Aq.get(P);if(!A.bodyNode){A.setStdModContent(AD.BODY,T);}Aq.render(A.bodyNode);}}},plotViewEvents:function(Aq){var A=this;Aq.plotEvents(A.get(Ai));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(m));},_afterActiveViewChange:function(As){var Aq=this;if(Aq.get(Am)){var Ar=As.newVal;var A=As.prevVal;if(A){A.hide();}Aq.renderView(Ar);}},_afterRender:function(Aq){var A=this;A.renderView(A.get(m));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,AB+AG,A);A.controlsNode.delegate("click",A._onClickPrevIcon,AB+h,A);A.controlsNode.delegate("click",A._onClickNextIcon,AB+AC,A);A.controlsNode.delegate("click",A._onClickToday,AB+d,A);},_createViewTriggerNode:function(Aq){var A=this;if(!Aq.get(b)){var Ar=Aq.get(P);Aq.set(b,AK.Node.create(AK.substitute(Ac,{name:Ar,label:(A.getString(Ar)||Ar)})));
}return Aq.get(b);},_getEvents:function(Aq,As){var A=this;var Ar=A.get(Ai);var At=[];AK.Array.each(Ar,function(Au,Av){if(As.apply(A,[Au])){At.push(Au);}else{if(Au.isRepeatableDate(Aq)){var Aw=Au.repeatByDate(Aq);At.push(Aw);}}});A.sortEventsByDateAsc(At);return At;},_onClickToday:function(Aq){var A=this;A.set(AJ,A.get(m).getToday());Aq.preventDefault();},_onClickNextIcon:function(Aq){var A=this;A.set(AJ,A.get(m).get(F));Aq.preventDefault();},_onClickPrevIcon:function(Aq){var A=this;A.set(AJ,A.get(m).get(AT));Aq.preventDefault();},_onClickViewTrigger:function(Ar){var A=this;var As=Ar.currentTarget;var At=As.attr(AQ);var Aq=A.getViewByName(At);A.set(m,Aq);Ar.preventDefault();},_processTemplate:function(Aq){var A=this;return AK.substitute(Aq,A.getStrings());},_setEventRecorder:function(Aq){var A=this;if(Aq){Aq.set(s,A);}},_setViews:function(Ar){var A=this;var Aq=[];AK.Array.each(Ar,function(As){if(Y(As)&&!As.get(Am)){As.set(s,A);Aq.push(As);A.viewStack[As.get(P)]=As;}});if(!A.get(m)){A.set(m,Ar[0]);}return Aq;},syncStdContent:function(){var A=this;var Aq=A.get(Ao);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);AK.Array.each(Aq,function(Ar){A.viewsNode.append(A._createViewTriggerNode(Ar));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(AM);A.setStdModContent(AD.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(Au){var Ar=this;var Aq=Ar.get(AZ);var A=Ar.get(Al);var At=AK.DataType.Date.format(Au,{format:Aq,locale:A});Ar.currentDateNode.html(At);if(Ar.get(Am)){var As=Ar.get(m);if(As){As._uiSetCurrentDate(Au);}Ar.syncEventsUI();}}}});AK.Scheduler=n;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(B3){var CK=B3.Lang,Cb=CK.isObject,Bs=CK.isString,Au=CK.isBoolean,Ag=CK.isNumber,BE=function(A){return A==0?0:(A<0?-1:1);},Ak=function(A,AM){return Math.max(Math.abs(A),AM)*BE(A);},Bf=function(A){return parseFloat(A)||0;},Bh=function(AM,A){return Math.round(AM/A)*A;},AR=B3.DataType.DateMath,Bz=B3.WidgetStdMod,Al=AR.WEEK_LENGTH,Bj="scheduler-view",Af="scheduler-view-day",B7="scheduler-view-week",CU="scheduler-view-month",Be="activeView",A6="am",V="borderLeftWidth",CB="borderRightWidth",Aq="boundingBox",R="children",BW="childNodes",AG="col",i="colblank",Z="coldata",Ai="colday",B="colgrid",BR="colmonth",w="colspan",N="coltime",CP="columnNode",AX="colDaysNode",B5="colHeaderDaysNode",Ao="container",Am="content",CR="contentBox",AV="createDocumentFragment",BB="currentDate",BX="data",BA="dateFormat",CH="day",u="days",e="delegateConfig",x="div",BJ="division",AB="down",B9="dragNode",Br="duration",Aa="endDate",A2="event",Bx="events",Cd="eventRecorder",T="eventWidth",Ah="first",B8="firstDayOfWeek",A8="grid",Cc="hd",B1="header",A9="headerDateFormat",CY="headerTableNode",Bm="height",Ap="host",Ae="hourHeight",W="icon",AK="isoTime",BF="labelAM",Ac="labelPM",Ar="left",AY="locale",AC="marker",A4="markercell",Ax="markercellsNode",Bk="markercellNode",l="markers",Bc="month",A7="monthContainerNode",Ba="navigationDateFormat",An="next",Bi="nextDate",Ce="node",AJ="nomonth",AS="noscroll",B0="offsetHeight",k="offsetTop",B2="offsetWidth",CF="ownerDocument",B4="pad",CM="parentEvent",r="parentNode",AO="pm",AA="prevDate",BQ="proxy",AH="px",As="rendered",By="repeated",Ay="right",BO="row",S="scheduler",Ad="scheduler-event",y="scrollable",t="shim",B6="startDate",At="table",CS="tableColNode",K="tableDataNode",d="tableGridNode",BU="tableNode",Bt="tableTimeNode",BS="tbody",F="td",BL="time",AI="timesNode",H="title",AL="today",BP="top",CZ="tr",a="trigger",CN="week",BY="width",Bg="-",L="a",Bl=".",Bd="",BZ="%",v=" ",f=B3.ClassNameManager.getClassName,BK=f(Bj,AS),AD=f(Bj,y);var Aw=B3.Component.create({NAME:Bj,ATTRS:{bodyContent:{value:Bd},height:{value:600},isoTime:{value:false,validator:Au},name:{value:Bd,validator:Bs},navigationDateFormat:{value:"%A - %d %b %Y",validator:Bs},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:Au},triggerNode:{setter:B3.one},visible:{value:false}},BIND_UI_ATTRS:[y],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);Cf.set(BB,AM);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return AR.clearTime(new Date());},limitDate:function(AM,Cf){var A=this;if(AR.after(AM,Cf)){AM=AR.clone(Cf);}return AM;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(Cf){var A=this;var AM=A.get(S);A.adjustCurrentDate();A._uiSetScrollable(A.get(y));},_setScheduler:function(Cf){var A=this;var AM=A.get(S);if(AM){A.removeTarget(AM);}if(Cf){A.addTarget(Cf);Cf.after("eventsChange",B3.bind(A.flushViewCache,A));}return Cf;},_uiSetScrollable:function(Cf){var A=this;var AM=A.bodyNode;if(AM){AM.toggleClass(AD,Cf);AM.toggleClass(BK,!Cf);}},_uiSetVisible:function(AM){var A=this;Aw.superclass._uiSetVisible.apply(this,arguments);if(AM&&A.get(As)){A.adjustCurrentDate();}}}});B3.SchedulerView=B3.Base.create(Bj,Aw,[B3.WidgetStdMod]);var o=function(A,AM){return function(Cg){var Cf=Cg.all(A);return(Cf.size()>=AM)?Cf:null;};},Aj=f(Ad),Bo=f(Ad,BQ),b=f(Bj,Z),D=f(Bj,B),q=f(S,AL),AQ=f(S,AL,Cc),CC=f(Bj,A8),CD=f(Bj,A8,Ao),CG=f(Bj,A4),m=f(Bj,l),BI=f(Bj,AC,BJ),BV=f(Bj,At),CJ=f(Bj,CH,B1,At),U=f(Bj,CH,B1,CH),BH=f(Bj,CH,B1,CH,B4,Ay),Bq=f(Bj,CH,B1,CH,Ah),A1=f(Bj,CH,B1,AG),CW=f(Bj,At,AG),Ab=f(Bj,At,AG,t),p=f(Bj,At,i),h=f(Bj,At,Ai),O=f(Bj,At,Ai,B1),CO=f(Bj,At,N),BN=f(Bj,At,BL),AE='<div class="'+CG+'">'+'<div class="'+BI+'"></div>'+"</div>",AU='<table class="'+BV+'">'+"<tbody>"+'<tr class="'+D+'" height="1">'+'<td height="0" class="'+[CW,p].join(v)+'"></td>'+'<td class="'+CD+'" colspan="1">'+'<div class="'+CC+'">'+'<div class="'+m+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+b+'">'+'<td class="'+[CW,CO].join(v)+'"></td>'+"</tr>"+"</tbody>"+"</table>",BD='<td class="'+[CW,h].join(v)+'">'+'<div class="'+Ab+'"></div>'+"</td>",J='<div class="'+BN+'">{hour}</div>',AW='<table class="'+CJ+'">'+"<tbody>"+'<tr class="'+A1+'"></tr>'+"</tbody>"+"</table>",BG='<th class="'+U+'"><a href="#">&nbsp;</a></th>',AT='<td class="'+[U,Bq].join(v)+'"></td>',X='<th class="'+[U,BH].join(v)+'">&nbsp;</th>';
var CX=B3.Component.create({NAME:Af,ATTRS:{bodyContent:{value:Bd},days:{value:1,validator:Ag},delegateConfig:{value:{},setter:function(AM){var A=this;return B3.merge({bubbleTargets:A,container:A.get(Aq),nodes:Bl+Aj},AM||{});},validator:Cb},headerDateFormat:{value:"%a %d/%m",validator:Bs},name:{value:CH},hourHeight:{value:52,validator:Ag},eventWidth:{value:95,validator:Ag},headerTableNode:{valueFn:function(){return B3.Node.create(AW);}},tableNode:{valueFn:function(){return B3.Node.create(AU);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:o(Bl+U,2),colDaysNode:o(Bl+h,1),markercellsNode:o(Bl+CG,24),timesNode:o(Bl+BN,24),headerTableNode:Bl+CJ,tableNode:Bl+BV},EXTENDS:B3.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(AX);A.colHeaderDaysNode=A.get(B5);A.headerTableNode=A.get(CY);A.markercellsNode=A.get(Ax);A.tableNode=A.get(BU);A.timesNode=A.get(AI);A.colShimNodes=A.colDaysNode.all(Bl+Ab);A.colDataNode=A.tableNode.one(Bl+b);A.colTimeNode=A.tableNode.one(Bl+CO);A.dayHeaderColNode=A.headerTableNode.one(Bl+A1);A.gridContainer=A.tableNode.one(Bl+CD);A.markersNode=A.tableNode.one(Bl+m);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",B3.bind(A._onClickDaysHeader,A),Bl+U);A.colDataNode.delegate("mousedown",B3.bind(A._onMouseDownTableCol,A),Bl+CW);A.colDataNode.delegate("mouseup",B3.bind(A._onMouseUpTableCol,A),Bl+CW);A.colDataNode.delegate("mousemove",B3.bind(A._onMouseMoveTableCol,A),Bl+CW);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;CX.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(w,A.get(u));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(Bz.BODY,A.tableNode.getDOM());A.setStdModContent(Bz.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(Cg){var AM=this;var A=AM.get(Ae);var Cf=Cg.getHours();var Ch=Cg.getMinutes();var Ci=Cg.getSeconds();return((Cf*60)+Ch+(Ci/60))*(A/60);},calculateHoursByTop:function(Ch){var AM=this;var A=AM.get(Ae);var Cj=Bf((Ch/A).toFixed(2));var Ci=0;var Cg=Math.floor((Cj*100)%100*0.6);var Cf=Math.floor(Cj);return[Cf,Cg,Ci];},getNextDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.add(AM,AR.DAY,1);},getPrevDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.subtract(AM,AR.DAY,1);},getColumnByDate:function(Cf){var A=this;var Cg=A.get(S);var AM=AR.safeClearTime(Cg.get(BB));var Ch=AR.getDayOffset(AR.safeClearTime(Cf),AM);return A.colDaysNode.item(Ch);},getDateByColumn:function(Cf){var A=this;var Cg=A.get(S);var AM=AR.safeClearTime(Cg.get(BB));return AR.add(AM,AR.DAY,Cf);},plotEvents:function(Cf){var A=this;var AM=A.get(S);A.colShimNodes.each(function(Cj,Ci){var Ch=A.getDateByColumn(Ci);var Cg=AM.getEventsByDay(Ch);Cj.empty();B3.Array.each(Cg,function(Ck,Cl){if(!Ck.isDayOverlapEvent()){Cj.append(Ck.get(Ce));Ck.set(CP,Cj.get(r));A.syncEventTopUI(Ck);A.syncEventHeightUI(Ck);}});A.syncEventsIntersectionUI(Cg);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(Cg,Cf){var AM=A.getDateByColumn(Cf);Cg.toggleClass(q,AR.isToday(AM));});},syncDaysHeaderUI:function(){var Cf=this;var Ch=Cf.get(S);var Cg=Ch.get(BB);var AM=Cf.get(A9);var A=Cf.get(AY);Cf.colHeaderDaysNode.all(L).each(function(Ck,Cj){var Ci=AR.add(Cg,AR.DAY,Cj);var Cl=B3.DataType.Date.format(Ci,{format:AM,locale:A});Ck.toggleClass(AQ,AR.isToday(Ci));Ck.html(Cl);});},syncEventsIntersectionUI:function(AM){var A=this;var Cf=A.get(S);var Cg=A.get(T);Cf.flushEvents();B3.Array.each(AM,function(Ci,Cj){var Cl=A.findEventIntersections(Ci,AM);var Ck=Cl.length;var Ch=(Cg/Ck);B3.Array.each(Cl,function(Cn,Co){var Cm=Cn.get(Ce);var Cq=Ch*Co;var Cp=Ch*1.7;if(Co==(Ck-1)){Cp=Cg-Cq;}Cm.setStyle(BY,Cp+BZ);Cm.setStyle(Ar,Cq+BZ);var Cr=Cm.get(r);if(Cr){Cr.insert(Cm,Co);}Cn._filtered=true;});});},syncEventHeightUI:function(Cf){var AM=this;var A=AM.get(Ae);var Ch=AM.calculateTopByDate(Cf.get(B6));var Cg=AM.calculateTopByDate(Cf.get(Aa));Cf.get(Ce).set(B0,Math.max(Cg-Ch,A/2));},syncEventRecorderUI:function(Cg){var A=this;var Cf=A.get(S);var Ch=Cf.get(Cd);var AM=Ch.get(Ce);if(Cg&&!AM.inDoc()){Cg.append(AM);}A.syncEventTopUI(Ch);A.syncEventHeightUI(Ch);},syncEventTopUI:function(Cf){var AM=this;var A=Cf.get(Ce);var Cg=AM.calculateTopByDate(Cf.get(B6));A.setStyle(BP,Cg+AH);},findEventIntersections:function(AM,Cf){var A=this;var Cg=[];B3.Array.each(Cf,function(Ci,Ch){if(!AM._filtered&&!Ci.isDayOverlapEvent()&&AM.intersectHours(Ci)){Cg.push(Ci);}});return Cg;},_createEvents:function(){var A=this;var AM=function(Cf,Cg){A.publish(Cf,{defaultFn:Cg,queuable:false,emitFacade:true,bubbles:true});};},_dragTickAlignX:function(AM){var Cn=this;var Co=AM.target.get(Ap);var Cp=Cn._getColumnRefWidth();var Ch=Co.get(Ce);var Ck=Cn.proxyEvt;var Cl=Ch.getData(Ad);var Cm=(Co.actXY[0]-Cn.bodyNode.getX()-Cn.colTimeNode.get(B2));var Cf=Math.floor(Cm/Cp);var Cj=Cn.colDaysNode.item(Cf);var Ci=Cn.getDateByColumn(Cf);var A=AR.clone(Ci);var Cg=AR.clone(Ci);AR.copyHours(Cg,Ck.get(Aa));AR.copyHours(A,Ck.get(B6));Ck.set(Aa,Cg);Ck.set(B6,A);},_dragTickAlignY:function(Cf){var Ck=this;var Cl=Cf.target.get(Ap);var Ch=Cl.get(Ce);var Ci=Ck.proxyEvt;var Cj=Ch.getData(Ad);var AM=AR.clone(Ci.get(B6));var A=Ck.calculateHoursByTop(Bf(Cl.get(B9).getComputedStyle(BP)));Ck._setTickedHours(AM,A);var Cg=AR.clone(AM);Ci.set(Aa,AR.add(Cg,AR.MINUTES,Ck._currentEvtDuration));Ci.set(B6,AM);Ci.syncNodeTitleUI();},_getXYDelta:function(AM){var A=this;var Cg=AM.currentTarget;var Cf=Cg.getXY(),Ch=[AM.pageX,AM.pageY];
return B3.Array.map(Cf,function(Cj,Ci){return(Ch[Ci]-Cj);});},_getTickY:function(){var A=this;return Bh(Math.ceil(A.get(Ae)/2),10);},_getColumnRefWidth:function(){var A=this;var AM=A.colDaysNode.item(0);return Bf(AM.getStyle(BY))-Bf(AM.getStyle(CB))-Bf(AM.getStyle(V));},_setupDragDrop:function(){var Cf=this;var Cg=Cf.get(Aq);if(!Cf.proxyEvt){var Ch=Cf.get(S);Cf.proxyEvt=new B3.SchedulerEvent({scheduler:Ch});Cf.proxyEvt.removeTarget(Ch);Cf.proxyEvt.get(Ce).addClass(Bo);}if(!Cf.delegate){Cf.delegate=new B3.DD.Delegate(Cf.get(e));}var AM=Cf.delegate.dd;var Ci=Cf.proxyEvt;var Cj=Cf.get(Ae)/2;var A=Cf._getColumnRefWidth();AM.unplug(B3.Plugin.DDConstrained);AM.unplug(B3.Plugin.DDNodeScroll);AM.plug(B3.Plugin.DDConstrained,{bubbleTargets:Cf,constrain:Cf.bodyNode,tickX:A,tickY:Cj});AM.plug(B3.Plugin.DDNodeScroll,{node:Cf.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(AM){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(Cg){var A=this;var Cf=A.get(S);if(Cg.target.test(L)){var Ch=Cf.getViewByName(CH);var AM=A.colHeaderDaysNode.indexOf(Cg.currentTarget)-1;if(Ch){Cf.set(BB,A.getDateByColumn(AM));Cf.set(Be,Ch);}}Cg.preventDefault();},_onEventDragEnd:function(A){var Ck=this;var Ch=Ck.get(S);var Cg=Ck.get(Aq);var Cl=Ck.delegate.dd;var Cf=Cl.get(Ce);var Ci=Ck.proxyEvt;var AM=Ci.get(Ce);var Cj=Cf.getData(Ad);Cf.show();AM.hide();Cg.selectable();Cj.copyDates(Ci);Ch.syncEventsUI();},_onEventDragStart:function(A){var Ck=this;var Ch=Ck.get(Aq);var Cl=Ck.delegate.dd;var Cg=Cl.get(Ce);var Ci=Ck.proxyEvt;var Cj=Cg.getData(Ad);var Cf=Bf(Cg.getComputedStyle(Ar));if(Cf){Cl.deltaXY[0]=(Cf+Bf(Cl.deltaXY[0]));}if(Cj){var Cm=Cj.get(CP);var AM=Ci.get(Ce);Cl.set(B9,AM);Cm.append(AM);Ci.copyPropagateAttrValues(Cj);Ck.syncEventTopUI(Ci);Ck.syncEventHeightUI(Ci);AM.show();Ck._currentEvtDuration=Cj.getMinutesDuration();}Cg.hide();Ch.unselectable();},_onMouseDownTableCol:function(Cg){var A=this;var Cf=A.get(S);var Ch=Cf.get(Cd);if(Ch){Ch.hideOverlay();if(Cg.target.test(Bl+Ab)){var AM=A.colDaysNode.indexOf(Cg.currentTarget);A.dragXY=A.startXY=A._getXYDelta(Cg);A.ddStartDate=A.getDateByColumn(AM);A.ddEndDate=AR.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=AR.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);Ch.set(B6,A.ddStartDate);Ch.set(Aa,A.limitDate(Ch.get(Aa),A.ddMaxDate));Cg.halt();}}},_onMouseMoveTableCol:function(Ch){var A=this;var Cg=A.get(S);var Ck=Cg.get(Cd);var Ci=A.ddStartDate;if(Ci){A.dragXY=A._getXYDelta(Ch);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var Cj=AR.getMinutesOffset(A.ddEndDate,Ci);if((A.dragXY[1]-A.startXY[1])>0){Cj=Ak(Cj,Ck.get(Br));}var AM=A.limitDate(AR.add(Ci,AR.MINUTES,Cj),A.ddMaxDate);if(Cj>0){Ck.set(Aa,AM);}else{var Cf=Ck.get(Aa);Ck.set(B6,AM);Ck.set(Aa,Cf);}A.syncEventRecorderUI(Ch.currentTarget);}},_onMouseUpTableCol:function(Cf){var A=this;var AM=A.get(S);var Cg=AM.get(Cd);if(Cg){if(A.ddStartDate){A.syncEventRecorderUI(Cf.currentTarget);Cg.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(AM,Cf){var A=this;AM.setHours(Cf[0],Bh(Cf[1],A._getTickY()),Cf[2]);},_valueColDaysNode:function(){var A=this;var Cf=A.get(u);var AM=[];while(Cf--){AM.push(BD);}return B3.NodeList.create(AM.join(Bd));},_valueColHeaderDaysNode:function(){var A=this;var Cf=A.get(u);var AM=[];AM.push(AT);while(Cf--){AM.push(BG);}AM.push(X);return B3.NodeList.create(AM.join(Bd));},_valueMarkercellsNode:function(){var A=this;var AM=[];for(var Cf=0;Cf<=23;Cf++){AM.push(AE);}return B3.NodeList.create(AM.join(Bd));},_valueTimesNode:function(){var A=this;var Cg=A.get(AK);var Cf=[];for(var AM=0;AM<=23;AM++){Cf.push(B3.substitute(J,{hour:Cg?AR.toIsoTimeString(AM):AR.toUsTimeString(AM,false,true)}));}return B3.NodeList.create(Cf.join(Bd));}}});B3.SchedulerDayView=CX;var AN=B3.Component.create({NAME:B7,ATTRS:{bodyContent:{value:Bd},days:{value:7},name:{value:CN}},EXTENDS:B3.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var Cg=A.get(S);var AM=Cg.get(BB);var Cf=Cg.get(B8);Cg.set(BB,AR.getFirstDayOfWeek(AM,Cf));},getNextDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);var Cg=A._firstDayOfWeek(AM);return AR.add(Cg,AR.WEEK,1);},getPrevDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);var Cg=A._firstDayOfWeek(AM);return AR.subtract(Cg,AR.WEEK,1);},getToday:function(){var A=this;var AM=AN.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(AM);},_firstDayOfWeek:function(Cf){var A=this;var Cg=A.get(S);var AM=Cg.get(B8);return AR.getFirstDayOfWeek(Cf,AM);}}});B3.SchedulerWeekView=AN;var I=f(Bj,Bc,Ao),A3=f(Bj,Bc,B1,AG),Y=f(Bj,Bc,B1,CH),CT=f(Bj,Bc,B1,At),Bv=f(Bj,Bc,BO),AP=f(Bj,Bc,BO,Ao),G=f(W),M=f(W,"arrowstop-1-l"),CQ=f(W,"arrowstop-1-r"),Bw=f(Bj,Bc,B),C=f(Bj,Bc,B,AL),P=f(Bj,Bc,B,Ah),Bb=f(Bj,Bc,At,BX),Az=f(Bj,Bc,At,BX,Ah),Bu=f(Bj,Bc,At,BX,AG),CA=f(Bj,Bc,At,BX,AG,Ah),A0=f(Bj,Bc,At,BX,AG,AJ),Av=f(Bj,Bc,At,BX,AG,H),s=f(Bj,Bc,At,BX,AG,H,AL),AF=f(Bj,Bc,At,BX,AG,H,Ah),c=f(Bj,Bc,At,BX,AG,H,An),CV=f(Bj,Bc,At,BX,AG,H,AB),BM=f(Bj,Bc,At,BX,A2),E=f(Bj,Bc,At,BX,A2,Ar),Bn=f(Bj,Bc,At,BX,A2,Ay),Q=f(Bj,Bc,At,BX,A2,By),BC=f(Bj,Bc,At,A8),CL=f(Bj,Bc,At,A8,Ah),Ca=f(Bj,At,BR,B1),g='<table class="'+CT+'">'+"<tbody>"+'<tr class="'+A3+'"></tr>'+"</tbody>"+"</table>",n='<th class="'+Y+'"><div>&nbsp;</div></th>',CI='<div class="'+I+'">'+'<div class="'+AP+'">'+'<div class="'+Bv+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",BT='<table cellspacing="0" cellpadding="0" class="'+BC+'">'+"<tbody>"+"<tr>"+'<td class="'+[Bw,P].join(v)+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",Bp='<table cellspacing="0" cellpadding="0" class="'+Bb+'">'+"<tbody></tbody>"+"</table>",CE="<tr></tr>",A5='<td class="'+Bu+'"><div></div></td>',z='<span class="'+[G,M].join(v)+'"></span>',j='<span class="'+[G,CQ].join(v)+'"></span>';
var AZ=B3.Component.create({NAME:CU,ATTRS:{bodyContent:{value:Bd},name:{value:Bc},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return B3.Node.create(CI);}},headerTableNode:{valueFn:function(){return B3.Node.create(g);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:o(Bl+BC,7),colHeaderDaysNode:o(Bl+Y,7),monthContainerNode:Bl+I,headerTableNode:Bl+CT},EXTENDS:B3.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var AM=A.get(S);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(B5);A.headerTableNode=A.get(CY);A.monthContainerNode=A.get(A7);A.tableGridNode=A.get(d);A.dayHeaderColNode=A.headerTableNode.one(Bl+A3);A.monthRows=A.monthContainerNode.all(Bl+Bv);A.tableGridCols=A.tableGridNode.all(F);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(Cg,Cf){var AM=A.tableGridNode.item(Cf);Cg.append(AM.toggleClass(CL,(Cf==0)));});},buildEventsTable:function(AM,Cj){var Cp=this;var Cm=5;var Cg=AR.clearTime(Cp._findCurrentMonthEnd());var Co=AR.clearTime(Cp._findCurrentMonthStart());var Cl=String(Co.getTime()).concat(AM.getTime()).concat(Cj.getTime());var Ck=Cp.evtDataTableStack[Cl];if(!Ck){Ck=B3.Node.create(Bp);var Cn=Ck.one(BS);var Ch=B3.Node.create(CE);Cp.loopDates(AM,Cj,function(Cr,Cq){var Cs=B3.Node.create(A5);Cs.addClass(Av).toggleClass(AF,(Cq==0)).toggleClass(s,AR.isToday(Cr)).toggleClass(c,AR.isToday(AR.subtract(Cr,AR.DAY,1))).toggleClass(CV,AR.isToday(AR.subtract(Cr,AR.WEEK,1)));if(AR.before(Cr,Co)||AR.after(Cr,Cg)){Cs.addClass(A0);}Ch.append(Cs.setContent(Cr.getDate()));});Cn.append(Ch);for(var A=0;A<Cm;A++){var Ci=0;var Cf=B3.Node.create(CE);Cp.loopDates(AM,Cj,function(Cv,Ct){if(Ci<=Ct){var Cu=Cp.getIntersectEvents(Cv),Cr=Cu[A];var Cw=B3.Node.create(A5);if(Cr){var Cq=Cw.one(x);var Cs=Cp._getEvtSplitInfo(Cr,AM,Cj);Cw.attr(w,Cs.colspan);Cq.addClass(BM).setContent(Cp._getEvtLabel(Cr));if(Cs.left){Cq.addClass(E).prepend(z);}if(Cs.right){Cq.addClass(Bn).append(j);}if(Cr.get(CM)){Cq.addClass(Q);}Ci+=Cs.colspan;}else{Ci++;}Cf.append(Cw);}});Cn.append(Cf);}Cp.evtDataTableStack[Cl]=Ck;}return Ck;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(AM){var A=this;var Cg=A.get(S);var Cf=String(AM.getTime());if(!A.evtDateStack[Cf]){A.evtDateStack[Cf]=Cg.getIntersectEvents(AM);}return A.evtDateStack[Cf];},loopDates:function(A,Cg,Cj,Ck,Ci){var Cl=this;var AM=AR.clone(A);var Cf=Cg.getTime();for(var Ch=0;AM.getTime()<=Cf;Ch++){Cj.apply(Cl,[AM,Ch]);AM=AR.add(AM,(Ck||AR.DAY),(Ci||1));}},plotEvents:function(){var AM=this;var Cf=AM._findCurrentMonthStart();var A=AR.safeClearTime(AM._findFirstDayOfWeek(Cf));AM.bodyNode.all(Bl+Bb).remove();AM.monthRows.each(function(Cj,Ch){var Cg=AR.add(A,AR.WEEK,Ch);var Ck=AR.add(Cg,AR.DAY,Al-1);var Ci=AM.buildEventsTable(Cg,Ck);if(Ch==0){Ci.addClass(Az);}Cj.append(Ci);});},syncStdContent:function(){var A=this;A.setStdModContent(Bz.BODY,A.monthContainerNode.getDOM());A.setStdModContent(Bz.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var Cl=this;var Cf=Cl.getToday();var AM=Cl.get(S);Cl.tableGridCols.removeClass(C);if(AR.isSameMonth(Cf,AM.get(BB))){var A=AM.get(B8);var Cf=Cl.getToday();var Ch=Cl._findCurrentMonthStart();var Cj=Cl._findFirstDayOfWeek(Cf);var Cg=AR.getWeekNumber(Cf,A)-AR.getWeekNumber(Ch,A);var Ck=(Cf.getDate()-Cj.getDate());var Ci=Cl.tableGridNode.item(Cg).all(F).item(Ck);if(Ci){Ci.addClass(C);}}},adjustCurrentDate:function(){var A=this;var AM=A.get(S);AM.set(BB,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.add(AM,AR.MONTH,1);},getPrevDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.subtract(AM,AR.MONTH,1);},syncDaysHeaderUI:function(){var Cf=this;var Ci=Cf.get(S);var Cg=Ci.get(BB);var AM=Cf.get(A9);var A=Cf.get(AY);var Ch=Cf._findFirstDayOfWeek(Cg);Cf.colHeaderDaysNode.all(x).each(function(Cl,Ck){var Cj=AR.add(Ch,AR.DAY,Ck);var Cm=B3.DataType.Date.format(Cj,{format:AM,locale:A});Cl.html(Cm);});},_findCurrentMonthEnd:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.findMonthEnd(AM);},_findCurrentMonthStart:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.findMonthStart(AM);},_findFirstDayOfWeek:function(Cf){var A=this;var Cg=A.get(S);var AM=Cg.get(B8);return AR.getFirstDayOfWeek(Cf,AM);},_getEvtLabel:function(Cf){var AM=this;var Cg=Cf.get(Aa);var A=Cf.get(B6);return[A.getHours(),Bg,Cg.getHours(),v,Cf.get(Am)].join(Bd);},_getEvtSplitInfo:function(Ck,A,Ci){var Cl=this;var AM=Ck.getClearStartDate();var Cj=Ck.getClearEndDate();var Ch=Ck.getDaysDuration();var Cg={};var Cf=1;if(AR.after(AM,A)){Cf=Math.min(Ch,Math.abs(AR.getDayOffset(Ci,AM))+1);if(Cf>1){Cg.right=true;}}else{Cf=Math.abs(AR.getDayOffset(Cj,A)+1);if(Cf>1){Cg.left=true;}}Cg.colspan=Math.min(Cf,Al);if(Cf>=Al){Cg.right=true;Cg.left=true;}return Cg;},_uiSetCurrentDate:function(AM){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(Al,n);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(Al,BT);},_valueNodeList:function(Cg,Cf){var A=this;var AM=[];while(Cg--){AM.push(Cf);}return B3.NodeList.create(AM.join(Bd));}}});B3.SchedulerMonthView=AZ;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","substitute","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(AV){var AG=AV.Lang,A6=AG.isString,I=AG.isDate,Aw=AG.isFunction,l=AG.isObject,Ay=AG.isBoolean,v=AG.isNumber,An=AV.ColorUtil,O=AV.DataType.DateMath,At=AV.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),A3="-",AL=".",U="",V=" ",R="_",Aa="_propagateSet",q="activeView",BF="borderWidth",Aj="colorBrightnessFactor",A1="colorSaturationFactor",m="Change",As="color",AR="content",AB="contentNode",Ap="duration",Ad="endDate",A7="events",Ar="id",Al="isoTime",BE="locale",S="node",L="overlay",AX="parentEvent",BH="recorder",Ab="repeat",A5="repeated",p="repeatedEvents",AA="scheduler",AJ="scheduler-event",AK="scheduler-event-recorder",A9="startDate",Av="template",Ai="title",H="titleDateFormat",j="titleNode",AT="borderStyle",G="%H:%M",Au="%I:%M",h=AV.ClassNameManager.getClassName,W=h(AJ),AH=h(AJ,BH),Ae=h(AJ,AR),AN=h(AJ,A5),e=h(AJ,Ai),AY='<div class="'+W+'">'+'<div class="'+e+'"></div>'+'<div class="'+Ae+'"></div>'+"</div>";
var r=AV.Component.create({NAME:AJ,ATTRS:{borderStyle:{value:"solid",validator:A6},borderWidth:{value:"1px",validator:A6},colorBrightnessFactor:{value:0.75,validator:v},colorSaturationFactor:{value:1.5,validator:v},content:{value:"(no title)",validator:A6},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:A6},titleDateFormat:{getter:"_getTitleDateFormat",validator:A6},endDate:{valueFn:function(){var A=O.clone(this.get(A9));A.setHours(A.getHours()+1);return A;},validator:I},columnNode:{setter:AV.one},node:{valueFn:function(){return AV.Node.create(AY).setData(AJ,this);},setter:AV.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:I}},EXTENDS:AV.Base,PROPAGATE_ATTRS:[A9,Ad,AR,As,Aj,A1,AT,BF,H],prototype:{eventStack:null,initializer:function(){var A=this;var BC=A.get(S);A.eventStack={};A.nodeStack={};AV.Array.each(AV.SchedulerEvent.PROPAGATE_ATTRS,function(BD){A.after(BD+m,A._propagateAttrChange);});A.contentNode=BC.one(AL+Ae);A.titleNode=BC.one(AL+e);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(BC,BD){BC.destroy();});A.eventStack={};A.get(S).remove(true);},copyDates:function(BC){var A=this;A.set(Ad,O.clone(BC.get(Ad)));A.set(A9,O.clone(BC.get(A9)));},copyPropagateAttrValues:function(BC,BD){var A=this;A.copyDates(BC);AV.Array.each(AV.SchedulerEvent.PROPAGATE_ATTRS,function(BK){if(!(BK in (BD||{}))){var BL=BC.get(BK);if(!l(BL)){A.set(BK,BL);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return O.getDayOffset(A.get(Ad),A.get(A9));},getHoursDuration:function(){var A=this;return O.getHoursOffset(A.get(Ad),A.get(A9));},getMinutesDuration:function(){var A=this;return O.getMinutesOffset(A.get(Ad),A.get(A9));},getSecondsDuration:function(){var A=this;return O.getSecondsOffset(A.get(Ad),A.get(A9));},sameEndDate:function(BC){var A=this;return O.compare(A.get(Ad),BC.get(Ad));},sameStartDate:function(BC){var A=this;return O.compare(A.get(A9),BC.get(A9));},isAfter:function(BK){var BD=this;var BC=BD.get(A9);var A=BK.get(A9);return O.after(BC,A);},isBefore:function(BK){var BD=this;var BC=BD.get(A9);var A=BK.get(A9);return O.before(BC,A);},repeatByDate:function(BD){var A=this;var BK=A.uidByDate(BD);if(!A.eventStack[BK]){var BC=O.clone(BD);var BL=O.clone(BD);O.copyHours(BC,A.get(A9));O.copyHours(BL,A.get(Ad));var BM=new AV.SchedulerEvent({endDate:BL,parentEvent:A,scheduler:A.get(AA),startDate:BC});BM.copyPropagateAttrValues(A);A.eventStack[BK]=BM;}return A.eventStack[BK];},intersects:function(BK){var BD=this;var BL=BD.get(Ad);var BC=BD.get(A9);var A=BK.get(A9);return(BD.sameStartDate(BK)||O.between(A,BC,BL));},intersectHours:function(BD){var BC=this;var BL=BC.get(Ad);var A=BC.get(A9);var BK=O.clone(A);O.copyHours(BK,BD.get(A9));return(O.compare(A,BK)||O.between(BK,A,BL));},isDayOverlapEvent:function(){var A=this;return O.isDayOverlap(A.get(A9),A.get(Ad));},isRepeatableDate:function(BC){var A=this;var BD=A.get(Ab);return(BD&&BD.validate(A,BC));},getClearEndDate:function(){var A=this;return O.safeClearTime(A.get(Ad));},getClearStartDate:function(){var A=this;return O.safeClearTime(A.get(A9));},uidByDate:function(BC){var A=this;BC=I(BC)?O.safeClearTime(BC):A.getClearStartDate();return[AJ,BC.getTime()].join(R);},setContent:function(BD,BC){var A=this;A._setContent(AB,BD,BC);},setTitle:function(BD,BC){var A=this;A._setContent(j,BD,BC);},syncNodeUI:function(BC){var A=this;A.get(S).toggleClass(AN,!!(A.get(AX)));A.syncNodeColorUI(BC);A.syncNodeTitleUI(BC);A.syncNodeContentUI(BC);},syncNodeColorUI:function(BC){var A=this;var BD=A.get(S);var BK=A.getBorderColor();if(BD){BD.setStyles({borderWidth:A.get(BF),borderColor:BK,backgroundColor:A.get(As),borderStyle:A.get(AT)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:BK});}if(BC){A.eachRepeatedEvent(function(BL,BM){BL.syncNodeColorUI();});}},syncNodeContentUI:function(BC){var A=this;A.setContent(A.get(AR),BC);},syncNodeTitleUI:function(BC){var A=this;var BD=A._formatDate(A.get(A9));var BK=A._formatDate(A.get(Ad));A.setTitle([BD,BK].join(V+A3+V),BC);},eachRepeatedEvent:function(BC){var A=this;AV.each(A.eventStack,BC,A);},unlink:function(){var A=this;if(A.get(AX)){A.set(AX,null);}else{A.eachRepeatedEvent(function(BC,BD){BC.unlink();});}A.eventStack={};A.syncNodeUI();},_propagateAttrChange:function(BK){var A=this;var BD=BK.attrName;var BC=BK.newVal;A.eachRepeatedEvent(function(BL,BM){var BN=BL[Aa+At(BD)];if(BN){BN.apply(A,[BL,BD,BC]);}else{BL.set(BD,BK.newVal);}BL.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,BC,BK){var BD=O.clone(A.get(Ad));O.copyHours(BD,BK);A.set(Ad,BD);},_propagateSetStartDate:function(BC,BD,BK){var A=O.clone(BC.get(A9));O.copyHours(A,BK);BC.set(A9,A);},_setColor:function(BC){var A=this;A.hsbColor=An.rgb2hsb(An.getRGB(BC));A.borderColor=AV.clone(A.hsbColor);A.borderColor.b*=A.get(Aj);A.borderColor.s*=A.get(A1);A.borderColorRGB=An.hsb2rgb(A.borderColor);return BC;},_setContent:function(BD,BL,BC){var A=this;var BK=A[BD];if(BK){BK.setContent(BL);}if(BC){A.eachRepeatedEvent(function(BM,BN){BM[BD].setContent(BL);});}},_setRepeat:function(BC){var A=this;if(A6(BC)){BC=AV.SchedulerEventRepeat[BC];}return BC;},_setScheduler:function(BD){var A=this;var BC=A.get(AA);if(BC){A.removeTarget(BC);}A.addTarget(BD);return BD;},_formatDate:function(BD,BK){var BC=this;var A=BC.get(BE);BK=BK||BC.get(H);return AV.DataType.Date.format(BD,{format:BK,locale:A});},_getTitleDateFormat:function(BD){var A=this;if(!A6(BD)){var BC=A.get(AA);BD=(BC&&BC.get(q).get(Al))?G:Au;}return BD;}}});AV.SchedulerEvent=r;AV.SchedulerEventRepeat={dayly:{description:"Every day",validate:function(A,BC){return true;},value:"dayly"},monthly:{description:"Every month",validate:function(BC,BD){var BK=BC.get(Ad);var A=BC.get(A9);return(A.getDate()===BD.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,BC){return O.isMonWedOrFri(BC);
},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,BC){return O.isTueOrThu(BC);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,BC){return O.isWeekDay(BC);},value:"weekDays"},weekly:{description:"Every week",validate:function(BC,BD){var BK=BC.get(Ad);var A=BC.get(A9);return(A.getDay()===BC.getDay());},value:"weekly"}};var q="activeView",BB="bc",BA="bd",AM="bodyContent",T="boundingBox",AW="button",F="column",AR="content",AS="dateFormat",AP="dblclick",Aq="desc",AO="disk",BI="event",Ax="field",AZ="fieldset",AQ="form",AC="hint",AF="input",Al="isoTime",Ac="label",X="layout",Ah="menu",f="overlayContextPanel",P="pencil",Ab="repeat",Q="row",AA="scheduler",u="select",o="strings",B="tc",i="text",t="when",K="trigger",AD="auiSchedulerEventRecorderWhen",A2="auiSchedulerEventRecorderDesc",Ao="auiSchedulerEventRecorderSelect",d="auiSchedulerEventRecorderButtonRow",z="cancel",b="edit",AU="save",A3="-",g="#",BJ=h(AJ,BH,L),A0=h(AJ,BH,AQ),Y=h(AQ),M=h(X,AR),A4=h(X,AZ),AI=h(X,AZ,BA),y=h(X,AZ,AR),c=h(X,"w100"),N=h(F),Af=h(F,AR),C=h(Ax),Z=h(Ax,Ah),Ag=h(Ax,u),A8=h(Ax,AR),E=h(Ax,Ac),Am=h(Ax,i),J=h(AW,Q),Az=h(Ax,AF),AE=h(Ax,AF,u),a=h(Ax,AF,i),Ak=h(AJ,BH,Ac,t),D=h(AJ,BH,Aq),n=h(AJ,BH,Ax,AC),x=h(AJ,BH,Ab),w=h(AJ,BH,AW,Q),k="<option></option>",BG='<form id="auiSchedulerEventRecorderForm" class="'+[A0,M,Y].join(V)+'">'+'<div class="'+[A4,c,N].join(V)+'">'+'<div class="'+[y,Af].join(V)+'aui-fieldset-content aui-column-content">'+'<div class="'+AI+'">'+'<span class="'+[C,Am].join(V)+'">'+'<span class="'+A8+'">'+'<label class="'+E+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+Ak+'"></span>'+"</span>"+"</span>"+'<span class="'+[C,Am].join(V)+'">'+'<span class="'+A8+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[Az,a,D].join(V)+'" size="30" type="text" />'+'<div class="'+n+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[C,Z,Ag].join(V)+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[Az,AE,x].join(V)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[C,J,w].join(V)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var s=AV.Component.create({NAME:AK,ATTRS:{content:{value:U},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:A6},event:{},strings:{value:{},setter:function(A){return AV.merge({save:"Save",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",when:"When","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat"},A||{});},validator:l},overlayContextPanel:{value:{},setter:function(BC){var A=this;var BD=AV.Node.create(AV.substitute(BG,A.get(o)));return AV.merge({align:{points:[BB,B]},anim:false,bodyContent:BD,hideOn:AP,trigger:A.get(S),visible:false,zIndex:9999},BC||{});}}},EXTENDS:AV.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.after("schedulerChange",A._afterSchedulerChange);A.on("startDateChange",A._onStartDateChange);A.get(S).addClass(AH);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(BC){var A=this;var BK=A.overlayDescNode.val();var BD=A.get(BI);if(!BD){BD=new AV.SchedulerEvent({endDate:A.get(Ad),scheduler:A.get(AA),startDate:A.get(A9)});BD.copyPropagateAttrValues(A,{content:true});}BD.set(Ab,A.overlaySelectNode.val());if(BK){BD.set(AR,BK);}return BD;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},loadFormValues:function(){var A=this;var BK=U;var BD=U;var BC=A.get(BI);if(BC){var BL=BC.get(Ab);if(BL){BK=BL.value;}BD=BC.get(AR);}A.overlaySelectNode.val(BK);A.overlayWhenNode.setContent(A._getWhenFormattedDt());setTimeout(function(){A.overlayDescNode.val(BD).selectText();},0);},_afterSchedulerChange:function(BK){var A=this;var BD=BK.newVal;var BC=BD.get(T);BC.delegate("click",AV.bind(A._onClickSchedulerEvent,A),AL+W);},_createEvents:function(){var A=this;var BC=function(BD,BK){A.publish(BD,{defaultFn:BK,queuable:false,emitFacade:true,bubbles:true});};BC(AU,this._defSaveEventFn);BC(b,this._defEditEventFn);BC(z,this._defCancelEventFn);},_initOverlay:function(){var BC=this;var A=BC.get(o);BC.overlay=new AV.OverlayContextPanel(BC.get(f));var BK=BC.overlay;var BD=BK.get(T);var BL=BK.get(AM);BC.overlayButtonRowNode=BL.one(g+d);BC.overlayDescNode=BL.one(g+A2);BC.overlaySelectNode=BL.one(g+Ao);BC.overlayWhenNode=BL.one(g+AD);BC.overlaySaveBtn=new AV.ButtonItem({label:A.save,icon:AO,render:BC.overlayButtonRowNode,handler:{fn:BC._handleSaveEvent,context:BC}});BC.overlayEditBtn=new AV.ButtonItem({label:A.edit,icon:P,render:BC.overlayButtonRowNode,handler:{fn:BC._handleEditEvent,context:BC}});BC.overlayCancelBtn=new AV.ButtonItem({label:A.cancel,render:BC.overlayButtonRowNode,handler:{fn:BC._handleCancelEvent,context:BC}});AV.each(AV.SchedulerEventRepeat,function(BN,BM){BC.overlaySelectNode.append(AV.Node.create(k).val(BN.value||BM).setContent(BN.description));});BK.on("hide",AV.bind(BC._onOverlayHide,BC));BK.on("show",AV.bind(BC._onOverlayShow,BC));BL.on("submit",AV.bind(BC._onSubmitForm,BC));BD.addClass(BJ);},_defCancelEventFn:function(BC){var A=this;A.hideOverlay();},_defEditEventFn:function(BC){var A=this;A.hideOverlay();},_defSaveEventFn:function(BD){var A=this;var BC=A.get(AA);BC.addEvent(BD.newSchedulerEvent);A.hideOverlay();BC.syncEventsUI();},_getWhenFormattedDt:function(){var BD=this;var BC=BD.get(AS);var BL=(BD.get(BI)||BD);var BN=BL.get(Ad);var BM=BL.get(AA);var A=BL.get(A9);var BK=(BM.get(q).get(Al)?O.toIsoTimeString:O.toUsTimeString);return[BL._formatDate(A,BC),BK(A),A3,BK(BN)].join(V);},_handleEditEvent:function(BC){var A=this;A.fire(b,{newSchedulerEvent:A.getEventCopy()});BC.preventDefault();},_handleSaveEvent:function(BC){var A=this;A.fire(AU,{newSchedulerEvent:A.getEventCopy()});
BC.preventDefault();},_handleCancelEvent:function(BC){var A=this;A.fire(z);BC.preventDefault();},_onClickSchedulerEvent:function(BD){var A=this;var BC=BD.currentTarget.getData(AJ);if(BC){if(!A.overlay){A._initOverlay();}A.set(BI,BC);A.overlay.set(K,BC.get(S));A.get(S).remove();A.showOverlay();}},_onOverlayHide:function(BD){var A=this;var BC=A.get(S);if(A.overlay){A.set(BI,null);A.overlay.set(K,BC);}BC.remove();},_onOverlayShow:function(BD){var BC=this;var BK=BC.overlayEditBtn;var A=BC.overlaySaveBtn;if(BC.get(BI)){BK.show();A.hide();}else{BK.hide();A.show();}BC.loadFormValues();},_onStartDateChange:function(BC){var A=this;var BD=A.get(Ap);A.set(Ad,O.add(BC.newVal,O.MINUTES,BD));},_onSubmitForm:function(BC){var A=this;if(A.get(BI)){A._handleEditEvent(BC);}else{A._handleSaveEvent(BC);}}}});AV.SchedulerEventRecorder=s;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel","substitute"]});AUI.add("aui-scheduler-calendar",function(D){var I=D.Lang,J=I.isArray,C=I.isString,G=function(A){return(A instanceof D.SchedulerEvent);},E="scheduler-calendar",B="color",K="events",H="pallete";var F=D.Component.create({NAME:E,ATTRS:{color:{valueFn:function(){var L=this;var M=L.get(H);var A=Math.ceil(Math.random()*M.length)-1;return M[A];},validator:C},name:{value:"(no name)",validator:C},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:J}},EXTENDS:D.Base,AUGMENTS:D.SchedulerEventSupport,prototype:{initializer:function(){var A=this;A.after("eventsChange",A._afterEventsChange);A._uiSetEvents(A.get(K));},_afterEventsChange:function(L){var A=this;A._uiSetEvents(L.newVal);},_uiSetEvents:function(L){var A=this;D.Array.each(L,function(M,N){M.set(B,A.get(B));});}}});D.SchedulerCalendar=F;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(B){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"],skinnable:true});