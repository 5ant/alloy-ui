AUI.add("aui-scheduler-base",function(AH){var t=AH.Lang,Ae=t.isString,f=t.isObject,C=t.isArray,G=t.isDate,n=t.isNumber,Y=function(A){return(A instanceof AH.SchedulerView);},AE=function(A){return(A instanceof AH.SchedulerEvent);},L=AH.DataType.DateMath,AA=AH.WidgetStdMod,Ac="-",y=".",T="",U=" ",W="scheduler-base",AN="data-view-name",l="activeView",S="boundingBox",Ad="clearfix",k="controls",AP="controlsNode",AS="current",AG="currentDate",AC="currentDateNode",AO="date",AF="dateFormat",AY="day",AM="endDate",Af="events",h="firstDayOfWeek",Ak="hd",Ab="headerNode",Q="helper",w="icon",N="iconNextNode",AX="iconPrevNode",Ai="locale",I="month",P="name",u="nav",q="navNode",R="next",F="nextDate",Aa="prev",AQ="prevDate",Aj="rendered",p="scheduler",AT="srcNode",Ag="startDate",i="strings",AV="template",H="today",AI="todayNode",a="triggerNode",d="view",Al="views",AB="viewsNode",s="week",X="year",AW="navigationDateFormat",r="eventRecorder",e=AH.ClassNameManager.getClassName,AJ=e(Q,Ad),M=e(w),AU=e(W,k),x=e(W,AS,AO),K=e(W,Ak),z=e(W,w,R),g=e(W,w,Aa),Ah=e(W,u),c=e(W,H),AD=e(W,d),V=e(W,Al),J=e(W,d,T),Z=e(W,d,AY),B=e(W,d,I),D=e(W,d,s),AL=e(W,d,X),j=e(p,d,T),AR='<div class="'+AU+'"></div>',b='<div class="'+x+'"></div>',E='<div class="'+K+'"></div>',Am='<a href="#" class="'+[M,z].join(U)+'">Next</a>',AK='<a href="#" class="'+[M,g].join(U)+'">Prev</a>',O='<div class="'+Ah+'"></div>',v='<a href="#" class="'+c+'">{today}</a>',AZ='<a href="#" class="'+[AD,J].join(U)+'{name}" data-view-name="{name}">{label}</a>',o='<div class="'+V+'"></div>';var m=AH.Component.create({NAME:W,ATTRS:{activeView:{validator:Y},eventRecorder:{setter:"_setEventRecorder"},events:{value:[],setter:"_setEvents",validator:C},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(Ao){var A=this;var An=A.get(l);if(An){return An.get(AW);}return Ao;},value:"%A - %d %b %Y",validator:Ae},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:G},firstDayOfWeek:{value:0,validator:n},controlsNode:{valueFn:function(){return AH.Node.create(AR);}},currentDateNode:{valueFn:function(){return AH.Node.create(b);}},headerNode:{valueFn:function(){return AH.Node.create(E);}},iconNextNode:{valueFn:function(){return AH.Node.create(Am);}},iconPrevNode:{valueFn:function(){return AH.Node.create(AK);}},navNode:{valueFn:function(){return AH.Node.create(O);}},todayNode:{valueFn:function(){return AH.Node.create(this._processTemplate(v));}},viewsNode:{valueFn:function(){return AH.Node.create(o);}}},HTML_PARSER:{controlsNode:y+AU,currentDateNode:y+x,headerNode:y+K,iconNextNode:y+z,iconPrevNode:y+g,navNode:y+Ah,todayNode:y+c,viewsNode:y+V},UI_ATTRS:[AG],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(AP);A.currentDateNode=A.get(AC);A.iconNextNode=A.get(N);A.iconPrevNode=A.get(AX);A.navNode=A.get(q);A.schedulerHeaderNode=A.get(Ab);A.todayNode=A.get(AI);A.viewsNode=A.get(AB);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},addEvent:function(An){var A=this;var Ao=A.get(Af);if(AH.Array.indexOf(Ao,An)>-1){AH.Array.removeItem(Ao,An);}Ao.push(An);A.set(Af,Ao);},removeEvent:function(An){var A=this;var Ao=A.get(Af);AH.Array.removeItem(Ao,An);A.set(Af,Ao);},flushEvents:function(){var A=this;AH.Array.each(A.get(Af),function(An,Ao){An.eachRepeatedEvent(function(Aq,Ap){delete Aq._filtered;});delete An._filtered;});},getEventsByDay:function(An){var A=this;An=L.safeClearTime(An);return A._getEvents(An,function(Ao){return L.compare(Ao.getClearStartDate(),An);});},getIntersectEvents:function(An){var A=this;An=L.safeClearTime(An);return A._getEvents(An,function(Ap){var Ao=Ap.getClearStartDate();var Aq=Ap.getClearEndDate();return(L.compare(An,Ao)||L.compare(An,Aq)||L.between(An,Ao,Aq));});},sortEventsByDateAsc:function(An){var A=this;An.sort(function(Ar,Ap){var Aq=Ar.get(AM);var Ao=Ap.get(AM);var At=Ar.get(Ag);var As=Ap.get(Ag);if(L.after(At,As)||L.compare(At,As)&&L.before(Aq,Ao)){return 1;}else{return -1;}});},getViewByName:function(An){var A=this;return A.viewStack[An];},getStrings:function(){var A=this;return A.get(i);},getString:function(An){var A=this;return A.getStrings()[An];},renderView:function(An){var A=this;if(An){An.show();if(!An.get(Aj)){var Ao=An.get(P);if(!A.bodyNode){A.setStdModContent(AA.BODY,T);}An.render(A.bodyNode);}}},plotViewEvents:function(An){var A=this;An.plotEvents(A.get(Af));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(l));},_afterActiveViewChange:function(Ap){var An=this;if(An.get(Aj)){var Ao=Ap.newVal;var A=Ap.prevVal;if(A){A.hide();}An.renderView(Ao);}},_afterRender:function(An){var A=this;A.renderView(A.get(l));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,y+AD,A);A.controlsNode.delegate("click",A._onClickPrevIcon,y+g,A);A.controlsNode.delegate("click",A._onClickNextIcon,y+z,A);A.controlsNode.delegate("click",A._onClickToday,y+c,A);},_createViewTriggerNode:function(An){var A=this;if(!An.get(a)){var Ao=An.get(P);An.set(a,AH.Node.create(AH.substitute(AZ,{name:Ao,label:(A.getString(Ao)||Ao)})));}return An.get(a);},_getEvents:function(An,Ap){var A=this;var Ao=A.get(Af);var Aq=[];AH.Array.each(Ao,function(Ar,As){if(Ap.apply(A,[Ar])){Aq.push(Ar);}else{if(Ar.isRepeatableDate(An)){var At=Ar.repeatByDate(An);Aq.push(At);}}});A.sortEventsByDateAsc(Aq);return Aq;},_onClickToday:function(An){var A=this;A.set(AG,A.get(l).getToday());An.preventDefault();},_onClickNextIcon:function(An){var A=this;A.set(AG,A.get(l).get(F));An.preventDefault();},_onClickPrevIcon:function(An){var A=this;A.set(AG,A.get(l).get(AQ));An.preventDefault();},_onClickViewTrigger:function(Ao){var A=this;var Ap=Ao.currentTarget;var Aq=Ap.attr(AN);var An=A.getViewByName(Aq);A.set(l,An);Ao.preventDefault();},_processTemplate:function(An){var A=this;return AH.substitute(An,A.getStrings());
},_setEventRecorder:function(An){var A=this;if(An){An.set(p,A);}},_setEvents:function(Ao){var A=this;var An=[];AH.Array.each(Ao,function(Ap,Aq){if(!AE(Ap)){Ap=new AH.SchedulerEvent(Ap);}Ap.set(p,A);An.push(Ap);});return An;},_setViews:function(Ao){var A=this;var An=[];AH.Array.each(Ao,function(Ap){if(Y(Ap)&&!Ap.get(Aj)){Ap.set(p,A);An.push(Ap);A.viewStack[Ap.get(P)]=Ap;}});if(!A.get(l)){A.set(l,Ao[0]);}return An;},syncStdContent:function(){var A=this;var An=A.get(Al);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);AH.Array.each(An,function(Ao){A.viewsNode.append(A._createViewTriggerNode(Ao));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(AJ);A.setStdModContent(AA.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(Ar){var Ao=this;var An=Ao.get(AW);var A=Ao.get(Ai);var Aq=AH.DataType.Date.format(Ar,{format:An,locale:A});Ao.currentDateNode.html(Aq);if(Ao.get(Aj)){var Ap=Ao.get(l);if(Ap){Ap._uiSetCurrentDate(Ar);}Ao.syncEventsUI();}}}});AH.Scheduler=AH.Base.create(W,m,[AH.WidgetStdMod]);},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(B1){var CI=B1.Lang,CZ=CI.isObject,Bq=CI.isString,As=CI.isBoolean,Ae=CI.isNumber,BC=function(A){return A==0?0:(A<0?-1:1);},Ai=function(A,AM){return Math.max(Math.abs(A),AM)*BC(A);},Bd=function(A){return parseFloat(A)||0;},Bf=function(AM,A){return Math.round(AM/A)*A;},AP=B1.DataType.DateMath,Bx=B1.WidgetStdMod,Aj=AP.WEEK_LENGTH,Bh="scheduler-view",Ad="scheduler-view-day",B5="scheduler-view-week",CS="scheduler-view-month",Bc="activeView",A4="am",Ao="boundingBox",R="children",BU="childNodes",AE="col",g="colblank",Z="coldata",Ag="colday",BP="colmonth",B="colgrid",u="colspan",BY="navigationDateFormat",N="coltime",AV="colDaysNode",B3="colHeaderDaysNode",Am="container",CP="contentBox",AT="createDocumentFragment",A9="currentDate",A8="dateFormat",CF="day",s="days",BH="division",AY="endDate",Bv="events",Af="first",B6="firstDayOfWeek",A6="grid",Ca="hd",Bz="header",CW="headerTableNode",Ac="hourHeight",AI="isoTime",BD="labelAM",Aa="labelPM",Ap="left",AW="locale",AA="marker",A2="markercell",Av="markercellsNode",Bi="markercellNode",j="markers",Bg="nextDate",Cc="node",By="offsetHeight",CD="ownerDocument",B2="pad",p="parentNode",AL="pm",y="prevDate",AF="px",Aq="rendered",Aw="right",S="scheduler",Ab="scheduler-event",w="scrollable",r="shim",B4="startDate",Ar="table",CQ="tableColNode",BS="tableNode",Br="tableTimeNode",BJ="time",AG="timesNode",AJ="today",BN="top",CX="tr",CL="week",BW="width",B9="borderRightWidth",V="borderLeftWidth",CN="columnNode",BO="proxy",B7="dragNode",H="title",An="host",i="offsetTop",B0="offsetWidth",CK="parentEvent",Ak="content",Ba="month",A7="headerDateFormat",A5="monthContainerNode",BM="row",Bk="height",c="tableGridNode",v="div",AQ="noscroll",BV="data",K="tableDataNode",BQ="tbody",AH="nomonth",A0="event",Al="next",z="down",F="td",Bw="repeated",W="icon",T="eventWidth",Cb="eventRecorder",Bp="duration",Be="-",L="a",Bj=".",Bb="",BX="%",t=" ",d=B1.ClassNameManager.getClassName,BI=d(Bh,AQ),AB=d(Bh,w);var Au=B1.Component.create({NAME:Bh,ATTRS:{bodyContent:{value:Bb},height:{value:600},name:{value:Bb,validator:Bq},navigationDateFormat:{value:"%A - %d %b %Y",validator:Bq},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:As},triggerNode:{setter:B1.one},visible:{value:false}},BIND_UI_ATTRS:[w],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);Cd.set(A9,AM);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return AP.clearTime(new Date());},limitDate:function(AM,Cd){var A=this;if(AP.after(AM,Cd)){AM=AP.clone(Cd);}return AM;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(Cd){var A=this;var AM=A.get(S);A.adjustCurrentDate();A._uiSetScrollable(A.get(w));},_setScheduler:function(Cd){var A=this;var AM=A.get(S);if(AM){A.removeTarget(AM);}if(Cd){A.addTarget(Cd);Cd.after("eventsChange",B1.bind(A.flushViewCache,A));}return Cd;},_uiSetScrollable:function(Cd){var A=this;var AM=A.bodyNode;if(AM){AM.toggleClass(AB,Cd);AM.toggleClass(BI,!Cd);}},_uiSetVisible:function(AM){var A=this;Au.superclass._uiSetVisible.apply(this,arguments);if(AM&&A.get(Aq)){A.adjustCurrentDate();}}}});B1.SchedulerView=B1.Base.create(Bh,Au,[B1.WidgetStdMod]);var m=function(A,AM){return function(Ce){var Cd=Ce.all(A);return(Cd.size()>=AM)?Cd:null;};},Ah=d(Ab),Bm=d(Ab,BO),a=d(Bh,Z),D=d(Bh,B),o=d(S,AJ),AO=d(S,AJ,Ca),CA=d(Bh,A6),CB=d(Bh,A6,Am),CE=d(Bh,A2),k=d(Bh,j),BG=d(Bh,AA,BH),BT=d(Bh,Ar),CH=d(Bh,CF,Bz,Ar),U=d(Bh,CF,Bz,CF),BF=d(Bh,CF,Bz,CF,B2,Aw),Bo=d(Bh,CF,Bz,CF,Af),Az=d(Bh,CF,Bz,AE),CU=d(Bh,Ar,AE),AZ=d(Bh,Ar,AE,r),n=d(Bh,Ar,g),f=d(Bh,Ar,Ag),O=d(Bh,Ar,Ag,Bz),CM=d(Bh,Ar,N),BL=d(Bh,Ar,BJ),AC='<div class="'+CE+'">'+'<div class="'+BG+'"></div>'+"</div>",AS='<table class="'+BT+'">'+"<tbody>"+'<tr class="'+D+'" height="1">'+'<td height="0" class="'+[CU,n].join(t)+'"></td>'+'<td class="'+CB+'" colspan="1">'+'<div class="'+CA+'">'+'<div class="'+k+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+a+'">'+'<td class="'+[CU,CM].join(t)+'"></td>'+"</tr>"+"</tbody>"+"</table>",BB='<td class="'+[CU,f].join(t)+'">'+'<div class="'+AZ+'"></div>'+"</td>",J='<div class="'+BL+'">{hour}</div>',AU='<table class="'+CH+'">'+"<tbody>"+'<tr class="'+Az+'"></tr>'+"</tbody>"+"</table>",BE='<th class="'+U+'"><a href="#">&nbsp;</a></th>',AR='<td class="'+[U,Bo].join(t)+'"></td>',X='<th class="'+[U,BF].join(t)+'">&nbsp;</th>';var CV=B1.Component.create({NAME:Ad,ATTRS:{bodyContent:{value:Bb},days:{value:1,validator:Ae},headerDateFormat:{value:"%a %d/%m",validator:Bq},isoTime:{value:false,validator:As},name:{value:CF},hourHeight:{value:52,validator:Ae},eventWidth:{value:95,validator:Ae},headerTableNode:{valueFn:function(){return B1.Node.create(AU);
}},tableNode:{valueFn:function(){return B1.Node.create(AS);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:m(Bj+U,2),colDaysNode:m(Bj+f,1),markercellsNode:m(Bj+CE,24),timesNode:m(Bj+BL,24),headerTableNode:Bj+CH,tableNode:Bj+BT},EXTENDS:B1.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(AV);A.colHeaderDaysNode=A.get(B3);A.headerTableNode=A.get(CW);A.markercellsNode=A.get(Av);A.tableNode=A.get(BS);A.timesNode=A.get(AG);A.colShimNodes=A.colDaysNode.all(Bj+AZ);A.colDataNode=A.tableNode.one(Bj+a);A.colTimeNode=A.tableNode.one(Bj+CM);A.dayHeaderColNode=A.headerTableNode.one(Bj+Az);A.gridContainer=A.tableNode.one(Bj+CB);A.markersNode=A.tableNode.one(Bj+k);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",B1.bind(A._onClickDaysHeader,A),Bj+U);A.colDataNode.delegate("click",B1.bind(A._onClickTableCol,A),Bj+CU);A.colDataNode.delegate("mousedown",B1.bind(A._onMouseDownTableCol,A),Bj+CU);A.colDataNode.delegate("mouseup",B1.bind(A._onMouseUpTableCol,A),Bj+CU);A.colDataNode.delegate("mousemove",B1.bind(A._onMouseMoveTableCol,A),Bj+CU);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;CV.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(u,A.get(s));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(Bx.BODY,A.tableNode.getDOM());A.setStdModContent(Bx.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(Ce){var AM=this;var A=AM.get(Ac);var Cd=Ce.getHours();var Cf=Ce.getMinutes();var Cg=Ce.getSeconds();return((Cd*60)+Cf+(Cg/60))*(A/60);},calculateHoursByTop:function(Cf){var AM=this;var A=AM.get(Ac);var Ch=Bd((Cf/A).toFixed(2));var Cg=0;var Ce=Math.floor((Ch*100)%100*0.6);var Cd=Math.floor(Ch);return[Cd,Ce,Cg];},getNextDate:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);return AP.add(AM,AP.DAY,1);},getPrevDate:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);return AP.subtract(AM,AP.DAY,1);},getColumnByDate:function(Cd){var A=this;var Ce=A.get(S);var AM=AP.safeClearTime(Ce.get(A9));var Cf=AP.getDayOffset(AP.safeClearTime(Cd),AM);return A.colDaysNode.item(Cf);},getDateByColumn:function(Cd){var A=this;var Ce=A.get(S);var AM=AP.safeClearTime(Ce.get(A9));return AP.add(AM,AP.DAY,Cd);},plotEvents:function(Cd){var A=this;var AM=A.get(S);A.colShimNodes.each(function(Ch,Cg){var Cf=A.getDateByColumn(Cg);var Ce=AM.getEventsByDay(Cf);Ch.empty();B1.Array.each(Ce,function(Ci,Cj){if(!Ci.isDayOverlapEvent()){Ch.append(Ci.get(Cc));Ci.set(CN,Ch.get(p));A.syncEventTopUI(Ci);A.syncEventHeightUI(Ci);}});A.syncEventsIntersectionUI(Ce);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(Ce,Cd){var AM=A.getDateByColumn(Cd);Ce.toggleClass(o,AP.isToday(AM));});},syncDaysHeaderUI:function(){var Cd=this;var Cf=Cd.get(S);var Ce=Cf.get(A9);var AM=Cd.get(A7);var A=Cd.get(AW);Cd.colHeaderDaysNode.all(L).each(function(Ci,Ch){var Cg=AP.add(Ce,AP.DAY,Ch);var Cj=B1.DataType.Date.format(Cg,{format:AM,locale:A});Ci.toggleClass(AO,AP.isToday(Cg));Ci.html(Cj);});},syncEventsIntersectionUI:function(AM){var A=this;var Cd=A.get(S);var Ce=A.get(T);Cd.flushEvents();B1.Array.each(AM,function(Cg,Ch){var Cj=A.findEventIntersections(Cg,AM);var Ci=Cj.length;var Cf=(Ce/Ci);B1.Array.each(Cj,function(Cl,Cm){var Ck=Cl.get(Cc);var Co=Cf*Cm;var Cn=Cf*1.7;if(Cm==(Ci-1)){Cn=Ce-Co;}Ck.setStyle(BW,Cn+BX);Ck.setStyle(Ap,Co+BX);var Cp=Ck.get(p);if(Cp){Cp.insert(Ck,Cm);}Cl._filtered=true;});});},syncEventHeightUI:function(Cd){var AM=this;var A=AM.get(Ac);var Cf=AM.calculateTopByDate(Cd.get(B4));var Ce=AM.calculateTopByDate(Cd.get(AY));Cd.get(Cc).set(By,Math.max(Ce-Cf,A/2));},syncEventRecorderUI:function(Ce){var A=this;var Cd=A.get(S);var Cf=Cd.get(Cb);var AM=Cf.get(Cc);if(Ce&&!AM.inDoc()){Ce.append(AM);}A.syncEventTopUI(Cf);A.syncEventHeightUI(Cf);},syncEventTopUI:function(Cd){var AM=this;var A=Cd.get(Cc);var Ce=AM.calculateTopByDate(Cd.get(B4));A.setStyle(BN,Ce+AF);},findEventIntersections:function(AM,Cd){var A=this;var Ce=[];B1.Array.each(Cd,function(Cg,Cf){if(!AM._filtered&&!Cg.isDayOverlapEvent()&&AM.intersectHours(Cg)){Ce.push(Cg);}});return Ce;},_createEvents:function(){var A=this;var AM=function(Cd,Ce){A.publish(Cd,{defaultFn:Ce,queuable:false,emitFacade:true,bubbles:true,prefix:Bh});};},_dragTickAlignX:function(AM){var Cl=this;var Cm=AM.target.get(An);var Cn=Cl._getColumnRefWidth();var Cf=Cm.get(Cc);var Ci=Cl.proxyEvt;var Cj=Cf.getData(Ab);var Ck=(Cm.actXY[0]-Cl.bodyNode.getX()-Cl.colTimeNode.get(B0));var Cd=Math.floor(Ck/Cn);var Ch=Cl.colDaysNode.item(Cd);var Cg=Cl.getDateByColumn(Cd);var A=AP.clone(Cg);var Ce=AP.clone(Cg);AP.copyHours(Ce,Ci.get(AY));AP.copyHours(A,Ci.get(B4));Ci.set(AY,Ce);Ci.set(B4,A);},_dragTickAlignY:function(Cd){var Ci=this;var Cj=Cd.target.get(An);var Cf=Cj.get(Cc);var Cg=Ci.proxyEvt;var Ch=Cf.getData(Ab);var AM=AP.clone(Cg.get(B4));var A=Ci.calculateHoursByTop(Bd(Cj.get(B7).getComputedStyle(BN)));Ci._setTickedHours(AM,A);var Ce=AP.clone(AM);Cg.set(AY,AP.add(Ce,AP.MINUTES,Ci._currentEvtDuration));Cg.set(B4,AM);Cg.syncNodeTitleUI();},_getXYDelta:function(AM){var A=this;var Ce=AM.currentTarget;var Cd=Ce.getXY(),Cf=[AM.pageX,AM.pageY];return B1.Array.map(Cd,function(Ch,Cg){return(Cf[Cg]-Ch);});},_getTickY:function(){var A=this;return Bf(Math.ceil(A.get(Ac)/2),10);},_getColumnRefWidth:function(){var A=this;var AM=A.colDaysNode.item(0);return Bd(AM.getStyle(BW))-Bd(AM.getStyle(B9))-Bd(AM.getStyle(V));},_setupDragDrop:function(){var Cd=this;var Ce=Cd.get(Ao);if(!Cd.proxyEvt){var Cf=Cd.get(S);
Cd.proxyEvt=new B1.SchedulerEvent({scheduler:Cf});Cd.proxyEvt.removeTarget(Cf);Cd.proxyEvt.get(Cc).addClass(Bm);}if(!Cd.delegate){Cd.delegate=new B1.DD.Delegate({bubbleTargets:Cd,container:Ce,nodes:Bj+Ah});}var AM=Cd.delegate.dd;var Cg=Cd.proxyEvt;var Ch=Cd.get(Ac)/2;var A=Cd._getColumnRefWidth();AM.unplug(B1.Plugin.DDConstrained);AM.unplug(B1.Plugin.DDNodeScroll);AM.plug(B1.Plugin.DDConstrained,{bubbleTargets:Cd,constrain:Cd.bodyNode,tickX:A,tickY:Ch});AM.plug(B1.Plugin.DDNodeScroll,{node:Cd.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(AM){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(Ce){var A=this;var Cd=A.get(S);if(Ce.target.test(L)){var Cf=Cd.getViewByName(CF);var AM=A.colHeaderDaysNode.indexOf(Ce.currentTarget)-1;if(Cf){Cd.set(A9,A.getDateByColumn(AM));Cd.set(Bc,Cf);}}Ce.preventDefault();},_onClickTableCol:function(Cd){var A=this;var AM=A.get(S);var Ce=AM.get(Cb);},_onEventDragEnd:function(A){var Ci=this;var Cf=Ci.get(S);var Ce=Ci.get(Ao);var Cj=Ci.delegate.dd;var Cd=Cj.get(Cc);var Cg=Ci.proxyEvt;var AM=Cg.get(Cc);var Ch=Cd.getData(Ab);Cd.show();AM.hide();Ce.selectable();Ch.copyDates(Cg);Cf.syncEventsUI();},_onEventDragStart:function(A){var Ci=this;var Cf=Ci.get(Ao);var Cj=Ci.delegate.dd;var Ce=Cj.get(Cc);var Cg=Ci.proxyEvt;var Ch=Ce.getData(Ab);var Cd=Bd(Ce.getComputedStyle(Ap));if(Cd){Cj.deltaXY[0]=(Cd+Bd(Cj.deltaXY[0]));}if(Ch){var Ck=Ch.get(CN);var AM=Cg.get(Cc);Cj.set(B7,AM);Ck.append(AM);Cg.copyPropagateAttrValues(Ch);Ci.syncEventTopUI(Cg);Ci.syncEventHeightUI(Cg);AM.show();Ci._currentEvtDuration=Ch.getMinutesDuration();}Ce.hide();Cf.unselectable();},_onMouseDownTableCol:function(Ce){var A=this;var Cd=A.get(S);var Cf=Cd.get(Cb);if(Cf){Cf.hideOverlay();if(Ce.target.test(Bj+AZ)){var AM=A.colDaysNode.indexOf(Ce.currentTarget);A.dragXY=A.startXY=A._getXYDelta(Ce);A.ddStartDate=A.getDateByColumn(AM);A.ddEndDate=AP.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=AP.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);Cf.set(B4,A.ddStartDate);Cf.set(AY,A.limitDate(Cf.get(AY),A.ddMaxDate));Ce.halt();}}},_onMouseMoveTableCol:function(Cf){var A=this;var Ce=A.get(S);var Ci=Ce.get(Cb);var Cg=A.ddStartDate;if(Cg){A.dragXY=A._getXYDelta(Cf);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var Ch=AP.getMinutesOffset(A.ddEndDate,Cg);if((A.dragXY[1]-A.startXY[1])>0){Ch=Ai(Ch,Ci.get(Bp));}var AM=A.limitDate(AP.add(Cg,AP.MINUTES,Ch),A.ddMaxDate);if(Ch>0){Ci.set(AY,AM);}else{var Cd=Ci.get(AY);Ci.set(B4,AM);Ci.set(AY,Cd);}A.syncEventRecorderUI(Cf.currentTarget);}},_onMouseUpTableCol:function(Cd){var A=this;var AM=A.get(S);var Ce=AM.get(Cb);if(Ce){if(A.ddStartDate){A.syncEventRecorderUI(Cd.currentTarget);Ce.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(AM,Cd){var A=this;AM.setHours(Cd[0],Bf(Cd[1],A._getTickY()),Cd[2]);},_valueColDaysNode:function(){var A=this;var Cd=A.get(s);var AM=[];while(Cd--){AM.push(BB);}return B1.NodeList.create(AM.join(Bb));},_valueColHeaderDaysNode:function(){var A=this;var Cd=A.get(s);var AM=[];AM.push(AR);while(Cd--){AM.push(BE);}AM.push(X);return B1.NodeList.create(AM.join(Bb));},_valueMarkercellsNode:function(){var A=this;var AM=[];for(var Cd=0;Cd<=23;Cd++){AM.push(AC);}return B1.NodeList.create(AM.join(Bb));},_valueTimesNode:function(){var A=this;var Ce=A.get(AI);var Cd=[];for(var AM=0;AM<=23;AM++){Cd.push(B1.substitute(J,{hour:Ce?AP.toIsoTimeString(AM):AP.toUsTimeString(AM,false,true)}));}return B1.NodeList.create(Cd.join(Bb));}}});B1.SchedulerDayView=CV;var AK=B1.Component.create({NAME:B5,ATTRS:{bodyContent:{value:Bb},days:{value:7},name:{value:CL}},EXTENDS:B1.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var Ce=A.get(S);var AM=Ce.get(A9);var Cd=Ce.get(B6);Ce.set(A9,AP.getFirstDayOfWeek(AM,Cd));},getNextDate:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);var Ce=A._firstDayOfWeek(AM);return AP.add(Ce,AP.WEEK,1);},getPrevDate:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);var Ce=A._firstDayOfWeek(AM);return AP.subtract(Ce,AP.WEEK,1);},getToday:function(){var A=this;var AM=AK.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(AM);},_firstDayOfWeek:function(Cd){var A=this;var Ce=A.get(S);var AM=Ce.get(B6);return AP.getFirstDayOfWeek(Cd,AM);}}});B1.SchedulerWeekView=AK;var I=d(Bh,Ba,Am),A1=d(Bh,Ba,Bz,AE),Y=d(Bh,Ba,Bz,CF),CR=d(Bh,Ba,Bz,Ar),Bt=d(Bh,Ba,BM),AN=d(Bh,Ba,BM,Am),G=d(W),M=d(W,"arrowstop-1-l"),CO=d(W,"arrowstop-1-r"),Bu=d(Bh,Ba,B),C=d(Bh,Ba,B,AJ),P=d(Bh,Ba,B,Af),BZ=d(Bh,Ba,Ar,BV),Ax=d(Bh,Ba,Ar,BV,Af),Bs=d(Bh,Ba,Ar,BV,AE),B8=d(Bh,Ba,Ar,BV,AE,Af),Ay=d(Bh,Ba,Ar,BV,AE,AH),At=d(Bh,Ba,Ar,BV,AE,H),q=d(Bh,Ba,Ar,BV,AE,H,AJ),AD=d(Bh,Ba,Ar,BV,AE,H,Af),b=d(Bh,Ba,Ar,BV,AE,H,Al),CT=d(Bh,Ba,Ar,BV,AE,H,z),BK=d(Bh,Ba,Ar,BV,A0),E=d(Bh,Ba,Ar,BV,A0,Ap),Bl=d(Bh,Ba,Ar,BV,A0,Aw),Q=d(Bh,Ba,Ar,BV,A0,Bw),BA=d(Bh,Ba,Ar,A6),CJ=d(Bh,Ba,Ar,A6,Af),CY=d(Bh,Ar,BP,Bz),e='<table class="'+CR+'">'+"<tbody>"+'<tr class="'+A1+'"></tr>'+"</tbody>"+"</table>",l='<th class="'+Y+'"><div>&nbsp;</div></th>',CG='<div class="'+I+'">'+'<div class="'+AN+'">'+'<div class="'+Bt+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+Bt+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+Bt+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+Bt+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+Bt+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+Bt+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",BR='<table cellspacing="0" cellpadding="0" class="'+BA+'">'+"<tbody>"+"<tr>"+'<td class="'+[Bu,P].join(t)+'">&nbsp;</td>'+'<td class="'+Bu+'">&nbsp;</td>'+'<td class="'+Bu+'">&nbsp;</td>'+'<td class="'+Bu+'">&nbsp;</td>'+'<td class="'+Bu+'">&nbsp;</td>'+'<td class="'+Bu+'">&nbsp;</td>'+'<td class="'+Bu+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",Bn='<table cellspacing="0" cellpadding="0" class="'+BZ+'">'+"<tbody></tbody>"+"</table>",CC="<tr></tr>",A3='<td class="'+Bs+'"><div></div></td>',x='<span class="'+[G,M].join(t)+'"></span>',h='<span class="'+[G,CO].join(t)+'"></span>';
var AX=B1.Component.create({NAME:CS,ATTRS:{bodyContent:{value:Bb},name:{value:Ba},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return B1.Node.create(CG);}},headerTableNode:{valueFn:function(){return B1.Node.create(e);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:m(Bj+BA,7),colHeaderDaysNode:m(Bj+Y,7),monthContainerNode:Bj+I,headerTableNode:Bj+CR},EXTENDS:B1.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var AM=A.get(S);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(B3);A.headerTableNode=A.get(CW);A.monthContainerNode=A.get(A5);A.tableGridNode=A.get(c);A.dayHeaderColNode=A.headerTableNode.one(Bj+A1);A.monthRows=A.monthContainerNode.all(Bj+Bt);A.tableGridCols=A.tableGridNode.all(F);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(Ce,Cd){var AM=A.tableGridNode.item(Cd);Ce.append(AM.toggleClass(CJ,(Cd==0)));});},buildEventsTable:function(AM,Ch){var Cn=this;var Ck=5;var Ce=AP.clearTime(Cn._findCurrentMonthEnd());var Cm=AP.clearTime(Cn._findCurrentMonthStart());var Cj=String(Cm.getTime()).concat(AM.getTime()).concat(Ch.getTime());var Ci=Cn.evtDataTableStack[Cj];if(!Ci){Ci=B1.Node.create(Bn);var Cl=Ci.one(BQ);var Cf=B1.Node.create(CC);Cn.loopDates(AM,Ch,function(Cp,Co){var Cq=B1.Node.create(A3);Cq.addClass(At).toggleClass(AD,(Co==0)).toggleClass(q,AP.isToday(Cp)).toggleClass(b,AP.isToday(AP.subtract(Cp,AP.DAY,1))).toggleClass(CT,AP.isToday(AP.subtract(Cp,AP.WEEK,1)));if(AP.before(Cp,Cm)||AP.after(Cp,Ce)){Cq.addClass(Ay);}Cf.append(Cq.setContent(Cp.getDate()));});Cl.append(Cf);for(var A=0;A<Ck;A++){var Cg=0;var Cd=B1.Node.create(CC);Cn.loopDates(AM,Ch,function(Ct,Cr){if(Cg<=Cr){var Cs=Cn.getIntersectEvents(Ct),Cp=Cs[A];var Cu=B1.Node.create(A3);if(Cp){var Co=Cu.one(v);var Cq=Cn._getEvtSplitInfo(Cp,AM,Ch);Cu.attr(u,Cq.colspan);Co.addClass(BK).setContent(Cn._getEvtLabel(Cp));if(Cq.left){Co.addClass(E).prepend(x);}if(Cq.right){Co.addClass(Bl).append(h);}if(Cp.get(CK)){Co.addClass(Q);}Cg+=Cq.colspan;}else{Cg++;}Cd.append(Cu);}});Cl.append(Cd);}Cn.evtDataTableStack[Cj]=Ci;}return Ci;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(AM){var A=this;var Ce=A.get(S);var Cd=String(AM.getTime());if(!A.evtDateStack[Cd]){A.evtDateStack[Cd]=Ce.getIntersectEvents(AM);}return A.evtDateStack[Cd];},loopDates:function(A,Ce,Ch,Ci,Cg){var Cj=this;var AM=AP.clone(A);var Cd=Ce.getTime();for(var Cf=0;AM.getTime()<=Cd;Cf++){Ch.apply(Cj,[AM,Cf]);AM=AP.add(AM,(Ci||AP.DAY),(Cg||1));}},plotEvents:function(){var AM=this;var Cd=AM._findCurrentMonthStart();var A=AP.safeClearTime(AM._findFirstDayOfWeek(Cd));AM.bodyNode.all(Bj+BZ).remove();AM.monthRows.each(function(Ch,Cf){var Ce=AP.add(A,AP.WEEK,Cf);var Ci=AP.add(Ce,AP.DAY,Aj-1);var Cg=AM.buildEventsTable(Ce,Ci);if(Cf==0){Cg.addClass(Ax);}Ch.append(Cg);});},syncStdContent:function(){var A=this;A.setStdModContent(Bx.BODY,A.monthContainerNode.getDOM());A.setStdModContent(Bx.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var Cj=this;var Cd=Cj.getToday();var AM=Cj.get(S);Cj.tableGridCols.removeClass(C);if(AP.isSameMonth(Cd,AM.get(A9))){var A=AM.get(B6);var Cd=Cj.getToday();var Cf=Cj._findCurrentMonthStart();var Ch=Cj._findFirstDayOfWeek(Cd);var Ce=AP.getWeekNumber(Cd,A)-AP.getWeekNumber(Cf,A);var Ci=(Cd.getDate()-Ch.getDate());var Cg=Cj.tableGridNode.item(Ce).all(F).item(Ci);if(Cg){Cg.addClass(C);}}},adjustCurrentDate:function(){var A=this;var AM=A.get(S);AM.set(A9,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);return AP.add(AM,AP.MONTH,1);},getPrevDate:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);return AP.subtract(AM,AP.MONTH,1);},syncDaysHeaderUI:function(){var Cd=this;var Cg=Cd.get(S);var Ce=Cg.get(A9);var AM=Cd.get(A7);var A=Cd.get(AW);var Cf=Cd._findFirstDayOfWeek(Ce);Cd.colHeaderDaysNode.all(v).each(function(Cj,Ci){var Ch=AP.add(Cf,AP.DAY,Ci);var Ck=B1.DataType.Date.format(Ch,{format:AM,locale:A});Cj.html(Ck);});},_findCurrentMonthEnd:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);return AP.findMonthEnd(AM);},_findCurrentMonthStart:function(){var A=this;var Cd=A.get(S);var AM=Cd.get(A9);return AP.findMonthStart(AM);},_findFirstDayOfWeek:function(Cd){var A=this;var Ce=A.get(S);var AM=Ce.get(B6);return AP.getFirstDayOfWeek(Cd,AM);},_getEvtLabel:function(Cd){var AM=this;var Ce=Cd.get(AY);var A=Cd.get(B4);return[A.getHours(),Be,Ce.getHours(),t,Cd.get(Ak)].join(Bb);},_getEvtSplitInfo:function(Ci,A,Cg){var Cj=this;var AM=Ci.getClearStartDate();var Ch=Ci.getClearEndDate();var Cf=Ci.getDaysDuration();var Ce={};var Cd=1;if(AP.after(AM,A)){Cd=Math.min(Cf,Math.abs(AP.getDayOffset(Cg,AM))+1);if(Cd>1){Ce.right=true;}}else{Cd=Math.abs(AP.getDayOffset(Ch,A)+1);if(Cd>1){Ce.left=true;}}Ce.colspan=Math.min(Cd,Aj);if(Cd>=Aj){Ce.right=true;Ce.left=true;}return Ce;},_uiSetCurrentDate:function(AM){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(Aj,l);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(Aj,BR);},_valueNodeList:function(Ce,Cd){var A=this;var AM=[];while(Ce--){AM.push(Cd);}return B1.NodeList.create(AM.join(Bb));}}});B1.SchedulerMonthView=AX;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","substitute","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(AS){var AD=AS.Lang,A3=AD.isString,I=AD.isDate,At=AD.isFunction,i=AD.isObject,Av=AD.isBoolean,s=AD.isNumber,Ak=AS.ColorUtil,N=AS.DataType.DateMath,Aq=AS.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),A0="-",AI=".",S="",T=" ",P="_",AX="_propagateSet",n="activeView",BA="borderWidth",Ag="colorBrightnessFactor",Ay="colorSaturationFactor",j="Change",Ap="color",AO="content",y="contentNode",Am="duration",Aa="endDate",A4="events",Ao="id",Ai="isoTime",A9="locale",Q="node",K="overlay",AU="parentEvent",BE="recorder",AY="repeat",A2="repeated",m="repeatedEvents",x="scheduler",AG="scheduler-event",AH="scheduler-event-recorder",A6="startDate",As="template",Af="title",H="titleDateFormat",g="titleNode",AQ="borderStyle",G="%H:%M",Ar="%I:%M",e=AS.ClassNameManager.getClassName,U=e(AG),AE=e(AG,BE),Ab=e(AG,AO),AK=e(AG,A2),b=e(AG,Af),AV='<div class="'+U+'">'+'<div class="'+b+'"></div>'+'<div class="'+Ab+'"></div>'+"</div>";
var o=AS.Component.create({NAME:AG,ATTRS:{borderStyle:{value:"solid",validator:A3},borderWidth:{value:"1px",validator:A3},colorBrightnessFactor:{value:0.75,validator:s},colorSaturationFactor:{value:1.5,validator:s},content:{value:"(no title)",validator:A3},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:A3},titleDateFormat:{getter:"_getTitleDateFormat",validator:A3},endDate:{valueFn:function(){var A=N.clone(this.get(A6));A.setHours(A.getHours()+1);return A;},validator:I},columnNode:{setter:AS.one},node:{valueFn:function(){return AS.Node.create(AV).setData(AG,this);},setter:AS.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:I}},EXTENDS:AS.Base,PROPAGATE_ATTRS:[A6,Aa,AO,Ap,Ag,Ay,AQ,BA,H],prototype:{eventStack:null,initializer:function(){var A=this;var BC=A.get(Q);A.eventStack={};A.nodeStack={};AS.Array.each(AS.SchedulerEvent.PROPAGATE_ATTRS,function(BD){A.after(BD+j,A._propagateAttrChange);});A.contentNode=BC.one(AI+Ab);A.titleNode=BC.one(AI+b);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(BC,BD){BC.destroy();});A.eventStack={};A.get(Q).remove(true);},copyDates:function(BC){var A=this;A.set(Aa,N.clone(BC.get(Aa)));A.set(A6,N.clone(BC.get(A6)));},copyPropagateAttrValues:function(BC,BD){var A=this;A.copyDates(BC);AS.Array.each(AS.SchedulerEvent.PROPAGATE_ATTRS,function(BG){if(!(BG in (BD||{}))){var BH=BC.get(BG);if(!i(BH)){A.set(BG,BH);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return N.getDayOffset(A.get(Aa),A.get(A6));},getHoursDuration:function(){var A=this;return N.getHoursOffset(A.get(Aa),A.get(A6));},getMinutesDuration:function(){var A=this;return N.getMinutesOffset(A.get(Aa),A.get(A6));},getSecondsDuration:function(){var A=this;return N.getSecondsOffset(A.get(Aa),A.get(A6));},sameEndDate:function(BC){var A=this;return N.compare(A.get(Aa),BC.get(Aa));},sameStartDate:function(BC){var A=this;return N.compare(A.get(A6),BC.get(A6));},isAfter:function(BG){var BD=this;var BC=BD.get(A6);var A=BG.get(A6);return N.after(BC,A);},isBefore:function(BG){var BD=this;var BC=BD.get(A6);var A=BG.get(A6);return N.before(BC,A);},repeatByDate:function(BD){var A=this;var BG=A.uidByDate(BD);if(!A.eventStack[BG]){var BC=N.clone(BD);var BH=N.clone(BD);N.copyHours(BC,A.get(A6));N.copyHours(BH,A.get(Aa));var BI=new AS.SchedulerEvent({endDate:BH,parentEvent:A,scheduler:A.get(x),startDate:BC});BI.copyPropagateAttrValues(A);A.eventStack[BG]=BI;}return A.eventStack[BG];},intersects:function(BG){var BD=this;var BH=BD.get(Aa);var BC=BD.get(A6);var A=BG.get(A6);return(BD.sameStartDate(BG)||N.between(A,BC,BH));},intersectHours:function(BD){var BC=this;var BH=BC.get(Aa);var A=BC.get(A6);var BG=N.clone(A);N.copyHours(BG,BD.get(A6));return(N.compare(A,BG)||N.between(BG,A,BH));},isDayOverlapEvent:function(){var A=this;return N.isDayOverlap(A.get(A6),A.get(Aa));},isRepeatableDate:function(BC){var A=this;var BD=A.get(AY);return(BD&&BD.validate(A,BC));},getClearEndDate:function(){var A=this;return N.safeClearTime(A.get(Aa));},getClearStartDate:function(){var A=this;return N.safeClearTime(A.get(A6));},uidByDate:function(BC){var A=this;BC=I(BC)?N.safeClearTime(BC):A.getClearStartDate();return[AG,BC.getTime()].join(P);},setContent:function(BD,BC){var A=this;A._setContent(y,BD,BC);},setTitle:function(BD,BC){var A=this;A._setContent(g,BD,BC);},syncNodeUI:function(BC){var A=this;A.get(Q).toggleClass(AK,!!(A.get(AU)));A.syncNodeColorUI(BC);A.syncNodeTitleUI(BC);A.syncNodeContentUI(BC);},syncNodeColorUI:function(BC){var A=this;var BD=A.get(Q);var BG=A.getBorderColor();if(BD){BD.setStyles({borderWidth:A.get(BA),borderColor:BG,backgroundColor:A.get(Ap),borderStyle:A.get(AQ)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:BG});}if(BC){A.eachRepeatedEvent(function(BH,BI){BH.syncNodeColorUI();});}},syncNodeContentUI:function(BC){var A=this;A.setContent(A.get(AO),BC);},syncNodeTitleUI:function(BC){var A=this;var BD=A._formatDate(A.get(A6));var BG=A._formatDate(A.get(Aa));A.setTitle([BD,BG].join(T+A0+T),BC);},eachRepeatedEvent:function(BC){var A=this;AS.each(A.eventStack,BC,A);},unlink:function(){var A=this;if(A.get(AU)){A.set(AU,null);}else{A.eachRepeatedEvent(function(BC,BD){BC.unlink();});}A.eventStack={};A.syncNodeUI();},_propagateAttrChange:function(BG){var A=this;var BD=BG.attrName;var BC=BG.newVal;A.eachRepeatedEvent(function(BH,BI){var BJ=BH[AX+Aq(BD)];if(BJ){BJ.apply(A,[BH,BD,BC]);}else{BH.set(BD,BG.newVal);}BH.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,BC,BG){var BD=N.clone(A.get(Aa));N.copyHours(BD,BG);A.set(Aa,BD);},_propagateSetStartDate:function(BC,BD,BG){var A=N.clone(BC.get(A6));N.copyHours(A,BG);BC.set(A6,A);},_setColor:function(BC){var A=this;A.hsbColor=Ak.rgb2hsb(Ak.getRGB(BC));A.borderColor=AS.clone(A.hsbColor);A.borderColor.b*=A.get(Ag);A.borderColor.s*=A.get(Ay);A.borderColorRGB=Ak.hsb2rgb(A.borderColor);return BC;},_setContent:function(BD,BH,BC){var A=this;var BG=A[BD];if(BG){BG.setContent(BH);}if(BC){A.eachRepeatedEvent(function(BI,BJ){BI[BD].setContent(BH);});}},_setRepeat:function(BC){var A=this;if(A3(BC)){BC=AS.SchedulerEventRepeat[BC];}return BC;},_setScheduler:function(BD){var A=this;var BC=A.get(x);if(BC){A.removeTarget(BC);}A.addTarget(BD);return BD;},_formatDate:function(BD,BG){var BC=this;var A=BC.get(A9);BG=BG||BC.get(H);return AS.DataType.Date.format(BD,{format:BG,locale:A});},_getTitleDateFormat:function(BD){var A=this;if(!A3(BD)){var BC=A.get(x);BD=(BC&&BC.get(n).get(Ai))?G:Ar;}return BD;}}});AS.SchedulerEvent=o;AS.SchedulerEventRepeat={dayly:{description:"Every day",validate:function(A,BC){return true;}},monthly:{description:"Every month",validate:function(BC,BD){var BG=BC.get(Aa);var A=BC.get(A6);return(A.getDate()===BC.getDate());}},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,BC){return N.isMonWedOrFri(BC);}},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,BC){return N.isTueOrThu(BC);
}},weekDays:{description:"Every week days",validate:function(A,BC){return N.isWeekDay(BC);}},weekly:{description:"Every week",validate:function(BC,BD){var BG=BC.get(Aa);var A=BC.get(A6);return(A.getDay()===BC.getDay());}}};var A8="bc",A7="bd",AJ="bodyContent",R="boundingBox",AT="button",F="column",AO="content",AM="dblclick",An="desc",AL="disk",Au="field",AW="fieldset",AN="form",z="hint",AC="input",AZ="label",V="layout",Ae="menu",c="overlayContextPanel",AY="repeat",O="row",r="select",l="strings",B="tc",f="text",q="when",AP="dateFormat",x="scheduler",Ai="isoTime",AA="auiSchedulerEventRecorderWhen",Az="auiSchedulerEventRecorderDesc",Al="auiSchedulerEventRecorderSelect",a="auiSchedulerEventRecorderButtonRow",AR="scheduler-event-recorder:save",w="scheduler-event-recorder:cancel",A0="-",d="#",BF=e(AG,BE,K),Ax=e(AG,BE,AN),W=e(AN),L=e(V,AO),A1=e(V,AW),AF=e(V,AW,A7),v=e(V,AW,AO),Z=e(V,"w100"),M=e(F),Ac=e(F,AO),C=e(Au),X=e(Au,Ae),Ad=e(Au,r),A5=e(Au,AO),E=e(Au,AZ),Aj=e(Au,f),J=e(AT,O),Aw=e(Au,AC),AB=e(Au,AC,r),Y=e(Au,AC,f),Ah=e(AG,BE,AZ,q),D=e(AG,BE,An),k=e(AG,BE,Au,z),u=e(AG,BE,AY),t=e(AG,BE,AT,O),h="<option></option>",BB='<form id="auiSchedulerEventRecorderForm" class="'+[Ax,L,W].join(T)+'">'+'<div class="'+[A1,Z,M].join(T)+'">'+'<div class="'+[v,Ac].join(T)+'aui-fieldset-content aui-column-content">'+'<div class="'+AF+'">'+'<span class="'+[C,Aj].join(T)+'">'+'<span class="'+A5+'">'+'<label class="'+E+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+Ah+'"></span>'+"</span>"+"</span>"+'<span class="'+[C,Aj].join(T)+'">'+'<span class="'+A5+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[Aw,Y,D].join(T)+'" size="30" type="text" />'+'<div class="'+k+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[C,X,Ad].join(T)+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[Aw,AB,u].join(T)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[C,J,t].join(T)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var p=AS.Component.create({NAME:AH,ATTRS:{content:{value:S},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:A3},strings:{value:{},setter:function(A){return AS.merge({save:"Save",cancel:"Cancel",description:"Description",repeat:"Repeat",when:"When","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat"},A||{});},validator:i},overlayContextPanel:{value:{},setter:function(BC){var A=this;var BD=AS.Node.create(AS.substitute(BB,A.get(l)));return AS.merge({align:{points:[A8,B]},anim:false,bodyContent:BD,hideOn:AM,trigger:A.get(Q),visible:false,zIndex:9999},BC||{});}}},EXTENDS:AS.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.on("startDateChange",A._onStartDateChange);A.get(Q).addClass(AE);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(BC){var A=this;var BG=A.overlayDescNode.val();var BD=new AS.SchedulerEvent({endDate:A.get(Aa),scheduler:A.get(x),startDate:A.get(A6),repeat:A.overlaySelectNode.val()});BD.copyPropagateAttrValues(A,{content:true});if(BG){BD.set(AO,BG);}return BD;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},_createEvents:function(){var A=this;var BC=function(BD,BG){A.publish(BD,{defaultFn:BG,queuable:false,emitFacade:true,bubbles:true,prefix:AH});};BC(AR,this._defSaveEventFn);BC(w,this._defCancelEventFn);},_initOverlay:function(){var BC=this;var A=BC.get(l);BC.overlay=new AS.OverlayContextPanel(BC.get(c));var BG=BC.overlay;var BD=BG.get(R);var BH=BG.get(AJ);BC.overlayButtonRowNode=BH.one(d+a);BC.overlayDescNode=BH.one(d+Az);BC.overlaySelectNode=BH.one(d+Al);BC.overlayWhenNode=BH.one(d+AA);BC.overlaySaveBtn=new AS.ButtonItem({label:A.save,icon:AL,render:BC.overlayButtonRowNode,handler:{fn:BC._handleSaveEvent,context:BC}});BC.overlayCancelBtn=new AS.ButtonItem({label:A.cancel,render:BC.overlayButtonRowNode,handler:{fn:BC._handleCancelEvent,context:BC}});AS.each(AS.SchedulerEventRepeat,function(BJ,BI){BC.overlaySelectNode.append(AS.Node.create(h).val(BI).setContent(BJ.description));});BG.on("hide",AS.bind(BC._onOverlayHide,BC));BG.on("show",AS.bind(BC._onOverlayShow,BC));BH.on("submit",AS.bind(BC._handleSaveEvent,BC));BD.addClass(BF);},_defCancelEventFn:function(BC){var A=this;A.hideOverlay();},_defSaveEventFn:function(BD){var A=this;var BC=A.get(x);BC.addEvent(BD.newSchedulerEvent);A.hideOverlay();BC.syncEventsUI();},_getWhenFormattedDt:function(){var BD=this;var BC=BD.get(AP);var BI=BD.get(Aa);var BH=BD.get(x);var A=BD.get(A6);var BG=(BH.get(Ai)?N.toIsoTimeString:N.toUsTimeString);return[BD._formatDate(A,BC),BG(A),A0,BG(BI)].join(T);},_handleSaveEvent:function(BC){var A=this;A.fire(AR,{newSchedulerEvent:A.getEventCopy()});BC.preventDefault();},_handleCancelEvent:function(BC){var A=this;A.fire(w);BC.preventDefault();},_onOverlayHide:function(BC){var A=this;A.get(Q).remove();},_onOverlayShow:function(BC){var A=this;A.overlayWhenNode.setContent(A._getWhenFormattedDt());setTimeout(function(){A.overlayDescNode.val(S).selectText();},0);},_onStartDateChange:function(BC){var A=this;var BD=A.get(Am);A.set(Aa,N.add(BC.newVal,N.MINUTES,BD));}}});AS.SchedulerEventRecorder=p;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel","substitute"]});AUI.add("aui-scheduler-calendar",function(D){var H=D.Lang,J=H.isArray,C=H.isString,G=function(A){return(A instanceof D.SchedulerEvent);},E="scheduler-calendar",B="color",I="pallete";var F=D.Component.create({NAME:E,ATTRS:{events:{lazyAdd:false,value:[],setter:"_setEvents",validator:J},color:{valueFn:function(){var K=this;var L=K.get(I);var A=Math.ceil(Math.random()*L.length)-1;return L[A];},validator:C},name:{value:"(no name)",validator:C},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:J}},EXTENDS:D.Base,prototype:{_setEvents:function(L){var A=this;
var K=[];D.Array.each(L,function(M,N){if(!G(M)){M=new D.SchedulerEvent(M);}M.set(B,A.get(B));K.push(M);});return K;}}});D.SchedulerCalendar=F;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(B){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event"],skinnable:true});