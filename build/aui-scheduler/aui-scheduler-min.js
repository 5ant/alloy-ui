AUI.add("aui-scheduler-base",function(ac){var R=ac.Lang,a=R.isArray,e=R.isDate,ap=R.isFunction,J=R.isNumber,I=function(A){return(A instanceof ac.Scheduler);},t=function(A){return(A instanceof ac.SchedulerView);},aa=function(A){return(A instanceof ac.SchedulerEvent);},u=function(A){return(ac.SchedulerCalendar&&(A instanceof ac.SchedulerCalendar));},i=ac.DataType.DateMath,X=ac.WidgetStdMod,V=".",p="",q=" ",s="scheduler-base",ai="data-view-name",G="activeView",au="clearfix",F="controls",ak="controlsNode",aj="date",ag="endDate",ah="eventClass",O="eventRecorder",av="events",aA="hd",w="header",at="headerNode",n="helper",U="icon",k="iconNextNode",ao="iconPrevNode",ay="locale",m="name",S="nav",N="navNode",b="navigationDateFormatter",o="next",c="nextDate",ar="prev",al="prevDate",az="rendered",M="scheduler",aw="startDate",E="strings",f="today",ad="todayNode",v="triggerNode",z="view",P="viewDate",C="viewDateNode",Q="viewStack",aB="views",Y="viewsNode",B=ac.getClassName,ae=B(n,au),j=B(U),an=B(s,F),x=B(s,z,aj),g=B(s,aA),W=B(s,U,o),D=B(s,U,ar),ax=B(s,S),y=B(s,f),Z=B(s,z),h=B(s,z,p),r=B(s,aB),am='<div class="'+an+'"></div>',ab='<div class="'+x+'"></div>',d='<div class="'+g+'"></div>',aC='<a href="#" class="'+[j,W].join(q)+'">Next</a>',af='<a href="#" class="'+[j,D].join(q)+'">Prev</a>',l='<div class="'+ax+'"></div>',T='<a href="#" class="'+y+'">{today}</a>',aq='<a href="#" class="'+[Z,h].join(q)+'{name}" data-view-name="{name}">{label}</a>',K='<div class="'+r+'"></div>';var L=function(){};L.ATTRS={eventClass:{valueFn:function(){return ac.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ac.mix(L.prototype,{addEvent:function(aD){var A=this;var aE=[].concat(A.get(av));if(ac.Array.indexOf(aE,aD)===-1){aE.push(aD);A.set(av,aE);}},addEvents:function(aD){var A=this;ac.Array.each(A._normalizeEvents(aD),ac.bind(A.addEvent,A));},eachEvent:function(aE){var A=this;var aD=A.get(av);ac.Array.each(aD,aE,A);},removeEvent:function(aD){var A=this;var aE=[].concat(A.get(av));if(aE.length){ac.Array.removeItem(aE,aD);A.set(av,aE);}},removeEvents:function(aD){var A=this;ac.Array.each(A._normalizeEvents(aD),ac.bind(A.removeEvent,A));},_normalizeEvents:function(aE){var A=this;var aD=[];aE=ac.Array(aE);ac.Array.each(aE,function(aF){if(aa(aF)){aD.push(aF);}else{if(u(aF)){if(I(A)){aF.set(M,A);}aD=aD.concat(A._normalizeEvents(aF.get(av)));}else{aF=new (A.get(ah))(aF);aD.push(aF);}}if(I(A)){aF.set(M,A);aF.set(ah,A.get(ah));}});return aD;},_setEvents:function(aD){var A=this;return A._normalizeEvents(aD);}});ac.SchedulerEventSupport=L;var H=ac.Component.create({NAME:s,ATTRS:{activeView:{validator:t},date:{value:new Date(),validator:e},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(aD){var A=this;return ac.DataType.Date.format(aD,{format:"%B %d, %Y",locale:A.get(ay)});},validator:ap},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:J},controlsNode:{valueFn:function(){return ac.Node.create(am);}},viewDateNode:{valueFn:function(){return ac.Node.create(ab);}},headerNode:{valueFn:function(){return ac.Node.create(d);}},iconNextNode:{valueFn:function(){return ac.Node.create(aC);}},iconPrevNode:{valueFn:function(){return ac.Node.create(af);}},navNode:{valueFn:function(){return ac.Node.create(l);}},todayNode:{valueFn:function(){return ac.Node.create(this._processTemplate(T));}},viewsNode:{valueFn:function(){return ac.Node.create(K);}}},HTML_PARSER:{controlsNode:V+an,viewDateNode:V+x,headerNode:V+g,iconNextNode:V+W,iconPrevNode:V+D,navNode:V+ax,todayNode:V+y,viewsNode:V+r},UI_ATTRS:[aj],AUGMENTS:[ac.SchedulerEventSupport,ac.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[Q]={};A[ak]=A.get(ak);A[C]=A.get(C);A[w]=A.get(at);A[k]=A.get(k);A[ao]=A.get(ao);A[N]=A.get(N);A[ad]=A.get(ad);A[Y]=A.get(Y);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ac.Array.each(A.get(av),function(aD){aD.eachRepeatedEvent(function(aE){delete aE._filtered;});delete aD._filtered;});},getEventsByDay:function(aD,aE){var A=this;aD=i.safeClearTime(aD);return A._getEvents(aD,function(aF){return i.compare(aF.getClearStartDate(),aD)||(aE&&i.compare(aF.getClearEndDate(),aD));});},getIntersectEvents:function(aD){var A=this;aD=i.safeClearTime(aD);return A._getEvents(aD,function(aF){var aE=aF.getClearStartDate();var aG=aF.getClearEndDate();return(i.compare(aD,aE)||i.compare(aD,aG)||i.between(aD,aE,aG));});},sortEventsByDateAsc:function(aD){var A=this;aD.sort(function(aH,aF){var aG=aH.get(ag);var aE=aF.get(ag);var aJ=aH.get(aw);var aI=aF.get(aw);if(i.after(aJ,aI)||(i.compare(aJ,aI)&&i.before(aG,aE))){return 1;}else{return -1;}});},getViewByName:function(aD){var A=this;return A[Q][aD];},getStrings:function(){var A=this;return A.get(E);},getString:function(aD){var A=this;return A.getStrings()[aD];},renderView:function(aD){var A=this;if(aD){aD.show();if(!aD.get(az)){if(!A.bodyNode){A.setStdModContent(X.BODY,p);}aD.render(A.bodyNode);}}},plotViewEvents:function(aD){var A=this;aD.plotEvents(A.get(av));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(G));},_afterActiveViewChange:function(aF){var aD=this;if(aD.get(az)){var aE=aF.newVal;var A=aF.prevVal;if(A){A.hide();}aD.renderView(aE);var aG=aD.get(O);if(aG){aG.hideOverlay();}aD._uiSetDate(aD.get(aj));}},_afterRender:function(aD){var A=this;A.renderView(A.get(G));A._uiSetDate(A.get(aj));},_bindDelegate:function(){var A=this;A[Y].delegate("click",A._onClickViewTrigger,V+Z,A);A[ak].delegate("click",A._onClickPrevIcon,V+D,A);A[ak].delegate("click",A._onClickNextIcon,V+W,A);A[ak].delegate("click",A._onClickToday,V+y,A);},_createViewTriggerNode:function(aD){var A=this;if(!aD.get(v)){var aE=aD.get(m);aD.set(v,ac.Node.create(R.sub(aq,{name:aE,label:(A.getString(aE)||aE)})));
}return aD.get(v);},_getEvents:function(aD,aG){var A=this;var aF=A.get(av);var aE=[];ac.Array.each(aF,function(aH){if(aG.apply(A,[aH])){aE.push(aH);}else{if(aH.isRepeatableDate(aD)){var aI=aH.repeatByDate(aD);aE.push(aI);}}});A.sortEventsByDateAsc(aE);return aE;},_getViewDate:function(){var A=this,aD=A.get(aj),aE=A.get(G);if(aE){aD=aE.getAdjustedViewDate(aD);}return aD;},_onClickToday:function(aD){var A=this;A.set(aj,A.get(G).getToday());aD.preventDefault();},_onClickNextIcon:function(aD){var A=this;A.set(aj,A.get(G).get(c));aD.preventDefault();},_onClickPrevIcon:function(aD){var A=this;A.set(aj,A.get(G).get(al));aD.preventDefault();},_onClickViewTrigger:function(aD){var A=this;var aE=aD.currentTarget.attr(ai);A.set(G,A.getViewByName(aE));aD.preventDefault();},_processTemplate:function(aD){var A=this;return R.sub(aD,A.getStrings());},_setEventRecorder:function(aD){var A=this;if(aD){aD.set(M,A);aD.set(ah,A.get(ah));}},_setViews:function(aE){var A=this;var aD=[];ac.Array.each(aE,function(aF){if(t(aF)&&!aF.get(az)){aF.set(M,A);aF.set(ah,A.get(ah));aD.push(aF);A[Q][aF.get(m)]=aF;}});if(!A.get(G)){A.set(G,aE[0]);}return aD;},syncStdContent:function(){var A=this;var aD=A.get(aB);A[N].append(A[ao]);A[N].append(A[k]);A[ak].append(A[ad]);A[ak].append(A[N]);A[ak].append(A[C]);ac.Array.each(aD,function(aE){A[Y].append(A._createViewTriggerNode(aE));});A[w].append(A[ak]);A[w].append(A[Y]);A[w].addClass(ae);A.setStdModContent(X.HEADER,A[w].getDOM());},_uiSetDate:function(aG){var aD=this;var aF=aD.get(b);var A=aF.call(aD,aG);if(aD.get(az)){var aE=aD.get(G);if(aE){aE._uiSetDate(aG);aF=aE.get(b);A=aF.call(aE,aG);}aD[C].html(A);aD.syncEventsUI();}}}});ac.Scheduler=H;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(c3){var dj=c3.Lang,bn=dj.isBoolean,E=dj.isFunction,aW=dj.isNumber,dA=dj.isObject,cP=dj.isString,cA=function(A){return parseFloat(A)||0;},cD=function(dF,A){return Math.round(dF/A)*A;},aE=c3.DataType.DateMath,cY=c3.WidgetStdMod,a4=aE.WEEK_LENGTH,cG="scheduler-view",aV="scheduler-view-day",dr="scheduler-view-month",cu="scheduler-view-table",c9="scheduler-view-week",bD="activeColumn",cz="activeView",U="allDay",aD="body",bc="boundingBox",dD="cancel",be="close",at="col",aL="colDaysNode",c7="colHeaderDaysNode",O="colblank",D="coldata",aY="colday",b="colgrid",ae="colspan",q="coltime",bZ="columnData",bl="columnDayHeader",a0="columnShims",a9="columnTableGrid",bK="columnTime",a8="container",a5="content",bC="creationEndDate",ah="creationStartDate",cd="date",cy="viewDate",cf="data",dg="day",aa="days",ay="dd",aN="delegate",H="delegateConfig",cx="disabled",bi="displayDaysInterval",cT="displayRows",af="div",bW="division",du="dotted",ak="down",db="dragNode",B="dragging",L="draggingEvent",cO="duration",aQ="endDate",bv="event",dt="eventClass",cw="eventPlaceholder",dC="eventRecorder",v="eventWidth",cU="events",cq="eventsOverlay",aj="eventsOverlayNode",cX="filterFn",aX="first",da="firstDayOfWeek",cj="fixedHeight",bH="grid",cc="gridContainer",bw="grip",dB="hd",c0="header",by="headerDateFormatter",dy="headerTableNode",br="headerView",bU="headerViewConfig",a2="headerViewLabelNode",cL="height",bz="horizontal",bb="host",aT="hourHeight",x="icon",x="icon",aw="isoTime",al="label",bj="lasso",bd="left",aM="locale",o="marginRight",an="marker",bx="markercell",bp="markercellsNode",P="markers",cm="markersNode",ct="minDuration",cp="month",bF="monthContainerNode",dc="monthRowContainer",f="monthRows",b7="more",I="mousedown",S="mousemove",bh="mouseup",a6="next",dE="node",av="nomonth",aF="noscroll",cZ="offsetHeight",c1="offsetWidth",bE="overlay",c4="pad",aZ="paddingNode",dm="parentEvent",Y="parentNode",b5="proxy",bL="proxyNode",au="px",ao="region",bf="rendered",cV="repeated",cJ="resizer",cQ="resizerNode",cC="resizing",bq="right",b3="row",b2="rowsContainerNode",cF="save",u="scheduler",aS="scheduler-event",ag="scrollable",Z="shim",Q="showMore",c8="startDate",ad="startXY",cR="strings",bg="table",G="tableGridNode",cb="tableNode",cr="tableRowContainer",dq="tableRows",ca="tbody",i="td",bY="time",ar="timesNode",k="title",a="tl",ax="today",b1="top",dz="tr",b9="view",aK="visible",dl="week",ch="width",y="data-colnumber",m="a",bV=",",cB="-",cI=".",cv="",h="&mdash;",ci="%",ac=" ",J=c3.getClassName,bX=J(cG,aF),am=J(cG,ag);var bo=c3.Component.create({NAME:cG,AUGMENTS:[c3.WidgetStdMod],ATTRS:{bodyContent:{value:cv},eventClass:{valueFn:function(){return c3.SchedulerEvent;}},filterFn:{validator:E,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bn},name:{value:cv,validator:cP},navigationDateFormatter:{value:function(dF){var A=this;var dG=A.get(u);return c3.DataType.Date.format(dF,{format:"%A, %d %B, %Y",locale:dG.get(aM)});},validator:E},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bn},triggerNode:{setter:c3.one},visible:{value:false}},BIND_UI_ATTRS:[ag],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},getAdjustedViewDate:function(dF){var A=this;return dF;},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return aE.clearTime(new Date());},limitDate:function(dF,dG){var A=this;if(aE.after(dF,dG)){dF=aE.clone(dG);}return dF;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetDate:function(A){},_afterRender:function(dG){var A=this;var dF=A.get(u);A._uiSetScrollable(A.get(ag));},_setScheduler:function(dG){var A=this;var dF=A.get(u);if(dF){A.removeTarget(dF);}if(dG){A.addTarget(dG);dG.after("eventsChange",c3.bind(A.flushViewCache,A));}return dG;},_uiSetScrollable:function(dG){var A=this;var dF=A.bodyNode;if(dF){dF.toggleClass(am,dG);dF.toggleClass(bX,!dG);}}}});c3.SchedulerView=bo;var cs=dj.sub;var n=c3.cached(function(){var dH=c3.config.doc,dF=dH.createElement("div"),A=dH.getElementsByTagName("body")[0],dG=0.1;
if(A){dF.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";dF.appendChild(dH.createElement("p")).style.height="1px";A.insertBefore(dF,A.firstChild);dG=dF.offsetWidth-dF.clientWidth;A.removeChild(dF);}return dG;},null,0.1);var T=function(A,dF){return function(dH){var dG=dH.all(A);return(dG.size()>=dF)?dG:null;};},j=J(x),M=J(x,bw,du,bz),a1=J(aS),bQ=J(aS,cx),cM=J(aS,b5),X=J(u,ax),aB=J(u,ax,dB),F=J(cG,D),e=J(cG,b),dd=J(cG,bH),de=J(cG,bH,a8),a3=J(cG,dg,cJ,x),cK=J(cG,dg,cJ),bT=J(cG,an,bW),df=J(cG,bx),R=J(cG,P),ce=J(cG,dg,bg),di=J(cG,dg,c0,bg),w=J(cG,dg,c0,dg),bS=J(cG,dg,c0,dg,c4,bq),cN=J(cG,dg,c0,dg,aX),bu=J(cG,dg,c0,at),bG=J(cG,dg,c0,b9,al),dv=J(cG,dg,bg,at),aR=J(cG,dg,bg,at,Z),W=J(cG,dg,bg,O),N=J(cG,dg,bg,aY),dn=J(cG,dg,bg,q),b0=J(cG,dg,bg,bY),s='<div class="'+cK+'">'+'<div class="'+[j,M,a3].join(ac)+'"></div>'+"</div>",ap='<div class="'+df+'">'+'<div class="'+bT+'"></div>'+"</div>",r='<span class="'+bG+'">{label}</span>',aI='<table cellspacing="0" cellpadding="0" class="'+ce+'">'+"<tbody>"+'<tr class="'+e+'" height="1">'+'<td height="0" class="'+[dv,W].join(ac)+'"></td>'+'<td class="'+de+'" colspan="1">'+'<div class="'+dd+'">'+'<div class="'+R+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+F+'">'+'<td class="'+[dv,dn].join(ac)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bM='<td class="'+[dv,N].join(ac)+'" data-colnumber="{colNumber}">'+'<div class="'+aR+'"></div>'+"</td>",l='<div class="'+b0+'">{hour}</div>',aJ='<table cellspacing="0" cellpadding="0" class="'+di+'">'+"<tbody>"+'<tr class="'+bu+'"></tr>'+"</tbody>"+"</table>",bP='<th class="'+w+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aH='<td class="'+[w,cN].join(ac)+'"></td>',C='<th class="'+[w,bS].join(ac)+'">&nbsp;</th>';var dx=c3.Component.create({NAME:aV,ATTRS:{bodyContent:{value:cv},days:{value:1,validator:aW},delegateConfig:{value:{},setter:function(dF){var A=this;return c3.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(bc),nodes:cI+a1,invalid:"input, select, button, a, textarea, "+cI+bQ},dF||{});},validator:dA},eventWidth:{value:95,validator:aW},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(U));}},headerDateFormatter:{value:function(dF){var A=this;var dG=A.get(u);return c3.DataType.Date.format(dF,{format:"%a %m/%d",locale:dG.get(aM)});},validator:cP},headerView:{value:true,validator:bn},headerViewConfig:{setter:function(dF){var A=this;return c3.merge({displayDaysInterval:1,displayRows:6,filterFn:function(dG){return((dG.getHoursDuration()>24)||dG.get(U));},height:"auto",visible:true},dF||{});},value:{}},hourHeight:{value:52,validator:aW},name:{value:dg},navigationDateFormatter:{value:function(dF){var A=this;var dG=A.get(u);return c3.DataType.Date.format(dF,{format:"%A, %b %d, %Y",locale:dG.get(aM)});},validator:E},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return c3.Node.create(aJ);}},headerViewLabelNode:{valueFn:function(){var dF=this;var A=dF.get(cR);return c3.Node.create(cs(r,{label:A[U]}));}},resizerNode:{valueFn:function(){return c3.Node.create(s);}},tableNode:{valueFn:function(){return c3.Node.create(aI);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:T(cI+N,1),colHeaderDaysNode:T(cI+w,2),headerTableNode:cI+di,headerViewLabelNode:cI+bG,markercellsNode:T(cI+df,24),resizerNode:cI+cK,tableNode:cI+ce,timesNode:T(cI+b0,24)},EXTENDS:c3.SchedulerView,prototype:{initializer:function(){var A=this;A[aL]=A.get(aL);A[c7]=A.get(c7);A[dy]=A.get(dy);A[bp]=A.get(bp);A[cQ]=A.get(cQ);A[cb]=A.get(cb);A[ar]=A.get(ar);A[bD]=null;A[bZ]=A[cb].one(cI+F);A[bl]=A.headerTableNode.one(cI+bu);A[a0]=A[aL].all(cI+aR);A[bK]=A[cb].one(cI+dn);A[cc]=A[cb].one(cI+de);A[cm]=A[cb].one(cI+R);if(A.get(br)){A[br]=new c3.SchedulerTableView(A.get(bU));}},renderUI:function(){var A=this;A[bK].setContent(A[ar]);A[cm].setContent(A[bp]);A[aL].appendTo(A[bZ]);A[c7].appendTo(A[bl]);if(A[br]){A[br].set(u,A.get(u));A[br].render();}},bindUI:function(){var A=this;A[dy].delegate("click",c3.bind(A._onClickDaysHeader,A),cI+w);A[bZ].delegate("mousedown",c3.bind(A._onMouseDownTableCol,A),cI+dv);A[bZ].delegate("mouseenter",c3.bind(A._onMouseEnterEvent,A),cI+a1);A[bZ].delegate("mouseleave",c3.bind(A._onMouseLeaveEvent,A),cI+a1);A[bZ].delegate("mousemove",c3.bind(A._onMouseMoveTableCol,A),cI+N);A[bZ].delegate("mouseup",c3.bind(A._onMouseUpTableCol,A),cI+dv);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;dx.superclass.syncUI.apply(this,arguments);A[cc].attr(ae,A.get(aa));A._setupDragDrop();},syncStdContent:function(){var dF=this;dF.setStdModContent(cY.BODY,dF[cb].getDOM());var A=c3.NodeList.create(dF[dy]);if(dF[br]){A.push(dF[br].get(bc));A.push(dF.get(a2));}dF.setStdModContent(cY.HEADER,A);},calculateEventHeight:function(dG){var dF=this;var A=dF.get(aT);return Math.max(dG*(A/60),A/2);},calculateTop:function(dF){var A=this;return((dF.getHours()*60)+dF.getMinutes()+(dF.getSeconds()/60))*(A.get(aT)/60);},getNextDate:function(){var A=this;var dF=A.get(u).get(cd);return aE.add(dF,aE.DAY,1);},getPrevDate:function(){var A=this;var dF=A.get(u).get(cd);return aE.subtract(dF,aE.DAY,1);},getColumnByDate:function(dF){var A=this;return A[aL].item(A.getDateDaysOffset(dF));},getColumnShimByDate:function(dF){var A=this;return A[a0].item(A.getDateDaysOffset(dF));},getDateByColumn:function(dF){var A=this;var dG=aE.safeClearTime(A.get(u).get(cy));return aE.add(dG,aE.DAY,dF);},getDateDaysOffset:function(dF){var A=this;var dG=aE.safeClearTime(A.get(u).get(cy));return aE.getDayOffset(aE.safeClearTime(dF),dG);},getYCoordTime:function(dI){var dF=this;var A=dF.get(aT);var dJ=cA((dI/A).toFixed(2));var dH=Math.floor((dJ*100)%100*0.6);var dG=Math.floor(dJ);return[dG,dH,0];
},plotEvent:function(dG){var A=this;var dH=dG.get(dE);if(dH.size()<2){dG.addPaddingNode();}var dJ=dG.get(dE).item(0);var dF=dG.get(dE).item(1);var dI=A.getColumnShimByDate(dG.get(aQ));var dK=A.getColumnShimByDate(dG.get(c8));if(dK){dK.append(dJ);if(dG.get(aK)){dJ.show();}}else{dJ.hide();}if(dI){if(dI.compareTo(dK)||dG.isDayBoundaryEvent()){dF.hide();}else{dI.append(dF);if(dG.get(aK)){dF.show();}}}else{dF.hide();}dG.syncNodeUI();A.syncEventTopUI(dG);A.syncEventHeightUI(dG);},plotEvents:function(){var A=this;var dF=A.get(u);var dG=A.get(cX);A[a0].each(function(dK,dJ){var dH=dF.getEventsByDay(A.getDateByColumn(dJ),true);var dI=[];dK.empty();c3.Array.each(dH,function(dL){if(dG.apply(A,[dL])){A.plotEvent(dL);dI.push(dL);}});A.syncEventsIntersectionUI(dI);});if(A.get(br)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[aL].each(function(dH,dG){var dF=A.getDateByColumn(dG);dH.toggleClass(X,aE.isToday(dF));});},syncDaysHeaderUI:function(){var dF=this;var dH=dF.get(u).get(cy);var dG=dF.get(by);var A=dF.get(aM);dF[c7].all(m).each(function(dK,dJ){var dI=aE.add(dH,aE.DAY,dJ);dK.toggleClass(aB,aE.isToday(dI));dK.html(dG.call(dF,dI));});},syncEventsIntersectionUI:function(dF){var A=this;var dG=A.get(v);A.get(u).flushEvents();c3.Array.each(dF,function(dI){var dK=A.findEventIntersections(dI,dF);var dJ=dK.length;var dH=(dG/dJ);c3.Array.each(dK,function(dM,dN){var dL=dM.get(dE).item(0);var dP=dH*dN;var dO=dH*1.7;if(dN===(dJ-1)){dO=dG-dP;}dL.setStyle(ch,dO+ci);dL.setStyle(bd,dP+ci);var dQ=dL.get(Y);if(dQ){dQ.insert(dL,dN);}dM._filtered=true;});});},syncEventHeightUI:function(dH){var dF=this;var dL=dH.get(aQ);var A=dH.get(c8);var dI=aE.clone(A);dI.setHours(24,0,0);var dJ=aE.getMinutesOffset(dF.limitDate(dL,dI),A);dH.get(dE).item(0).set(cZ,dF.calculateEventHeight(dJ));var dG=dH.get(dE).item(1);if(dG.inDoc()){var dK=aE.getMinutesOffset(dL,aE.toMidnight(dH.getClearEndDate()));dG.set(cZ,dF.calculateEventHeight(dK));}},syncEventTopUI:function(dF){var A=this;dF.get(dE).item(0).setStyle(b1,A.calculateTop(dF.get(c8))+au);dF.get(dE).item(1).setStyle(b1,0);},syncHeaderViewUI:function(){var dF=this;if(dF.get(br)){var dH=dF[br];dH.plotEvents();var dI=dH.get(bc);dI.setStyle(o,n());var dG=dI.one(cI+bt);var A=Math.max(dG.get(cZ),40);dH.set(cL,A);dF._fillHeight();}},calculateYDelta:function(dG,dF){var A=this;return(dF[1]-dG[1])/(A.get(aT)/2)*30;},findEventIntersections:function(dF,dG){var A=this;var dH=[];c3.Array.each(dG,function(dI){if(!dF._filtered&&dF.intersectHours(dI)){dH.push(dI);}});return dH;},getXYDelta:function(dF){var A=this;var dG=dF.currentTarget.getXY(),dH=[dF.pageX,dF.pageY];return c3.Array.map(dG,function(dJ,dI){return(dH[dI]-dJ);});},getTickY:function(){var A=this;return cD(Math.ceil(A.get(aT)/2),10);},roundToNearestHour:function(dF,dG){var A=this;dF.setHours(dG[0],cD(dG[1],A.getTickY()),dG[2]);},_afterDragAlign:function(dG){var dF=this;var A=dG.target;if(!dF[ad]){dF[ad]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(dG){var dF=this;var dJ=dF[L];if(dJ&&!dF[cC]){var dH=dF[cw];var dI=cA(dG.attr(y))-dF.startColNumber;dF.draggingEventStartDate=aE.add(dJ.get(c8),aE.DAY,dI);var A=aE.clone(dF.draggingEventStartDate);aE.copyHours(A,dH.get(c8));dH.move(A);dF.plotEvent(dH);}},_dragTickAlignY:function(A){var dK=this;var dF=dK.get(u);var dM=dF.get(dC);var dH=dK[L];if(dH){var dL=A.target.get(bb);var dI=dK[cw];var dJ=dK.calculateYDelta(dK[ad],dL.actXY);if(dK[cC]){var dG=aE.add(dK.draggingEventEndDate,aE.MINUTES,dJ);if(aE.getMinutesOffset(dG,dK.draggingEventStartDate)<dM.get(ct)){return;}dI.set(aQ,dG);}else{dI.move(aE.add(dK.draggingEventStartDate,aE.MINUTES,dJ));}dK.plotEvent(dI);}},_setupDragDrop:function(){var dF=this;if(!dF[cw]){var dG=dF.get(u);dF[cw]=new (dF.get(dt))({scheduler:dG});dF[cw].removeTarget(dG);dF[cw].get(dE).addClass(cM).hide();}if(!dF.delegate){dF.delegate=new c3.DD.Delegate(dF.get(H));}var A=dF.delegate.dd;A.unplug(c3.Plugin.DDConstrained);A.unplug(c3.Plugin.DDNodeScroll);var dH=dF.bodyNode.get(ao);dH.bottom=Infinity;dH.top=-Infinity;A.plug(c3.Plugin.DDConstrained,{bubbleTargets:dF,constrain:dH,stickY:true,tickY:dF.get(aT)/2});A.plug(c3.Plugin.DDNodeScroll,{node:dF.bodyNode,scrollDelay:150});},_uiSetDate:function(dF){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(dH){var A=this;var dG=A.get(u);if(dH.target.test(m)){var dI=dG.getViewByName(dg);if(dI){var dF=cA(dH.currentTarget.attr(y));dG.set(cy,A.getDateByColumn(dF));dG.set(cz,dI);}}dH.preventDefault();},_onEventDragEnd:function(dF){var A=this;var dH=A[L];if(dH){var dG=A[cw];dG.set(aK,false);dH.set(aK,true);dH.copyDates(dG);A.get(u).syncEventsUI();}A[ad]=null;A[L]=null;},_onEventDragStart:function(dG){var A=this;var dI=A[L]=A.delegate.dd.get(dE).getData(aS);if(dI){var dH=A[cw];dH.copyPropagateAttrValues(dI);A.plotEvent(dH);dI.set(aK,false);A.draggingEventStartDate=aE.clone(dI.get(c8));A.draggingEventEndDate=aE.clone(dI.get(aQ));var dF=A.getColumnByDate(dI.get(c8));A.startColNumber=dF?cA(dF.attr(y)):0;}},_onMouseDownTableCol:function(dF){var dK=this;var dJ=dF.target;var dH=dK.get(u);var dL=dH.get(dC);if(dL&&!dH.get(cx)){dL.hideOverlay();if(dJ.test(cI+aR)){dK[ad]=[dF.pageX,dF.pageY];var dM=cA(dF.currentTarget.attr(y));var dG=dK.getDateByColumn(dM);var A=dK.getXYDelta(dF);dK.roundToNearestHour(dG,dK.getYCoordTime(A[1]));var dI=aE.add(dG,aE.MINUTES,dL.get(cO));dL.move(dG);dL.set(U,false);dL.set(aQ,dI);dK[ah]=dG;dK[bC]=dI;dF.halt();}else{if(dJ.test([cI+cK,cI+a3].join(bV))){dK[cC]=true;}}}dK.get(bc).unselectable();},_onMouseEnterEvent:function(dG){var A=this;var dH=dG.currentTarget;var dF=dH.getData(aS);if(dF&&!dF.get(cx)){A[cQ].appendTo(dH);}},_onMouseLeaveEvent:function(dF){var A=this;if(!A[cC]){A._removeResizer();}},_onMouseMoveTableCol:function(dI){var A=this;var dH=dI.currentTarget;var dF=A.get(u).get(dC);if(A[bD]!==dH){A[bD]=dH;A._dragTickAlignX(A[bD]);}var dG=A[bC];var dJ=A[ah];if(dJ){var dK=cD(A.calculateYDelta(A[ad],[dI.pageX,dI.pageY]),A.getTickY());if(A._delta!==dK){if(dK>0){dF.set(aQ,aE.add(dG,aE.MINUTES,dK));
}else{dF.set(c8,aE.add(dJ,aE.MINUTES,dK));}A.plotEvent(dF);A._delta=dK;}}},_onMouseUpTableCol:function(dH){var A=this;var dG=A.get(u);var dF=dG.get(dC);if(dF&&!dG.get(cx)){if(A[ah]){A.plotEvent(dF);dF.showOverlay([dH.pageX,dH.pageY]);}}A[ah]=null;A[bC]=null;A[cC]=false;A[ad]=null;A._removeResizer();A.get(bc).selectable();},_onSchedulerChange:function(dF){var A=this;if(A[br]){A[br].set(u,dF.newVal);}},_removeResizer:function(){var A=this;A[cQ].remove();},_valueColDaysNode:function(){var A=this;var dH=A.get(aa);var dF=[],dG=0;while(dH--){dF.push(c3.Lang.sub(bM,{colNumber:dG++}));}return c3.NodeList.create(dF.join(cv));},_valueColHeaderDaysNode:function(){var A=this;var dH=A.get(aa);var dF=[],dG=0;dF.push(aH);while(dH--){dF.push(c3.Lang.sub(bP,{colNumber:dG++}));}dF.push(C);return c3.NodeList.create(dF.join(cv));},_valueMarkercellsNode:function(){var A=this;var dF=[],dG;for(dG=0;dG<=23;dG++){dF.push(ap);}return c3.NodeList.create(dF.join(cv));},_valueTimesNode:function(){var A=this;var dH=A.get(aw);var dG=[],dF;for(dF=0;dF<=23;dF++){dG.push(cs(l,{hour:dH?aE.toIsoTimeString(dF):aE.toUsTimeString(dF,false,true)}));}return c3.NodeList.create(dG.join(cv));}}});c3.SchedulerDayView=dx;var aA=c3.Component.create({NAME:c9,ATTRS:{bodyContent:{value:cv},days:{value:7},headerViewConfig:{value:{displayDaysInterval:a4}},name:{value:dl},navigationDateFormatter:{valueFn:function(){return this._valueNavigationDateFormatter;},validator:E}},EXTENDS:c3.SchedulerDayView,prototype:{getAdjustedViewDate:function(dH){var A=this;var dG=A.get(u);var dF=dG.get(da);return aE.getFirstDayOfWeek(dH,dF);},getNextDate:function(){var A=this;var dG=A.get(u);var dF=dG.get(cd);var dH=A._firstDayOfWeek(dF);return aE.add(dH,aE.WEEK,1);},getPrevDate:function(){var A=this;var dG=A.get(u);var dF=dG.get(cd);var dH=A._firstDayOfWeek(dF);return aE.subtract(dH,aE.WEEK,1);},getToday:function(){var A=this;var dF=aA.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(dF);},_firstDayOfWeek:function(dG){var A=this;var dH=A.get(u);var dF=dH.get(da);return aE.getFirstDayOfWeek(dG,dF);},_valueNavigationDateFormatter:function(dH){var dG=this;var dI=dG.get(u);var dF=dI.get(aM);var A=dG._firstDayOfWeek(dH);var dJ=c3.DataType.Date.format(A,{format:"%b %d",locale:dF});var dL=aE.add(A,aE.DAY,dG.get(aa)-1);var dK=c3.DataType.Date.format(dL,{format:(aE.isMonthOverlapWeek(dH)?"%b %d":"%d")+", %Y",locale:dF});return[dJ,h,dK].join(ac);}}});c3.SchedulerWeekView=aA;var j=J(x),p=J(x,"arrowstop-1-l"),dp=J(x,"arrowstop-1-r"),t=J(cG,bg,b),a7=J(cG,bg,b,aX),aG=J(cG,bg,b,ax),bN=J(cG,bg,a8),dw=J(cG,bg,cU,bE,dE),az=J(cG,bg,cU,bE,dE,aD),cl=J(cG,bg,cU,bE,dE,be),aC=J(cG,bg,c0,at),dk=J(cG,bg,c0,dg),d=J(cG,bg,c0,bg),co=J(cG,bg,b7),c2=J(cG,bg,b3),cg=J(cG,bg,b3,a8),bt=J(cG,bg,cf),cW=J(cG,bg,cf,at),b8=J(cG,bg,cf,at,k),cS=J(cG,bg,cf,at,k,ak),ck=J(cG,bg,cf,at,k,aX),ds=J(cG,bg,cf,at,k,a6),bR=J(cG,bg,cf,at,k,ax),aO=J(cG,bg,cf,bv),c=J(cG,bg,cf,bv,bd),c5=J(cG,bg,cf,bv,cV),aq=J(cG,bg,cf,bv,bq),ai=J(cG,bg,cf,aX),aU=J(cG,bg,bH),cn=J(cG,bg,bH,aX),ba='<div class="'+bN+'">'+'<div class="'+cg+'"></div>'+"</div>",b6='<div class="'+dw+'">'+'<div class="'+az+'"></div>'+'<a href="javascript:;" class="'+cl+'">{label}</a>'+"</div>",cH='<td class="'+t+'">&nbsp;</td>',g='<th class="'+dk+'"><div>&nbsp;</div></th>',ab='<table cellspacing="0" cellpadding="0" class="'+d+'">'+"<tbody>"+'<tr class="'+aC+'"></tr>'+"</tbody>"+"</table>",bB='<a href="javascript:;" class="'+co+'">{label} {count}</a>',bJ='<div class="'+c2+'" style="top: {top}%; height: {height}%;"></div>',bO='<table cellspacing="0" cellpadding="0" class="'+bt+'">'+"<tbody></tbody>"+"</table>",bk='<table cellspacing="0" cellpadding="0" class="'+aU+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",V='<span class="'+[j,p].join(ac)+'"></span>',bA='<span class="'+[j,dp].join(ac)+'"></span>',bI='<td class="'+cW+'"><div></div></td>',dh="<tr></tr>";var bm=c3.Component.create({NAME:cu,ATTRS:{bodyContent:{value:cv},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:bg},headerDateFormatter:{value:function(dF){var A=this;var dG=A.get(u);return c3.DataType.Date.format(dF,{format:"%a",locale:dG.get(aM)});},validator:cP},navigationDateFormatter:{value:function(dF){var A=this;var dG=A.get(u);return c3.DataType.Date.format(dF,{format:"%b %Y",locale:dG.get(aM)});},validator:E},scrollable:{value:false},strings:{value:{close:"Close",showMore:"Show more"}},headerTableNode:{valueFn:function(){return c3.Node.create(ab);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return c3.Node.create(ba);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:T(cI+dk,7),headerTableNode:cI+d,rowsContainerNode:cI+bN,tableGridNode:T(cI+aU,7)},EXTENDS:c3.SchedulerView,prototype:{evtDateStack:null,evtRenderedStack:null,rowDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};A[c7]=A.get(c7);A[dy]=A.get(dy);A[b2]=A.get(b2);A[G]=A.get(G);A[bl]=A.headerTableNode.one(cI+aC);A[a9]=c3.NodeList.create();A[cr]=A[b2].one(cI+cg);A[dq]=c3.NodeList.create();},bindUI:function(){var A=this;A[b2].delegate("click",c3.bind(A._onClickMore,A),cI+co);},renderUI:function(){var A=this;var dF=A._getDisplayRowsCount();for(var dG=0;dG<dF;dG++){A[dq].push(A.buildGridRowNode(dG));}A._renderEventsOverlay();A[c7].appendTo(A[bl]);A[dq].appendTo(A[cr]);},buildEventsRow:function(dG,dL,dK){var dF=this;var dH=dF.get(cT);var A=dF._getDisplayRowDaysCount();var dJ=0;var dI=c3.Node.create(dh);dF.loopDates(dG,dL,function(dU,dQ){if(dJ>dQ){return;}var dV=dF.getIntersectEvents(dU);var dS=dF._getRenderableEvent(dV,dG,dL,dU);var dO=c3.Node.create(bI);var dN=dO.one(af);if((dH<dV.length)&&(dK===(dH-1))){var dT=dF.get(cR);var dP=c3.Node.create(dj.sub(bB,{count:(dV.length-(dH-1)),label:dT[Q]}));dP.setData(cU,dV);dN.append(dP);}else{if(dS){var dM=dF._getEvtSplitInfo(dS,dU,dG,dL);dO.attr(ae,dM.colspan);dJ+=(dM.colspan-1);dF._syncEventNodeContainerUI(dS,dN,dM);
dF._syncEventNodeUI(dS,dN,dU);var dR=String(dU.getTime());dF.evtRenderedStack[dR].push(dS);}}dJ++;dI.append(dO);});return dI;},buildEventsTable:function(A,dI){var dO=this;var dM=dO.get(cT);var dL=aE.clearTime(dO._findCurrentIntervalStart());var dK=String(dL.getTime()).concat(A.getTime()).concat(dI.getTime());var dN=dO.rowDataTableStack[dK];if(!dN){dN=c3.Node.create(bO);var dH=dN.one(ca);var dG=dO.buildEventsTitleRow(dN,A,dI);dH.append(dG);for(var dJ=0;dJ<dM;dJ++){var dF=dO.buildEventsRow(A,dI,dJ);dH.append(dF);}dO.rowDataTableStack[dK]=dN;}return dN;},buildEventsTitleRow:function(dG,dF,dI){var A=this;var dH=c3.Node.create(dh);A.loopDates(dF,dI,function(dK,dJ){var dL=c3.Node.create(bI);dL.addClass(b8).toggleClass(ck,(dJ===0)).toggleClass(bR,aE.isToday(dK)).toggleClass(ds,aE.isToday(aE.subtract(dK,aE.DAY,1))).toggleClass(cS,aE.isToday(aE.subtract(dK,aE.WEEK,1)));dH.append(dL.setContent(dK.getDate()));});return dH;},buildGridRowNode:function(dJ){var dG=this;var dH=dG._getDisplayRowsCount();var dF=100/dH;var A=dG._getTableGridNode(dJ);var dI=c3.Node.create(dj.sub(bJ,{height:dF,top:dF*dJ}));dI.append(A.toggleClass(cn,(dJ===0)));return dI;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};},getIntersectEvents:function(dF){var A=this;var dI=A.get(u);var dH=String(dF.getTime());if(!A.evtDateStack[dH]){var dG=dI.getIntersectEvents(dF);A.evtDateStack[dH]=dG.filter(A.get(cX));}return A.evtDateStack[dH];},getNextDate:function(){var A=this;var dG=A.get(u);var dH=dG.get(cy);var dF=A.get(bi);return aE.add(dH,aE.DAY,dF);},getPrevDate:function(){var A=this;var dG=A.get(u);var dH=dG.get(cy);var dF=A.get(bi);return aE.subtract(dH,aE.DAY,dF);},hideEventsOverlay:function(){var A=this;A[cq].set(aK,false);},loopDates:function(A,dH,dK,dL,dJ){var dM=this;var dF=aE.clone(A);var dG=dH.getTime();var dI;for(dI=0;dF.getTime()<=dG;dI++){dK.apply(dM,[dF,dI]);dF=aE.add(dF,(dL||aE.DAY),(dJ||1));}},plotEvents:function(){var dF=this;var dI=dF._findCurrentIntervalStart();var A=aE.safeClearTime(dI);dF.flushViewCache();dF.hideEventsOverlay();dF.bodyNode.all(cI+bt).remove();var dG=dF.get(bi);var dH=Math.min(dG,a4);dF[dq].each(function(dM,dK){var dJ=aE.add(A,aE.DAY,dH*dK);var dN=aE.add(dJ,aE.DAY,dH-1);var dL=dF.buildEventsTable(dJ,dN);if(dK===0){dL.addClass(ai);}dM.append(dL);});},syncDaysHeaderUI:function(){var dF=this;var dI=dF.get(u);var dJ=dI.get(cy);var dH=dF.get(by);var A=dF.get(aM);var dG=dF._findFirstDayOfWeek(dJ);dF.colHeaderDaysNode.all(af).each(function(dM,dL){var dK=aE.add(dG,aE.DAY,dL);dM.html(dH.call(dF,dK));});},syncGridUI:function(){var dO=this;var dI=dO.getToday();var dF=dO.get(u);dO[a9].removeClass(aG);var dH=dO._findCurrentIntervalStart();var dK=dO._findCurrentIntervalEnd();if(aE.between(dI,dH,dK)){var A=dF.get(da);var dM=dO._findFirstDayOfWeek(dI);var dJ=aE.getWeekNumber(dI,A)-aE.getWeekNumber(dH,A);var dN=(dI.getDate()-dM.getDate());var dG=dO._getCellIndex([dN,dJ]);var dL=dO[a9].item(dG);if(dL){dL.addClass(aG);}}},syncStdContent:function(){var A=this;A.setStdModContent(cY.BODY,A[b2].getDOM());A.setStdModContent(cY.HEADER,A[dy].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var dG=A.get(u);var dH=dG.get(cy);var dF=A.get(bi);return aE.add(dH,aE.DAY,dF);},_findCurrentIntervalStart:function(){var A=this;var dF=A.get(u);return dF.get(cy);},_findFirstDayOfWeek:function(dG){var A=this;var dH=A.get(u);var dF=dH.get(da);return aE.getFirstDayOfWeek(dG,dF);},_getDisplayRowsCount:function(){var A=this;var dF=A.get(bi);return Math.ceil(dF/a4);},_getDisplayRowDaysCount:function(){var A=this;var dF=A.get(bi);return Math.min(dF,a4);},_getEvtLabel:function(dG){var dF=this;var dH=dG.get(aQ);var A=dG.get(c8);return[A.getHours(),cB,dH.getHours(),ac,dG.get(a5)].join(cv);},_getEvtSplitInfo:function(dJ,dM,A,dH){var dK=this;var dF=dJ.getClearStartDate();var dI=dJ.getClearEndDate();var dL=aE.getDayOffset(dH,dM);var dG={colspan:Math.min(aE.getDayOffset(dI,dM),dL)+1,left:aE.before(dF,A),right:aE.after(dI,dH)};return dG;},_getRenderableEvent:function(dN,A,dH,dO){var dM=this;var dK=String(dO.getTime());if(!dM.evtRenderedStack[dK]){dM.evtRenderedStack[dK]=[];}for(var dG=0;dG<dN.length;dG++){var dL=dN[dG];var dF=dL.get(c8);var dJ=aE.after(dO,dF)&&!aE.isDayOverlap(dO,A);var dI=!aE.isDayOverlap(dF,dO);var dP=c3.Array.indexOf(dM.evtRenderedStack[dK],dL)>-1;if(!dP&&(dI||dJ)){return dL;}}return null;},_getTableGridNode:function(dK){var dF=this;var dH=dF.get(bi);var A=dF[G].item(dK);var dJ=A.one(dz);for(var dG=0;dG<Math.min(dH,a4);dG++){var dI=c3.Node.create(cH);dJ.append(dI);dF[a9].push(dI);}return A;},_onClickMore:function(dG){var A=this;var dH=dG.target;var dF=dH.getData(cU);var dI=c3.NodeList.create();c3.Array.each(dF,function(dK){var dJ=dK.get(dE).item(0).clone();dJ.setData(aS,dK);dJ.setStyles({height:"auto",left:0,position:"relative",top:0,width:"auto"});dI.push(dJ);});A[cq].bodyNode.one(cI+az).setContent(dI);A[cq].setAttrs({visible:true,xy:dH.getXY()});},_renderEventsOverlay:function(){var dF=this;var A=dF.get(cR);dF[cq]=new c3.Overlay({align:{points:[a,a]},bodyContent:dj.sub(b6,{label:A[be]}),render:dF[b2],visible:false,width:250,zIndex:450});dF[cq].bodyNode.delegate("click",c3.bind(dF.hideEventsOverlay,dF),cI+cl);},_syncEventNodeContainerUI:function(dF,dH,dG){var A=this;dH.addClass(aO);if(dG.left){dH.addClass(c).prepend(V);}if(dG.right){dH.addClass(aq).append(bA);}if(dF.get(dm)){dH.addClass(c5);}},_syncEventNodeUI:function(dN,dF,dP){var dO=this;var dI=dO.get(u);var A=dI.get(da);var dH=dN.get(dE);var dG=dN.get(c8);var dM=aE.clearTime(dO._findCurrentIntervalStart());var dJ=aE.getFirstDayOfWeek(new Date(Math.max(dG,dM)),A);var dL=Math.floor(aE.getDayOffset(dP,dJ)/a4);if(dH.size()<=dL){dN.addPaddingNode();}var dK=dH.item(dL);dK.setStyles({height:"auto",left:0,top:0,width:"auto"});dK.appendTo(dF);dN.syncNodeUI();},_uiSetDate:function(dF){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var dF=A.get(bi);var dG=Math.min(dF,a4);return A._valueNodeList(dG,g);
},_valueTableGridNode:function(){var A=this;var dF=A.get(bi);var dG=Math.min(dF,a4);return A._valueNodeList(dG,bk);},_valueNodeList:function(dH,dG){var A=this;var dF=[];while(dH--){dF.push(dG);}return c3.NodeList.create(dF.join(cv));}}});c3.SchedulerTableView=bm;var bs=J(dr,bg,cf,at,av);var aP=c3.Component.create({NAME:dr,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:cp},navigationDateFormatter:{value:function(dF){var A=this;var dG=A.get(u);return c3.DataType.Date.format(dF,{format:"%B %Y",locale:dG.get(aM)});},validator:E}},EXTENDS:c3.SchedulerTableView,prototype:{getAdjustedViewDate:function(dF){var A=this;return aE.findMonthStart(dF);},getNextDate:function(){var A=this;var dG=A.get(u);var dF=dG.get(cd);return aE.add(dF,aE.MONTH,1);},getPrevDate:function(){var A=this;var dG=A.get(u);var dF=dG.get(cd);return aE.subtract(dF,aE.MONTH,1);},plotEvents:function(){var A=this;c3.SchedulerMonthView.superclass.plotEvents.apply(A,arguments);var dF=A.get(u);var dJ=dF.get(cy);var dI=aE.findMonthEnd(dJ);var dH=aE.findMonthStart(dJ);var dG=A._findCurrentIntervalStart();var dK=A[cr].all(cI+b8);dK.each(function(dN,dL){var dM=aE.add(dG,aE.DAY,dL);if(aE.before(dM,dH)||aE.after(dM,dI)){dN.addClass(bs);}});},_findCurrentIntervalStart:function(){var A=this;var dF=A.get(u);var dG=dF.get(cy);return A._findFirstDayOfWeek(dG);},_findFirstDayOfWeek:function(dG){var A=this;var dH=A.get(u);var dF=dH.get(da);return aE.getFirstDayOfWeek(dG,dF);}}});c3.SchedulerMonthView=aP;var z=J(cG,bg,B),K=J(cG,bg,bj),cE=J(cG,bg,b5,dE),b4='<div class="'+K+'"></div>',c6='<div class="'+cE+'"></div>';c3.SchedulerTableViewDD=function(){};c3.SchedulerTableViewDD.ATTRS={delegateConfig:{value:{},setter:function(dF){var A=this;return c3.merge({dragConfig:{offsetNode:false,useShim:false},bubbleTargets:A,container:A.get(bc),nodes:cI+a1,invalid:"input, select, button, a, textarea, "+cI+bQ},dF||{});},validator:dA}};c3.mix(c3.SchedulerTableViewDD.prototype,{initializer:function(){var A=this;A[bL]=c3.Node.create(c6);A.after(A.viewDDBindUI,A,"bindUI");A.after(A.viewDDRenderUI,A,"renderUI");A.after(A.viewDDSyncUI,A,"syncUI");},viewDDBindUI:function(){var A=this;var dF=A.get(u).get(dC);if(dF){dF.on({cancel:c3.bind(A.removeLasso,A),save:c3.bind(A.removeLasso,A)});}A[b2].on({mousedown:c3.bind(A._onMouseDownGrid,A),mousemove:c3.bind(A._onMouseMoveGrid,A),mouseup:c3.bind(A._onMouseUpGrid,A)});A.after("drag:align",A._afterDragAlign);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);},viewDDRenderUI:function(){var A=this;},viewDDSyncUI:function(){var A=this;A._setupDragDrop();},removeLasso:function(){var A=this;if(A[bj]){A[bj].remove();}},removeProxy:function(){var A=this;if(A[bL]){A[bL].remove();}},renderLasso:function(dL,dF){var dR=this;var dI=dL;var dK=dF;if(dL[1]>dF[1]){dI=dF;dK=dL;}var dS=dI[0],dN=dI[1],dG=dK[0],A=dK[1];dR.removeLasso();dR.lasso=c3.NodeList.create();for(var dH=dN;dH<=A;dH++){var dJ=dR.gridCellHeight,dQ=dR.gridCellWidth,dO=0,dM=(dJ*dH);if(dH===dN){if(dN===A){dO+=Math.min(dS,dG)*dQ;dQ*=Math.abs(dG-dS)+1;}else{dO+=dS*dQ;dQ*=a4-dS;}}else{if(dH===A){dQ*=dG+1;}else{dQ*=a4;}}var dP=c3.Node.create(b4);dR.lasso.push(dP);dR[b2].append(dP);dP.sizeTo(dQ,dJ);dP.setXY(dR._offsetXY([dO,dM],1));}},_afterDragAlign:function(A){var dL=this;var dM=A.target;var dI=dL.bodyNode.get(ao);var dJ={bottom:A.pageY,left:A.pageX,right:A.pageX,top:A.pageY};if(!c3.DOM.inRegion(null,dI,true,dJ)){return;}var dK=dL[L];var dF=[A.pageX,A.pageY];var dH=dL._findPosition(dL._offsetXY(dF,-1));if(dK&&dL._hasLassoChanged(dH)){dL.lassoLastPosition=dH;var dG=aE.add(dL._getPositionDate(dH),aE.MINUTES,dK.getMinutesDuration());dL.renderLasso(dH,dL._getDatePosition(dG));}},_findPosition:function(dH){var A=this;var dG=Math.floor(dH[0]/A.gridCellWidth);var dF=Math.floor(dH[1]/A.gridCellHeight);return[dG,dF];},_getCellIndex:function(dF){var A=this;return dF[1]*a4+dF[0];},_getDatePosition:function(dG){var dF=this;var dH=dF._findCurrentIntervalStart();var dI=aE.getDayOffset(dG,dH);var A=[];A[1]=Math.floor(dI/a4);A[0]=dI%a4;return A;},_getPositionDate:function(dG){var dF=this;var dI=dF._findCurrentIntervalStart();var A=aE.safeClearTime(dF._findFirstDayOfWeek(dI));var dH=aE.add(A,aE.DAY,dF._getCellIndex(dG));dH.setHours(0,0,0,0);return dH;},_hasLassoChanged:function(dF){var A=this;var dG=A.lassoLastPosition||A.lassoStartPosition;return dG&&((dF[0]!==dG[0])||(dF[1]!==dG[1]));},_offsetXY:function(dH,dG){var A=this;var dF=A[b2].getXY();return[dH[0]+dF[0]*dG,dH[1]+dF[1]*dG];},_onEventDragEnd:function(dF){var A=this;var dG=A[L];if(dG){dG.move(A._getPositionDate(A.lassoLastPosition));dG.set(aK,true);A[b2].removeClass(z).unselectable();dF.target.set(db,A.originalDragNode);A.removeLasso();A.removeProxy();A.get(u).syncEventsUI();}A[L]=null;},_onEventDragStart:function(dI){var A=this;var dJ=A[L]=A[aN][ay].get(dE).getData(aS);if(dJ){A._syncCellDimensions();var dG=[dI.pageX,dI.pageY];var dH=A._findPosition(A._offsetXY(dG,-1));var dF=aE.add(A._getPositionDate(dH),aE.MINUTES,dJ.getMinutesDuration());A.renderLasso(dH,A._getDatePosition(dF));dJ.set(aK,false);A._syncProxyNodeUI(dJ);A.lassoStartPosition=A.lassoLastPosition=dH;A[b2].addClass(z).unselectable();A.originalDragNode=dI.target.get(db);dI.target.set(db,A[bL]);}},_onMouseDownGrid:function(dI){var A=this;var dH=A.get(u);var dG=dH.get(dC);var dJ=dI.target;if(dG&&dJ.test([cI+t,cI+cW].join(bV))){A._recording=true;A._syncCellDimensions();var dF=A._offsetXY([dI.pageX,dI.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(dF);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[b2].unselectable();}},_onMouseMoveGrid:function(dH){var dF=this;var dI=dH.currentTarget;var dG=[dH.pageX,dH.pageY];var A=dF._findPosition(dF._offsetXY(dG,-1));if(dF._recording&&dF._hasLassoChanged(A)){dF.lassoLastPosition=A;dF.renderLasso(dF.lassoStartPosition,A);}},_onMouseUpGrid:function(dK){var dF=this;var dJ=dF.get(u);var dH=dJ.get(dC);if(dH&&dF._recording&&!dJ.get(cx)){var dI=dF._getPositionDate(dF.lassoStartPosition);
var dG=dF._getPositionDate(dF.lassoLastPosition);var A=new Date(Math.min(dI,dG));A.setHours(0,0,0);var dL=new Date(Math.max(dI,dG));dL.setHours(23,59,59);dH.set(U,true);dH.set(aQ,dL);dH.set(c8,A);dH.showOverlay([dK.pageX,dK.pageY]);dF._recording=false;}},_setupDragDrop:function(){var dF=this;if(!dF[aN]){dF[aN]=new c3.DD.Delegate(dF.get(H));}var A=dF[aN][ay];A.unplug(c3.Plugin.DDConstrained);A.unplug(c3.Plugin.DDNodeScroll);A.unplug(c3.Plugin.DDProxy);A.plug(c3.Plugin.DDConstrained,{bubbleTargets:dF,constrain:dF.bodyNode});A.plug(c3.Plugin.DDNodeScroll,{node:dF.bodyNode,scrollDelay:150});A.plug(c3.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false});},_syncCellDimensions:function(){var A=this;var dG=A.get(bi);var dF=Math.ceil(dG/a4);var dH=Math.min(dG,a4);A.gridCellHeight=A[b2].get(cZ)/dF;A.gridCellWidth=A[b2].get(c1)/dH;},_syncProxyNodeUI:function(dF){var A=this;var dG=dF.get(dE).item(0);A[bL].setStyles({backgroundColor:dG.getStyle("backgroundColor"),display:"block",width:"200px"});A[bL].appendTo(A[b2]);A[bL].setContent(dF.get(a5));}});c3.Base.mix(c3.SchedulerTableView,[c3.SchedulerTableViewDD]);},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-datatype","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aK){var an=aK.Lang,bj=an.isString,f=an.isDate,a9=an.isFunction,G=an.isObject,bc=an.isBoolean,ac=an.isNumber,aY=aK.ColorUtil,j=aK.DataType.DateMath,a5=aK.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),be="-",t="&ndash;",ay=".",p="",q=" ",l="_",aM="_propagateSet",Q="activeView",T="borderColor",aO="borderColorRGB",aI="borderStyle",bq="borderWidth",I="Change",a3="color",aW="colorBrightnessFactor",bd="colorSaturationFactor",aG="content",w="disabled",a0="duration",aP="endDate",aS="eventClass",aq="eventStack",bk="events",au="hidden",H="hsbColor",at="icon",aa="icons",a1="id",ai="inherit",aX="isoTime",bp="locale",aZ="never",n="node",h="overlay",aL="parentEvent",bv="recorder",aN="repeat",bi="repeated",P="repeatedEvents",bb="repeater",af="scheduler",av="scheduler-event",ax="scheduler-event-recorder",bm="startDate",a7="template",aV="title",e="titleDateFormat",ao="visible",d="%H:%M",a6="%I:%M",E=aK.getClassName,k=E(at),s=E(av),aQ=E(av,aG),C=E(av,au),bg=E(av,w),ap=E(av,bv),aB=E(av,bi),am=E(av,bb),D=E(av,aV),bo=E(av,aa),v=E(av,at,w),b=E(av,at,bi),bs=E(av,at,bb);var V=aK.Component.create({NAME:av,ATTRS:{allDay:{setter:aK.DataType.Boolean.parse,value:false},borderStyle:{value:"solid",validator:bj},borderWidth:{value:"1px",validator:bj},colorBrightnessFactor:{value:0.75,validator:ac},colorSaturationFactor:{value:1.5,validator:ac},content:{value:"(no title)",validator:bj},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bj},titleDateFormat:{getter:"_getTitleDateFormat",validator:bj},endDate:{setter:"_setDate",valueFn:function(){var A=j.clone(this.get(bm));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aK.SchedulerEvent;}},disabled:{value:false,validator:bc},node:{valueFn:function(){return aK.NodeList.create(aK.Node.create(this.EVENT_NODE_TEMPLATE).setData(av,this));}},parentEvent:{},repeat:{value:p,setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bc}},EXTENDS:aK.Base,PROPAGATE_ATTRS:[bm,aP,aG,a3,aW,bd,aI,bq,e,ao,w],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+s+'">'+'<div class="'+D+'"></div>'+'<div class="'+aQ+'"></div>'+'<div class="'+bo+'">'+'<span class="'+[k,b].join(q)+'"></span>'+'<span class="'+[k,bs].join(q)+'"></span>'+'<span class="'+[k,v].join(q)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var L=A.get(n);A[aq]={};aK.Array.each(A.get(aS).PROPAGATE_ATTRS,function(X){A.after(X+I,A._propagateAttrChange);});A._bindUIAttrs();A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(L,X){L.destroy();});A[aq]={};A.get(n).remove(true);},addPaddingNode:function(){var A=this;A.get(n).push(aK.Node.create(A.EVENT_NODE_TEMPLATE).setData(av,A));A.syncNodeUI();},copyDates:function(L){var A=this;A.set(aP,j.clone(L.get(aP)));A.set(bm,j.clone(L.get(bm)));},copyPropagateAttrValues:function(L,X){var A=this;A.copyDates(L);aK.Array.each(A.get(aS).PROPAGATE_ATTRS,function(Y){if(!((X||{}).hasOwnProperty(Y))){var bA=L.get(Y);if(!G(bA)){A.set(Y,bA);}}});},getBorderColor:function(){var A=this;return A[aO].hex;},getDaysDuration:function(){var A=this;return j.getDayOffset(A.get(aP),A.get(bm));},getHoursDuration:function(){var A=this;return j.getHoursOffset(A.get(aP),A.get(bm));},getMinutesDuration:function(){var A=this;return j.getMinutesOffset(A.get(aP),A.get(bm));},getSecondsDuration:function(){var A=this;return j.getSecondsOffset(A.get(aP),A.get(bm));},sameEndDate:function(L){var A=this;return j.compare(A.get(aP),L.get(aP));},sameStartDate:function(L){var A=this;return j.compare(A.get(bm),L.get(bm));},isAfter:function(Y){var X=this;var L=X.get(bm);var A=Y.get(bm);return j.after(L,A);},isBefore:function(Y){var X=this;var L=X.get(bm);var A=Y.get(bm);return j.before(L,A);},repeatByDate:function(X){var L=this;var Y=L.uidByDate(X);if(!L[aq][Y]){var A=j.clone(X);var bB=j.clone(X);j.copyHours(A,L.get(bm));j.copyHours(bB,L.get(aP));var bA=new L.get(aS)({endDate:bB,parentEvent:L,scheduler:L.get(af),startDate:A});bA.copyPropagateAttrValues(L);L[aq][Y]=bA;}return L[aq][Y];},intersects:function(Y){var X=this;var bA=X.get(aP);var L=X.get(bm);var A=Y.get(bm);return(X.sameStartDate(Y)||j.between(A,L,bA));},intersectHours:function(X){var L=this;var bA=L.get(aP);var A=L.get(bm);var Y=j.clone(A);j.copyHours(Y,X.get(bm));return(j.compare(A,Y)||j.between(Y,A,bA));},isDayBoundaryEvent:function(){var A=this;return j.isDayBoundary(A.get(bm),A.get(aP));},isDayOverlapEvent:function(){var A=this;return j.isDayOverlap(A.get(bm),A.get(aP));},isRepeatableDate:function(L){var A=this;var X=A.get(aN);return(X&&X.validate(A,L));},getClearEndDate:function(){var A=this;
return j.safeClearTime(A.get(aP));},getClearStartDate:function(){var A=this;return j.safeClearTime(A.get(bm));},move:function(L){var A=this;var X=A.getMinutesDuration();A.set(bm,L);A.set(aP,j.add(j.clone(L),j.MINUTES,X));},uidByDate:function(L){var A=this;L=f(L)?j.safeClearTime(L):A.getClearStartDate();return[av,L.getTime()].join(l);},setContent:function(X,L){var A=this;A.get(n).each(function(bA){var Y=bA.one(g+aQ);Y.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bA){Y.setContent(X);});}},setTitle:function(X,L){var A=this;A.get(n).each(function(Y){var bA=Y.one(g+D);bA.setContent(X);});if(L){A.eachRepeatedEvent(function(Y,bA){Y.setTitle(X);});}},syncNodeUI:function(L){var A=this;A._syncUIAttrs();A.syncNodeColorUI(L);A.syncNodeTitleUI(L);A.syncNodeContentUI(L);},syncNodeColorUI:function(L){var A=this;var Y=A.get(n);var bA=A.getBorderColor();if(Y){var X={borderWidth:A.get(bq),borderColor:bA,backgroundColor:A.get(a3),borderStyle:A.get(aI),color:ai};Y.setStyles(X);}if(L){A.eachRepeatedEvent(function(bB,bC){bB.syncNodeColorUI();});}},syncNodeContentUI:function(L){var A=this;A.setContent(A.get(aG),L);},syncNodeTitleUI:function(L){var A=this;var Y=A._formatDate(A.get(bm));var X=A._formatDate(A.get(aP));A.setTitle([Y,X].join(q+t+q),L);},split:function(){var A=this,X=j.clone(A.get(bm)),Y=j.clone(A.get(aP));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var L=j.clone(X);L.setHours(24,0,0,0);return[[X,j.toMidnight(j.clone(X))],[L,j.clone(Y)]];}return[[X,Y]];},eachRepeatedEvent:function(L){var A=this;aK.each(A[aq],L,A);},unlink:function(){var A=this;if(A.get(aL)){A.set(aL,null);}else{A.eachRepeatedEvent(function(L,X){L.unlink();});}A[aq]={};A.syncNodeUI();},_afterDisabledChange:function(L){var A=this;A._uiSetDisabled(L.newVal);},_afterVisibleChange:function(L){var A=this;A._uiSetVisible(L.newVal);},_afterRepeatChange:function(L){var A=this;A._uiSetRepeat(L.newVal);},_afterParentEventChange:function(L){var A=this;A._uiSetParentEvent(L.newVal);},_bindUIAttrs:function(){var A=this;A.after({disabledChange:A._afterDisabledChange,visibleChange:A._afterVisibleChange,parentEventChange:A._afterParentEventChange,repeatChange:A._afterRepeatChange});A._syncUIAttrs();},_propagateAttrChange:function(Y){var A=this;var X=Y.attrName;var L=Y.newVal;A.eachRepeatedEvent(function(bA,bB){var bC=bA[aM+a5(X)];if(bC){bC.apply(A,[bA,X,L]);}else{bA.set(X,Y.newVal);}bA.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,L,Y){var X=j.clone(A.get(aP));j.copyHours(X,Y);A.set(aP,X);},_propagateSetStartDate:function(L,X,Y){var A=j.clone(L.get(bm));j.copyHours(A,Y);L.set(bm,A);},_setColor:function(L){var A=this;A[H]=aY.rgb2hsb(aY.getRGB(L));A[T]=aK.clone(A[H]);A[T].b*=A.get(aW);A[T].s*=A.get(bd);A[aO]=aY.hsb2rgb(A[T]);return L;},_setDate:function(L){var A=this;if(ac(L)){L=new Date(L);}return L;},_setRepeat:function(L){var A=this;if(bj(L)){L=aK.SchedulerEventRepeat[L];}return G(L)?L:null;},_setScheduler:function(X){var A=this;var L=A.get(af);if(L){A.removeTarget(L);}A.addTarget(X);return X;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(w));A._uiSetVisible(A.get(ao));A._uiSetParentEvent(A.get(aL));A._uiSetRepeat(A.get(aN));},_formatDate:function(X,Y){var L=this;var A=L.get(bp);Y=Y||L.get(e);return aK.DataType.Date.format(X,{format:Y,locale:A});},_getTitleDateFormat:function(X){var A=this;if(!bj(X)){var L=A.get(af);X=(L&&L.get(Q).get(aX))?d:a6;}return X;},_uiSetDisabled:function(L){var A=this;A.get(n).toggleClass(bg,!!L);},_uiSetParentEvent:function(L){var A=this;A.get(n).toggleClass(aB,!!L);},_uiSetRepeat:function(X){var A=this;var L=!!X&&X!==aK.SchedulerEventRepeat[aZ];A.get(n).toggleClass(am,L);},_uiSetVisible:function(L){var A=this;A.get(n).toggleClass(C,!L);}}});aK.SchedulerEvent=V;aK.SchedulerEventRepeat={never:{description:"Never repeat",validate:function(A,L){return false;},value:"never"},daily:{description:"Every day",validate:function(A,L){return true;},value:"daily"},monthly:{description:"Every month",validate:function(L,X){var Y=L.get(aP);var A=L.get(bm);return(A.getDate()===X.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,L){return j.isMonWedOrFri(L);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,L){return j.isTueOrThu(L);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,L){return j.isWeekDay(L);},value:"weekDays"},weekly:{description:"Every week",validate:function(L,X){var Y=L.get(aP);var A=L.get(bm);return(A.getDay()===X.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(L,X){var Y=L.get(aP);var A=L.get(bm);return((A.getMonth()===X.getMonth())&&(A.getDay()===X.getDay()));},value:"yearly"}};var aw=aK.Lang,a=aw.isArray,G=aw.isObject,Q="activeView",J="allDay",c="arrow",aU="body",aA="bodyContent",o="boundingBox",az="cancel",a2="click",aG="content",aT="date",aH="dateFormat",aj="delete",ba="description",R="edit",bu="event",aS="eventClass",B="footerContent",aE="form",z="header",u="hide",aX="isoTime",aF="link",n="node",O="offsetHeight",bh="offsetWidth",h="overlay",S="overlayOffset",bv="recorder",br="rendered",aN="repeat",a4="save",af="scheduler",m="schedulerChange",av="scheduler-event",ax="scheduler-event-recorder",aD="shadow",aC="show",F="startDateChange",N="strings",a7="template",aV="title",bt="tl",ab="toolbar",bl="submit",bn="value",aR="visibleChange",Z="when",al="x",ak="y",ae="cancel",M="delete",y="edit",aJ="save",bw="-",g=".",ad="",i="#",r=aK.IO.prototype._serialize,E=aK.getClassName,s=E(af,bu),ap=E(af,bu,bv),bx=E(af,bu,bv,h),x=E(af,bu,bv,h,c),bf=E(af,bu,bv,h,c,aD),ah=E(af,bu,bv,h,aU),a8=E(af,bu,bv,h,aG),ag=E(af,bu,bv,h,aT),U=E(af,bu,bv,h,aE),bz=E(af,bu,bv,h,z),ar=E(af,bu,bv,h,aN),D=E(af,bu,aV),K=new aK.Template('<div class="',bf," ",x,'"></div>','<div class="',x,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',bz,'">','<input class="',a8,'" name="content" value="{content}" />',"</div>",'<div class="',ah,'">','<label class="',ag,'">{date}</label>','<select class="',ar,'" name="repeat">','<tpl for="eventRepeat">','<option {[ (parent.repeat && parent.repeat.value) == parent.eventRepeat[$i].value ? \'selected="selected"\' : "" ]} value="{value}">{description}</option>',"</tpl>","</select>","</div>"),by='<form class="'+U+'" id="schedulerEventRecorderForm"></form>';
var W=aK.Component.create({NAME:ax,ATTRS:{allDay:{value:false},content:{value:ad},duration:{value:60},dateFormat:{validator:bj,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return aK.SchedulerEvent;}},minDuration:{value:30},strings:{value:{},setter:function(A){return aK.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});},validator:G},overlay:{validator:G,value:{align:{points:[bt,bt]},visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:a},template:{value:K},toolbar:{setter:function(X){var L=this;var A=L.get(N);return aK.merge({children:[{handler:aK.bind(L._handleSaveEvent,L),label:A[a4]},{handler:aK.bind(L._handleCancelEvent,L),label:A[az]},{handler:aK.bind(L._handleDeleteEvent,L),label:A[aj]}]},X||{});},validator:G,value:{}}},EXTENDS:aK.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(n).addClass(ap);A.publish(ae,{defaultFn:A._defCancelEventFn});A.publish(M,{defaultFn:A._defDeleteEventFn});A.publish(y,{defaultFn:A._defEditEventFn});A.publish(aJ,{defaultFn:A._defSaveEventFn});A.after(m,A._afterSchedulerChange);A[h]=new aK.Overlay(A.get(h));A[ab]=new aK.Toolbar(A.get(ab));},_afterSchedulerChange:function(Y){var A=this;var X=Y.newVal;var L=X.get(o);L.delegate(a2,aK.bind(A._onClickSchedulerEvent,A),g+s);},_defCancelEventFn:function(L){var A=this;A.get(n).remove();A.hideOverlay();},_defDeleteEventFn:function(X){var A=this;var L=A.get(af);L.removeEvent(A.get(bu));A.hideOverlay();L.syncEventsUI();},_defEditEventFn:function(X){var A=this;var L=A.get(af);A.hideOverlay();L.syncEventsUI();},_defSaveEventFn:function(X){var A=this;var L=A.get(af);L.addEvent(X.newSchedulerEvent);A.hideOverlay();L.syncEventsUI();},_handleCancelEvent:function(L){var A=this;A.fire(ae);L.preventDefault();},_handleDeleteEvent:function(L){var A=this;A.fire(M,{schedulerEvent:A.get(bu)});L.preventDefault();},_handleSaveEvent:function(L){var A=this;A.fire(A.get(bu)?y:aJ,{newSchedulerEvent:A.getEventCopy()});L.preventDefault();},_onClickSchedulerEvent:function(X){var A=this;var L=X.currentTarget.getData(av);if(L){A.set(bu,L);A.showOverlay([X.pageX,X.pageY]);A.get(n).remove();}},_onOverlayVisibleChange:function(Y){var L=this;if(Y.newVal){L.populateForm();if(!L.get(bu)){var X=L[h].get(o);var A=X.one(g+a8);setTimeout(function(){A.selectText();},0);}}else{L.set(bu,null);L.get(n).remove();}},_onSubmitForm:function(L){var A=this;A._handleSaveEvent(L);},_renderOverlay:function(){var L=this;var A=L.get(N);L[h].render();L[ab].render();var X=L[h].get(o);X.addClass(bx);L[h].set(B,L[ab].get(o));L[h].on(aR,aK.bind(L._onOverlayVisibleChange,L));L.formNode=aK.Node.create(by);L[h].set(aA,L.formNode);L.formNode.on(bl,aK.bind(L._onSubmitForm,L));},getEventCopy:function(){var A=this;var X=A.get(bu);if(!X){X=new (A.get(aS))({allDay:A.get(J),endDate:A.get(aP),scheduler:A.get(af),startDate:A.get(bm)});X.copyPropagateAttrValues(A,{content:true});}var L=A.serializeForm();X.set(aG,L[aG]);X.set(aN,L[aN]);return X;},getFormattedDate:function(){var X=this;var L=X.get(aH);var bA=(X.get(bu)||X);var bC=bA.get(aP);var bB=bA.get(af);var A=bA.get(bm);var Y=(bB.get(Q).get(aX)?j.toIsoTimeString:j.toUsTimeString);return[bA._formatDate(A,L),Y(A),be,Y(bC)].join(q);},getTemplateData:function(){var L=this;var A=L.get(N);var X=(L.get(bu)||L);return{content:X.get(aG)||A["description-hint"],date:L.getFormattedDate(),endDate:X.get(aP).getTime(),eventRepeat:L.eventRepeatArray,repeat:X.get(aN),startDate:X.get(bm).getTime()};},hideOverlay:function(){var A=this;A[h].hide();},populateForm:function(){var A=this;if(!A.eventRepeatArray){A.eventRepeatArray=[];aK.each(aK.SchedulerEventRepeat,function(L){A.eventRepeatArray.push({description:L[ba],value:L[bn]});});}A.formNode.setContent(A.get(a7).parse(A.getTemplateData()));},serializeForm:function(){var A=this;return aK.QueryString.parse(r(A.formNode.getDOM()));},showOverlay:function(Y,bB){var A=this;var X=A.get(S);if(!A[h].get(br)){A._renderOverlay();}A[h].show();if(!Y){var L=(A.get(bu)||A).get(n);var bA=L.one(g+D);bB=[X[0]+bA.get(bh),X[1]+bA.get(O)/2];Y=bA.getXY();}bB=bB||X;Y[0]+=bB[0];Y[1]+=bB[1];A[h].set("xy",Y);}}});aK.SchedulerEventRecorder=W;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler-calendar",function(d){var h=d.Lang,i=h.isArray,c=h.isBoolean,b=h.isString,a="color",j="disabled",l="events",g="pallete",m="scheduler",e="scheduler-calendar",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var o=this;var p=o.get(g);var n=Math.ceil(Math.random()*p.length)-1;return p[n];},validator:b},disabled:{value:false,validator:c},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:i},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var n=this;n.after("colorChange",n._afterColorChange);n.after("disabledChange",n._afterDisabledChange);n.after("eventsChange",n._afterEventsChange);n.after("visibleChange",n._afterVisibleChange);n.on("eventsChange",n._onEventsChange);n._uiSetColor(n.get(a));n._uiSetDisabled(n.get(j));n._uiSetEvents(n.get(l));n._uiSetVisible(n.get(k));},_afterColorChange:function(o){var n=this;n._uiSetColor(o.newVal);},_afterDisabledChange:function(o){var n=this;n._uiSetDisabled(o.newVal);},_afterEventsChange:function(o){var n=this;n._uiSetEvents(o.newVal);
},_afterVisibleChange:function(o){var n=this;n._uiSetVisible(o.newVal);},_onEventsChange:function(p){var n=this;var o=n.get(m);if(o){o.removeEvents(n);}},_propagateAttr:function(o,p){var n=this;n.eachEvent(function(q){q.set(o,p);});},_setScheduler:function(p){var n=this;var o=n.get(m);if(o){n.removeTarget(o);}n.addTarget(p);return p;},_uiSetColor:function(o){var n=this;n._propagateAttr(a,n.get(a));},_uiSetDisabled:function(o){var n=this;n._propagateAttr(j,o);},_uiSetEvents:function(p){var n=this;var o=n.get(m);n._propagateAttr(a,n.get(a));n._propagateAttr(j,n.get(j));n._propagateAttr(k,n.get(k));if(o){o.addEvents(p);o.syncEventsUI();}},_uiSetVisible:function(o){var n=this;n._propagateAttr(k,o);}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:false});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});