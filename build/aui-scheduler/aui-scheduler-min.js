AUI.add("aui-scheduler-base",function(aa){var N=aa.Lang,at=N.isString,a=N.isArray,d=N.isDate,H=N.isNumber,G=function(A){return(A instanceof aa.Scheduler);},s=function(A){return(A instanceof aa.SchedulerView);},Y=function(A){return(A instanceof aa.SchedulerEvent);},t=function(A){return(aa.SchedulerCalendar&&(A instanceof aa.SchedulerCalendar));},h=aa.DataType.DateMath,U=aa.WidgetStdMod,S=".",o="",p=" ",r="scheduler-base",af="data-view-name",E="activeView",ar="clearfix",D="controls",ah="controlsNode",ak="current",Z="currentDate",W="currentDateNode",ag="date",ae="endDate",au="events",az="hd",v="header",aq="headerNode",m="helper",Q="icon",j="iconNextNode",an="iconPrevNode",ax="locale",l="name",O="nav",L="navNode",am="navigationDateFormat",n="next",b="nextDate",ap="prev",ai="prevDate",ay="rendered",K="scheduler",av="startDate",C="strings",e="today",ab="todayNode",u="triggerNode",y="view",M="viewStack",aA="views",V="viewsNode",z=aa.getClassName,ac=z(m,ar),i=z(Q),al=z(r,D),R=z(r,ak,ag),f=z(r,az),T=z(r,Q,n),B=z(r,Q,ap),aw=z(r,O),x=z(r,e),X=z(r,y),g=z(r,y,o),q=z(r,aA),aj='<div class="'+al+'"></div>',w='<div class="'+R+'"></div>',c='<div class="'+f+'"></div>',aB='<a href="#" class="'+[i,T].join(p)+'">Next</a>',ad='<a href="#" class="'+[i,B].join(p)+'">Prev</a>',k='<div class="'+aw+'"></div>',P='<a href="#" class="'+x+'">{today}</a>',ao='<a href="#" class="'+[X,g].join(p)+'{name}" data-view-name="{name}">{label}</a>',I='<div class="'+q+'"></div>';var J=function(){};J.ATTRS={events:{value:[],setter:"_setEvents",validator:a}};aa.mix(J.prototype,{addEvent:function(aC){var A=this;var aD=A.get(au);if(aa.Array.indexOf(aD,aC)>-1){aa.Array.removeItem(aD,aC);}aD.push(aC);A.set(au,aD);},addEvents:function(aC){var A=this;aa.Array.each(A._normalizeEvents(aC),aa.bind(A.addEvent,A));},eachEvent:function(aD){var A=this;var aC=A.get(au);aa.Array.each(aC,aD,A);},removeEvent:function(aC){var A=this;var aD=A.get(au);aa.Array.removeItem(aD,aC);A.set(au,aD);},removeEvents:function(aC){var A=this;aa.Array.each(A._normalizeEvents(aC),aa.bind(A.removeEvent,A));},_normalizeEvents:function(aD){var A=this;var aC=[];aD=aa.Array(aD);aa.Array.each(aD,function(aE){if(Y(aE)){aC.push(aE);}else{if(t(aE)){aC=aC.concat(A._normalizeEvents(aE.get(au)));}else{aE=new aa.SchedulerEvent(aE);aC.push(aE);}}if(G(A)){aE.set(K,A);}});return aC;},_setEvents:function(aC){var A=this;return A._normalizeEvents(aC);}});aa.SchedulerEventSupport=J;var F=aa.Component.create({NAME:r,ATTRS:{activeView:{validator:s},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aD){var A=this;var aC=A.get(E);if(aC){return aC.get(am);}return aD;},value:"%A - %d %b %Y",validator:at},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:d},firstDayOfWeek:{value:0,validator:H},controlsNode:{valueFn:function(){return aa.Node.create(aj);}},currentDateNode:{valueFn:function(){return aa.Node.create(w);}},headerNode:{valueFn:function(){return aa.Node.create(c);}},iconNextNode:{valueFn:function(){return aa.Node.create(aB);}},iconPrevNode:{valueFn:function(){return aa.Node.create(ad);}},navNode:{valueFn:function(){return aa.Node.create(k);}},todayNode:{valueFn:function(){return aa.Node.create(this._processTemplate(P));}},viewsNode:{valueFn:function(){return aa.Node.create(I);}}},HTML_PARSER:{controlsNode:S+al,currentDateNode:S+R,headerNode:S+f,iconNextNode:S+T,iconPrevNode:S+B,navNode:S+aw,todayNode:S+x,viewsNode:S+q},UI_ATTRS:[Z],AUGMENTS:[aa.SchedulerEventSupport,aa.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[M]={};A[ah]=A.get(ah);A[W]=A.get(W);A[v]=A.get(aq);A[j]=A.get(j);A[an]=A.get(an);A[L]=A.get(L);A[ab]=A.get(ab);A[V]=A.get(V);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;aa.Array.each(A.get(au),function(aC){aC.eachRepeatedEvent(function(aD){delete aD._filtered;});delete aC._filtered;});},getEventsByDay:function(aC,aD){var A=this;aC=h.safeClearTime(aC);return A._getEvents(aC,function(aE){return h.compare(aE.getClearStartDate(),aC)||(aD&&h.compare(aE.getClearEndDate(),aC));});},getIntersectEvents:function(aC){var A=this;aC=h.safeClearTime(aC);return A._getEvents(aC,function(aE){var aD=aE.getClearStartDate();var aF=aE.getClearEndDate();return(h.compare(aC,aD)||h.compare(aC,aF)||h.between(aC,aD,aF));});},sortEventsByDateAsc:function(aC){var A=this;aC.sort(function(aG,aE){var aF=aG.get(ae);var aD=aE.get(ae);var aI=aG.get(av);var aH=aE.get(av);if(h.after(aI,aH)||(h.compare(aI,aH)&&h.before(aF,aD))){return 1;}else{return -1;}});},getViewByName:function(aC){var A=this;return A[M][aC];},getStrings:function(){var A=this;return A.get(C);},getString:function(aC){var A=this;return A.getStrings()[aC];},renderView:function(aC){var A=this;if(aC){aC.show();if(!aC.get(ay)){if(!A.bodyNode){A.setStdModContent(U.BODY,o);}aC.render(A.bodyNode);}}},plotViewEvents:function(aC){var A=this;aC.plotEvents(A.get(au));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(E));},_afterActiveViewChange:function(aE){var aC=this;if(aC.get(ay)){var aD=aE.newVal;var A=aE.prevVal;if(A){A.hide();}aC.renderView(aD);}},_afterRender:function(aC){var A=this;A.renderView(A.get(E));},_bindDelegate:function(){var A=this;A[V].delegate("click",A._onClickViewTrigger,S+X,A);A[ah].delegate("click",A._onClickPrevIcon,S+B,A);A[ah].delegate("click",A._onClickNextIcon,S+T,A);A[ah].delegate("click",A._onClickToday,S+x,A);},_createViewTriggerNode:function(aC){var A=this;if(!aC.get(u)){var aD=aC.get(l);aC.set(u,aa.Node.create(N.sub(ao,{name:aD,label:(A.getString(aD)||aD)})));}return aC.get(u);},_getEvents:function(aC,aF){var A=this;var aE=A.get(au);var aD=[];aa.Array.each(aE,function(aG){if(aF.apply(A,[aG])){aD.push(aG);}else{if(aG.isRepeatableDate(aC)){var aH=aG.repeatByDate(aC);
aD.push(aH);}}});A.sortEventsByDateAsc(aD);return aD;},_onClickToday:function(aC){var A=this;A.set(Z,A.get(E).getToday());aC.preventDefault();},_onClickNextIcon:function(aC){var A=this;A.set(Z,A.get(E).get(b));aC.preventDefault();},_onClickPrevIcon:function(aC){var A=this;A.set(Z,A.get(E).get(ai));aC.preventDefault();},_onClickViewTrigger:function(aC){var A=this;var aD=aC.currentTarget.attr(af);A.set(E,A.getViewByName(aD));aC.preventDefault();},_processTemplate:function(aC){var A=this;return N.sub(aC,A.getStrings());},_setEventRecorder:function(aC){var A=this;if(aC){aC.set(K,A);}},_setViews:function(aD){var A=this;var aC=[];aa.Array.each(aD,function(aE){if(s(aE)&&!aE.get(ay)){aE.set(K,A);aC.push(aE);A[M][aE.get(l)]=aE;}});if(!A.get(E)){A.set(E,aD[0]);}return aC;},syncStdContent:function(){var A=this;var aC=A.get(aA);A[L].append(A[an]);A[L].append(A[j]);A[ah].append(A[ab]);A[ah].append(A[L]);A[ah].append(A[W]);aa.Array.each(aC,function(aD){A[V].append(A._createViewTriggerNode(aD));});A[v].append(A[ah]);A[v].append(A[V]);A[v].addClass(ac);A.setStdModContent(U.HEADER,A[v].getDOM());},_uiSetCurrentDate:function(aE){var A=this;var aD=aa.DataType.Date.format(aE,{format:A.get(am),locale:A.get(ax)});A[W].html(aD);if(A.get(ay)){var aC=A.get(E);if(aC){aC._uiSetCurrentDate(aE);}A.syncEventsUI();}}}});aa.Scheduler=F;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(b0){var cd=b0.Lang,cp=cd.isObject,bS=cd.isString,aU=cd.isBoolean,aD=cd.isNumber,bI=function(A){return parseFloat(A)||0;},bK=function(ct,A){return Math.round(ct/A)*A;},ao=b0.DataType.DateMath,bX=b0.WidgetStdMod,aJ=ao.WEEK_LENGTH,bL="scheduler-view",aC="scheduler-view-day",b4="scheduler-view-week",ck="scheduler-view-month",a7="activeColumn",bH="activeView",aP="boundingBox",af="col",av="colDaysNode",b2="colHeaderDaysNode",G="colblank",w="coldata",aF="colday",a="colgrid",U="colspan",m="coltime",bk="columnData",aT="columnDayHeader",aH="columnShims",aN="columnTableGrid",bd="columnTime",aM="container",aK="content",a6="creationEndDate",X="creationStartDate",bb="currentDate",bx="data",ca="day",R="days",B="delegateConfig",bF="disabled",V="div",bj="division",Z="down",D="draggingEvent",bQ="duration",ay="endDate",a2="event",bE="eventPlaceholder",cr="eventRecorder",q="eventWidth",aE="first",b5="firstDayOfWeek",a9="grid",bu="gridContainer",cq="hd",bZ="header",ba="headerDateFormat",co="headerTableNode",aO="host",aB="hourHeight",s="icon",aj="isoTime",aQ="left",aw="locale",aa="marker",a4="markercell",aX="markercellsNode",I="markers",bA="markersNode",bC="month",a8="monthContainerNode",e="monthRows",aL="next",cs="node",ai="nomonth",ap="noscroll",bY="offsetHeight",b1="pad",aG="paddingNode",cf="parentEvent",O="parentNode",br="proxy",ag="px",ab="region",aR="rendered",bW="repeated",aY="right",bp="row",p="scheduler",az="scheduler-event",W="scrollable",Q="shim",b3="startDate",T="startXY",aS="table",z="tableGridNode",bv="tableNode",bs="tbody",f="td",bm="time",ah="timesNode",h="title",ak="today",bq="top",au="visible",cg="week",by="width",t="data-colnumber",k="a",bJ="-",bM=".",bG="",bz="%",S=" ",C=b0.getClassName,bl=C(bL,ap),ac=C(bL,W);var aW=b0.Component.create({NAME:bL,AUGMENTS:[b0.WidgetStdMod],ATTRS:{bodyContent:{value:bG},height:{value:600},isoTime:{value:false,validator:aU},name:{value:bG,validator:bS},navigationDateFormat:{value:"%A - %d %B, %Y",validator:bS},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:aU},triggerNode:{setter:b0.one},visible:{value:false}},BIND_UI_ATTRS:[W],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var cu=A.get(p);var ct=cu.get(bb);cu.set(bb,ct);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return ao.clearTime(new Date());},limitDate:function(ct,cu){var A=this;if(ao.after(ct,cu)){ct=ao.clone(cu);}return ct;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(ct){var A=this;A.adjustCurrentDate();A._uiSetScrollable(A.get(W));},_setScheduler:function(cu){var A=this;var ct=A.get(p);if(ct){A.removeTarget(ct);}if(cu){A.addTarget(cu);cu.after("eventsChange",b0.bind(A.flushViewCache,A));}return cu;},_uiSetScrollable:function(cu){var A=this;var ct=A.bodyNode;if(ct){ct.toggleClass(ac,cu);ct.toggleClass(bl,!cu);}},_uiSetVisible:function(ct){var A=this;aW.superclass._uiSetVisible.apply(this,arguments);if(ct&&A.get(aR)){A.adjustCurrentDate();}}}});b0.SchedulerView=aW;var bD=cd.sub;var L=function(A,ct){return function(cv){var cu=cv.all(A);return(cu.size()>=ct)?cu:null;};},aI=C(az),bg=C(az,bF),bO=C(az,br),M=C(p,ak),an=C(p,ak,cq),x=C(bL,w),c=C(bL,a),b6=C(bL,a9),b7=C(bL,a9,aM),bi=C(bL,aa,bj),b9=C(bL,a4),J=C(bL,I),bw=C(bL,aS),cc=C(bL,ca,bZ,aS),r=C(bL,ca,bZ,ca),bh=C(bL,ca,bZ,ca,b1,aY),bR=C(bL,ca,bZ,ca,aE),a1=C(bL,ca,bZ,af),cm=C(bL,aS,af),aA=C(bL,aS,af,Q),N=C(bL,aS,G),F=C(bL,aS,aF),ch=C(bL,aS,m),bo=C(bL,aS,bm),ad='<div class="'+b9+'">'+'<div class="'+bi+'"></div>'+"</div>",ar='<table cellspacing="0" cellpadding="0" class="'+bw+'">'+"<tbody>"+'<tr class="'+c+'" height="1">'+'<td height="0" class="'+[cm,N].join(S)+'"></td>'+'<td class="'+b7+'" colspan="1">'+'<div class="'+b6+'">'+'<div class="'+J+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+x+'">'+'<td class="'+[cm,ch].join(S)+'"></td>'+"</tr>"+"</tbody>"+"</table>",be='<td class="'+[cm,F].join(S)+'" data-colnumber="{colNumber}">'+'<div class="'+aA+'"></div>'+"</td>",j='<div class="'+bo+'">{hour}</div>',at='<table cellspacing="0" cellpadding="0" class="'+cc+'">'+"<tbody>"+'<tr class="'+a1+'"></tr>'+"</tbody>"+"</table>",bf='<th class="'+r+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aq='<td class="'+[r,bR].join(S)+'"></td>',u='<th class="'+[r,bh].join(S)+'">&nbsp;</th>';
var cn=b0.Component.create({NAME:aC,ATTRS:{bodyContent:{value:bG},days:{value:1,validator:aD},delegateConfig:{value:{},setter:function(ct){var A=this;return b0.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(aP),nodes:bM+aI,invalid:"input, select, button, a, textarea, "+bM+bg},ct||{});},validator:cp},headerDateFormat:{value:"%d %A",validator:bS},name:{value:ca},hourHeight:{value:52,validator:aD},eventWidth:{value:95,validator:aD},headerTableNode:{valueFn:function(){return b0.Node.create(at);}},tableNode:{valueFn:function(){return b0.Node.create(ar);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:L(bM+F,1),colHeaderDaysNode:L(bM+r,2),headerTableNode:bM+cc,markercellsNode:L(bM+b9,24),tableNode:bM+bw,timesNode:L(bM+bo,24)},EXTENDS:b0.SchedulerView,prototype:{initializer:function(){var A=this;A[av]=A.get(av);A[b2]=A.get(b2);A[co]=A.get(co);A[aX]=A.get(aX);A[bv]=A.get(bv);A[ah]=A.get(ah);A[a7]=null;A[bk]=A[bv].one(bM+x);A[aT]=A.headerTableNode.one(bM+a1);A[aH]=A[av].all(bM+aA);A[bd]=A[bv].one(bM+ch);A[bu]=A[bv].one(bM+b7);A[bA]=A[bv].one(bM+J);},renderUI:function(){var A=this;A[bd].setContent(A[ah]);A[bA].setContent(A[aX]);A[av].appendTo(A[bk]);A[b2].appendTo(A[aT]);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",b0.bind(A._onClickDaysHeader,A),bM+r);A[bk].delegate("mousedown",b0.bind(A._onMouseDownTableCol,A),bM+cm);A[bk].delegate("mouseup",b0.bind(A._onMouseUpTableCol,A),bM+cm);A[bk].delegate("mousemove",b0.bind(A._onMouseMoveTableCol,A),bM+F);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;cn.superclass.syncUI.apply(this,arguments);A[bu].attr(U,A.get(R));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(bX.BODY,A[bv].getDOM());A.setStdModContent(bX.HEADER,A[co].getDOM());},calculateEventHeight:function(cu){var ct=this;var A=ct.get(aB);return Math.max(cu*(A/60),A/2);},calculateTop:function(ct){var A=this;return((ct.getHours()*60)+ct.getMinutes()+(ct.getSeconds()/60))*(A.get(aB)/60);},getNextDate:function(){var A=this;var ct=A.get(p).get(bb);return ao.add(ct,ao.DAY,1);},getPrevDate:function(){var A=this;var ct=A.get(p).get(bb);return ao.subtract(ct,ao.DAY,1);},getColumnByDate:function(ct){var A=this;return A[av].item(A.getDateDaysOffset(ct));},getColumnShimByDate:function(ct){var A=this;return A[aH].item(A.getDateDaysOffset(ct));},getDateByColumn:function(cu){var A=this;var ct=ao.safeClearTime(A.get(p).get(bb));return ao.add(ct,ao.DAY,cu);},getDateDaysOffset:function(cu){var A=this;var ct=ao.safeClearTime(A.get(p).get(bb));return ao.getDayOffset(ao.safeClearTime(cu),ct);},getYCoordTime:function(cw){var ct=this;var A=ct.get(aB);var cx=bI((cw/A).toFixed(2));var cv=Math.floor((cx*100)%100*0.6);var cu=Math.floor(cx);return[cu,cv,0];},plotEvent:function(cu){var A=this;var cw=cu.get(cs);var ct=cu.get(aG);var cv=A.getColumnShimByDate(cu.get(ay));var cx=A.getColumnShimByDate(cu.get(b3));if(cx){cx.append(cw);if(cu.get(au)){cw.show();}}else{cw.hide();}if(cv){if(cv.compareTo(cx)||cu.isDayBoundaryEvent()){ct.hide();}else{cv.append(ct);if(cu.get(au)){ct.show();}}}else{ct.hide();}A.syncEventTopUI(cu);A.syncEventHeightUI(cu);},plotEvents:function(){var A=this;var ct=A.get(p);A[aH].each(function(cw,cv){var cu=ct.getEventsByDay(A.getDateByColumn(cv),true);cw.empty();b0.Array.each(cu,function(cx){if(cx.getHoursDuration()<=24){A.plotEvent(cx);}});A.syncEventsIntersectionUI(cu);});},syncColumnsUI:function(){var A=this;A[av].each(function(cv,cu){var ct=A.getDateByColumn(cu);cv.toggleClass(M,ao.isToday(ct));});},syncDaysHeaderUI:function(){var cu=this;var cv=cu.get(p).get(bb);var ct=cu.get(ba);var A=cu.get(aw);cu[b2].all(k).each(function(cy,cx){var cw=ao.add(cv,ao.DAY,cx);var cz=b0.DataType.Date.format(cw,{format:ct,locale:A});cy.toggleClass(an,ao.isToday(cw));cy.html(cz);});},syncEventsIntersectionUI:function(ct){var A=this;var cu=A.get(q);A.get(p).flushEvents();b0.Array.each(ct,function(cw){var cy=A.findEventIntersections(cw,ct);var cx=cy.length;var cv=(cu/cx);b0.Array.each(cy,function(cA,cB){var cz=cA.get(cs);var cD=cv*cB;var cC=cv*1.7;if(cB===(cx-1)){cC=cu-cD;}cz.setStyle(by,cC+bz);cz.setStyle(aQ,cD+bz);var cE=cz.get(O);if(cE){cE.insert(cz,cB);}cA._filtered=true;});});},syncEventHeightUI:function(cv){var ct=this;var cz=cv.get(ay);var A=cv.get(b3);var cw=ao.clone(A);cw.setHours(24,0,0);var cx=ao.getMinutesOffset(ct.limitDate(cz,cw),A);cv.get(cs).set(bY,ct.calculateEventHeight(cx));var cu=cv.get(aG);if(cu.inDoc()){var cy=ao.getMinutesOffset(cz,ao.toMidnight(cv.getClearEndDate()));cu.set(bY,ct.calculateEventHeight(cy));}},syncEventTopUI:function(ct){var A=this;ct.get(aG).setStyle(bq,0);ct.get(cs).setStyle(bq,A.calculateTop(ct.get(b3))+ag);},calculateYDelta:function(cu,ct){var A=this;return(ct[1]-cu[1])/(A.get(aB)/2)*30;},findEventIntersections:function(ct,cu){var A=this;var cv=[];b0.Array.each(cu,function(cw){if(!ct._filtered&&ct.intersectHours(cw)&&(!cw.isDayOverlapEvent()||cw.isDayBoundaryEvent())){cv.push(cw);}});return cv;},getXYDelta:function(ct){var A=this;var cu=ct.currentTarget.getXY(),cv=[ct.pageX,ct.pageY];return b0.Array.map(cu,function(cx,cw){return(cv[cw]-cx);});},getTickY:function(){var A=this;return bK(Math.ceil(A.get(aB)/2),10);},roundToNearestHour:function(ct,cu){var A=this;ct.setHours(cu[0],bK(cu[1],A.getTickY()),cu[2]);},_afterDragAlign:function(cu){var ct=this;var A=cu.target;if(!ct[T]){ct[T]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(cu){var ct=this;var cx=ct[D];if(cx){var cv=ct[bE];var cw=bI(cu.attr(t))-ct.startColNumber;ct.activeColumnDate=ao.add(cx.get(b3),ao.DAY,cw);var A=ao.clone(ct.activeColumnDate);ao.copyHours(A,cv.get(b3));cv.move(A);ct.plotEvent(cv);}},_dragTickAlignY:function(cu){var ct=this;var cx=ct[D];if(cx){var A=cu.target.get(aO);
var cv=ct[bE];var cw=ct.calculateYDelta(ct[T],A.actXY);cv.move(ao.add(ct.activeColumnDate,ao.MINUTES,cw));ct.plotEvent(cv);}},_setupDragDrop:function(){var ct=this;if(!ct[bE]){var cu=ct.get(p);ct[bE]=new b0.SchedulerEvent({scheduler:cu});ct[bE].removeTarget(cu);ct[bE].get(cs).addClass(bO).hide();ct[bE].get(aG).addClass(bO).hide();}if(!ct.delegate){ct.delegate=new b0.DD.Delegate(ct.get(B));}var A=ct.delegate.dd;A.unplug(b0.Plugin.DDConstrained);A.unplug(b0.Plugin.DDNodeScroll);var cv=ct.bodyNode.get(ab);cv.bottom=Infinity;cv.top=-Infinity;A.plug(b0.Plugin.DDConstrained,{bubbleTargets:ct,constrain:cv,stickY:true,tickY:ct.get(aB)/2});A.plug(b0.Plugin.DDNodeScroll,{node:ct.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(ct){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(cv){var A=this;var cu=A.get(p);if(cv.target.test(k)){var cw=cu.getViewByName(ca);if(cw){var ct=bI(cv.currentTarget.attr(t));cu.set(bb,A.getDateByColumn(ct));cu.set(bH,cw);}}cv.preventDefault();},_onEventDragEnd:function(ct){var A=this;var cv=A[D];if(cv){var cu=A[bE];cu.set(au,false);cv.set(au,true);cv.copyDates(cu);A.get(p).syncEventsUI();}A[T]=null;A[D]=null;},_onEventDragStart:function(cu){var A=this;var cw=A[D]=A.delegate.dd.get(cs).getData(az);if(cw){var cv=A[bE];cv.copyPropagateAttrValues(cw);A.plotEvent(cv);cw.set(au,false);A.activeColumnDate=ao.clone(cw.get(b3));var ct=A.getColumnByDate(cw.get(b3));A.startColNumber=ct?bI(ct.attr(t)):0;}},_onMouseDownTableCol:function(cx){var ct=this;var cw=ct.get(p);var cv=cw.get(cr);if(cv&&!cw.get(bF)){cv.hideOverlay();if(cx.target.test(bM+aA)){ct[T]=[cx.pageX,cx.pageY];var cu=bI(cx.currentTarget.attr(t));var A=ct.getDateByColumn(cu);var cy=ct.getXYDelta(cx);ct.roundToNearestHour(A,ct.getYCoordTime(cy[1]));var cz=ao.add(A,ao.MINUTES,cv.get(bQ));cv.move(A);cv.set(ay,cz);ct[X]=A;ct[a6]=cz;cx.halt();}}ct.get(aP).unselectable();},_onMouseMoveTableCol:function(cw){var A=this;var cv=cw.currentTarget;var ct=A.get(p).get(cr);if(A[a7]!==cv){A[a7]=cv;A._dragTickAlignX(A[a7]);}var cu=A[a6];var cx=A[X];if(cx){var cy=bK(A.calculateYDelta(A[T],[cw.pageX,cw.pageY]),A.getTickY());if(A._delta!==cy){if(cy>0){ct.set(ay,ao.add(cu,ao.MINUTES,cy));}else{ct.set(b3,ao.add(cx,ao.MINUTES,cy));}A.plotEvent(ct);A._delta=cy;}}},_onMouseUpTableCol:function(cv){var A=this;var cu=A.get(p);var ct=cu.get(cr);if(ct&&!cu.get(bF)){if(A[X]){A.plotEvent(ct);ct.showOverlay();}}A[X]=null;A[a6]=null;A[T]=null;A.get(aP).selectable();},_valueColDaysNode:function(){var A=this;var cv=A.get(R);var ct=[],cu=0;while(cv--){ct.push(b0.Lang.sub(be,{colNumber:cu++}));}return b0.NodeList.create(ct.join(bG));},_valueColHeaderDaysNode:function(){var A=this;var cv=A.get(R);var ct=[],cu=0;ct.push(aq);while(cv--){ct.push(b0.Lang.sub(bf,{colNumber:cu++}));}ct.push(u);return b0.NodeList.create(ct.join(bG));},_valueMarkercellsNode:function(){var A=this;var ct=[],cu;for(cu=0;cu<=23;cu++){ct.push(ad);}return b0.NodeList.create(ct.join(bG));},_valueTimesNode:function(){var A=this;var cv=A.get(aj);var cu=[],ct;for(ct=0;ct<=23;ct++){cu.push(bD(j,{hour:cv?ao.toIsoTimeString(ct):ao.toUsTimeString(ct,false,true)}));}return b0.NodeList.create(cu.join(bG));}}});b0.SchedulerDayView=cn;var al=b0.Component.create({NAME:b4,ATTRS:{bodyContent:{value:bG},days:{value:7},name:{value:cg}},EXTENDS:b0.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var cv=A.get(p);var ct=cv.get(bb);var cu=cv.get(b5);cv.set(bb,ao.getFirstDayOfWeek(ct,cu));},getNextDate:function(){var A=this;var cu=A.get(p);var ct=cu.get(bb);var cv=A._firstDayOfWeek(ct);return ao.add(cv,ao.WEEK,1);},getPrevDate:function(){var A=this;var cu=A.get(p);var ct=cu.get(bb);var cv=A._firstDayOfWeek(ct);return ao.subtract(cv,ao.WEEK,1);},getToday:function(){var A=this;var ct=al.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(ct);},_firstDayOfWeek:function(cu){var A=this;var cv=A.get(p);var ct=cv.get(b5);return ao.getFirstDayOfWeek(cu,ct);}}});b0.SchedulerWeekView=al;var g=C(s),l=C(s,"arrowstop-1-l"),ci=C(s,"arrowstop-1-r"),bV=C(bL,bC,a),n=C(bL,bC,a,aE),b=C(bL,bC,a,ak),i=C(bL,bC,aM),a3=C(bL,bC,bZ,af),v=C(bL,bC,bZ,ca),cj=C(bL,bC,bZ,aS),bU=C(bL,bC,bp),am=C(bL,bC,bp,aM),bB=C(bL,bC,aS,bx),bT=C(bL,bC,aS,bx,af),a0=C(bL,bC,aS,bx,af,ai),aV=C(bL,bC,aS,bx,af,h),cl=C(bL,bC,aS,bx,af,h,Z),ae=C(bL,bC,aS,bx,af,h,aE),y=C(bL,bC,aS,bx,af,h,aL),P=C(bL,bC,aS,bx,af,h,ak),bn=C(bL,bC,aS,bx,a2),d=C(bL,bC,aS,bx,a2,aQ),o=C(bL,bC,aS,bx,a2,bW),bN=C(bL,bC,aS,bx,a2,aY),aZ=C(bL,bC,aS,bx,aE),bc=C(bL,bC,aS,a9),ce=C(bL,bC,aS,a9,aE),E='<table cellspacing="0" cellpadding="0" class="'+cj+'">'+"<tbody>"+'<tr class="'+a3+'"></tr>'+"</tbody>"+"</table>",K='<th class="'+v+'"><div>&nbsp;</div></th>',cb='<div class="'+i+'">'+'<div class="'+am+'">'+'<div class="'+bU+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+bU+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",bt='<table cellspacing="0" cellpadding="0" class="'+bc+'">'+"<tbody>"+"<tr>"+'<td class="'+[bV,n].join(S)+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+'<td class="'+bV+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",bP='<table cellspacing="0" cellpadding="0" class="'+bB+'">'+"<tbody></tbody>"+"</table>",b8="<tr></tr>",a5='<td class="'+bT+'"><div></div></td>',Y='<span class="'+[g,l].join(S)+'"></span>',H='<span class="'+[g,ci].join(S)+'"></span>';var ax=b0.Component.create({NAME:ck,ATTRS:{bodyContent:{value:bG},name:{value:bC},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return b0.Node.create(cb);}},headerTableNode:{valueFn:function(){return b0.Node.create(E);
}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:L(bM+bc,7),colHeaderDaysNode:L(bM+v,7),monthContainerNode:bM+i,headerTableNode:bM+cj},EXTENDS:b0.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};A[b2]=A.get(b2);A[co]=A.get(co);A[a8]=A.get(a8);A[z]=A.get(z);A[aT]=A.headerTableNode.one(bM+a3);A[aN]=A[z].all(f);A[e]=A[a8].all(bM+bU);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A[aT]);A[e].each(function(cv,cu){var ct=A[z].item(cu);cv.append(ct.toggleClass(ce,(cu===0)));});},buildEventsTable:function(ct,cy){var cE=this;var cB=5;var cv=ao.clearTime(cE._findCurrentMonthEnd());var cD=ao.clearTime(cE._findCurrentMonthStart());var cA=String(cD.getTime()).concat(ct.getTime()).concat(cy.getTime());var cz=cE.evtDataTableStack[cA];if(!cz){cz=b0.Node.create(bP);var cC=cz.one(bs);var cw=b0.Node.create(b8);cE.loopDates(ct,cy,function(cG,cF){var cH=b0.Node.create(a5);cH.addClass(aV).toggleClass(ae,(cF===0)).toggleClass(P,ao.isToday(cG)).toggleClass(y,ao.isToday(ao.subtract(cG,ao.DAY,1))).toggleClass(cl,ao.isToday(ao.subtract(cG,ao.WEEK,1)));if(ao.before(cG,cD)||ao.after(cG,cv)){cH.addClass(a0);}cw.append(cH.setContent(cG.getDate()));});cC.append(cw);var A;for(A=0;A<cB;A++){var cx=0;var cu=b0.Node.create(b8);cE.loopDates(ct,cy,function(cK,cI){if(cx<=cI){var cJ=cE.getIntersectEvents(cK),cG=cJ[A];var cL=b0.Node.create(a5);if(cG){var cF=cL.one(V);var cH=cE._getEvtSplitInfo(cG,ct,cy);cL.attr(U,cH.colspan);cF.addClass(bn).setContent(cE._getEvtLabel(cG));if(cH.left){cF.addClass(d).prepend(Y);}if(cH.right){cF.addClass(bN).append(H);}if(cG.get(cf)){cF.addClass(o);}cx+=cH.colspan;}else{cx++;}cu.append(cL);}});cC.append(cu);}cE.evtDataTableStack[cA]=cz;}return cz;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(ct){var A=this;var cv=A.get(p);var cu=String(ct.getTime());if(!A.evtDateStack[cu]){A.evtDateStack[cu]=cv.getIntersectEvents(ct);}return A.evtDateStack[cu];},loopDates:function(A,cv,cy,cz,cx){var cA=this;var ct=ao.clone(A);var cu=cv.getTime(),cw;for(cw=0;ct.getTime()<=cu;cw++){cy.apply(cA,[ct,cw]);ct=ao.add(ct,(cz||ao.DAY),(cx||1));}},plotEvents:function(){var ct=this;var cu=ct._findCurrentMonthStart();var A=ao.safeClearTime(ct._findFirstDayOfWeek(cu));ct.bodyNode.all(bM+bB).remove();ct[e].each(function(cy,cw){var cv=ao.add(A,ao.WEEK,cw);var cz=ao.add(cv,ao.DAY,aJ-1);var cx=ct.buildEventsTable(cv,cz);if(cw===0){cx.addClass(aZ);}cy.append(cx);});},syncStdContent:function(){var A=this;A.setStdModContent(bX.BODY,A[a8].getDOM());A.setStdModContent(bX.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var cA=this;var cu=cA.getToday();var ct=cA.get(p);cA[aN].removeClass(b);if(ao.isSameMonth(cu,ct.get(bb))){var A=ct.get(b5);var cw=cA._findCurrentMonthStart();var cy=cA._findFirstDayOfWeek(cu);var cv=ao.getWeekNumber(cu,A)-ao.getWeekNumber(cw,A);var cz=(cu.getDate()-cy.getDate());var cx=cA[z].item(cv).all(f).item(cz);if(cx){cx.addClass(b);}}},adjustCurrentDate:function(){var A=this;var ct=A.get(p);ct.set(bb,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var cu=A.get(p);var ct=cu.get(bb);return ao.add(ct,ao.MONTH,1);},getPrevDate:function(){var A=this;var cu=A.get(p);var ct=cu.get(bb);return ao.subtract(ct,ao.MONTH,1);},syncDaysHeaderUI:function(){var cu=this;var cx=cu.get(p);var cv=cx.get(bb);var ct=cu.get(ba);var A=cu.get(aw);var cw=cu._findFirstDayOfWeek(cv);cu.colHeaderDaysNode.all(V).each(function(cA,cz){var cy=ao.add(cw,ao.DAY,cz);var cB=b0.DataType.Date.format(cy,{format:ct,locale:A});cA.html(cB);});},_findCurrentMonthEnd:function(){var A=this;var cu=A.get(p);var ct=cu.get(bb);return ao.findMonthEnd(ct);},_findCurrentMonthStart:function(){var A=this;var cu=A.get(p);var ct=cu.get(bb);return ao.findMonthStart(ct);},_findFirstDayOfWeek:function(cu){var A=this;var cv=A.get(p);var ct=cv.get(b5);return ao.getFirstDayOfWeek(cu,ct);},_getEvtLabel:function(cu){var ct=this;var cv=cu.get(ay);var A=cu.get(b3);return[A.getHours(),bJ,cv.getHours(),S,cu.get(aK)].join(bG);},_getEvtSplitInfo:function(cz,A,cx){var cA=this;var ct=cz.getClearStartDate();var cy=cz.getClearEndDate();var cw=cz.getDaysDuration();var cv={};var cu=1;if(ao.after(ct,A)){cu=Math.min(cw,Math.abs(ao.getDayOffset(cx,ct))+1);if(cu>1){cv.right=true;}}else{cu=Math.abs(ao.getDayOffset(cy,A)+1);if(cu>1){cv.left=true;}}cv.colspan=Math.min(cu,aJ);if(cu>=aJ){cv.right=true;cv.left=true;}return cv;},_uiSetCurrentDate:function(ct){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(aJ,K);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(aJ,bt);},_valueNodeList:function(cv,cu){var A=this;var ct=[];while(cv--){ct.push(cu);}return b0.NodeList.create(ct.join(bG));}}});b0.SchedulerMonthView=ax;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(bl){var bu=bl.Lang,bd=bu.isString,L=bu.isDate,o=bu.isFunction,bG=bu.isObject,ap=bu.isBoolean,aa=bu.isNumber,bp=bl.ColorUtil,Q=bl.DataType.DateMath,ag=bl.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),a4="-",a5="&ndash;",a7=".",aZ="",G=" ",r="_",ay="_propagateSet",a1="activeView",bs="borderColor",bC="borderColorRGB",p="borderStyle",aN="borderWidth",am="Change",bx="color",D="colorBrightnessFactor",aJ="colorSaturationFactor",ah="content",aR="contentNode",aY="disabled",bc="duration",Y="endDate",at="eventStack",bh="events",R="hidden",P="hsbColor",n="icon",w="icons",bv="id",K="isoTime",W="locale",bH="node",aw="overlay",bA="parentEvent",au="recorder",X="repeat",bi="repeated",bB="repeatedEvents",a9="repeater",k="scheduler",Z="scheduler-event",U="scheduler-event-recorder",bo="startDate",af="template",e="title",ae="titleDateFormat",aS="titleNode",V="visible",ab="paddingNode",bq="paddingContentNode",u="paddingTitleNode",bE="%H:%M",S="%I:%M",t=bl.getClassName,d=t(n),ad=t(Z),a0=t(Z,ah),aT=t(Z,R),aE=t(Z,aY),J=t(Z,au),aU=t(Z,bi),aL=t(Z,a9),x=t(Z,e),N=t(Z,w),al=t(Z,n,aY),aH=t(Z,n,bi),aC=t(Z,n,a9);
var i=bl.Component.create({NAME:Z,ATTRS:{borderStyle:{value:"solid",validator:bd},borderWidth:{value:"1px",validator:bd},colorBrightnessFactor:{value:0.75,validator:aa},colorSaturationFactor:{value:1.5,validator:aa},content:{value:"(no title)",validator:bd},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bd},titleDateFormat:{getter:"_getTitleDateFormat",validator:bd},endDate:{valueFn:function(){var A=Q.clone(this.get(bo));A.setHours(A.getHours()+1);return A;},validator:L},disabled:{value:false,validator:ap},node:{valueFn:function(){return bl.Node.create(this.EVENT_NODE_TEMPLATE).setData(Z,this);},setter:bl.one},paddingNode:{readOnly:true,valueFn:function(){return bl.Node.create(this.EVENT_NODE_TEMPLATE).setData(Z,this);}},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:L},visible:{value:true,validator:ap}},EXTENDS:bl.Base,PROPAGATE_ATTRS:[bo,Y,ah,bx,D,aJ,p,aN,ae,V,aY],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+ad+'">'+'<div class="'+x+'"></div>'+'<div class="'+a0+'"></div>'+'<div class="'+N+'">'+'<span class="'+[d,aH].join(G)+'"></span>'+'<span class="'+[d,aC].join(G)+'"></span>'+'<span class="'+[d,al].join(G)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var bJ=A.get(bH);var bI=A.get(ab);A[at]={};bl.Array.each(bl.SchedulerEvent.PROPAGATE_ATTRS,function(bK){A.after(bK+am,A._propagateAttrChange);});A._bindUIAttrs();A[aR]=bJ.one(a7+a0);A[aS]=bJ.one(a7+x);A[bq]=bI.one(a7+a0);A[u]=bI.one(a7+x);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(bI,bJ){bI.destroy();});A[at]={};A.get(ab).remove(true);A.get(bH).remove(true);},copyDates:function(bI){var A=this;A.set(Y,Q.clone(bI.get(Y)));A.set(bo,Q.clone(bI.get(bo)));},copyPropagateAttrValues:function(bI,bJ){var A=this;A.copyDates(bI);bl.Array.each(bl.SchedulerEvent.PROPAGATE_ATTRS,function(bK){if(!((bJ||{}).hasOwnProperty(bK))){var bL=bI.get(bK);if(!bG(bL)){A.set(bK,bL);}}});},getBorderColor:function(){var A=this;return A[bC].hex;},getDaysDuration:function(){var A=this;return Q.getDayOffset(A.get(Y),A.get(bo));},getHoursDuration:function(){var A=this;return Q.getHoursOffset(A.get(Y),A.get(bo));},getMinutesDuration:function(){var A=this;return Q.getMinutesOffset(A.get(Y),A.get(bo));},getSecondsDuration:function(){var A=this;return Q.getSecondsOffset(A.get(Y),A.get(bo));},sameEndDate:function(bI){var A=this;return Q.compare(A.get(Y),bI.get(Y));},sameStartDate:function(bI){var A=this;return Q.compare(A.get(bo),bI.get(bo));},isAfter:function(bK){var bJ=this;var bI=bJ.get(bo);var A=bK.get(bo);return Q.after(bI,A);},isBefore:function(bK){var bJ=this;var bI=bJ.get(bo);var A=bK.get(bo);return Q.before(bI,A);},repeatByDate:function(bJ){var bI=this;var bK=bI.uidByDate(bJ);if(!bI[at][bK]){var A=Q.clone(bJ);var bM=Q.clone(bJ);Q.copyHours(A,bI.get(bo));Q.copyHours(bM,bI.get(Y));var bL=new bl.SchedulerEvent({endDate:bM,parentEvent:bI,scheduler:bI.get(k),startDate:A});bL.copyPropagateAttrValues(bI);bI[at][bK]=bL;}return bI[at][bK];},intersects:function(bK){var bJ=this;var bL=bJ.get(Y);var bI=bJ.get(bo);var A=bK.get(bo);return(bJ.sameStartDate(bK)||Q.between(A,bI,bL));},intersectHours:function(bJ){var bI=this;var bL=bI.get(Y);var A=bI.get(bo);var bK=Q.clone(A);Q.copyHours(bK,bJ.get(bo));return(Q.compare(A,bK)||Q.between(bK,A,bL));},isDayBoundaryEvent:function(){var A=this;return Q.isDayBoundary(A.get(bo),A.get(Y));},isDayOverlapEvent:function(){var A=this;return Q.isDayOverlap(A.get(bo),A.get(Y));},isRepeatableDate:function(bI){var A=this;var bJ=A.get(X);return(bJ&&bJ.validate(A,bI));},getClearEndDate:function(){var A=this;return Q.safeClearTime(A.get(Y));},getClearStartDate:function(){var A=this;return Q.safeClearTime(A.get(bo));},move:function(bI){var A=this;var bJ=A.getMinutesDuration();A.set(bo,bI);A.set(Y,Q.add(Q.clone(bI),Q.MINUTES,bJ));},uidByDate:function(bI){var A=this;bI=L(bI)?Q.safeClearTime(bI):A.getClearStartDate();return[Z,bI.getTime()].join(r);},setContent:function(bJ,bI){var A=this;A._setContent(aR,bJ,bI);A._setContent(bq,bJ,bI);},setTitle:function(bJ,bI){var A=this;A._setContent(aS,bJ,bI);A._setContent(u,bJ,bI);},syncNodeUI:function(bI){var A=this;A._syncUIAttrs();A.syncNodeColorUI(bI);A.syncNodeTitleUI(bI);A.syncNodeContentUI(bI);},syncNodeColorUI:function(bI){var A=this;var bL=A.get(bH);var bJ=A.get(ab);var bM=A.getBorderColor();if(bL&&bJ){var bK={borderWidth:A.get(aN),borderColor:bM,backgroundColor:A.get(bx),borderStyle:A.get(p)};bL.setStyles(bK);bJ.setStyles(bK);}if(bI){A.eachRepeatedEvent(function(bN,bO){bN.syncNodeColorUI();});}},syncNodeContentUI:function(bI){var A=this;A.setContent(A.get(ah),bI);},syncNodeTitleUI:function(bI){var A=this;var bK=A._formatDate(A.get(bo));var bJ=A._formatDate(A.get(Y));A.setTitle([bK,bJ].join(G+a5+G),bI);},split:function(){var A=this,bJ=Q.clone(A.get(bo)),bK=Q.clone(A.get(Y));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var bI=Q.clone(bJ);bI.setHours(24,0,0,0);return[[bJ,Q.toMidnight(Q.clone(bJ))],[bI,Q.clone(bK)]];}return[[bJ,bK]];},eachRepeatedEvent:function(bI){var A=this;bl.each(A[at],bI,A);},unlink:function(){var A=this;if(A.get(bA)){A.set(bA,null);}else{A.eachRepeatedEvent(function(bI,bJ){bI.unlink();});}A[at]={};A.syncNodeUI();},_afterDisabledChange:function(bI){var A=this;A._uiSetDisabled(bI.newVal);},_afterVisibleChange:function(bI){var A=this;A._uiSetVisible(bI.newVal);},_afterRepeatChange:function(bI){var A=this;A._uiSetRepeat(bI.newVal);},_afterParentEventChange:function(bI){var A=this;A._uiSetParentEvent(bI.newVal);},_bindUIAttrs:function(){var A=this;A.after({disabledChange:A._afterDisabledChange,visibleChange:A._afterVisibleChange,parentEventChange:A._afterParentEventChange,repeatChange:A._afterRepeatChange});A._syncUIAttrs();},_propagateAttrChange:function(bK){var A=this;var bJ=bK.attrName;var bI=bK.newVal;A.eachRepeatedEvent(function(bL,bM){var bN=bL[ay+ag(bJ)];if(bN){bN.apply(A,[bL,bJ,bI]);}else{bL.set(bJ,bK.newVal);
}bL.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,bI,bK){var bJ=Q.clone(A.get(Y));Q.copyHours(bJ,bK);A.set(Y,bJ);},_propagateSetStartDate:function(bI,bJ,bK){var A=Q.clone(bI.get(bo));Q.copyHours(A,bK);bI.set(bo,A);},_setColor:function(bI){var A=this;A[P]=bp.rgb2hsb(bp.getRGB(bI));A[bs]=bl.clone(A[P]);A[bs].b*=A.get(D);A[bs].s*=A.get(aJ);A[bC]=bp.hsb2rgb(A[bs]);return bI;},_setContent:function(bJ,bL,bI){var A=this;var bK=A[bJ];if(bK){bK.setContent(bL);}if(bI){A.eachRepeatedEvent(function(bM,bN){bM[bJ].setContent(bL);});}},_setRepeat:function(bI){var A=this;if(bd(bI)){bI=bl.SchedulerEventRepeat[bI];}return bG(bI)?bI:null;},_setScheduler:function(bJ){var A=this;var bI=A.get(k);if(bI){A.removeTarget(bI);}A.addTarget(bJ);return bJ;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(aY));A._uiSetVisible(A.get(V));A._uiSetParentEvent(A.get(bA));A._uiSetRepeat(A.get(X));},_formatDate:function(bJ,bK){var bI=this;var A=bI.get(W);bK=bK||bI.get(ae);return bl.DataType.Date.format(bJ,{format:bK,locale:A});},_getTitleDateFormat:function(bJ){var A=this;if(!bd(bJ)){var bI=A.get(k);bJ=(bI&&bI.get(a1).get(K))?bE:S;}return bJ;},_uiSetDisabled:function(bI){var A=this;A.get(bH).toggleClass(aE,!!bI);A.get(ab).toggleClass(aE,!!bI);},_uiSetParentEvent:function(bI){var A=this;A.get(bH).toggleClass(aU,!!bI);A.get(ab).toggleClass(aU,!!bI);},_uiSetRepeat:function(bI){var A=this;A.get(bH).toggleClass(aL,!!bI);A.get(ab).toggleClass(aL,!!bI);},_uiSetVisible:function(bI){var A=this;A.get(bH).toggleClass(aT,!bI);A.get(ab).toggleClass(aT,!bI);}}});bl.SchedulerEvent=i;bl.SchedulerEventRepeat={daily:{description:"Every day",validate:function(A,bI){return true;},value:"daily"},monthly:{description:"Every month",validate:function(bI,bJ){var bK=bI.get(Y);var A=bI.get(bo);return(A.getDate()===bJ.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,bI){return Q.isMonWedOrFri(bI);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,bI){return Q.isTueOrThu(bI);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,bI){return Q.isWeekDay(bI);},value:"weekDays"},weekly:{description:"Every week",validate:function(bI,bJ){var bK=bI.get(Y);var A=bI.get(bo);return(A.getDay()===bJ.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(bI,bJ){var bK=bI.get(Y);var A=bI.get(bo);return((A.getMonth()===bJ.getMonth())&&(A.getDay()===bJ.getDay()));},value:"yearly"}};var a1="activeView",ao="bc",an="bd",g="bodyContent",aj="boundingBox",by="button",bf="column",ah="content",aA="dateFormat",T="dblclick",aW="desc",aO="disk",av="event",aG="field",aq="fieldset",m="form",bt="hint",ar="input",K="isoTime",H="label",z="layout",a="menu",bm="overlayButtonRowNode",aQ="overlayContextPanel",a3="overlayDescNode",aX="overlaySelectNode",bD="overlayWhenNode",bk="pencil",X="repeat",aI="row",k="scheduler",aF="select",bg="strings",b="tc",a2="text",q="trigger",ac="when",bF="auiSchedulerEventRecorderButtonRow",a6="auiSchedulerEventRecorderDesc",bn="auiSchedulerEventRecorderSelect",ak="auiSchedulerEventRecorderWhen",B="cancel",F="edit",bb="save",a4="-",be="#",aD=t(by,aI),I=t(bf),y=t(bf,ah),f=t(aG),j=t(aG,ah),aM=t(aG,ar),a8=t(aG,ar,aF),C=t(aG,ar,a2),ai=t(aG,H),bz=t(aG,a),s=t(aG,aF),aK=t(aG,a2),aV=t(z,aq),bw=t(z,aq,an),h=t(z,aq,ah),c=t(m),E=t(z,ah),v=t(Z,au,aW),az=t(Z,au,m),aB=t(Z,au,H,ac),l=t(Z,au,aw),bj=t(z,"w100"),ax=t(Z,au,by,aI),ba=t(Z,au,aG,bt),O=t(Z,au,X),M="<option></option>",aP='<form id="auiSchedulerEventRecorderForm" class="'+[az,E,c].join(G)+'">'+'<div class="'+[aV,bj,I].join(G)+'">'+'<div class="'+[h,y].join(G)+'aui-fieldset-content aui-column-content">'+'<div class="'+bw+'">'+'<span class="'+[f,aK].join(G)+'">'+'<span class="'+j+'">'+'<label class="'+ai+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+aB+'"></span>'+"</span>"+"</span>"+'<span class="'+[f,aK].join(G)+'">'+'<span class="'+j+'">'+'<label class="'+ai+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[aM,C,v].join(G)+'" size="30" type="text" />'+'<div class="'+ba+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[f,bz,s].join(G)+'">'+'<label class="'+ai+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[aM,a8,O].join(G)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[f,aD,ax].join(G)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var br=bl.Component.create({NAME:U,ATTRS:{content:{value:aZ},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:bd},event:{},strings:{value:{},setter:function(A){return bl.merge({"description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",save:"Save",when:"When"},A||{});},validator:bG},overlayContextPanel:{value:{},setter:function(bI){var A=this;var bJ=bl.Node.create(bl.Lang.sub(aP,A.get(bg)));return bl.merge({align:{points:[ao,b]},anim:false,bodyContent:bJ,hideOn:T,trigger:A.get(bH),visible:false,zIndex:9999},bI||{});}}},EXTENDS:bl.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.after("schedulerChange",A._afterSchedulerChange);A.get(bH).addClass(J);A.get(ab).addClass(J);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(){var A=this;var bJ=A[a3].val();var bI=A.get(av);if(!bI){bI=new bl.SchedulerEvent({endDate:A.get(Y),scheduler:A.get(k),startDate:A.get(bo)});bI.copyPropagateAttrValues(A,{content:true});}bI.set(X,A[aX].val());if(bJ){bI.set(ah,bJ);}return bI;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},loadFormValues:function(){var A=this;var bK=aZ;var bJ=aZ;var bI=A.get(av);if(bI){var bL=bI.get(X);if(bL){bK=bL.value;}bJ=bI.get(ah);
}A[aX].val(bK);A[bD].setContent(A._getWhenFormattedDt());setTimeout(function(){A[a3].val(bJ).selectText();},0);},_afterSchedulerChange:function(bK){var A=this;var bJ=bK.newVal;var bI=bJ.get(aj);bI.delegate("click",bl.bind(A._onClickSchedulerEvent,A),a7+ad);},_createEvents:function(){var A=this;var bI=function(bJ,bK){A.publish(bJ,{defaultFn:bK,queuable:false,emitFacade:true,bubbles:true});};bI(bb,this._defSaveEventFn);bI(F,this._defEditEventFn);bI(B,this._defCancelEventFn);},_initOverlay:function(){var bI=this;var A=bI.get(bg);bI.overlay=new bl.OverlayContextPanel(bI.get(aQ));var bK=bI.overlay;var bJ=bK.get(aj);var bL=bK.get(g);bI[bm]=bL.one(be+bF);bI[a3]=bL.one(be+a6);bI[aX]=bL.one(be+bn);bI[bD]=bL.one(be+ak);bI.overlaySaveBtn=new bl.ButtonItem({label:A.save,icon:aO,render:bI[bm],handler:{fn:bI._handleSaveEvent,context:bI}});bI.overlayEditBtn=new bl.ButtonItem({label:A.edit,icon:bk,render:bI[bm],handler:{fn:bI._handleEditEvent,context:bI}});bI.overlayCancelBtn=new bl.ButtonItem({label:A.cancel,render:bI[bm],handler:{fn:bI._handleCancelEvent,context:bI}});bl.each(bl.SchedulerEventRepeat,function(bN,bM){bI[aX].append(bl.Node.create(M).val(bN.value||bM).setContent(bN.description));});bK.on("hide",bl.bind(bI._onOverlayHide,bI));bK.on("show",bl.bind(bI._onOverlayShow,bI));bL.on("submit",bl.bind(bI._onSubmitForm,bI));bJ.addClass(l);},_defCancelEventFn:function(bI){var A=this;A.hideOverlay();},_defEditEventFn:function(bI){var A=this;A.hideOverlay();A.get(k).syncEventsUI();},_defSaveEventFn:function(bJ){var A=this;var bI=A.get(k);bI.addEvent(bJ.newSchedulerEvent);A.hideOverlay();bI.syncEventsUI();},_getWhenFormattedDt:function(){var bJ=this;var bI=bJ.get(aA);var bL=(bJ.get(av)||bJ);var bN=bL.get(Y);var bM=bL.get(k);var A=bL.get(bo);var bK=(bM.get(a1).get(K)?Q.toIsoTimeString:Q.toUsTimeString);return[bL._formatDate(A,bI),bK(A),a4,bK(bN)].join(G);},_handleEditEvent:function(bI){var A=this;A.fire(F,{newSchedulerEvent:A.getEventCopy()});bI.preventDefault();},_handleSaveEvent:function(bI){var A=this;A.fire(bb,{newSchedulerEvent:A.getEventCopy()});bI.preventDefault();},_handleCancelEvent:function(bI){var A=this;A.fire(B);bI.preventDefault();},_onClickSchedulerEvent:function(bJ){var A=this;var bI=bJ.currentTarget.getData(Z);if(bI){if(!A.overlay){A._initOverlay();}A.set(av,bI);A.overlay.set(q,bJ.currentTarget);A.get(bH).remove();A.showOverlay();}},_onOverlayHide:function(bJ){var A=this;var bI=A.get(bH);if(A.overlay){A.set(av,null);A.overlay.set(q,bI);}bI.remove();},_onOverlayShow:function(bJ){var bI=this;var bK=bI.overlayEditBtn;var A=bI.overlaySaveBtn;if(bI.get(av)){bK.show();A.hide();}else{bK.hide();A.show();}bI.loadFormValues();},_onSubmitForm:function(bI){var A=this;if(A.get(av)){A._handleEditEvent(bI);}else{A._handleSaveEvent(bI);}}}});bl.SchedulerEventRecorder=br;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(m){return(m instanceof d.SchedulerEvent);},a="color",l="events",h="pallete",e="scheduler-calendar",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var n=this;var o=n.get(h);var m=Math.ceil(Math.random()*o.length)-1;return o[m];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var m=this;m.after("colorChange",m._afterColorChange);m.after("eventsChange",m._afterEventsChange);m.on("visibleChange",m._onVisibleChange);m._uiSetVisible(m.get(k));m._uiSetEvents(m.get(l));},syncEventsColor:function(n){var m=this;d.Array.each(n||m.get(l),function(o){o.set(a,m.get(a));});},_afterColorChange:function(n){var m=this;m.syncEventsColor(m.get(l));},_afterEventsChange:function(n){var m=this;m._uiSetEvents(n.newVal);},_onVisibleChange:function(n){var m=this;m._uiSetVisible(n.newVal);},_uiSetEvents:function(n){var m=this;m.syncEventsColor(n);},_uiSetVisible:function(n){var m=this;m.eachEvent(function(o){o.set(k,n);});}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:false});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:true,use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"]});