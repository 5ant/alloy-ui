AUI.add("aui-scheduler-base",function(AK){var w=AK.Lang,Ah=w.isString,g=w.isObject,C=w.isArray,G=w.isDate,p=w.isNumber,o=function(A){return(A instanceof AK.Scheduler);},Y=function(A){return(A instanceof AK.SchedulerView);},AH=function(A){return(A instanceof AK.SchedulerEvent);},a=function(A){return(AK.SchedulerCalendar&&(A instanceof AK.SchedulerCalendar));},L=AK.DataType.DateMath,AD=AK.WidgetStdMod,Af="-",AB=".",T="",U=" ",W="scheduler-base",AQ="data-view-name",m="activeView",S="boundingBox",Ag="clearfix",l="controls",AS="controlsNode",AV="current",AJ="currentDate",AF="currentDateNode",AR="date",AI="dateFormat",Ab="day",AP="endDate",Ai="events",i="firstDayOfWeek",An="hd",Ae="headerNode",Q="helper",z="icon",N="iconNextNode",Aa="iconPrevNode",Al="locale",I="month",P="name",x="nav",t="navNode",R="next",F="nextDate",Ad="prev",AT="prevDate",Am="rendered",s="scheduler",AW="srcNode",Ak="startDate",j="strings",AY="template",H="today",AL="todayNode",b="triggerNode",e="view",Ao="views",AE="viewsNode",v="week",X="year",AZ="navigationDateFormat",u="eventRecorder",f=AK.ClassNameManager.getClassName,AM=f(Q,Ag),M=f(z),AX=f(W,l),AA=f(W,AV,AR),K=f(W,An),AC=f(W,z,R),h=f(W,z,Ad),Aj=f(W,x),d=f(W,H),AG=f(W,e),V=f(W,Ao),J=f(W,e,T),Z=f(W,e,Ab),B=f(W,e,I),D=f(W,e,v),AO=f(W,e,X),k=f(s,e,T),AU='<div class="'+AX+'"></div>',c='<div class="'+AA+'"></div>',E='<div class="'+K+'"></div>',Ap='<a href="#" class="'+[M,AC].join(U)+'">Next</a>',AN='<a href="#" class="'+[M,h].join(U)+'">Prev</a>',O='<div class="'+Aj+'"></div>',y='<a href="#" class="'+d+'">{today}</a>',Ac='<a href="#" class="'+[AG,J].join(U)+'{name}" data-view-name="{name}">{label}</a>',q='<div class="'+V+'"></div>';var r=function(){};r.ATTRS={events:{value:[],setter:"_setEvents",validator:C}};AK.mix(r.prototype,{addEvent:function(Aq){var A=this;var Ar=A.get(Ai);if(AK.Array.indexOf(Ar,Aq)>-1){AK.Array.removeItem(Ar,Aq);}Ar.push(Aq);A.set(Ai,Ar);},addEvents:function(Aq){var A=this;AK.Array.each(A._normalizeEvents(Aq),AK.bind(A.addEvent,A));},eachEvent:function(Ar){var A=this;var Aq=A.get(Ai);AK.Array.each(Aq,Ar,A);},removeEvent:function(Aq){var A=this;var Ar=A.get(Ai);AK.Array.removeItem(Ar,Aq);A.set(Ai,Ar);},removeEvents:function(Aq){var A=this;AK.Array.each(A._normalizeEvents(Aq),AK.bind(A.removeEvent,A));},_normalizeEvents:function(Ar){var A=this;var Aq=[];Ar=AK.Array(Ar);AK.Array.each(Ar,function(As,At){if(AH(As)){Aq.push(As);}else{if(a(As)){Aq=Aq.concat(A._normalizeEvents(As.get(Ai)));}else{As=new AK.SchedulerEvent(As);Aq.push(As);}}if(o(A)){As.set(s,A);}});return Aq;},_setEvents:function(Aq){var A=this;return A._normalizeEvents(Aq);}});AK.SchedulerEventSupport=r;var n=AK.Component.create({NAME:W,ATTRS:{activeView:{validator:Y},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(Ar){var A=this;var Aq=A.get(m);if(Aq){return Aq.get(AZ);}return Ar;},value:"%A - %d %b %Y",validator:Ah},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:G},firstDayOfWeek:{value:0,validator:p},controlsNode:{valueFn:function(){return AK.Node.create(AU);}},currentDateNode:{valueFn:function(){return AK.Node.create(c);}},headerNode:{valueFn:function(){return AK.Node.create(E);}},iconNextNode:{valueFn:function(){return AK.Node.create(Ap);}},iconPrevNode:{valueFn:function(){return AK.Node.create(AN);}},navNode:{valueFn:function(){return AK.Node.create(O);}},todayNode:{valueFn:function(){return AK.Node.create(this._processTemplate(y));}},viewsNode:{valueFn:function(){return AK.Node.create(q);}}},HTML_PARSER:{controlsNode:AB+AX,currentDateNode:AB+AA,headerNode:AB+K,iconNextNode:AB+AC,iconPrevNode:AB+h,navNode:AB+Aj,todayNode:AB+d,viewsNode:AB+V},UI_ATTRS:[AJ],AUGMENTS:[AK.SchedulerEventSupport,AK.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(AS);A.currentDateNode=A.get(AF);A.iconNextNode=A.get(N);A.iconPrevNode=A.get(Aa);A.navNode=A.get(t);A.schedulerHeaderNode=A.get(Ae);A.todayNode=A.get(AL);A.viewsNode=A.get(AE);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;AK.Array.each(A.get(Ai),function(Aq,Ar){Aq.eachRepeatedEvent(function(At,As){delete At._filtered;});delete Aq._filtered;});},getEventsByDay:function(Aq){var A=this;Aq=L.safeClearTime(Aq);return A._getEvents(Aq,function(Ar){return L.compare(Ar.getClearStartDate(),Aq);});},getIntersectEvents:function(Aq){var A=this;Aq=L.safeClearTime(Aq);return A._getEvents(Aq,function(As){var Ar=As.getClearStartDate();var At=As.getClearEndDate();return(L.compare(Aq,Ar)||L.compare(Aq,At)||L.between(Aq,Ar,At));});},sortEventsByDateAsc:function(Aq){var A=this;Aq.sort(function(Au,As){var At=Au.get(AP);var Ar=As.get(AP);var Aw=Au.get(Ak);var Av=As.get(Ak);if(L.after(Aw,Av)||L.compare(Aw,Av)&&L.before(At,Ar)){return 1;}else{return -1;}});},getViewByName:function(Aq){var A=this;return A.viewStack[Aq];},getStrings:function(){var A=this;return A.get(j);},getString:function(Aq){var A=this;return A.getStrings()[Aq];},renderView:function(Aq){var A=this;if(Aq){Aq.show();if(!Aq.get(Am)){var Ar=Aq.get(P);if(!A.bodyNode){A.setStdModContent(AD.BODY,T);}Aq.render(A.bodyNode);}}},plotViewEvents:function(Aq){var A=this;Aq.plotEvents(A.get(Ai));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(m));},_afterActiveViewChange:function(As){var Aq=this;if(Aq.get(Am)){var Ar=As.newVal;var A=As.prevVal;if(A){A.hide();}Aq.renderView(Ar);}},_afterRender:function(Aq){var A=this;A.renderView(A.get(m));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,AB+AG,A);A.controlsNode.delegate("click",A._onClickPrevIcon,AB+h,A);A.controlsNode.delegate("click",A._onClickNextIcon,AB+AC,A);A.controlsNode.delegate("click",A._onClickToday,AB+d,A);},_createViewTriggerNode:function(Aq){var A=this;
if(!Aq.get(b)){var Ar=Aq.get(P);Aq.set(b,AK.Node.create(AK.substitute(Ac,{name:Ar,label:(A.getString(Ar)||Ar)})));}return Aq.get(b);},_getEvents:function(Aq,As){var A=this;var Ar=A.get(Ai);var At=[];AK.Array.each(Ar,function(Au,Av){if(As.apply(A,[Au])){At.push(Au);}else{if(Au.isRepeatableDate(Aq)){var Aw=Au.repeatByDate(Aq);At.push(Aw);}}});A.sortEventsByDateAsc(At);return At;},_onClickToday:function(Aq){var A=this;A.set(AJ,A.get(m).getToday());Aq.preventDefault();},_onClickNextIcon:function(Aq){var A=this;A.set(AJ,A.get(m).get(F));Aq.preventDefault();},_onClickPrevIcon:function(Aq){var A=this;A.set(AJ,A.get(m).get(AT));Aq.preventDefault();},_onClickViewTrigger:function(Ar){var A=this;var As=Ar.currentTarget;var At=As.attr(AQ);var Aq=A.getViewByName(At);A.set(m,Aq);Ar.preventDefault();},_processTemplate:function(Aq){var A=this;return AK.substitute(Aq,A.getStrings());},_setEventRecorder:function(Aq){var A=this;if(Aq){Aq.set(s,A);}},_setViews:function(Ar){var A=this;var Aq=[];AK.Array.each(Ar,function(As){if(Y(As)&&!As.get(Am)){As.set(s,A);Aq.push(As);A.viewStack[As.get(P)]=As;}});if(!A.get(m)){A.set(m,Ar[0]);}return Aq;},syncStdContent:function(){var A=this;var Aq=A.get(Ao);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);AK.Array.each(Aq,function(Ar){A.viewsNode.append(A._createViewTriggerNode(Ar));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(AM);A.setStdModContent(AD.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(Au){var Ar=this;var Aq=Ar.get(AZ);var A=Ar.get(Al);var At=AK.DataType.Date.format(Au,{format:Aq,locale:A});Ar.currentDateNode.html(At);if(Ar.get(Am)){var As=Ar.get(m);if(As){As._uiSetCurrentDate(Au);}Ar.syncEventsUI();}}}});AK.Scheduler=n;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(B3){var CK=B3.Lang,Cb=CK.isObject,Bs=CK.isString,Au=CK.isBoolean,Ag=CK.isNumber,BE=function(A){return A==0?0:(A<0?-1:1);},Ak=function(A,AM){return Math.max(Math.abs(A),AM)*BE(A);},Bf=function(A){return parseFloat(A)||0;},Bh=function(AM,A){return Math.round(AM/A)*A;},AR=B3.DataType.DateMath,Bz=B3.WidgetStdMod,Al=AR.WEEK_LENGTH,Bj="scheduler-view",Af="scheduler-view-day",B7="scheduler-view-week",CU="scheduler-view-month",Be="activeView",A6="am",V="borderLeftWidth",CB="borderRightWidth",Aq="boundingBox",R="children",BW="childNodes",AG="col",i="colblank",Z="coldata",Ai="colday",B="colgrid",BR="colmonth",w="colspan",N="coltime",CP="columnNode",AX="colDaysNode",B5="colHeaderDaysNode",Ao="container",Am="content",CR="contentBox",AV="createDocumentFragment",BB="currentDate",BX="data",BA="dateFormat",CH="day",u="days",e="delegateConfig",x="div",BJ="division",AB="down",B9="dragNode",Br="duration",Aa="endDate",A2="event",Bx="events",Cd="eventRecorder",T="eventWidth",Ah="first",B8="firstDayOfWeek",A8="grid",Cc="hd",B1="header",A9="headerDateFormat",CY="headerTableNode",Bm="height",Ap="host",Ae="hourHeight",W="icon",AK="isoTime",BF="labelAM",Ac="labelPM",Ar="left",AY="locale",AC="marker",A4="markercell",Ax="markercellsNode",Bk="markercellNode",l="markers",Bc="month",A7="monthContainerNode",Ba="navigationDateFormat",An="next",Bi="nextDate",Ce="node",AJ="nomonth",AS="noscroll",B0="offsetHeight",k="offsetTop",B2="offsetWidth",CF="ownerDocument",B4="pad",CM="parentEvent",r="parentNode",AO="pm",AA="prevDate",BQ="proxy",AH="px",As="rendered",By="repeated",Ay="right",BO="row",S="scheduler",Ad="scheduler-event",y="scrollable",t="shim",B6="startDate",At="table",CS="tableColNode",K="tableDataNode",d="tableGridNode",BU="tableNode",Bt="tableTimeNode",BS="tbody",F="td",BL="time",AI="timesNode",H="title",AL="today",BP="top",CZ="tr",a="trigger",CN="week",BY="width",Bg="-",L="a",Bl=".",Bd="",BZ="%",v=" ",f=B3.ClassNameManager.getClassName,BK=f(Bj,AS),AD=f(Bj,y);var Aw=B3.Component.create({NAME:Bj,ATTRS:{bodyContent:{value:Bd},height:{value:600},isoTime:{value:false,validator:Au},name:{value:Bd,validator:Bs},navigationDateFormat:{value:"%A - %d %b %Y",validator:Bs},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:Au},triggerNode:{setter:B3.one},visible:{value:false}},BIND_UI_ATTRS:[y],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);Cf.set(BB,AM);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return AR.clearTime(new Date());},limitDate:function(AM,Cf){var A=this;if(AR.after(AM,Cf)){AM=AR.clone(Cf);}return AM;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(Cf){var A=this;var AM=A.get(S);A.adjustCurrentDate();A._uiSetScrollable(A.get(y));},_setScheduler:function(Cf){var A=this;var AM=A.get(S);if(AM){A.removeTarget(AM);}if(Cf){A.addTarget(Cf);Cf.after("eventsChange",B3.bind(A.flushViewCache,A));}return Cf;},_uiSetScrollable:function(Cf){var A=this;var AM=A.bodyNode;if(AM){AM.toggleClass(AD,Cf);AM.toggleClass(BK,!Cf);}},_uiSetVisible:function(AM){var A=this;Aw.superclass._uiSetVisible.apply(this,arguments);if(AM&&A.get(As)){A.adjustCurrentDate();}}}});B3.SchedulerView=B3.Base.create(Bj,Aw,[B3.WidgetStdMod]);var o=function(A,AM){return function(Cg){var Cf=Cg.all(A);return(Cf.size()>=AM)?Cf:null;};},Aj=f(Ad),Bo=f(Ad,BQ),b=f(Bj,Z),D=f(Bj,B),q=f(S,AL),AQ=f(S,AL,Cc),CC=f(Bj,A8),CD=f(Bj,A8,Ao),CG=f(Bj,A4),m=f(Bj,l),BI=f(Bj,AC,BJ),BV=f(Bj,At),CJ=f(Bj,CH,B1,At),U=f(Bj,CH,B1,CH),BH=f(Bj,CH,B1,CH,B4,Ay),Bq=f(Bj,CH,B1,CH,Ah),A1=f(Bj,CH,B1,AG),CW=f(Bj,At,AG),Ab=f(Bj,At,AG,t),p=f(Bj,At,i),h=f(Bj,At,Ai),O=f(Bj,At,Ai,B1),CO=f(Bj,At,N),BN=f(Bj,At,BL),AE='<div class="'+CG+'">'+'<div class="'+BI+'"></div>'+"</div>",AU='<table class="'+BV+'">'+"<tbody>"+'<tr class="'+D+'" height="1">'+'<td height="0" class="'+[CW,p].join(v)+'"></td>'+'<td class="'+CD+'" colspan="1">'+'<div class="'+CC+'">'+'<div class="'+m+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+b+'">'+'<td class="'+[CW,CO].join(v)+'"></td>'+"</tr>"+"</tbody>"+"</table>",BD='<td class="'+[CW,h].join(v)+'">'+'<div class="'+Ab+'"></div>'+"</td>",J='<div class="'+BN+'">{hour}</div>',AW='<table class="'+CJ+'">'+"<tbody>"+'<tr class="'+A1+'"></tr>'+"</tbody>"+"</table>",BG='<th class="'+U+'"><a href="#">&nbsp;</a></th>',AT='<td class="'+[U,Bq].join(v)+'"></td>',X='<th class="'+[U,BH].join(v)+'">&nbsp;</th>';
var CX=B3.Component.create({NAME:Af,ATTRS:{bodyContent:{value:Bd},days:{value:1,validator:Ag},delegateConfig:{value:{},setter:function(AM){var A=this;return B3.merge({bubbleTargets:A,container:A.get(Aq),nodes:Bl+Aj},AM||{});},validator:Cb},headerDateFormat:{value:"%a %d/%m",validator:Bs},name:{value:CH},hourHeight:{value:52,validator:Ag},eventWidth:{value:95,validator:Ag},headerTableNode:{valueFn:function(){return B3.Node.create(AW);}},tableNode:{valueFn:function(){return B3.Node.create(AU);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:o(Bl+U,2),colDaysNode:o(Bl+h,1),markercellsNode:o(Bl+CG,24),timesNode:o(Bl+BN,24),headerTableNode:Bl+CJ,tableNode:Bl+BV},EXTENDS:B3.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(AX);A.colHeaderDaysNode=A.get(B5);A.headerTableNode=A.get(CY);A.markercellsNode=A.get(Ax);A.tableNode=A.get(BU);A.timesNode=A.get(AI);A.colShimNodes=A.colDaysNode.all(Bl+Ab);A.colDataNode=A.tableNode.one(Bl+b);A.colTimeNode=A.tableNode.one(Bl+CO);A.dayHeaderColNode=A.headerTableNode.one(Bl+A1);A.gridContainer=A.tableNode.one(Bl+CD);A.markersNode=A.tableNode.one(Bl+m);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",B3.bind(A._onClickDaysHeader,A),Bl+U);A.colDataNode.delegate("mousedown",B3.bind(A._onMouseDownTableCol,A),Bl+CW);A.colDataNode.delegate("mouseup",B3.bind(A._onMouseUpTableCol,A),Bl+CW);A.colDataNode.delegate("mousemove",B3.bind(A._onMouseMoveTableCol,A),Bl+CW);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;CX.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(w,A.get(u));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(Bz.BODY,A.tableNode.getDOM());A.setStdModContent(Bz.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(Cg){var AM=this;var A=AM.get(Ae);var Cf=Cg.getHours();var Ch=Cg.getMinutes();var Ci=Cg.getSeconds();return((Cf*60)+Ch+(Ci/60))*(A/60);},calculateHoursByTop:function(Ch){var AM=this;var A=AM.get(Ae);var Cj=Bf((Ch/A).toFixed(2));var Ci=0;var Cg=Math.floor((Cj*100)%100*0.6);var Cf=Math.floor(Cj);return[Cf,Cg,Ci];},getNextDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.add(AM,AR.DAY,1);},getPrevDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.subtract(AM,AR.DAY,1);},getColumnByDate:function(Cf){var A=this;var Cg=A.get(S);var AM=AR.safeClearTime(Cg.get(BB));var Ch=AR.getDayOffset(AR.safeClearTime(Cf),AM);return A.colDaysNode.item(Ch);},getDateByColumn:function(Cf){var A=this;var Cg=A.get(S);var AM=AR.safeClearTime(Cg.get(BB));return AR.add(AM,AR.DAY,Cf);},plotEvents:function(Cf){var A=this;var AM=A.get(S);A.colShimNodes.each(function(Cj,Ci){var Ch=A.getDateByColumn(Ci);var Cg=AM.getEventsByDay(Ch);Cj.empty();B3.Array.each(Cg,function(Ck,Cl){if(!Ck.isDayOverlapEvent()){Cj.append(Ck.get(Ce));Ck.set(CP,Cj.get(r));A.syncEventTopUI(Ck);A.syncEventHeightUI(Ck);}});A.syncEventsIntersectionUI(Cg);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(Cg,Cf){var AM=A.getDateByColumn(Cf);Cg.toggleClass(q,AR.isToday(AM));});},syncDaysHeaderUI:function(){var Cf=this;var Ch=Cf.get(S);var Cg=Ch.get(BB);var AM=Cf.get(A9);var A=Cf.get(AY);Cf.colHeaderDaysNode.all(L).each(function(Ck,Cj){var Ci=AR.add(Cg,AR.DAY,Cj);var Cl=B3.DataType.Date.format(Ci,{format:AM,locale:A});Ck.toggleClass(AQ,AR.isToday(Ci));Ck.html(Cl);});},syncEventsIntersectionUI:function(AM){var A=this;var Cf=A.get(S);var Cg=A.get(T);Cf.flushEvents();B3.Array.each(AM,function(Ci,Cj){var Cl=A.findEventIntersections(Ci,AM);var Ck=Cl.length;var Ch=(Cg/Ck);B3.Array.each(Cl,function(Cn,Co){var Cm=Cn.get(Ce);var Cq=Ch*Co;var Cp=Ch*1.7;if(Co==(Ck-1)){Cp=Cg-Cq;}Cm.setStyle(BY,Cp+BZ);Cm.setStyle(Ar,Cq+BZ);var Cr=Cm.get(r);if(Cr){Cr.insert(Cm,Co);}Cn._filtered=true;});});},syncEventHeightUI:function(Cf){var AM=this;var A=AM.get(Ae);var Ch=AM.calculateTopByDate(Cf.get(B6));var Cg=AM.calculateTopByDate(Cf.get(Aa));Cf.get(Ce).set(B0,Math.max(Cg-Ch,A/2));},syncEventRecorderUI:function(Cg){var A=this;var Cf=A.get(S);var Ch=Cf.get(Cd);var AM=Ch.get(Ce);if(Cg&&!AM.inDoc()){Cg.append(AM);}A.syncEventTopUI(Ch);A.syncEventHeightUI(Ch);},syncEventTopUI:function(Cf){var AM=this;var A=Cf.get(Ce);var Cg=AM.calculateTopByDate(Cf.get(B6));A.setStyle(BP,Cg+AH);},findEventIntersections:function(AM,Cf){var A=this;var Cg=[];B3.Array.each(Cf,function(Ci,Ch){if(!AM._filtered&&!Ci.isDayOverlapEvent()&&AM.intersectHours(Ci)){Cg.push(Ci);}});return Cg;},_createEvents:function(){var A=this;var AM=function(Cf,Cg){A.publish(Cf,{defaultFn:Cg,queuable:false,emitFacade:true,bubbles:true});};},_dragTickAlignX:function(AM){var Cn=this;var Co=AM.target.get(Ap);var Cp=Cn._getColumnRefWidth();var Ch=Co.get(Ce);var Ck=Cn.proxyEvt;var Cl=Ch.getData(Ad);var Cm=(Co.actXY[0]-Cn.bodyNode.getX()-Cn.colTimeNode.get(B2));var Cf=Math.floor(Cm/Cp);var Cj=Cn.colDaysNode.item(Cf);var Ci=Cn.getDateByColumn(Cf);var A=AR.clone(Ci);var Cg=AR.clone(Ci);AR.copyHours(Cg,Ck.get(Aa));AR.copyHours(A,Ck.get(B6));Ck.set(Aa,Cg);Ck.set(B6,A);},_dragTickAlignY:function(Cf){var Ck=this;var Cl=Cf.target.get(Ap);var Ch=Cl.get(Ce);var Ci=Ck.proxyEvt;var Cj=Ch.getData(Ad);var AM=AR.clone(Ci.get(B6));var A=Ck.calculateHoursByTop(Bf(Cl.get(B9).getComputedStyle(BP)));Ck._setTickedHours(AM,A);var Cg=AR.clone(AM);Ci.set(Aa,AR.add(Cg,AR.MINUTES,Ck._currentEvtDuration));Ci.set(B6,AM);Ci.syncNodeTitleUI();},_getXYDelta:function(AM){var A=this;var Cg=AM.currentTarget;var Cf=Cg.getXY(),Ch=[AM.pageX,AM.pageY];
return B3.Array.map(Cf,function(Cj,Ci){return(Ch[Ci]-Cj);});},_getTickY:function(){var A=this;return Bh(Math.ceil(A.get(Ae)/2),10);},_getColumnRefWidth:function(){var A=this;var AM=A.colDaysNode.item(0);return Bf(AM.getStyle(BY))-Bf(AM.getStyle(CB))-Bf(AM.getStyle(V));},_setupDragDrop:function(){var Cf=this;var Cg=Cf.get(Aq);if(!Cf.proxyEvt){var Ch=Cf.get(S);Cf.proxyEvt=new B3.SchedulerEvent({scheduler:Ch});Cf.proxyEvt.removeTarget(Ch);Cf.proxyEvt.get(Ce).addClass(Bo);}if(!Cf.delegate){Cf.delegate=new B3.DD.Delegate(Cf.get(e));}var AM=Cf.delegate.dd;var Ci=Cf.proxyEvt;var Cj=Cf.get(Ae)/2;var A=Cf._getColumnRefWidth();AM.unplug(B3.Plugin.DDConstrained);AM.unplug(B3.Plugin.DDNodeScroll);AM.plug(B3.Plugin.DDConstrained,{bubbleTargets:Cf,constrain:Cf.bodyNode,tickX:A,tickY:Cj});AM.plug(B3.Plugin.DDNodeScroll,{node:Cf.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(AM){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(Cg){var A=this;var Cf=A.get(S);if(Cg.target.test(L)){var Ch=Cf.getViewByName(CH);var AM=A.colHeaderDaysNode.indexOf(Cg.currentTarget)-1;if(Ch){Cf.set(BB,A.getDateByColumn(AM));Cf.set(Be,Ch);}}Cg.preventDefault();},_onEventDragEnd:function(A){var Ck=this;var Ch=Ck.get(S);var Cg=Ck.get(Aq);var Cl=Ck.delegate.dd;var Cf=Cl.get(Ce);var Ci=Ck.proxyEvt;var AM=Ci.get(Ce);var Cj=Cf.getData(Ad);Cf.show();AM.hide();Cg.selectable();Cj.copyDates(Ci);Ch.syncEventsUI();},_onEventDragStart:function(A){var Ck=this;var Ch=Ck.get(Aq);var Cl=Ck.delegate.dd;var Cg=Cl.get(Ce);var Ci=Ck.proxyEvt;var Cj=Cg.getData(Ad);var Cf=Bf(Cg.getComputedStyle(Ar));if(Cf){Cl.deltaXY[0]=(Cf+Bf(Cl.deltaXY[0]));}if(Cj){var Cm=Cj.get(CP);var AM=Ci.get(Ce);Cl.set(B9,AM);Cm.append(AM);Ci.copyPropagateAttrValues(Cj);Ck.syncEventTopUI(Ci);Ck.syncEventHeightUI(Ci);AM.show();Ck._currentEvtDuration=Cj.getMinutesDuration();}Cg.hide();Ch.unselectable();},_onMouseDownTableCol:function(Cg){var A=this;var Cf=A.get(S);var Ch=Cf.get(Cd);if(Ch){Ch.hideOverlay();if(Cg.target.test(Bl+Ab)){var AM=A.colDaysNode.indexOf(Cg.currentTarget);A.dragXY=A.startXY=A._getXYDelta(Cg);A.ddStartDate=A.getDateByColumn(AM);A.ddEndDate=AR.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=AR.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);Ch.set(B6,A.ddStartDate);Ch.set(Aa,A.limitDate(Ch.get(Aa),A.ddMaxDate));Cg.halt();}}},_onMouseMoveTableCol:function(Ch){var A=this;var Cg=A.get(S);var Ck=Cg.get(Cd);var Ci=A.ddStartDate;if(Ci){A.dragXY=A._getXYDelta(Ch);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var Cj=AR.getMinutesOffset(A.ddEndDate,Ci);if((A.dragXY[1]-A.startXY[1])>0){Cj=Ak(Cj,Ck.get(Br));}var AM=A.limitDate(AR.add(Ci,AR.MINUTES,Cj),A.ddMaxDate);if(Cj>0){Ck.set(Aa,AM);}else{var Cf=Ck.get(Aa);Ck.set(B6,AM);Ck.set(Aa,Cf);}A.syncEventRecorderUI(Ch.currentTarget);}},_onMouseUpTableCol:function(Cf){var A=this;var AM=A.get(S);var Cg=AM.get(Cd);if(Cg){if(A.ddStartDate){A.syncEventRecorderUI(Cf.currentTarget);Cg.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(AM,Cf){var A=this;AM.setHours(Cf[0],Bh(Cf[1],A._getTickY()),Cf[2]);},_valueColDaysNode:function(){var A=this;var Cf=A.get(u);var AM=[];while(Cf--){AM.push(BD);}return B3.NodeList.create(AM.join(Bd));},_valueColHeaderDaysNode:function(){var A=this;var Cf=A.get(u);var AM=[];AM.push(AT);while(Cf--){AM.push(BG);}AM.push(X);return B3.NodeList.create(AM.join(Bd));},_valueMarkercellsNode:function(){var A=this;var AM=[];for(var Cf=0;Cf<=23;Cf++){AM.push(AE);}return B3.NodeList.create(AM.join(Bd));},_valueTimesNode:function(){var A=this;var Cg=A.get(AK);var Cf=[];for(var AM=0;AM<=23;AM++){Cf.push(B3.substitute(J,{hour:Cg?AR.toIsoTimeString(AM):AR.toUsTimeString(AM,false,true)}));}return B3.NodeList.create(Cf.join(Bd));}}});B3.SchedulerDayView=CX;var AN=B3.Component.create({NAME:B7,ATTRS:{bodyContent:{value:Bd},days:{value:7},name:{value:CN}},EXTENDS:B3.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var Cg=A.get(S);var AM=Cg.get(BB);var Cf=Cg.get(B8);Cg.set(BB,AR.getFirstDayOfWeek(AM,Cf));},getNextDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);var Cg=A._firstDayOfWeek(AM);return AR.add(Cg,AR.WEEK,1);},getPrevDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);var Cg=A._firstDayOfWeek(AM);return AR.subtract(Cg,AR.WEEK,1);},getToday:function(){var A=this;var AM=AN.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(AM);},_firstDayOfWeek:function(Cf){var A=this;var Cg=A.get(S);var AM=Cg.get(B8);return AR.getFirstDayOfWeek(Cf,AM);}}});B3.SchedulerWeekView=AN;var I=f(Bj,Bc,Ao),A3=f(Bj,Bc,B1,AG),Y=f(Bj,Bc,B1,CH),CT=f(Bj,Bc,B1,At),Bv=f(Bj,Bc,BO),AP=f(Bj,Bc,BO,Ao),G=f(W),M=f(W,"arrowstop-1-l"),CQ=f(W,"arrowstop-1-r"),Bw=f(Bj,Bc,B),C=f(Bj,Bc,B,AL),P=f(Bj,Bc,B,Ah),Bb=f(Bj,Bc,At,BX),Az=f(Bj,Bc,At,BX,Ah),Bu=f(Bj,Bc,At,BX,AG),CA=f(Bj,Bc,At,BX,AG,Ah),A0=f(Bj,Bc,At,BX,AG,AJ),Av=f(Bj,Bc,At,BX,AG,H),s=f(Bj,Bc,At,BX,AG,H,AL),AF=f(Bj,Bc,At,BX,AG,H,Ah),c=f(Bj,Bc,At,BX,AG,H,An),CV=f(Bj,Bc,At,BX,AG,H,AB),BM=f(Bj,Bc,At,BX,A2),E=f(Bj,Bc,At,BX,A2,Ar),Bn=f(Bj,Bc,At,BX,A2,Ay),Q=f(Bj,Bc,At,BX,A2,By),BC=f(Bj,Bc,At,A8),CL=f(Bj,Bc,At,A8,Ah),Ca=f(Bj,At,BR,B1),g='<table class="'+CT+'">'+"<tbody>"+'<tr class="'+A3+'"></tr>'+"</tbody>"+"</table>",n='<th class="'+Y+'"><div>&nbsp;</div></th>',CI='<div class="'+I+'">'+'<div class="'+AP+'">'+'<div class="'+Bv+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+Bv+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",BT='<table cellspacing="0" cellpadding="0" class="'+BC+'">'+"<tbody>"+"<tr>"+'<td class="'+[Bw,P].join(v)+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+'<td class="'+Bw+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",Bp='<table cellspacing="0" cellpadding="0" class="'+Bb+'">'+"<tbody></tbody>"+"</table>",CE="<tr></tr>",A5='<td class="'+Bu+'"><div></div></td>',z='<span class="'+[G,M].join(v)+'"></span>',j='<span class="'+[G,CQ].join(v)+'"></span>';
var AZ=B3.Component.create({NAME:CU,ATTRS:{bodyContent:{value:Bd},name:{value:Bc},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return B3.Node.create(CI);}},headerTableNode:{valueFn:function(){return B3.Node.create(g);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:o(Bl+BC,7),colHeaderDaysNode:o(Bl+Y,7),monthContainerNode:Bl+I,headerTableNode:Bl+CT},EXTENDS:B3.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var AM=A.get(S);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(B5);A.headerTableNode=A.get(CY);A.monthContainerNode=A.get(A7);A.tableGridNode=A.get(d);A.dayHeaderColNode=A.headerTableNode.one(Bl+A3);A.monthRows=A.monthContainerNode.all(Bl+Bv);A.tableGridCols=A.tableGridNode.all(F);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(Cg,Cf){var AM=A.tableGridNode.item(Cf);Cg.append(AM.toggleClass(CL,(Cf==0)));});},buildEventsTable:function(AM,Cj){var Cp=this;var Cm=5;var Cg=AR.clearTime(Cp._findCurrentMonthEnd());var Co=AR.clearTime(Cp._findCurrentMonthStart());var Cl=String(Co.getTime()).concat(AM.getTime()).concat(Cj.getTime());var Ck=Cp.evtDataTableStack[Cl];if(!Ck){Ck=B3.Node.create(Bp);var Cn=Ck.one(BS);var Ch=B3.Node.create(CE);Cp.loopDates(AM,Cj,function(Cr,Cq){var Cs=B3.Node.create(A5);Cs.addClass(Av).toggleClass(AF,(Cq==0)).toggleClass(s,AR.isToday(Cr)).toggleClass(c,AR.isToday(AR.subtract(Cr,AR.DAY,1))).toggleClass(CV,AR.isToday(AR.subtract(Cr,AR.WEEK,1)));if(AR.before(Cr,Co)||AR.after(Cr,Cg)){Cs.addClass(A0);}Ch.append(Cs.setContent(Cr.getDate()));});Cn.append(Ch);for(var A=0;A<Cm;A++){var Ci=0;var Cf=B3.Node.create(CE);Cp.loopDates(AM,Cj,function(Cv,Ct){if(Ci<=Ct){var Cu=Cp.getIntersectEvents(Cv),Cr=Cu[A];var Cw=B3.Node.create(A5);if(Cr){var Cq=Cw.one(x);var Cs=Cp._getEvtSplitInfo(Cr,AM,Cj);Cw.attr(w,Cs.colspan);Cq.addClass(BM).setContent(Cp._getEvtLabel(Cr));if(Cs.left){Cq.addClass(E).prepend(z);}if(Cs.right){Cq.addClass(Bn).append(j);}if(Cr.get(CM)){Cq.addClass(Q);}Ci+=Cs.colspan;}else{Ci++;}Cf.append(Cw);}});Cn.append(Cf);}Cp.evtDataTableStack[Cl]=Ck;}return Ck;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(AM){var A=this;var Cg=A.get(S);var Cf=String(AM.getTime());if(!A.evtDateStack[Cf]){A.evtDateStack[Cf]=Cg.getIntersectEvents(AM);}return A.evtDateStack[Cf];},loopDates:function(A,Cg,Cj,Ck,Ci){var Cl=this;var AM=AR.clone(A);var Cf=Cg.getTime();for(var Ch=0;AM.getTime()<=Cf;Ch++){Cj.apply(Cl,[AM,Ch]);AM=AR.add(AM,(Ck||AR.DAY),(Ci||1));}},plotEvents:function(){var AM=this;var Cf=AM._findCurrentMonthStart();var A=AR.safeClearTime(AM._findFirstDayOfWeek(Cf));AM.bodyNode.all(Bl+Bb).remove();AM.monthRows.each(function(Cj,Ch){var Cg=AR.add(A,AR.WEEK,Ch);var Ck=AR.add(Cg,AR.DAY,Al-1);var Ci=AM.buildEventsTable(Cg,Ck);if(Ch==0){Ci.addClass(Az);}Cj.append(Ci);});},syncStdContent:function(){var A=this;A.setStdModContent(Bz.BODY,A.monthContainerNode.getDOM());A.setStdModContent(Bz.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var Cl=this;var Cf=Cl.getToday();var AM=Cl.get(S);Cl.tableGridCols.removeClass(C);if(AR.isSameMonth(Cf,AM.get(BB))){var A=AM.get(B8);var Cf=Cl.getToday();var Ch=Cl._findCurrentMonthStart();var Cj=Cl._findFirstDayOfWeek(Cf);var Cg=AR.getWeekNumber(Cf,A)-AR.getWeekNumber(Ch,A);var Ck=(Cf.getDate()-Cj.getDate());var Ci=Cl.tableGridNode.item(Cg).all(F).item(Ck);if(Ci){Ci.addClass(C);}}},adjustCurrentDate:function(){var A=this;var AM=A.get(S);AM.set(BB,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.add(AM,AR.MONTH,1);},getPrevDate:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.subtract(AM,AR.MONTH,1);},syncDaysHeaderUI:function(){var Cf=this;var Ci=Cf.get(S);var Cg=Ci.get(BB);var AM=Cf.get(A9);var A=Cf.get(AY);var Ch=Cf._findFirstDayOfWeek(Cg);Cf.colHeaderDaysNode.all(x).each(function(Cl,Ck){var Cj=AR.add(Ch,AR.DAY,Ck);var Cm=B3.DataType.Date.format(Cj,{format:AM,locale:A});Cl.html(Cm);});},_findCurrentMonthEnd:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.findMonthEnd(AM);},_findCurrentMonthStart:function(){var A=this;var Cf=A.get(S);var AM=Cf.get(BB);return AR.findMonthStart(AM);},_findFirstDayOfWeek:function(Cf){var A=this;var Cg=A.get(S);var AM=Cg.get(B8);return AR.getFirstDayOfWeek(Cf,AM);},_getEvtLabel:function(Cf){var AM=this;var Cg=Cf.get(Aa);var A=Cf.get(B6);return[A.getHours(),Bg,Cg.getHours(),v,Cf.get(Am)].join(Bd);},_getEvtSplitInfo:function(Ck,A,Ci){var Cl=this;var AM=Ck.getClearStartDate();var Cj=Ck.getClearEndDate();var Ch=Ck.getDaysDuration();var Cg={};var Cf=1;if(AR.after(AM,A)){Cf=Math.min(Ch,Math.abs(AR.getDayOffset(Ci,AM))+1);if(Cf>1){Cg.right=true;}}else{Cf=Math.abs(AR.getDayOffset(Cj,A)+1);if(Cf>1){Cg.left=true;}}Cg.colspan=Math.min(Cf,Al);if(Cf>=Al){Cg.right=true;Cg.left=true;}return Cg;},_uiSetCurrentDate:function(AM){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(Al,n);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(Al,BT);},_valueNodeList:function(Cg,Cf){var A=this;var AM=[];while(Cg--){AM.push(Cf);}return B3.NodeList.create(AM.join(Bd));}}});B3.SchedulerMonthView=AZ;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","substitute","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(AZ){var AI=AZ.Lang,BA=AI.isString,I=AI.isDate,A0=AI.isFunction,n=AI.isObject,A2=AI.isBoolean,x=AI.isNumber,Ar=AZ.ColorUtil,O=AZ.DataType.DateMath,Ax=AZ.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),A7="-",Z="&ndash;",AP=".",U="",V=" ",R="_",Ae="_propagateSet",s="activeView",AX="borderStyle",BJ="borderWidth",o="Change",Aw="color",An="colorBrightnessFactor",A5="colorSaturationFactor",AV="content",AD="contentNode",At="duration",Ah="endDate",BB="events",AL="hidden",Av="id",Ap="isoTime",BI="locale",S="node",L="overlay",Ab="parentEvent",BM="recorder",Af="repeat",A9="repeated",r="repeatedEvents",AC="scheduler",AN="scheduler-event",AO="scheduler-event-recorder",BF="startDate",Az="template",Am="title",H="titleDateFormat",l="titleNode",AJ="visible",G="%H:%M",Ay="%I:%M",j=AZ.ClassNameManager.getClassName,W=j(AN),Ai=j(AN,AV),e=j(AN,AL),AK=j(AN,BM),AR=j(AN,A9),g=j(AN,Am),Ac='<div class="'+W+'">'+'<div class="'+g+'"></div>'+'<div class="'+Ai+'"></div>'+"</div>";
var t=AZ.Component.create({NAME:AN,ATTRS:{borderStyle:{value:"solid",validator:BA},borderWidth:{value:"1px",validator:BA},colorBrightnessFactor:{value:0.75,validator:x},colorSaturationFactor:{value:1.5,validator:x},content:{value:"(no title)",validator:BA},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:BA},titleDateFormat:{getter:"_getTitleDateFormat",validator:BA},endDate:{valueFn:function(){var A=O.clone(this.get(BF));A.setHours(A.getHours()+1);return A;},validator:I},columnNode:{setter:AZ.one},node:{valueFn:function(){return AZ.Node.create(Ac).setData(AN,this);},setter:AZ.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:I},visible:{value:true,validator:A2}},EXTENDS:AZ.Base,PROPAGATE_ATTRS:[BF,Ah,AV,Aw,An,A5,AX,BJ,H,AJ],prototype:{eventStack:null,initializer:function(){var A=this;var BC=A.get(S);A.eventStack={};A.nodeStack={};AZ.Array.each(AZ.SchedulerEvent.PROPAGATE_ATTRS,function(BD){A.after(BD+o,A._propagateAttrChange);});A.on("visibleChange",A._onVisibleChange);A._uiSetVisible(A.get(AJ));A.contentNode=BC.one(AP+Ai);A.titleNode=BC.one(AP+g);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(BC,BD){BC.destroy();});A.eventStack={};A.get(S).remove(true);},copyDates:function(BC){var A=this;A.set(Ah,O.clone(BC.get(Ah)));A.set(BF,O.clone(BC.get(BF)));},copyPropagateAttrValues:function(BC,BD){var A=this;A.copyDates(BC);AZ.Array.each(AZ.SchedulerEvent.PROPAGATE_ATTRS,function(BO){if(!(BO in (BD||{}))){var BP=BC.get(BO);if(!n(BP)){A.set(BO,BP);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return O.getDayOffset(A.get(Ah),A.get(BF));},getHoursDuration:function(){var A=this;return O.getHoursOffset(A.get(Ah),A.get(BF));},getMinutesDuration:function(){var A=this;return O.getMinutesOffset(A.get(Ah),A.get(BF));},getSecondsDuration:function(){var A=this;return O.getSecondsOffset(A.get(Ah),A.get(BF));},sameEndDate:function(BC){var A=this;return O.compare(A.get(Ah),BC.get(Ah));},sameStartDate:function(BC){var A=this;return O.compare(A.get(BF),BC.get(BF));},isAfter:function(BO){var BD=this;var BC=BD.get(BF);var A=BO.get(BF);return O.after(BC,A);},isBefore:function(BO){var BD=this;var BC=BD.get(BF);var A=BO.get(BF);return O.before(BC,A);},repeatByDate:function(BD){var A=this;var BO=A.uidByDate(BD);if(!A.eventStack[BO]){var BC=O.clone(BD);var BP=O.clone(BD);O.copyHours(BC,A.get(BF));O.copyHours(BP,A.get(Ah));var BQ=new AZ.SchedulerEvent({endDate:BP,parentEvent:A,scheduler:A.get(AC),startDate:BC});BQ.copyPropagateAttrValues(A);A.eventStack[BO]=BQ;}return A.eventStack[BO];},intersects:function(BO){var BD=this;var BP=BD.get(Ah);var BC=BD.get(BF);var A=BO.get(BF);return(BD.sameStartDate(BO)||O.between(A,BC,BP));},intersectHours:function(BD){var BC=this;var BP=BC.get(Ah);var A=BC.get(BF);var BO=O.clone(A);O.copyHours(BO,BD.get(BF));return(O.compare(A,BO)||O.between(BO,A,BP));},isDayOverlapEvent:function(){var A=this;return O.isDayOverlap(A.get(BF),A.get(Ah));},isRepeatableDate:function(BC){var A=this;var BD=A.get(Af);return(BD&&BD.validate(A,BC));},getClearEndDate:function(){var A=this;return O.safeClearTime(A.get(Ah));},getClearStartDate:function(){var A=this;return O.safeClearTime(A.get(BF));},uidByDate:function(BC){var A=this;BC=I(BC)?O.safeClearTime(BC):A.getClearStartDate();return[AN,BC.getTime()].join(R);},setContent:function(BD,BC){var A=this;A._setContent(AD,BD,BC);},setTitle:function(BD,BC){var A=this;A._setContent(l,BD,BC);},syncNodeUI:function(BC){var A=this;A.get(S).toggleClass(AR,!!(A.get(Ab)));A.syncNodeColorUI(BC);A.syncNodeTitleUI(BC);A.syncNodeContentUI(BC);},syncNodeColorUI:function(BC){var A=this;var BD=A.get(S);var BO=A.getBorderColor();if(BD){BD.setStyles({borderWidth:A.get(BJ),borderColor:BO,backgroundColor:A.get(Aw),borderStyle:A.get(AX)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:BO});}if(BC){A.eachRepeatedEvent(function(BP,BQ){BP.syncNodeColorUI();});}},syncNodeContentUI:function(BC){var A=this;A.setContent(A.get(AV),BC);},syncNodeTitleUI:function(BC){var A=this;var BD=A._formatDate(A.get(BF));var BO=A._formatDate(A.get(Ah));A.setTitle([BD,BO].join(V+Z+V),BC);},eachRepeatedEvent:function(BC){var A=this;AZ.each(A.eventStack,BC,A);},unlink:function(){var A=this;if(A.get(Ab)){A.set(Ab,null);}else{A.eachRepeatedEvent(function(BC,BD){BC.unlink();});}A.eventStack={};A.syncNodeUI();},_onVisibleChange:function(BC){var A=this;A._uiSetVisible(BC.newVal);},_propagateAttrChange:function(BO){var A=this;var BD=BO.attrName;var BC=BO.newVal;A.eachRepeatedEvent(function(BP,BQ){var BR=BP[Ae+Ax(BD)];if(BR){BR.apply(A,[BP,BD,BC]);}else{BP.set(BD,BO.newVal);}BP.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,BC,BO){var BD=O.clone(A.get(Ah));O.copyHours(BD,BO);A.set(Ah,BD);},_propagateSetStartDate:function(BC,BD,BO){var A=O.clone(BC.get(BF));O.copyHours(A,BO);BC.set(BF,A);},_setColor:function(BC){var A=this;A.hsbColor=Ar.rgb2hsb(Ar.getRGB(BC));A.borderColor=AZ.clone(A.hsbColor);A.borderColor.b*=A.get(An);A.borderColor.s*=A.get(A5);A.borderColorRGB=Ar.hsb2rgb(A.borderColor);return BC;},_setContent:function(BD,BP,BC){var A=this;var BO=A[BD];if(BO){BO.setContent(BP);}if(BC){A.eachRepeatedEvent(function(BQ,BR){BQ[BD].setContent(BP);});}},_setRepeat:function(BC){var A=this;if(BA(BC)){BC=AZ.SchedulerEventRepeat[BC];}return n(BC)?BC:null;},_setScheduler:function(BD){var A=this;var BC=A.get(AC);if(BC){A.removeTarget(BC);}A.addTarget(BD);return BD;},_formatDate:function(BD,BO){var BC=this;var A=BC.get(BI);BO=BO||BC.get(H);return AZ.DataType.Date.format(BD,{format:BO,locale:A});},_getTitleDateFormat:function(BD){var A=this;if(!BA(BD)){var BC=A.get(AC);BD=(BC&&BC.get(s).get(Ap))?G:Ay;}return BD;},_uiSetVisible:function(BC){var A=this;A.get(S).toggleClass(e,!BC);}}});AZ.SchedulerEvent=t;AZ.SchedulerEventRepeat={daily:{description:"Every day",validate:function(A,BC){return true;
},value:"daily"},monthly:{description:"Every month",validate:function(BC,BD){var BO=BC.get(Ah);var A=BC.get(BF);return(A.getDate()===BD.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,BC){return O.isMonWedOrFri(BC);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,BC){return O.isTueOrThu(BC);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,BC){return O.isWeekDay(BC);},value:"weekDays"},weekly:{description:"Every week",validate:function(BC,BD){var BO=BC.get(Ah);var A=BC.get(BF);return(A.getDay()===BC.getDay());},value:"weekly"}};var s="activeView",BH="bc",BG="bd",AQ="bodyContent",T="boundingBox",Aa="button",F="column",AV="content",AW="dateFormat",AT="dblclick",Au="desc",AS="disk",BL="event",A1="field",Ad="fieldset",AU="form",AE="hint",AH="input",Ap="isoTime",Ag="label",X="layout",Al="menu",h="overlayContextPanel",P="pencil",Af="repeat",Q="row",AC="scheduler",w="select",q="strings",B="tc",k="text",v="when",K="trigger",AF="auiSchedulerEventRecorderWhen",A6="auiSchedulerEventRecorderDesc",As="auiSchedulerEventRecorderSelect",f="auiSchedulerEventRecorderButtonRow",AB="cancel",c="edit",AY="save",A7="-",i="#",BN=j(AN,BM,L),A4=j(AN,BM,AU),Y=j(AU),M=j(X,AV),A8=j(X,Ad),AM=j(X,Ad,BG),AA=j(X,Ad,AV),d=j(X,"w100"),N=j(F),Aj=j(F,AV),C=j(A1),a=j(A1,Al),Ak=j(A1,w),BE=j(A1,AV),E=j(A1,Ag),Aq=j(A1,k),J=j(Aa,Q),A3=j(A1,AH),AG=j(A1,AH,w),b=j(A1,AH,k),Ao=j(AN,BM,Ag,v),D=j(AN,BM,Au),p=j(AN,BM,A1,AE),z=j(AN,BM,Af),y=j(AN,BM,Aa,Q),m="<option></option>",BK='<form id="auiSchedulerEventRecorderForm" class="'+[A4,M,Y].join(V)+'">'+'<div class="'+[A8,d,N].join(V)+'">'+'<div class="'+[AA,Aj].join(V)+'aui-fieldset-content aui-column-content">'+'<div class="'+AM+'">'+'<span class="'+[C,Aq].join(V)+'">'+'<span class="'+BE+'">'+'<label class="'+E+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+Ao+'"></span>'+"</span>"+"</span>"+'<span class="'+[C,Aq].join(V)+'">'+'<span class="'+BE+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[A3,b,D].join(V)+'" size="30" type="text" />'+'<div class="'+p+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[C,a,Ak].join(V)+'">'+'<label class="'+E+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[A3,AG,z].join(V)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[C,J,y].join(V)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var u=AZ.Component.create({NAME:AO,ATTRS:{content:{value:U},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:BA},event:{},strings:{value:{},setter:function(A){return AZ.merge({save:"Save",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",when:"When","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat"},A||{});},validator:n},overlayContextPanel:{value:{},setter:function(BC){var A=this;var BD=AZ.Node.create(AZ.substitute(BK,A.get(q)));return AZ.merge({align:{points:[BH,B]},anim:false,bodyContent:BD,hideOn:AT,trigger:A.get(S),visible:false,zIndex:9999},BC||{});}}},EXTENDS:AZ.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.after("schedulerChange",A._afterSchedulerChange);A.on("startDateChange",A._onStartDateChange);A.get(S).addClass(AK);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(BC){var A=this;var BO=A.overlayDescNode.val();var BD=A.get(BL);if(!BD){BD=new AZ.SchedulerEvent({endDate:A.get(Ah),scheduler:A.get(AC),startDate:A.get(BF)});BD.copyPropagateAttrValues(A,{content:true});}BD.set(Af,A.overlaySelectNode.val());if(BO){BD.set(AV,BO);}return BD;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},loadFormValues:function(){var A=this;var BO=U;var BD=U;var BC=A.get(BL);if(BC){var BP=BC.get(Af);if(BP){BO=BP.value;}BD=BC.get(AV);}A.overlaySelectNode.val(BO);A.overlayWhenNode.setContent(A._getWhenFormattedDt());setTimeout(function(){A.overlayDescNode.val(BD).selectText();},0);},_afterSchedulerChange:function(BO){var A=this;var BD=BO.newVal;var BC=BD.get(T);BC.delegate("click",AZ.bind(A._onClickSchedulerEvent,A),AP+W);},_createEvents:function(){var A=this;var BC=function(BD,BO){A.publish(BD,{defaultFn:BO,queuable:false,emitFacade:true,bubbles:true});};BC(AY,this._defSaveEventFn);BC(c,this._defEditEventFn);BC(AB,this._defCancelEventFn);},_initOverlay:function(){var BC=this;var A=BC.get(q);BC.overlay=new AZ.OverlayContextPanel(BC.get(h));var BO=BC.overlay;var BD=BO.get(T);var BP=BO.get(AQ);BC.overlayButtonRowNode=BP.one(i+f);BC.overlayDescNode=BP.one(i+A6);BC.overlaySelectNode=BP.one(i+As);BC.overlayWhenNode=BP.one(i+AF);BC.overlaySaveBtn=new AZ.ButtonItem({label:A.save,icon:AS,render:BC.overlayButtonRowNode,handler:{fn:BC._handleSaveEvent,context:BC}});BC.overlayEditBtn=new AZ.ButtonItem({label:A.edit,icon:P,render:BC.overlayButtonRowNode,handler:{fn:BC._handleEditEvent,context:BC}});BC.overlayCancelBtn=new AZ.ButtonItem({label:A.cancel,render:BC.overlayButtonRowNode,handler:{fn:BC._handleCancelEvent,context:BC}});AZ.each(AZ.SchedulerEventRepeat,function(BR,BQ){BC.overlaySelectNode.append(AZ.Node.create(m).val(BR.value||BQ).setContent(BR.description));});BO.on("hide",AZ.bind(BC._onOverlayHide,BC));BO.on("show",AZ.bind(BC._onOverlayShow,BC));BP.on("submit",AZ.bind(BC._onSubmitForm,BC));BD.addClass(BN);},_defCancelEventFn:function(BC){var A=this;A.hideOverlay();},_defEditEventFn:function(BC){var A=this;A.hideOverlay();},_defSaveEventFn:function(BD){var A=this;var BC=A.get(AC);BC.addEvent(BD.newSchedulerEvent);A.hideOverlay();BC.syncEventsUI();},_getWhenFormattedDt:function(){var BD=this;var BC=BD.get(AW);var BP=(BD.get(BL)||BD);var BR=BP.get(Ah);var BQ=BP.get(AC);var A=BP.get(BF);
var BO=(BQ.get(s).get(Ap)?O.toIsoTimeString:O.toUsTimeString);return[BP._formatDate(A,BC),BO(A),A7,BO(BR)].join(V);},_handleEditEvent:function(BC){var A=this;A.fire(c,{newSchedulerEvent:A.getEventCopy()});BC.preventDefault();},_handleSaveEvent:function(BC){var A=this;A.fire(AY,{newSchedulerEvent:A.getEventCopy()});BC.preventDefault();},_handleCancelEvent:function(BC){var A=this;A.fire(AB);BC.preventDefault();},_onClickSchedulerEvent:function(BD){var A=this;var BC=BD.currentTarget.getData(AN);if(BC){if(!A.overlay){A._initOverlay();}A.set(BL,BC);A.overlay.set(K,BC.get(S));A.get(S).remove();A.showOverlay();}},_onOverlayHide:function(BD){var A=this;var BC=A.get(S);if(A.overlay){A.set(BL,null);A.overlay.set(K,BC);}BC.remove();},_onOverlayShow:function(BD){var BC=this;var BO=BC.overlayEditBtn;var A=BC.overlaySaveBtn;if(BC.get(BL)){BO.show();A.hide();}else{BO.hide();A.show();}BC.loadFormValues();},_onStartDateChange:function(BC){var A=this;var BD=A.get(At);A.set(Ah,O.add(BC.newVal,O.MINUTES,BD));},_onSubmitForm:function(BC){var A=this;if(A.get(BL)){A._handleEditEvent(BC);}else{A._handleSaveEvent(BC);}}}});AZ.SchedulerEventRecorder=u;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel","substitute"]});AUI.add("aui-scheduler-calendar",function(E){var J=E.Lang,K=J.isArray,D=J.isBoolean,C=J.isString,H=function(A){return(A instanceof E.SchedulerEvent);},F="scheduler-calendar",B="color",M="events",I="pallete",L="visible";var G=E.Component.create({NAME:F,ATTRS:{color:{valueFn:function(){var N=this;var O=N.get(I);var A=Math.ceil(Math.random()*O.length)-1;return O[A];},validator:C},name:{value:"(no name)",validator:C},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:K},visible:{value:true,validator:D}},EXTENDS:E.Base,AUGMENTS:E.SchedulerEventSupport,prototype:{initializer:function(){var A=this;A.after("eventsChange",A._afterEventsChange);A.on("visibleChange",A._onVisibleChange);A._uiSetVisible(A.get(L));A._uiSetEvents(A.get(M));},syncEventsColor:function(N){var A=this;E.Array.each(N||A.get(M),function(O,P){O.set(B,A.get(B));});},_afterEventsChange:function(N){var A=this;A._uiSetEvents(N.newVal);},_onVisibleChange:function(N){var A=this;A._uiSetVisible(N.newVal);},_uiSetEvents:function(N){var A=this;A.syncEventsColor(N);},_uiSetVisible:function(N){var A=this;A.eachEvent(function(O,P){O.set(L,N);});}}});E.SchedulerCalendar=G;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(B){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"],skinnable:true});