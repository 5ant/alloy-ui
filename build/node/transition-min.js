/*
Copyright (c) 2010, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 3.2.0PR1
build: nightly
*/
YUI.add("transition",function(C){var B="transitionend",A=C.Transition;C.mix(A.prototype,{_start:function(){if(A.useNative){this._runNative();}else{this._runTimer();}},_runTimer:function(){this._initAttrs();A._running[C.stamp(this)]=this;this._startTime=new Date();A._startTimer();},_end:function(D){var E=this._duration*1000;if(D){this._runAttrs(E,E);}delete A._running[C.stamp(this)];this._running=false;this._startTime=null;},_runFrame:function(){var E=new Date()-this._startTime,D=(E>=this._totalDuration);this._runAttrs(E);if(D){this._end();}},_runAttrs:function(G){var M=this._runtimeAttr,F=A.behaviors,H=this._node,J=false,D=false,E,I,L,O,N,P,K;for(K in M){if(M[K].to){E=M[K];N=E.duration;L=N;O=G/1000;P=G;I=(K in F&&"set" in F[K])?F[K].set:A.DEFAULT_SETTER;J=(P>=N);if(N===0){N=P=1;}else{if(P>N){P=N;}}if(!this._skip[K]){I(this,K,E.from,E.to,P,N,E.easing,E.unit);if(J){this._skip[K]=true;this._count--;if(L>0){H.fire(B,{elapsedTime:O,propertyName:K});}if(!D&&this._count<=0){D=true;H.fire("transitionsend",{elapsedTime:O});}}}}}},_initAttrs:function(){var P={},Q={},M=this._easing,K={},E=A.behaviors,H=this._config,J,G,D,O,F,I;for(D in H){G=H[D];if(!A._reKeywords.test(D)){J=this._duration*1000;if(typeof G.value!=="undefined"){J=(("duration" in G)?G.duration:this._duration)*1000;M=G.easing||M;G=G.value;}if(typeof G==="function"){G=G.call(this._node,this._node);}F=(D in E&&"get" in E[D])?E[D].get(this,D):A.DEFAULT_GETTER(this,D);var N=A.RE_UNITS.exec(F);var L=A.RE_UNITS.exec(G);F=N?N[1]:F;I=L?L[1]:G;O=L?L[2]:N?N[2]:"";if(!O&&A.RE_DEFAULT_UNIT.test(D)){O=A.DEFAULT_UNIT;}if(!F||!I){return;}if(typeof M==="string"){if(M.indexOf("cubic-bezier")>-1){M=M.substring(13,M.length-1).split(",");}else{if(A.easings[M]){M=A.easings[M];}}}K[D]={from:F,to:I,unit:O,duration:J,easing:M};if(J>this._totalDuration){this._totalDuration=J;}this._count++;}}this._skip={};this._runtimeAttr=K;},_getOffset:function(E){var I=this._node,G=I._node,K=I.getComputedStyle(E),D,H,F,J;if(K==="auto"){D=I.getStyle("position");if(D==="static"||D==="relative"){K=0;}else{if(G.getBoundingClientRect){H=G.offsetParent;F=H.getBoundingClientRect()[E];J=G.getBoundingClientRect()[E];if(E==="left"||E==="top"){K=J-F;}else{K=F-G.getBoundingClientRect()[E];}}}}return K;},destroy:function(){this.detachAll();this._node=null;}},true);C.mix(C.Transition,{RE_DEFAULT_UNIT:/^width|height|top|right|bottom|left|margin.*|padding.*|border.*$/i,DEFAULT_UNIT:"px",intervalTime:20,behaviors:{left:{get:function(E,D){return E._getOffset(D);}}},DEFAULT_SETTER:function(G,H,J,K,M,F,I,L){J=Number(J);K=Number(K);var E=G._node,D=A.cubicBezier(I,M/F);D=J+D[0]*(K-J);if(H in E._node.style||H in C.DOM.CUSTOM_STYLES){L=L||"";E.setStyle(H,D+L);}else{if(E._node.attributes[H]){E.setAttribute(H,D);}else{E.set(H,D);}}},DEFAULT_GETTER:function(F,D){var E=F._node,G="";if(D in E._node.style||D in C.DOM.CUSTOM_STYLES){G=E.getComputedStyle(D);}else{if(E._node.attributes[D]){G=E.getAttribute(D);}else{G=E.get(D);}}return G;},_startTimer:function(){if(!A._timer){A._timer=setInterval(A._runFrame,A.intervalTime);}},_stopTimer:function(){clearInterval(A._timer);A._timer=null;},_runFrame:function(){var D=true,E;for(E in A._running){if(A._running[E]._runFrame){D=false;A._running[E]._runFrame();}}if(D){A._stopTimer();}},cubicBezier:function(X,S){var b=0,L=0,a=X[0],K=X[1],Z=X[2],J=X[3],Y=1,I=0,W=Y-3*Z+3*a-b,V=3*Z-6*a+3*b,U=3*a-3*b,T=b,R=I-3*J+3*K-L,Q=3*J-6*K+3*L,P=3*K-3*L,O=L,N=(((W*S)+V)*S+U)*S+T,M=(((R*S)+Q)*S+P)*S+O;return[N,M];},easings:{ease:[0.25,0,1,0.25],linear:[0,0,1,1],"ease-in":[0.42,0,1,1],"ease-out":[0,0,0.58,1],"ease-in-out":[0.42,0,0.58,1]},_running:{},_timer:null,RE_UNITS:/^(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)*$/},true);A.behaviors.top=A.behaviors.bottom=A.behaviors.right=A.behaviors.left;C.Transition=A;},"3.2.0PR1",{requires:["transition-native","node-style"]});