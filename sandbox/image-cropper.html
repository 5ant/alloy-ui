<!DOCTYPE html>

<html>
<head>
	<script src="../build/aui/aui.js" type="text/javascript"></script>

	<link rel="stylesheet" href="../build/aui-skin-classic/css/aui-skin-classic-all-min.css" type="text/css" media="screen" />

	<style type="text/css" media="screen">
		body {
			font-size: 12px;
			padding: 30px;
		}

		.aui-resize .aui-resize-handle-tr,
		.aui-resize .aui-resize-handle-br,
		.aui-resize .aui-resize-handle-tl,
		.aui-resize .aui-resize-handle-bl,
		.aui-resize .aui-resize-handle-b,
		.aui-resize .aui-resize-handle-t,
		.aui-resize .aui-resize-handle-l,
		.aui-resize .aui-resize-handle-r {
			border: 1px solid #808080;
			background-color: #F2F2F2;
			height: 6px;
			width: 6px;
		}
		
		.aui-resize .aui-resize-handle-b,
		.aui-resize .aui-resize-handle-t {
			left: 45%;
		}
		
		.aui-resize .aui-resize-handle-l,
		.aui-resize .aui-resize-handle-r {
			top: 45%;
		}
		
		.aui-resize-handle-inner {
			background: none;
			height: 6px;
			width: 6px;
		}
		
		#cropper {
			position: absolute;
			top: 100px;
			left: 120px;
			height: 50px;
			width: 50px;
			border: 1px dashed #CCCCCC;
		}
		
		#image {
			opacity: .5;
		}
	</style>
</head>

<body>

<h1>Alloy - Resize Demo</h1>

<img src="assets/cream.jpg" id="image" />

<div id="cropper"></div>

<script type="text/javascript" charset="utf-8">
AUI().ready(
	'aui-resize',
	function(A) {
		var cropEl = A.one('#cropper');
		var imageEl = A.one('#image');
	
		var updateBackground = function(left, top) {
			left = (left - imageEl.getX())  * -1 + 'px';
			top = (top - imageEl.getY()) * -1 + 'px';
			
			var url = 'url(' + imageEl.get('src') + ')';
			var background = url + ' no-repeat ' + left + ' ' + top;
			
			cropEl.setStyle('background', background);
		};

		var cropper = new A.Resize({
			node: cropEl,
			constrain2node: imageEl,
			proxy: true
		});
		
		var drag = new A.DD.Drag({
			node: cropEl
		}).plug(
			A.Plugin.DDConstrained,
			{
				constrain2node: imageEl
			}
		);
		
		cropper.on('resize', function(event){
			var info = event.info;
			
			updateBackground(info.left, info.top);
		});
		
		drag.on('drag:drag', function(event){
			var info = event.info;
			
			updateBackground(info.xy[0], info.xy[1]);
		});
		
		updateBackground(cropEl.getX(), cropEl.getY());
	}
);

</script>

</body>
</html>
