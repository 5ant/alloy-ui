<!DOCTYPE>
<html class="ltr" xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: node   node-base-debug.js  (YUI Library)</title>

	<link rel="stylesheet" href="../build/aui-skin-classic/css/aui-skin-classic-all-min.css" type="text/css" media="screen" />
	<link rel="stylesheet" type="text/css" href="assets/custom.css" />

    <script type="text/javascript" src="assets/api-js"></script>
    <script type="text/javascript" src="assets/ac-js"></script>
</head>

<body>

<div id="wrapper">
	<div class="aui-header">
		<h1>
			<a class="aui-header-text" href="http://alloy.liferay.com/deploy/api" title="Alloy UI">Alloy UI</a>
		</h1>

		<h3>
			node&nbsp; <span class="subtitle">1.0.1</span>
		</h3>

		<p class="breadcrumbs">
			<a href="./index.html" title="Alloy UI">Alloy UI</a>

	            <span class="separator">&gt;</span>

				<a class="modulename" href="./module_node.html" title="node">node</a>

	                

	                 <span class="separator">&gt;</span> <span class="filename">node-base-debug.js (source view)</span> 
		</p>

		<form onsubmit="return false;">
            <div id="propertysearch">
				<span class="aui-field aui-field-text aui-field-labels-inline aui-field-labels-right">
					<span class="aui-field-content">
						<label class="aui-field-label" for="searchinput">Search:</label>
						<input class="aui-field-input aui-field-input-text" id="searchinput" name="searchinput" type="text" value="" />
					</span>
				</span>
                <div id="searchresults">
                    &nbsp;
                </div>
            </div>
        </form>
	</div>

	<div class="aui-body">
		<form action="#" name="classOptions" id="classOptions">
			<fieldset>
				<legend>Filters</legend>

				<span class="aui-field aui-field-checkbox aui-field-choice aui-field-inline">
					<span class="aui-field-content">
						<label class="aui-field-label" for="show_private">
							<input class="aui-field-input aui-field-input-checkbox aui-field-input-choice" id="show_private" name="show_private" type="checkbox" value="" />
						Show Private</label>
					</span>
				</span>

				<span class="aui-field aui-field-checkbox aui-field-choice aui-field-inline">
					<span class="aui-field-content">
						<label class="aui-field-label" for="show_protected">
							<input class="aui-field-input aui-field-input-checkbox aui-field-input-choice" id="show_protected" name="show_protected" type="checkbox" value="" />
						Show Protected</label>
					</span>
				</span>

				<span class="aui-field aui-field-checkbox aui-field-choice aui-field-inline">
					<span class="aui-field-content">
						<label class="aui-field-label" for="show_deprecated">
							<input class="aui-field-input aui-field-input-checkbox aui-field-input-choice" id="show_deprecated" name="show_deprecated" type="checkbox" value="" />
						Show Deprecated</label>
					</span>
				</span>
			</fieldset>
		</form>

		<div class="aui-layout">
			<div class="aui-layout-content">
				<div class="aui-column aui-w25 aui-column-first">
					<div class="aui-column-content aui-column-content-first">

						<div class="yui3-widget aui-list aui-list-modules">
							<div class="yui3-widget-content">
								<div class="yui3-widget-hd aui-list-hd aui-list-modules-hd">
									<span class="yui3-widget-hd-text">Modules</span>
								</div>

								<div class="yui3-widget-bd aui-list-bd">
									<h4 class="aui-module-section-heading">Alloy Modules</h4>
									<ul class="content">



				                                <li class=""><a href="module_aui-autocomplete.html" title="aui-autocomplete">aui-autocomplete</a></li>



				                                <li class=""><a href="module_aui-button-item.html" title="aui-button-item">aui-button-item</a></li>



				                                <li class=""><a href="module_aui-calendar.html" title="aui-calendar">aui-calendar</a></li>



				                                <li class=""><a href="module_aui-char-counter.html" title="aui-char-counter">aui-char-counter</a></li>



				                                <li class=""><a href="module_aui-color-picker.html" title="aui-color-picker">aui-color-picker</a></li>



				                                <li class=""><a href="module_aui-component.html" title="aui-component">aui-component</a></li>



				                                <li class=""><a href="module_aui-datatype.html" title="aui-datatype">aui-datatype</a></li>



				                                <li class=""><a href="module_aui-delayed-task.html" title="aui-delayed-task">aui-delayed-task</a></li>



				                                <li class=""><a href="module_aui-dialog.html" title="aui-dialog">aui-dialog</a></li>



				                                <li class=""><a href="module_aui-editable.html" title="aui-editable">aui-editable</a></li>



				                                <li class=""><a href="module_aui-event.html" title="aui-event">aui-event</a></li>



				                                <li class=""><a href="module_aui-image-viewer.html" title="aui-image-viewer">aui-image-viewer</a></li>



				                                <li class=""><a href="module_aui-io.html" title="aui-io">aui-io</a></li>



				                                <li class=""><a href="module_aui-live-search.html" title="aui-live-search">aui-live-search</a></li>



				                                <li class=""><a href="module_aui-loading-mask.html" title="aui-loading-mask">aui-loading-mask</a></li>



				                                <li class=""><a href="module_aui-nested-list.html" title="aui-nested-list">aui-nested-list</a></li>



				                                <li class=""><a href="module_aui-node.html" title="aui-node">aui-node</a></li>



				                                <li class=""><a href="module_aui-overlay.html" title="aui-overlay">aui-overlay</a></li>



				                                <li class=""><a href="module_aui-paginator.html" title="aui-paginator">aui-paginator</a></li>



				                                <li class=""><a href="module_aui-panel.html" title="aui-panel">aui-panel</a></li>



				                                <li class=""><a href="module_aui-parse-content.html" title="aui-parse-content">aui-parse-content</a></li>



				                                <li class=""><a href="module_aui-portal-layout.html" title="aui-portal-layout">aui-portal-layout</a></li>



				                                <li class=""><a href="module_aui-progressbar.html" title="aui-progressbar">aui-progressbar</a></li>



				                                <li class=""><a href="module_aui-rating.html" title="aui-rating">aui-rating</a></li>



				                                <li class=""><a href="module_aui-resize.html" title="aui-resize">aui-resize</a></li>



				                                <li class=""><a href="module_aui-textboxlist.html" title="aui-textboxlist">aui-textboxlist</a></li>



				                                <li class=""><a href="module_aui-toolbar.html" title="aui-toolbar">aui-toolbar</a></li>



				                                <li class=""><a href="module_aui-tooltip.html" title="aui-tooltip">aui-tooltip</a></li>



				                                <li class=""><a href="module_aui-tree.html" title="aui-tree">aui-tree</a></li>
			                        </ul>

									<h4 class="aui-module-section-heading">YUI Modules</h4>
									<ul class="content">



			                                
													<li class=""><a href="module_align-plugin.html" title="align-plugin">align-plugin</a></li>



			                                
													<li class=""><a href="module_anim.html" title="anim">anim</a></li>



			                                
													<li class=""><a href="module_async-queue.html" title="async-queue">async-queue</a></li>



			                                
													<li class=""><a href="module_attribute.html" title="attribute">attribute</a></li>



			                                
													<li class=""><a href="module_autocomplete.html" title="autocomplete">autocomplete</a></li>



			                                
													<li class=""><a href="module_base.html" title="base">base</a></li>



			                                
													<li class=""><a href="module_cache.html" title="cache">cache</a></li>



			                                
													<li class=""><a href="module_charts.html" title="charts">charts</a></li>



			                                
													<li class=""><a href="module_classnamemanager.html" title="classnamemanager">classnamemanager</a></li>



			                                
													<li class=""><a href="module_collection.html" title="collection">collection</a></li>



			                                
													<li class=""><a href="module_console.html" title="console">console</a></li>



			                                
													<li class=""><a href="module_console-filters.html" title="console-filters">console-filters</a></li>



			                                
													<li class=""><a href="module_cookie.html" title="cookie">cookie</a></li>



			                                
													<li class=""><a href="module_dataschema.html" title="dataschema">dataschema</a></li>



			                                
													<li class=""><a href="module_datasource.html" title="datasource">datasource</a></li>



			                                
													<li class=""><a href="module_datatable.html" title="datatable">datatable</a></li>



			                                
													<li class=""><a href="module_datatype.html" title="datatype">datatype</a></li>



			                                
													<li class=""><a href="module_dd.html" title="dd">dd</a></li>



			                                
													<li class=""><a href="module_dial.html" title="dial">dial</a></li>



			                                
													<li class=""><a href="module_dom.html" title="dom">dom</a></li>



			                                
													<li class=""><a href="module_dump.html" title="dump">dump</a></li>



			                                
													<li class=""><a href="module_editor.html" title="editor">editor</a></li>



			                                
													<li class=""><a href="module_escape.html" title="escape">escape</a></li>



			                                
													<li class=""><a href="module_event.html" title="event">event</a></li>



			                                
													<li class=""><a href="module_event-custom.html" title="event-custom">event-custom</a></li>



			                                
													<li class=""><a href="module_event-gestures.html" title="event-gestures">event-gestures</a></li>



			                                
													<li class=""><a href="module_event-simulate.html" title="event-simulate">event-simulate</a></li>



			                                
													<li class=""><a href="module_event-touch.html" title="event-touch">event-touch</a></li>



			                                
													<li class=""><a href="module_event-valuechange.html" title="event-valuechange">event-valuechange</a></li>



			                                
													<li class=""><a href="module_highlight.html" title="highlight">highlight</a></li>



			                                
													<li class=""><a href="module_history.html" title="history">history</a></li>



			                                
													<li class=""><a href="module_history-deprecated.html" title="history-deprecated">history-deprecated</a></li>



			                                
													<li class=""><a href="module_imageloader.html" title="imageloader">imageloader</a></li>



			                                
													<li class=""><a href="module_intl.html" title="intl">intl</a></li>



			                                
													<li class=""><a href="module_io.html" title="io">io</a></li>



			                                
													<li class=""><a href="module_json.html" title="json">json</a></li>



			                                
													<li class=""><a href="module_jsonp.html" title="jsonp">jsonp</a></li>



			                                
													<li class=""><a href="module_loader.html" title="loader">loader</a></li>



			                                
													<li class="selected"><a href="module_node.html" title="node">node</a></li>



			                                
													<li class=""><a href="module_node-flick.html" title="node-flick">node-flick</a></li>



			                                
													<li class=""><a href="module_node-focusmanager.html" title="node-focusmanager">node-focusmanager</a></li>



			                                
													<li class=""><a href="module_node-menunav.html" title="node-menunav">node-menunav</a></li>



			                                
													<li class=""><a href="module_oop.html" title="oop">oop</a></li>



			                                
													<li class=""><a href="module_overlay.html" title="overlay">overlay</a></li>



			                                
													<li class=""><a href="module_plugin.html" title="plugin">plugin</a></li>



			                                
													<li class=""><a href="module_pluginhost.html" title="pluginhost">pluginhost</a></li>



			                                
													<li class=""><a href="module_pluginhost-base.html" title="pluginhost-base">pluginhost-base</a></li>



			                                
													<li class=""><a href="module_profiler.html" title="profiler">profiler</a></li>



			                                
													<li class=""><a href="module_querystring.html" title="querystring">querystring</a></li>



			                                
													<li class=""><a href="module_queue-promote.html" title="queue-promote">queue-promote</a></li>



			                                
													<li class=""><a href="module_recordset.html" title="recordset">recordset</a></li>



			                                
													<li class=""><a href="module_resize.html" title="resize">resize</a></li>



			                                
													<li class=""><a href="module_scrollview.html" title="scrollview">scrollview</a></li>



			                                
													<li class=""><a href="module_scrollview-base.html" title="scrollview-base">scrollview-base</a></li>



			                                
													<li class=""><a href="module_scrollview-base-ie.html" title="scrollview-base-ie">scrollview-base-ie</a></li>



			                                
													<li class=""><a href="module_scrollview-paginator.html" title="scrollview-paginator">scrollview-paginator</a></li>



			                                
													<li class=""><a href="module_scrollview-scrollbars.html" title="scrollview-scrollbars">scrollview-scrollbars</a></li>



			                                
													<li class=""><a href="module_shim-plugin.html" title="shim-plugin">shim-plugin</a></li>



			                                
													<li class=""><a href="module_slider.html" title="slider">slider</a></li>



			                                
													<li class=""><a href="module_sortable.html" title="sortable">sortable</a></li>



			                                
													<li class=""><a href="module_stylesheet.html" title="stylesheet">stylesheet</a></li>



			                                
													<li class=""><a href="module_substitute.html" title="substitute">substitute</a></li>



			                                
													<li class=""><a href="module_swf.html" title="swf">swf</a></li>



			                                
													<li class=""><a href="module_swfdetect.html" title="swfdetect">swfdetect</a></li>



			                                
													<li class=""><a href="module_tabview.html" title="tabview">tabview</a></li>



			                                
													<li class=""><a href="module_test.html" title="test">test</a></li>



			                                
													<li class=""><a href="module_text.html" title="text">text</a></li>



			                                
													<li class=""><a href="module_transition.html" title="transition">transition</a></li>



			                                
													<li class=""><a href="module_uploader.html" title="uploader">uploader</a></li>



			                                
													<li class=""><a href="module_value-change.html" title="value-change">value-change</a></li>



			                                
													<li class=""><a href="module_widget.html" title="widget">widget</a></li>



			                                
													<li class=""><a href="module_widget-anim.html" title="widget-anim">widget-anim</a></li>



			                                
													<li class=""><a href="module_widget-base-ie.html" title="widget-base-ie">widget-base-ie</a></li>



			                                
													<li class=""><a href="module_widget-child.html" title="widget-child">widget-child</a></li>



			                                
													<li class=""><a href="module_widget-locale.html" title="widget-locale">widget-locale</a></li>



			                                
													<li class=""><a href="module_widget-parent.html" title="widget-parent">widget-parent</a></li>



			                                
													<li class=""><a href="module_widget-position.html" title="widget-position">widget-position</a></li>



			                                
													<li class=""><a href="module_widget-position-align.html" title="widget-position-align">widget-position-align</a></li>



			                                
													<li class=""><a href="module_widget-position-constrain.html" title="widget-position-constrain">widget-position-constrain</a></li>



			                                
													<li class=""><a href="module_widget-stack.html" title="widget-stack">widget-stack</a></li>



			                                
													<li class=""><a href="module_widget-stdmod.html" title="widget-stdmod">widget-stdmod</a></li>



			                                
													<li class=""><a href="module_yql.html" title="yql">yql</a></li>



			                                
													<li class=""><a href="module_yui.html" title="yui">yui</a></li>
			                        </ul>
								</div>
							</div>
						</div>

							<div class="yui3-widget aui-list aui-list-classes">
								<div class="yui3-widget-content">
									<div class="yui3-widget-hd aui-list-hd aui-list-classes-hd">
										<span class="yui3-widget-hd-text">Classes</span>
									</div>

									<div class="yui3-widget-bd aui-list-bd">
										<ul class="content">


				                                <li class=""><a href="Node.html" title="Node">Node</a></li>


				                                <li class=""><a href="NodeList.html" title="NodeList">NodeList</a></li>


				                                <li class=""><a href="Transition.html" title="Transition">Transition</a></li>
				                        </ul>
									</div>
								</div>
							</div>




					</div>

						<div class="yui3-widget aui-list aui-list-files">
							<div class="yui3-widget-content">
								<div class="yui3-widget-hd aui-list-hd aui-list-files-hd">
									<span class="yui3-widget-hd-text">Files</span>
								</div>

								<div class="yui3-widget-bd aui-list-bd">
									<ul class="content">


			                                <li class=""><a href="node-aria-min.js.html" title="node-aria-min.js">node-aria-min.js</a></li>


			                                <li class=""><a href="node-aria.js.html" title="node-aria.js">node-aria.js</a></li>


			                                <li class="selected"><a href="node-base-debug.js.html" title="node-base-debug.js">node-base-debug.js</a></li>


			                                <li class=""><a href="node-debug.js.html" title="node-debug.js">node-debug.js</a></li>


			                                <li class=""><a href="shim-plugin-debug.js.html" title="shim-plugin-debug.js">shim-plugin-debug.js</a></li>


			                                <li class=""><a href="transition-min.js.html" title="transition-min.js">transition-min.js</a></li>


			                                <li class=""><a href="transition-native-debug.js.html" title="transition-native-debug.js">transition-native-debug.js</a></li>


			                                <li class=""><a href="transition-native-min.js.html" title="transition-native-min.js">transition-native-min.js</a></li>


			                                <li class=""><a href="transition-native.js.html" title="transition-native.js">transition-native.js</a></li>


			                                <li class=""><a href="transition.js.html" title="transition.js">transition.js</a></li>
			                        </ul>
								</div>
							</div>
						</div>
				</div>
				<div class="aui-column aui-w75 aui-column-last">
					<div class="aui-column-content aui-column-content-last">


							<div id="srcout">
								<style>
									#doc3 .classopts { display:none; }
								</style>
								<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">Copyright (c) 2010, Yahoo! Inc. All rights reserved.</span>
<span class="cm">Code licensed under the BSD License:</span>
<span class="cm">http://developer.yahoo.com/yui/license.html</span>
<span class="cm">version: 3.3.0</span>
<span class="cm">build: nightly</span>
<span class="cm">*/</span>
<span class="nx">YUI</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;node-base&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>

<span class="cm">/**</span>
<span class="cm"> * The Node Utility provides a DOM-like interface for interacting with DOM nodes.</span>
<span class="cm"> * @module node</span>
<span class="cm"> * @submodule node-base</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * The Node class provides a wrapper for manipulating DOM Nodes.</span>
<span class="cm"> * Node properties can be accessed via the set/get methods.</span>
<span class="cm"> * Use Y.get() to retrieve Node instances.</span>
<span class="cm"> *</span>
<span class="cm"> * &lt;strong&gt;NOTE:&lt;/strong&gt; Node properties are accessed using</span>
<span class="cm"> * the &lt;code&gt;set&lt;/code&gt; and &lt;code&gt;get&lt;/code&gt; methods.</span>
<span class="cm"> *</span>
<span class="cm"> * @class Node</span>
<span class="cm"> * @constructor</span>
<span class="cm"> * @param {DOMNode} node the DOM node to be mapped to the Node instance.</span>
<span class="cm"> * @for Node</span>
<span class="cm"> */</span>

<span class="c1">// &quot;globals&quot;</span>
<span class="kd">var</span> <span class="nx">DOT</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
    <span class="nx">NODE_NAME</span> <span class="o">=</span> <span class="s1">&#39;nodeName&#39;</span><span class="p">,</span>
    <span class="nx">NODE_TYPE</span> <span class="o">=</span> <span class="s1">&#39;nodeType&#39;</span><span class="p">,</span>
    <span class="nx">OWNER_DOCUMENT</span> <span class="o">=</span> <span class="s1">&#39;ownerDocument&#39;</span><span class="p">,</span>
    <span class="nx">TAG_NAME</span> <span class="o">=</span> <span class="s1">&#39;tagName&#39;</span><span class="p">,</span>
    <span class="nx">UID</span> <span class="o">=</span> <span class="s1">&#39;_yuid&#39;</span><span class="p">,</span>

    <span class="nx">_slice</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span>

    <span class="nx">Y_DOM</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">,</span>

    <span class="nx">Y_Node</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">uid</span> <span class="o">=</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">9</span><span class="p">)</span> <span class="o">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">uniqueID</span> <span class="o">:</span> <span class="nx">node</span><span class="p">[</span><span class="nx">UID</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">uid</span> <span class="o">&amp;&amp;</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">uid</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">uid</span><span class="p">].</span><span class="nx">_node</span> <span class="o">!==</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span><span class="p">[</span><span class="nx">UID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// unset existing uid to prevent collision (via clone or hack)</span>
        <span class="p">}</span>

        <span class="nx">uid</span> <span class="o">=</span> <span class="nx">uid</span> <span class="o">||</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">uid</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// stamp failed; likely IE non-HTMLElement</span>
            <span class="nx">uid</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">guid</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">[</span><span class="nx">UID</span><span class="p">]</span> <span class="o">=</span> <span class="nx">uid</span><span class="p">;</span>

        <span class="cm">/**</span>
<span class="cm">         * The underlying DOM node bound to the Y.Node instance</span>
<span class="cm">         * @property _node</span>
<span class="cm">         * @private</span>
<span class="cm">         */</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
        <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">uid</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_stateProxy</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span> <span class="c1">// when augmented with Attribute</span>

        <span class="nx">Y</span><span class="p">.</span><span class="nx">EventTarget</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">{</span><span class="nx">emitFacade</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_initPlugins</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// when augmented with Plugin.Host</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_initPlugins</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">SHOW_TRANSITION</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">SHOW_TRANSITION</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">HIDE_TRANSITION</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">HIDE_TRANSITION</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">// used with previous/next/ancestor tests</span>
    <span class="nx">_wrapFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">fn</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="o">?</span>
            <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
            <span class="p">}</span> <span class="o">:</span>
            <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">n</span><span class="p">));</span>
            <span class="p">};</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="p">};</span>
<span class="c1">// end &quot;globals&quot;</span>

<span class="cm">/**</span>
<span class="cm"> * The name of the component</span>
<span class="cm"> * @static</span>
<span class="cm"> * @property NAME</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">NAME</span> <span class="o">=</span> <span class="s1">&#39;node&#39;</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * The pattern used to identify ARIA attributes</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">re_aria</span> <span class="o">=</span> <span class="sr">/^(?:role$|aria-)/</span><span class="p">;</span>

<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">SHOW_TRANSITION</span> <span class="o">=</span> <span class="s1">&#39;fadeIn&#39;</span><span class="p">;</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">HIDE_TRANSITION</span> <span class="o">=</span> <span class="s1">&#39;fadeOut&#39;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * List of events that route to DOM events</span>
<span class="cm"> * @static</span>
<span class="cm"> * @property DOM_EVENTS</span>
<span class="cm"> */</span>

<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">DOM_EVENTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">abort</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">beforeunload</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">blur</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">change</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">click</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">close</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">command</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">contextmenu</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">dblclick</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">DOMMouseScroll</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">drag</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">dragstart</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">dragenter</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">dragover</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">dragleave</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">dragend</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">drop</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">focus</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">key</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">keydown</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">keypress</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">keyup</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">load</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">message</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mousedown</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mouseenter</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mouseleave</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mousemove</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mousemultiwheel</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mouseout</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mouseover</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mouseup</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">mousewheel</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">orientationchange</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">reset</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">resize</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">select</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">selectstart</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">submit</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">scroll</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">textInput</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">unload</span><span class="o">:</span> <span class="mi">1</span>
<span class="p">};</span>

<span class="c1">// Add custom event adaptors to this list.  This will make it so</span>
<span class="c1">// that delegate, key, available, contentready, etc all will</span>
<span class="c1">// be available through Node.on</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">Y_Node</span><span class="p">.</span><span class="nx">DOM_EVENTS</span><span class="p">,</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">evt</span><span class="p">.</span><span class="nx">plugins</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * A list of Node instances that have been created</span>
<span class="cm"> * @private</span>
<span class="cm"> * @property _instances</span>
<span class="cm"> * @static</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">_instances</span> <span class="o">=</span> <span class="p">{};</span>

<span class="cm">/**</span>
<span class="cm"> * Retrieves the DOM node bound to a Node instance</span>
<span class="cm"> * @method getDOMNode</span>
<span class="cm"> * @static</span>
<span class="cm"> *</span>
<span class="cm"> * @param {Y.Node || HTMLNode} node The Node instance or an HTMLNode</span>
<span class="cm"> * @return {HTMLNode} The DOM node bound to the Node instance.  If a DOM node is passed</span>
<span class="cm"> * as the node argument, it is simply returned.</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">getDOMNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">)</span> <span class="o">?</span> <span class="nx">node</span> <span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">_node</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Checks Node return values and wraps DOM Nodes as Y.Node instances</span>
<span class="cm"> * and DOM Collections / Arrays as Y.NodeList instances.</span>
<span class="cm"> * Other return values just pass thru.  If undefined is returned (e.g. no return)</span>
<span class="cm"> * then the Node instance is returned for chainability.</span>
<span class="cm"> * @method scrubVal</span>
<span class="cm"> * @static</span>
<span class="cm"> *</span>
<span class="cm"> * @param {any} node The Node instance or an HTMLNode</span>
<span class="cm"> * @return {Y.Node | Y.NodeList | any} Depends on what is returned from the DOM node.</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">scrubVal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// only truthy values are risky</span>
         <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">val</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">val</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// safari nodeList === function</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">NODE_TYPE</span> <span class="k">in</span> <span class="nx">val</span> <span class="o">||</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">val</span><span class="p">))</span> <span class="p">{</span><span class="c1">// node || window</span>
                <span class="nx">val</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="nx">val</span><span class="p">.</span><span class="nx">item</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">val</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">)</span> <span class="o">||</span> <span class="c1">// dom collection or Node instance</span>
                    <span class="p">(</span><span class="nx">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nx">NODE_TYPE</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">// array of DOM Nodes</span>
                <span class="nx">val</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">val</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">val</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span> <span class="c1">// for chaining</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">val</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// IE: DOM null not the same as null</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Adds methods to the Y.Node prototype, routing through scrubVal.</span>
<span class="cm"> * @method addMethod</span>
<span class="cm"> * @static</span>
<span class="cm"> *</span>
<span class="cm"> * @param {String} name The name of the method to add</span>
<span class="cm"> * @param {Function} fn The function that becomes the method</span>
<span class="cm"> * @param {Object} context An optional context to call the method with</span>
<span class="cm"> * (defaults to the Node instance)</span>
<span class="cm"> * @return {any} Depends on what is returned from the DOM node.</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">addMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="nx">fn</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">fn</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">_slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
                <span class="nx">ret</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">Y_Node</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">_node</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">Y_Node</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">_node</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">_node</span><span class="p">);</span>

            <span class="nx">ret</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">ret</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// scrub truthy</span>
                <span class="nx">ret</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">scrubVal</span><span class="p">(</span><span class="nx">ret</span><span class="p">,</span> <span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="p">(</span><span class="k">typeof</span> <span class="nx">ret</span> <span class="o">!=</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">ret</span> <span class="o">=</span> <span class="nx">node</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;unable to add method: &#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;Node&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Imports utility methods to be added as Y.Node methods.</span>
<span class="cm"> * @method importMethod</span>
<span class="cm"> * @static</span>
<span class="cm"> *</span>
<span class="cm"> * @param {Object} host The object that contains the method to import.</span>
<span class="cm"> * @param {String} name The name of the method to import</span>
<span class="cm"> * @param {String} altName An optional name to use in place of the host name</span>
<span class="cm"> * @param {Object} context An optional context to call the method with</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">importMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">altName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">altName</span> <span class="o">=</span> <span class="nx">altName</span> <span class="o">||</span> <span class="nx">name</span><span class="p">;</span>
        <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">addMethod</span><span class="p">(</span><span class="nx">altName</span><span class="p">,</span> <span class="nx">host</span><span class="p">[</span><span class="nx">name</span><span class="p">],</span> <span class="nx">host</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">importMethod</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Returns a single Node instance bound to the node or the</span>
<span class="cm"> * first element matching the given selector. Returns null if no match found.</span>
<span class="cm"> * &lt;strong&gt;Note:&lt;/strong&gt; For chaining purposes you may want to</span>
<span class="cm"> * use &lt;code&gt;Y.all&lt;/code&gt;, which returns a NodeList when no match is found.</span>
<span class="cm"> * @method Y.one</span>
<span class="cm"> * @static</span>
<span class="cm"> * @param {String | HTMLElement} node a node or Selector</span>
<span class="cm"> * @return {Y.Node | null} a Node instance or null if no match found.</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">one</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">cachedNode</span><span class="p">,</span>
        <span class="nx">uid</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">node</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;doc&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// doc OR document</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// win OR window</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">win</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">Y_Node</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">node</span><span class="p">;</span> <span class="c1">// NOTE: return</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">||</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">node</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// avoid bad input (numbers, boolean, etc)</span>
            <span class="nx">uid</span> <span class="o">=</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">uniqueID</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">9</span><span class="p">)</span> <span class="o">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">uniqueID</span> <span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">_yuid</span><span class="p">;</span>
            <span class="nx">instance</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">uid</span><span class="p">];</span> <span class="c1">// reuse exising instances</span>
            <span class="nx">cachedNode</span> <span class="o">=</span> <span class="nx">instance</span> <span class="o">?</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">_node</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">instance</span> <span class="o">||</span> <span class="p">(</span><span class="nx">cachedNode</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span> <span class="o">!==</span> <span class="nx">cachedNode</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// new Node when nodes don&#39;t match</span>
                <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Y_Node</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">instance</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Returns a new dom node using the provided markup string.</span>
<span class="cm"> * @method create</span>
<span class="cm"> * @static</span>
<span class="cm"> * @param {String} html The markup used to create the element</span>
<span class="cm"> * @param {HTMLDocument} doc An optional document context</span>
<span class="cm"> * @return {Node} A Node instance bound to a DOM node or fragment</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">doc</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">html</span><span class="p">,</span> <span class="nx">doc</span><span class="p">));</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Static collection of configuration attributes for special handling</span>
<span class="cm"> * @property ATTRS</span>
<span class="cm"> * @static</span>
<span class="cm"> * @type object</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">ATTRS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Allows for getting and setting the text of an element.</span>
<span class="cm">     * Formatting is preserved and special characters are treated literally.</span>
<span class="cm">     * @config text</span>
<span class="cm">     * @type String</span>
<span class="cm">     */</span>
    <span class="nx">text</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">getText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">setText</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">content</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">content</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="s1">&#39;options&#39;</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns a NodeList instance of all HTMLElement children.</span>
<span class="cm">     * @readOnly</span>
<span class="cm">     * @config children</span>
<span class="cm">     * @type NodeList</span>
<span class="cm">     */</span>
    <span class="s1">&#39;children&#39;</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span>
                <span class="nx">children</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span>
                <span class="nx">childNodes</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">childNodes</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span>
                <span class="nx">children</span> <span class="o">=</span> <span class="p">[];</span>

                <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">TAG_NAME</span><span class="p">])</span> <span class="p">{</span>
                        <span class="nx">children</span><span class="p">[</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span> <span class="o">=</span> <span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">children</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * The default setter for DOM properties</span>
<span class="cm"> * Called with instance context (this === the Node instance)</span>
<span class="cm"> * @method DEFAULT_SETTER</span>
<span class="cm"> * @static</span>
<span class="cm"> * @param {String} name The attribute/property being set</span>
<span class="cm"> * @param {any} val The value to be set</span>
<span class="cm"> * @return {any} The value</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">DEFAULT_SETTER</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_stateProxy</span><span class="p">,</span>
        <span class="nx">strPath</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">DOT</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">strPath</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
        <span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">DOT</span><span class="p">);</span>
        <span class="c1">// only allow when defined on node</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">node</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// pass thru DOM properties</span>
        <span class="nx">node</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * The default getter for DOM properties</span>
<span class="cm"> * Called with instance context (this === the Node instance)</span>
<span class="cm"> * @method DEFAULT_GETTER</span>
<span class="cm"> * @static</span>
<span class="cm"> * @param {String} name The attribute/property to look up</span>
<span class="cm"> * @return {any} The current value</span>
<span class="cm"> */</span>
<span class="nx">Y_Node</span><span class="p">.</span><span class="nx">DEFAULT_GETTER</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_stateProxy</span><span class="p">,</span>
        <span class="nx">val</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span> <span class="o">&amp;&amp;</span> <span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">DOT</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">val</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">DOT</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">node</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// pass thru from DOM</span>
        <span class="nx">val</span> <span class="o">=</span> <span class="nx">node</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Basic prototype augment - no lazy constructor invocation.</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">Y_Node</span><span class="p">,</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">EventTarget</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">Y_Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>
<span class="cm">/**</span>
<span class="cm"> * The method called when outputting Node instances as strings</span>
<span class="cm"> * @method toString</span>
<span class="cm"> * @return {String} A string representation of the Node instance</span>
<span class="cm"> */</span>
    <span class="nx">toString</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">UID</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: not bound to a node&#39;</span><span class="p">,</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span>
            <span class="nx">attrs</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">className</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">;</span>
            <span class="nx">id</span> <span class="o">=</span> <span class="p">(</span><span class="nx">attrs</span> <span class="o">&amp;&amp;</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="o">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">className</span> <span class="o">=</span> <span class="p">(</span><span class="nx">attrs</span> <span class="o">&amp;&amp;</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">className</span><span class="p">)</span> <span class="o">?</span> <span class="nx">node</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;className&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">str</span> <span class="o">=</span> <span class="nx">node</span><span class="p">[</span><span class="nx">NODE_NAME</span><span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">id</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// TODO: add yuid?</span>
            <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">[</span><span class="nx">UID</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns an attribute value on the Node instance.</span>
<span class="cm">     * Unless pre-configured (via Node.ATTRS), get hands</span>
<span class="cm">     * off to the underlying DOM node.  Only valid</span>
<span class="cm">     * attributes/properties for the node will be set.</span>
<span class="cm">     * @method get</span>
<span class="cm">     * @param {String} attr The attribute</span>
<span class="cm">     * @return {any} The current value of the attribute</span>
<span class="cm">     */</span>
    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">val</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_getAttr</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// use Attribute imple</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getAttr</span><span class="p">(</span><span class="nx">attr</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">attr</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">scrubVal</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// IE: DOM null is not true null (even though they ===)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Helper method for get.</span>
<span class="cm">     * @method _get</span>
<span class="cm">     * @private</span>
<span class="cm">     * @param {String} attr The attribute</span>
<span class="cm">     * @return {any} The current value of the attribute</span>
<span class="cm">     */</span>
    <span class="nx">_get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">attrConfig</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">ATTRS</span><span class="p">[</span><span class="nx">attr</span><span class="p">],</span>
            <span class="nx">val</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">attrConfig</span> <span class="o">&amp;&amp;</span> <span class="nx">attrConfig</span><span class="p">.</span><span class="nx">getter</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="nx">attrConfig</span><span class="p">.</span><span class="nx">getter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">Y_Node</span><span class="p">.</span><span class="nx">re_aria</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">attr</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">attr</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">DEFAULT_GETTER</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Sets an attribute on the Node instance.</span>
<span class="cm">     * Unless pre-configured (via Node.ATTRS), set hands</span>
<span class="cm">     * off to the underlying DOM node.  Only valid</span>
<span class="cm">     * attributes/properties for the node will be set.</span>
<span class="cm">     * To set custom attributes use setAttribute.</span>
<span class="cm">     * @method set</span>
<span class="cm">     * @param {String} attr The attribute to be set.</span>
<span class="cm">     * @param {any} val The value to set the attribute to.</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">attrConfig</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">ATTRS</span><span class="p">[</span><span class="nx">attr</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_setAttr</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// use Attribute imple</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_setAttr</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// use setters inline</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">attrConfig</span> <span class="o">&amp;&amp;</span> <span class="nx">attrConfig</span><span class="p">.</span><span class="nx">setter</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">attrConfig</span><span class="p">.</span><span class="nx">setter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">attr</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">Y_Node</span><span class="p">.</span><span class="nx">re_aria</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">attr</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// special case Aria</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">attr</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">DEFAULT_SETTER</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Sets multiple attributes.</span>
<span class="cm">     * @method setAttrs</span>
<span class="cm">     * @param {Object} attrMap an object of name/value pairs to set</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">setAttrs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attrMap</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_setAttrs</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// use Attribute imple</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_setAttrs</span><span class="p">(</span><span class="nx">attrMap</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// use setters inline</span>
            <span class="nx">Y</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">attrMap</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>
            <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns an object containing the values for the requested attributes.</span>
<span class="cm">     * @method getAttrs</span>
<span class="cm">     * @param {Array} attrs an array of attributes to get values</span>
<span class="cm">     * @return {Object} An object with attribute name/value pairs.</span>
<span class="cm">     */</span>
    <span class="nx">getAttrs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_getAttrs</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// use Attribute imple</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_getAttrs</span><span class="p">(</span><span class="nx">attrs</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// use setters inline</span>
            <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ret</span><span class="p">[</span><span class="nx">v</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
            <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Creates a new Node using the provided markup string.</span>
<span class="cm">     * @method create</span>
<span class="cm">     * @param {String} html The markup used to create the element</span>
<span class="cm">     * @param {HTMLDocument} doc An optional document context</span>
<span class="cm">     * @return {Node} A Node instance bound to a DOM node or fragment</span>
<span class="cm">     */</span>
    <span class="nx">create</span><span class="o">:</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">create</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Compares nodes to determine if they match.</span>
<span class="cm">     * Node instances can be compared to each other and/or HTMLElements.</span>
<span class="cm">     * @method compareTo</span>
<span class="cm">     * @param {HTMLElement | Node} refNode The reference node to compare to the node.</span>
<span class="cm">     * @return {Boolean} True if the nodes match, false if they do not.</span>
<span class="cm">     */</span>
    <span class="nx">compareTo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">refNode</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">refNode</span><span class="p">,</span> <span class="nx">Y_Node</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">refNode</span> <span class="o">=</span> <span class="nx">refNode</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">node</span> <span class="o">===</span> <span class="nx">refNode</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Determines whether the node is appended to the document.</span>
<span class="cm">     * @method inDoc</span>
<span class="cm">     * @param {Node|HTMLElement} doc optional An optional document to check against.</span>
<span class="cm">     * Defaults to current document.</span>
<span class="cm">     * @return {Boolean} Whether or not this node is appended to the document.</span>
<span class="cm">     */</span>
    <span class="nx">inDoc</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="nx">doc</span> <span class="o">=</span> <span class="p">(</span><span class="nx">doc</span><span class="p">)</span> <span class="o">?</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_node</span> <span class="o">||</span> <span class="nx">doc</span> <span class="o">:</span> <span class="nx">node</span><span class="p">[</span><span class="nx">OWNER_DOCUMENT</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span> <span class="nx">node</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">getById</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">byId</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">node</span><span class="p">[</span><span class="nx">OWNER_DOCUMENT</span><span class="p">]);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ret</span> <span class="o">&amp;&amp;</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">ret</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">ret</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="p">},</span>

   <span class="cm">/**</span>
<span class="cm">     * Returns the nearest ancestor that passes the test applied by supplied boolean method.</span>
<span class="cm">     * @method ancestor</span>
<span class="cm">     * @param {String | Function} fn A selector string or boolean method for testing elements.</span>
<span class="cm">     * @param {Boolean} testSelf optional Whether or not to include the element in the scan</span>
<span class="cm">     * If a function is used, it receives the current node being tested as the only argument.</span>
<span class="cm">     * @return {Node} The matching Node instance or null if not found</span>
<span class="cm">     */</span>
    <span class="nx">ancestor</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">testSelf</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">ancestor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">_wrapFn</span><span class="p">(</span><span class="nx">fn</span><span class="p">),</span> <span class="nx">testSelf</span><span class="p">));</span>
    <span class="p">},</span>

   <span class="cm">/**</span>
<span class="cm">     * Returns the ancestors that pass the test applied by supplied boolean method.</span>
<span class="cm">     * @method ancestors</span>
<span class="cm">     * @param {String | Function} fn A selector string or boolean method for testing elements.</span>
<span class="cm">     * @param {Boolean} testSelf optional Whether or not to include the element in the scan</span>
<span class="cm">     * If a function is used, it receives the current node being tested as the only argument.</span>
<span class="cm">     * @return {NodeList} A NodeList instance containing the matching elements </span>
<span class="cm">     */</span>
    <span class="nx">ancestors</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">testSelf</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">ancestors</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">_wrapFn</span><span class="p">(</span><span class="nx">fn</span><span class="p">),</span> <span class="nx">testSelf</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the previous matching sibling.</span>
<span class="cm">     * Returns the nearest element node sibling if no method provided.</span>
<span class="cm">     * @method previous</span>
<span class="cm">     * @param {String | Function} fn A selector or boolean method for testing elements.</span>
<span class="cm">     * If a function is used, it receives the current node being tested as the only argument.</span>
<span class="cm">     * @return {Node} Node instance or null if not found</span>
<span class="cm">     */</span>
    <span class="nx">previous</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">all</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">elementByAxis</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="s1">&#39;previousSibling&#39;</span><span class="p">,</span> <span class="nx">_wrapFn</span><span class="p">(</span><span class="nx">fn</span><span class="p">),</span> <span class="nx">all</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the next matching sibling.</span>
<span class="cm">     * Returns the nearest element node sibling if no method provided.</span>
<span class="cm">     * @method next</span>
<span class="cm">     * @param {String | Function} fn A selector or boolean method for testing elements.</span>
<span class="cm">     * If a function is used, it receives the current node being tested as the only argument.</span>
<span class="cm">     * @return {Node} Node instance or null if not found</span>
<span class="cm">     */</span>
    <span class="nx">next</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">all</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">elementByAxis</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="s1">&#39;nextSibling&#39;</span><span class="p">,</span> <span class="nx">_wrapFn</span><span class="p">(</span><span class="nx">fn</span><span class="p">),</span> <span class="nx">all</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns all matching siblings.</span>
<span class="cm">     * Returns all siblings if no method provided.</span>
<span class="cm">     * @method siblings</span>
<span class="cm">     * @param {String | Function} fn A selector or boolean method for testing elements.</span>
<span class="cm">     * If a function is used, it receives the current node being tested as the only argument.</span>
<span class="cm">     * @return {NodeList} NodeList instance bound to found siblings</span>
<span class="cm">     */</span>
    <span class="nx">siblings</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">siblings</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">_wrapFn</span><span class="p">(</span><span class="nx">fn</span><span class="p">)));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Retrieves a Node instance of nodes based on the given CSS selector.</span>
<span class="cm">     * @method one</span>
<span class="cm">     *</span>
<span class="cm">     * @param {string} selector The CSS selector to test against.</span>
<span class="cm">     * @return {Node} A Node instance for the matching HTMLElement.</span>
<span class="cm">     */</span>
    <span class="nx">one</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="kc">true</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Retrieves a nodeList based on the given CSS selector.</span>
<span class="cm">     * @method all</span>
<span class="cm">     *</span>
<span class="cm">     * @param {string} selector The CSS selector to test against.</span>
<span class="cm">     * @return {NodeList} A NodeList instance for the matching HTMLCollection/Array.</span>
<span class="cm">     */</span>
    <span class="nx">all</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">nodelist</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">));</span>
        <span class="nx">nodelist</span><span class="p">.</span><span class="nx">_query</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">;</span>
        <span class="nx">nodelist</span><span class="p">.</span><span class="nx">_queryRoot</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">nodelist</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">// TODO: allow fn test</span>
    <span class="cm">/**</span>
<span class="cm">     * Test if the supplied node matches the supplied selector.</span>
<span class="cm">     * @method test</span>
<span class="cm">     *</span>
<span class="cm">     * @param {string} selector The CSS selector to test against.</span>
<span class="cm">     * @return {boolean} Whether or not the node matches the selector.</span>
<span class="cm">     */</span>
    <span class="nx">test</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">selector</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Removes the node from its parent.</span>
<span class="cm">     * Shortcut for myNode.get(&#39;parentNode&#39;).removeChild(myNode);</span>
<span class="cm">     * @method remove</span>
<span class="cm">     * @param {Boolean} destroy whether or not to call destroy() on the node</span>
<span class="cm">     * after removal.</span>
<span class="cm">     * @chainable</span>
<span class="cm">     *</span>
<span class="cm">     */</span>
    <span class="nx">remove</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">destroy</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span>
            <span class="nx">parentNode</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">parentNode</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">destroy</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Replace the node with the other node. This is a DOM update only</span>
<span class="cm">     * and does not change the node bound to the Node instance.</span>
<span class="cm">     * Shortcut for myNode.get(&#39;parentNode&#39;).replaceChild(newNode, myNode);</span>
<span class="cm">     * @method replace</span>
<span class="cm">     * @param {Y.Node || HTMLNode} newNode Node to be inserted</span>
<span class="cm">     * @chainable</span>
<span class="cm">     *</span>
<span class="cm">     */</span>
    <span class="nx">replace</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newNode</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">newNode</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">newNode</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">newNode</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">replaceChild</span><span class="p">(</span><span class="nx">Y_Node</span><span class="p">.</span><span class="nx">getDOMNode</span><span class="p">(</span><span class="nx">newNode</span><span class="p">),</span> <span class="nx">node</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * @method replaceChild</span>
<span class="cm">     * @for Node</span>
<span class="cm">     * @param {String | HTMLElement | Node} node Node to be inserted </span>
<span class="cm">     * @param {HTMLElement | Node} refNode Node to be replaced </span>
<span class="cm">     * @return {Node} The replaced node</span>
<span class="cm">     */</span>
    <span class="nx">replaceChild</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">refNode</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">node</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">replaceChild</span><span class="p">(</span><span class="nx">Y_Node</span><span class="p">.</span><span class="nx">getDOMNode</span><span class="p">(</span><span class="nx">node</span><span class="p">),</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">getDOMNode</span><span class="p">(</span><span class="nx">refNode</span><span class="p">)));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * @method appendChild</span>
<span class="cm">     * @param {String | HTMLElement | Node} node Node to be appended </span>
<span class="cm">     * @return {Node} The appended node </span>
<span class="cm">     */</span>
    <span class="nx">appendChild</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">scrubVal</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_insert</span><span class="p">(</span><span class="nx">node</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * @method insertBefore</span>
<span class="cm">     * @param {String | HTMLElement | Node} newNode Node to be appended </span>
<span class="cm">     * @param {HTMLElement | Node} refNode Node to be inserted before </span>
<span class="cm">     * @return {Node} The inserted node </span>
<span class="cm">     */</span>
    <span class="nx">insertBefore</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newNode</span><span class="p">,</span> <span class="nx">refNode</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">scrubVal</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_insert</span><span class="p">(</span><span class="nx">newNode</span><span class="p">,</span> <span class="nx">refNode</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Removes event listeners from the node and (optionally) its subtree</span>
<span class="cm">     * @method purge</span>
<span class="cm">     * @param {Boolean} recurse (optional) Whether or not to remove listeners from the</span>
<span class="cm">     * node&#39;s subtree</span>
<span class="cm">     * @param {String} type (optional) Only remove listeners of the specified type</span>
<span class="cm">     * @chainable</span>
<span class="cm">     *</span>
<span class="cm">     */</span>
    <span class="nx">purge</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">recurse</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">purgeElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">recurse</span><span class="p">,</span> <span class="nx">type</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Nulls internal node references, removes any plugins and event listeners</span>
<span class="cm">     * @method destroy</span>
<span class="cm">     * @param {Boolean} recursivePurge (optional) Whether or not to remove listeners from the</span>
<span class="cm">     * node&#39;s subtree (default is false)</span>
<span class="cm">     *</span>
<span class="cm">     */</span>
    <span class="nx">destroy</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">recursive</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">purge</span><span class="p">();</span> <span class="c1">// TODO: only remove events add via this Node</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">unplug</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// may not be a PluginHost</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">unplug</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">clearData</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">recursive</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">).</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_node</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_stateProxy</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">delete</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="k">this</span><span class="p">[</span><span class="nx">UID</span><span class="p">]];</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Invokes a method on the Node instance</span>
<span class="cm">     * @method invoke</span>
<span class="cm">     * @param {String} method The name of the method to invoke</span>
<span class="cm">     * @param {Any}  a, b, c, etc. Arguments to invoke the method with.</span>
<span class="cm">     * @return Whatever the underly method returns.</span>
<span class="cm">     * DOM Nodes and Collections return values</span>
<span class="cm">     * are converted to Node/NodeList instances.</span>
<span class="cm">     *</span>
<span class="cm">     */</span>
    <span class="nx">invoke</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span>
            <span class="nx">ret</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">Y_Node</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">Y_Node</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">ret</span> <span class="o">=</span> <span class="nx">node</span><span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">scrubVal</span><span class="p">(</span><span class="nx">ret</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Inserts the content before the reference node.</span>
<span class="cm">     * @method insert</span>
<span class="cm">     * @param {String | Y.Node | HTMLElement | Y.NodeList | HTMLCollection} content The content to insert</span>
<span class="cm">     * @param {Int | Y.Node | HTMLElement | String} where The position to insert at.</span>
<span class="cm">     * Possible &quot;where&quot; arguments</span>
<span class="cm">     * &lt;dl&gt;</span>
<span class="cm">     * &lt;dt&gt;Y.Node&lt;/dt&gt;</span>
<span class="cm">     * &lt;dd&gt;The Node to insert before&lt;/dd&gt;</span>
<span class="cm">     * &lt;dt&gt;HTMLElement&lt;/dt&gt;</span>
<span class="cm">     * &lt;dd&gt;The element to insert before&lt;/dd&gt;</span>
<span class="cm">     * &lt;dt&gt;Int&lt;/dt&gt;</span>
<span class="cm">     * &lt;dd&gt;The index of the child element to insert before&lt;/dd&gt;</span>
<span class="cm">     * &lt;dt&gt;&quot;replace&quot;&lt;/dt&gt;</span>
<span class="cm">     * &lt;dd&gt;Replaces the existing HTML&lt;/dd&gt;</span>
<span class="cm">     * &lt;dt&gt;&quot;before&quot;&lt;/dt&gt;</span>
<span class="cm">     * &lt;dd&gt;Inserts before the existing HTML&lt;/dd&gt;</span>
<span class="cm">     * &lt;dt&gt;&quot;before&quot;&lt;/dt&gt;</span>
<span class="cm">     * &lt;dd&gt;Inserts content before the node&lt;/dd&gt;</span>
<span class="cm">     * &lt;dt&gt;&quot;after&quot;&lt;/dt&gt;</span>
<span class="cm">     * &lt;dd&gt;Inserts content after the node&lt;/dd&gt;</span>
<span class="cm">     * &lt;/dl&gt;</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">insert</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="nx">where</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_insert</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="nx">where</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">_insert</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="nx">where</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">where</span> <span class="o">==</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// allow index</span>
            <span class="nx">where</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">where</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">where</span> <span class="o">&amp;&amp;</span> <span class="nx">where</span><span class="p">.</span><span class="nx">_node</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Node</span>
            <span class="nx">where</span> <span class="o">=</span> <span class="nx">where</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">content</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">content</span> <span class="o">!=</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// allow Node or NodeList/Array instances</span>
            <span class="nx">content</span> <span class="o">=</span> <span class="nx">content</span><span class="p">.</span><span class="nx">_node</span> <span class="o">||</span> <span class="nx">content</span><span class="p">.</span><span class="nx">_nodes</span> <span class="o">||</span> <span class="nx">content</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">ret</span> <span class="o">=</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">addHTML</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">content</span><span class="p">,</span> <span class="nx">where</span><span class="p">);</span>

        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Inserts the content as the firstChild of the node.</span>
<span class="cm">     * @method prepend</span>
<span class="cm">     * @param {String | Y.Node | HTMLElement} content The content to insert</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">prepend</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Inserts the content as the lastChild of the node.</span>
<span class="cm">     * @method append</span>
<span class="cm">     * @param {String | Y.Node | HTMLElement} content The content to insert</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">append</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Appends the node to the given node. </span>
<span class="cm">     * @method appendTo</span>
<span class="cm">     * @param {Y.Node | HTMLElement} node The node to append to</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">appendTo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">node</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Replaces the node&#39;s current content with the content.</span>
<span class="cm">     * @method setContent</span>
<span class="cm">     * @param {String | Y.Node | HTMLElement | Y.NodeList | HTMLCollection} content The content to insert</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">setContent</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_insert</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the node&#39;s current content (e.g. innerHTML) </span>
<span class="cm">     * @method getContent</span>
<span class="cm">     * @return {String} The current content</span>
<span class="cm">     */</span>
    <span class="nx">getContent</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">    * @method swap</span>
<span class="cm">    * @description Swap DOM locations with the given node.</span>
<span class="cm">    * This does not change which DOM node each Node instance refers to.</span>
<span class="cm">    * @param {Node} otherNode The node to swap with</span>
<span class="cm">     * @chainable</span>
<span class="cm">    */</span>
    <span class="nx">swap</span><span class="o">:</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">swapNode</span> <span class="o">?</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">otherNode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">swapNode</span><span class="p">(</span><span class="nx">Y_Node</span><span class="p">.</span><span class="nx">getDOMNode</span><span class="p">(</span><span class="nx">otherNode</span><span class="p">));</span>
        <span class="p">}</span> <span class="o">:</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">otherNode</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">otherNode</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">.</span><span class="nx">getDOMNode</span><span class="p">(</span><span class="nx">otherNode</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span>
                <span class="nx">parent</span> <span class="o">=</span> <span class="nx">otherNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span>
                <span class="nx">nextSibling</span> <span class="o">=</span> <span class="nx">otherNode</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">nextSibling</span> <span class="o">===</span> <span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">parent</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">otherNode</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">otherNode</span> <span class="o">===</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">parent</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">otherNode</span><span class="p">,</span> <span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">replaceChild</span><span class="p">(</span><span class="nx">otherNode</span><span class="p">,</span> <span class="nx">node</span><span class="p">);</span>
                <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">addHTML</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">nextSibling</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">},</span>


    <span class="cm">/**</span>
<span class="cm">    * @method getData</span>
<span class="cm">    * @description Retrieves arbitrary data stored on a Node instance.</span>
<span class="cm">    * This is not stored with the DOM node.</span>
<span class="cm">    * @param {string} name Optional name of the data field to retrieve.</span>
<span class="cm">    * If no name is given, all data is returned.</span>
<span class="cm">    * @return {any | Object} Whatever is stored at the given field,</span>
<span class="cm">    * or an object hash of all fields.</span>
<span class="cm">    */</span>
    <span class="nx">getData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ret</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_data</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_data</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_data</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_data</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>

    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">    * @method setData</span>
<span class="cm">    * @description Stores arbitrary data on a Node instance.</span>
<span class="cm">    * This is not stored with the DOM node.</span>
<span class="cm">    * @param {string} name The name of the field to set. If no name</span>
<span class="cm">    * is given, name is treated as the data and overrides any existing data.</span>
<span class="cm">    * @param {any} val The value to be assigned to the field.</span>
<span class="cm">    * @chainable</span>
<span class="cm">    */</span>
    <span class="nx">setData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_data</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_data</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_data</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_data</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
        <span class="p">}</span>

       <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">    * @method clearData</span>
<span class="cm">    * @description Clears stored data.</span>
<span class="cm">    * @param {string} name The name of the field to clear. If no name</span>
<span class="cm">    * is given, all data is cleared.</span>
<span class="cm">    * @chainable</span>
<span class="cm">    */</span>
    <span class="nx">clearData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;_data&#39;</span> <span class="k">in</span> <span class="k">this</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_data</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_data</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">hasMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="nx">method</span> <span class="k">in</span> <span class="nx">node</span> <span class="o">&amp;&amp;</span>
                <span class="k">typeof</span> <span class="nx">node</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;unknown&#39;</span> <span class="o">&amp;&amp;</span>
            <span class="p">(</span><span class="k">typeof</span> <span class="nx">node</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span> <span class="o">||</span>
                <span class="nb">String</span><span class="p">(</span><span class="nx">node</span><span class="p">[</span><span class="nx">method</span><span class="p">]).</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">1</span><span class="p">));</span> <span class="c1">// IE reports as object, prepends space</span>
    <span class="p">},</span>

    <span class="nx">SHOW_TRANSITION</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nx">HIDE_TRANSITION</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Makes the node visible.</span>
<span class="cm">     * If the &quot;transition&quot; module is loaded, show optionally</span>
<span class="cm">     * animates the showing of the node using either the default</span>
<span class="cm">     * transition effect (&#39;fadeIn&#39;), or the given named effect.</span>
<span class="cm">     * @method show</span>
<span class="cm">     * @param {String} name A named Transition effect to use as the show effect. </span>
<span class="cm">     * @param {Object} config Options to use with the transition. </span>
<span class="cm">     * @param {Function} callback An optional function to run after the transition completes. </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">show</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">callback</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">toggleView</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * The implementation for showing nodes.</span>
<span class="cm">     * Default is to toggle the style.display property.</span>
<span class="cm">     * @protected</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">_show</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>

    <span class="p">},</span>

    <span class="nx">_isHidden</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">toggleView</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">on</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_toggleView</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">_toggleView</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">on</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">callback</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

        <span class="c1">// base on current state if not forcing </span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">on</span> <span class="o">!=</span> <span class="s1">&#39;boolean&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">on</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isHidden</span><span class="p">())</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">on</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_show</span><span class="p">();</span>
        <span class="p">}</span>  <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_hide</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">callback</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Hides the node.</span>
<span class="cm">     * If the &quot;transition&quot; module is loaded, hide optionally</span>
<span class="cm">     * animates the hiding of the node using either the default</span>
<span class="cm">     * transition effect (&#39;fadeOut&#39;), or the given named effect.</span>
<span class="cm">     * @method hide</span>
<span class="cm">     * @param {String} name A named Transition effect to use as the show effect. </span>
<span class="cm">     * @param {Object} config Options to use with the transition. </span>
<span class="cm">     * @param {Function} callback An optional function to run after the transition completes. </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">hide</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">callback</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">toggleView</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * The implementation for hiding nodes.</span>
<span class="cm">     * Default is to toggle the style.display property.</span>
<span class="cm">     * @protected</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">_hide</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">isFragment</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;nodeType&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">11</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Removes all of the child nodes from the node.</span>
<span class="cm">     * @param {Boolean} destroy Whether the nodes should also be destroyed. </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">empty</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">destroy</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;childNodes&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">(</span><span class="nx">destroy</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">},</span> <span class="kc">true</span><span class="p">);</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span> <span class="o">=</span> <span class="nx">Y_Node</span><span class="p">;</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">one</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">one</span><span class="p">;</span>
<span class="cm">/**</span>
<span class="cm"> * The NodeList module provides support for managing collections of Nodes.</span>
<span class="cm"> * @module node</span>
<span class="cm"> * @submodule nodelist</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * The NodeList class provides a wrapper for manipulating DOM NodeLists.</span>
<span class="cm"> * NodeList properties can be accessed via the set/get methods.</span>
<span class="cm"> * Use Y.all() to retrieve NodeList instances.</span>
<span class="cm"> *</span>
<span class="cm"> * @class NodeList</span>
<span class="cm"> * @constructor</span>
<span class="cm"> */</span>

<span class="kd">var</span> <span class="nx">NodeList</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nodes</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">nodes</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// selector query</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_query</span> <span class="o">=</span> <span class="nx">nodes</span><span class="p">;</span>
        <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">nodes</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">||</span> <span class="nx">Y_DOM</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">nodes</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// domNode || window</span>
        <span class="nx">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="nx">nodes</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">nodes</span><span class="p">,</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">_node</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">instanceOf</span><span class="p">(</span><span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// allow array of Y.Nodes</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">nodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">_node</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">tmp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">_node</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// array of domNodes or domNodeList (no mixed array of Y.Node/domNodes)</span>
        <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">(</span><span class="nx">nodes</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * The underlying array of DOM nodes bound to the Y.NodeList instance</span>
<span class="cm">     * @property _nodes</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span> <span class="o">=</span> <span class="nx">nodes</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">NodeList</span><span class="p">.</span><span class="nx">NAME</span> <span class="o">=</span> <span class="s1">&#39;NodeList&#39;</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Retrieves the DOM nodes bound to a NodeList instance</span>
<span class="cm"> * @method NodeList.getDOMNodes</span>
<span class="cm"> * @static</span>
<span class="cm"> *</span>
<span class="cm"> * @param {Y.NodeList} nodelist The NodeList instance</span>
<span class="cm"> * @return {Array} The array of DOM nodes bound to the NodeList</span>
<span class="cm"> */</span>
<span class="nx">NodeList</span><span class="p">.</span><span class="nx">getDOMNodes</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nodelist</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">nodelist</span> <span class="o">&amp;&amp;</span> <span class="nx">nodelist</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">)</span> <span class="o">?</span> <span class="nx">nodelist</span><span class="p">.</span><span class="nx">_nodes</span> <span class="o">:</span> <span class="nx">nodelist</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">NodeList</span><span class="p">.</span><span class="nx">each</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">nodes</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">nodes</span> <span class="o">&amp;&amp;</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">nodes</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span> <span class="o">||</span> <span class="nx">instance</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;no nodes bound to &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;NodeList&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">NodeList</span><span class="p">.</span><span class="nx">addMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">NodeList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">[],</span>
                <span class="nx">args</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">;</span>

            <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">UID</span> <span class="o">=</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">uniqueID</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">9</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;uniqueID&#39;</span> <span class="o">:</span> <span class="s1">&#39;_yuid&#39;</span><span class="p">,</span>
                    <span class="nx">instance</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">node</span><span class="p">[</span><span class="nx">UID</span><span class="p">]],</span>
                    <span class="nx">ctx</span><span class="p">,</span>
                    <span class="nx">result</span><span class="p">;</span>

                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">instance</span> <span class="o">=</span> <span class="nx">NodeList</span><span class="p">.</span><span class="nx">_getTempNode</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">context</span> <span class="o">||</span> <span class="nx">instance</span><span class="p">;</span>
                <span class="nx">result</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="nx">result</span> <span class="o">!==</span> <span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">ret</span><span class="p">[</span><span class="nx">ret</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>

            <span class="c1">// TODO: remove tmp pointer</span>
            <span class="k">return</span> <span class="nx">ret</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">ret</span> <span class="o">:</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;unable to add method: &#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; to NodeList&#39;</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;node&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">NodeList</span><span class="p">.</span><span class="nx">importMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">altName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">altName</span> <span class="o">=</span> <span class="nx">altName</span> <span class="o">||</span> <span class="nx">name</span><span class="p">;</span>
        <span class="nx">NodeList</span><span class="p">.</span><span class="nx">addMethod</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">host</span><span class="p">[</span><span class="nx">name</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">NodeList</span><span class="p">.</span><span class="nx">importMethod</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">NodeList</span><span class="p">.</span><span class="nx">_getTempNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">NodeList</span><span class="p">.</span><span class="nx">_tempNode</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">tmp</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
        <span class="nx">NodeList</span><span class="p">.</span><span class="nx">_tempNode</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">tmp</span><span class="p">.</span><span class="nx">_node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
    <span class="nx">tmp</span><span class="p">.</span><span class="nx">_stateProxy</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">tmp</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">NodeList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Retrieves the Node instance at the given index.</span>
<span class="cm">     * @method item</span>
<span class="cm">     *</span>
<span class="cm">     * @param {Number} index The index of the target Node.</span>
<span class="cm">     * @return {Node} The Node instance at the given index.</span>
<span class="cm">     */</span>
    <span class="nx">item</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span> <span class="o">||</span> <span class="p">[])[</span><span class="nx">index</span><span class="p">]);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Applies the given function to each Node in the NodeList.</span>
<span class="cm">     * @method each</span>
<span class="cm">     * @param {Function} fn The function to apply. It receives 3 arguments:</span>
<span class="cm">     * the current node instance, the node&#39;s index, and the NodeList instance</span>
<span class="cm">     * @param {Object} context optional An optional context to apply the function with</span>
<span class="cm">     * Default context is the current Node instance</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span> <span class="o">||</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">instance</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">instance</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">batch</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">nodelist</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">node</span><span class="p">[</span><span class="nx">UID</span><span class="p">]];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">instance</span> <span class="o">=</span> <span class="nx">NodeList</span><span class="p">.</span><span class="nx">_getTempNode</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span> <span class="o">||</span> <span class="nx">instance</span><span class="p">,</span> <span class="nx">instance</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">nodelist</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">nodelist</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Executes the function once for each node until a true value is returned.</span>
<span class="cm">     * @method some</span>
<span class="cm">     * @param {Function} fn The function to apply. It receives 3 arguments:</span>
<span class="cm">     * the current node instance, the node&#39;s index, and the NodeList instance</span>
<span class="cm">     * @param {Object} context optional An optional context to execute the function from.</span>
<span class="cm">     * Default context is the current Node instance</span>
<span class="cm">     * @return {Boolean} Whether or not the function returned true for any node.</span>
<span class="cm">     */</span>
    <span class="nx">some</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span> <span class="o">||</span> <span class="nx">node</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">instance</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Creates a documenFragment from the nodes bound to the NodeList instance</span>
<span class="cm">     * @method toFrag</span>
<span class="cm">     * @return Node a Node instance bound to the documentFragment</span>
<span class="cm">     */</span>
    <span class="nx">toFrag</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">.</span><span class="nx">_nl2frag</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the index of the node in the NodeList instance</span>
<span class="cm">     * or -1 if the node isn&#39;t found.</span>
<span class="cm">     * @method indexOf</span>
<span class="cm">     * @param {Y.Node || DOMNode} node the node to search for</span>
<span class="cm">     * @return {Int} the index of the node value or -1 if not found</span>
<span class="cm">     */</span>
    <span class="nx">indexOf</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">getDOMNode</span><span class="p">(</span><span class="nx">node</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Filters the NodeList instance down to only nodes matching the given selector.</span>
<span class="cm">     * @method filter</span>
<span class="cm">     * @param {String} selector The selector to filter against</span>
<span class="cm">     * @return {NodeList} NodeList containing the updated collection</span>
<span class="cm">     * @see Selector</span>
<span class="cm">     */</span>
    <span class="nx">filter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span> <span class="nx">selector</span><span class="p">));</span>
    <span class="p">},</span>


    <span class="cm">/**</span>
<span class="cm">     * Creates a new NodeList containing all nodes at every n indices, where</span>
<span class="cm">     * remainder n % index equals r.</span>
<span class="cm">     * (zero-based index).</span>
<span class="cm">     * @method modulus</span>
<span class="cm">     * @param {Int} n The offset to use (return every nth node)</span>
<span class="cm">     * @param {Int} r An optional remainder to use with the modulus operation (defaults to zero)</span>
<span class="cm">     * @return {NodeList} NodeList containing the updated collection</span>
<span class="cm">     */</span>
    <span class="nx">modulus</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">r</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">nodes</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">NodeList</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="nx">n</span> <span class="o">===</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">nodes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">nodes</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Creates a new NodeList containing all nodes at odd indices</span>
<span class="cm">     * (zero-based index).</span>
<span class="cm">     * @method odd</span>
<span class="cm">     * @return {NodeList} NodeList containing the updated collection</span>
<span class="cm">     */</span>
    <span class="nx">odd</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">modulus</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Creates a new NodeList containing all nodes at even indices</span>
<span class="cm">     * (zero-based index), including zero.</span>
<span class="cm">     * @method even</span>
<span class="cm">     * @return {NodeList} NodeList containing the updated collection</span>
<span class="cm">     */</span>
    <span class="nx">even</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">modulus</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">destructor</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Reruns the initial query, when created using a selector query</span>
<span class="cm">     * @method refresh</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">refresh</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">doc</span><span class="p">,</span>
            <span class="nx">nodes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span>
            <span class="nx">query</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_query</span><span class="p">,</span>
            <span class="nx">root</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_queryRoot</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">query</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">root</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">nodes</span> <span class="o">&amp;&amp;</span> <span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ownerDocument</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">root</span> <span class="o">=</span> <span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ownerDocument</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">root</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">_prepEvtArgs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// map to Y.on/after signature (type, fn, nodes, context, arg1, arg2, etc)</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// type only (event hash) just add nodes</span>
            <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">args</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">args</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nx">context</span> <span class="o">||</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// default to NodeList instance as context</span>

        <span class="k">return</span> <span class="nx">args</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Applies an event listener to each Node bound to the NodeList.</span>
<span class="cm">     * @method on</span>
<span class="cm">     * @param {String} type The event being listened for</span>
<span class="cm">     * @param {Function} fn The handler to call when the event fires</span>
<span class="cm">     * @param {Object} context The context to call the handler with.</span>
<span class="cm">     * Default is the NodeList instance.</span>
<span class="cm">     * @param {Object} context The context to call the handler with.</span>
<span class="cm">     * param {mixed} arg* 0..n additional arguments to supply to the subscriber</span>
<span class="cm">     * when the event fires.</span>
<span class="cm">     * @return {Object} Returns an event handle that can later be use to detach().</span>
<span class="cm">     * @see Event.on</span>
<span class="cm">     */</span>
    <span class="nx">on</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_prepEvtArgs</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Applies an one-time event listener to each Node bound to the NodeList.</span>
<span class="cm">     * @method once</span>
<span class="cm">     * @param {String} type The event being listened for</span>
<span class="cm">     * @param {Function} fn The handler to call when the event fires</span>
<span class="cm">     * @param {Object} context The context to call the handler with.</span>
<span class="cm">     * Default is the NodeList instance.</span>
<span class="cm">     * @return {Object} Returns an event handle that can later be use to detach().</span>
<span class="cm">     * @see Event.on</span>
<span class="cm">     */</span>
    <span class="nx">once</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">once</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_prepEvtArgs</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Applies an event listener to each Node bound to the NodeList.</span>
<span class="cm">     * The handler is called only after all on() handlers are called</span>
<span class="cm">     * and the event is not prevented.</span>
<span class="cm">     * @method after</span>
<span class="cm">     * @param {String} type The event being listened for</span>
<span class="cm">     * @param {Function} fn The handler to call when the event fires</span>
<span class="cm">     * @param {Object} context The context to call the handler with.</span>
<span class="cm">     * Default is the NodeList instance.</span>
<span class="cm">     * @return {Object} Returns an event handle that can later be use to detach().</span>
<span class="cm">     * @see Event.on</span>
<span class="cm">     */</span>
    <span class="nx">after</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">after</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_prepEvtArgs</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the current number of items in the NodeList.</span>
<span class="cm">     * @method size</span>
<span class="cm">     * @return {Int} The number of items in the NodeList.</span>
<span class="cm">     */</span>
    <span class="nx">size</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Determines if the instance is bound to any nodes</span>
<span class="cm">     * @method isEmpty</span>
<span class="cm">     * @return {Boolean} Whether or not the NodeList is bound to any nodes</span>
<span class="cm">     */</span>
    <span class="nx">isEmpty</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">toString</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="nx">errorMsg</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">UID</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: not bound to any nodes&#39;</span><span class="p">,</span>
            <span class="nx">nodes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span>
            <span class="nx">node</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">nodes</span> <span class="o">&amp;&amp;</span> <span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">str</span> <span class="o">+=</span> <span class="nx">node</span><span class="p">[</span><span class="nx">NODE_NAME</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">str</span> <span class="o">+=</span> <span class="s1">&#39;...[&#39;</span> <span class="o">+</span> <span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s1">&#39; items]&#39;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">str</span> <span class="o">||</span> <span class="nx">errorMsg</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">},</span> <span class="kc">true</span><span class="p">);</span>

<span class="nx">NodeList</span><span class="p">.</span><span class="nx">importMethod</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">[</span>
    <span class="cm">/**</span>
<span class="cm">     * Called on each Node instance</span>
<span class="cm">     * @for NodeList</span>
<span class="cm">     * @method append</span>
<span class="cm">     * @see Node.append</span>
<span class="cm">     */</span>
    <span class="s1">&#39;append&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method destroy</span>
<span class="cm">      * @see Node.destroy</span>
<span class="cm">      */</span>
    <span class="s1">&#39;destroy&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">      * Called on each Node instance</span>
<span class="cm">      * @method detach</span>
<span class="cm">      * @see Node.detach</span>
<span class="cm">      */</span>
    <span class="s1">&#39;detach&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method detachAll</span>
<span class="cm">      * @see Node.detachAll</span>
<span class="cm">      */</span>
    <span class="s1">&#39;detachAll&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method empty</span>
<span class="cm">      * @see Node.empty</span>
<span class="cm">      */</span>
    <span class="s1">&#39;empty&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method insert</span>
<span class="cm">      * @see Node.insert</span>
<span class="cm">      */</span>
    <span class="s1">&#39;insert&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method prepend</span>
<span class="cm">      * @see Node.prepend</span>
<span class="cm">      */</span>
    <span class="s1">&#39;prepend&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method remove</span>
<span class="cm">      * @see Node.remove</span>
<span class="cm">      */</span>
    <span class="s1">&#39;remove&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method set</span>
<span class="cm">      * @see Node.set</span>
<span class="cm">      */</span>
    <span class="s1">&#39;set&#39;</span><span class="p">,</span>

    <span class="cm">/** Called on each Node instance</span>
<span class="cm">      * @method setContent</span>
<span class="cm">      * @see Node.setContent</span>
<span class="cm">      */</span>
    <span class="s1">&#39;setContent&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Makes each node visible.</span>
<span class="cm">     * If the &quot;transition&quot; module is loaded, show optionally</span>
<span class="cm">     * animates the showing of the node using either the default</span>
<span class="cm">     * transition effect (&#39;fadeIn&#39;), or the given named effect.</span>
<span class="cm">     * @method show</span>
<span class="cm">     * @param {String} name A named Transition effect to use as the show effect. </span>
<span class="cm">     * @param {Object} config Options to use with the transition. </span>
<span class="cm">     * @param {Function} callback An optional function to run after the transition completes. </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;show&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Hides each node.</span>
<span class="cm">     * If the &quot;transition&quot; module is loaded, hide optionally</span>
<span class="cm">     * animates the hiding of the node using either the default</span>
<span class="cm">     * transition effect (&#39;fadeOut&#39;), or the given named effect.</span>
<span class="cm">     * @method hide</span>
<span class="cm">     * @param {String} name A named Transition effect to use as the show effect. </span>
<span class="cm">     * @param {Object} config Options to use with the transition. </span>
<span class="cm">     * @param {Function} callback An optional function to run after the transition completes. </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;hide&#39;</span><span class="p">,</span>

    <span class="s1">&#39;toggleView&#39;</span>
<span class="p">]);</span>

<span class="c1">// one-off implementation to convert array of Nodes to NodeList</span>
<span class="c1">// e.g. Y.all(&#39;input&#39;).get(&#39;parentNode&#39;);</span>

<span class="cm">/** Called on each Node instance</span>
<span class="cm">  * @method get</span>
<span class="cm">  * @see Node</span>
<span class="cm">  */</span>
<span class="nx">NodeList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="nx">nodes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span>
        <span class="nx">isNodeList</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">getTemp</span> <span class="o">=</span> <span class="nx">NodeList</span><span class="p">.</span><span class="nx">_getTempNode</span><span class="p">,</span>
        <span class="nx">instance</span><span class="p">,</span>
        <span class="nx">val</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">instance</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">_yuid</span><span class="p">]</span> <span class="o">||</span> <span class="nx">getTemp</span><span class="p">(</span><span class="nx">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nx">val</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">attr</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">isNodeList</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">nodes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">instance</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">_instances</span><span class="p">[</span><span class="nx">node</span><span class="p">.</span><span class="nx">_yuid</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">instance</span> <span class="o">=</span> <span class="nx">getTemp</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">val</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">_get</span><span class="p">(</span><span class="nx">attr</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isNodeList</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// convert array of Nodes to NodeList</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">scrubVal</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">instance</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="p">(</span><span class="nx">isNodeList</span><span class="p">)</span> <span class="o">?</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">ret</span><span class="p">)</span> <span class="o">:</span> <span class="nx">ret</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">NodeList</span> <span class="o">=</span> <span class="nx">NodeList</span><span class="p">;</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">all</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">nodes</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">NodeList</span><span class="p">(</span><span class="nx">nodes</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">all</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">all</span><span class="p">;</span>
<span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span>
    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @for Node</span>
<span class="cm">     * @method removeChild</span>
<span class="cm">     * @param {HTMLElement | Node} node Node to be removed </span>
<span class="cm">     * @return {Node} The removed node </span>
<span class="cm">     */</span>
    <span class="s1">&#39;removeChild&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method hasChildNodes</span>
<span class="cm">     * @return {Boolean} Whether or not the node has any childNodes </span>
<span class="cm">     */</span>
    <span class="s1">&#39;hasChildNodes&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method cloneNode</span>
<span class="cm">     * @param {Boolean} deep Whether or not to perform a deep clone, which includes</span>
<span class="cm">     * subtree and attributes</span>
<span class="cm">     * @return {Node} The clone </span>
<span class="cm">     */</span>
    <span class="s1">&#39;cloneNode&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method hasAttribute</span>
<span class="cm">     * @param {String} attribute The attribute to test for </span>
<span class="cm">     * @return {Boolean} Whether or not the attribute is present </span>
<span class="cm">     */</span>
    <span class="s1">&#39;hasAttribute&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method removeAttribute</span>
<span class="cm">     * @param {String} attribute The attribute to be removed </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;removeAttribute&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method scrollIntoView</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;scrollIntoView&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method getElementsByTagName</span>
<span class="cm">     * @param {String} tagName The tagName to collect </span>
<span class="cm">     * @return {NodeList} A NodeList representing the HTMLCollection</span>
<span class="cm">     */</span>
    <span class="s1">&#39;getElementsByTagName&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method focus</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;focus&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method blur</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;blur&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * Only valid on FORM elements</span>
<span class="cm">     * @method submit</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;submit&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * Only valid on FORM elements</span>
<span class="cm">     * @method reset</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;reset&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * @method select</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
     <span class="s1">&#39;select&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Passes through to DOM method.</span>
<span class="cm">     * Only valid on TABLE elements</span>
<span class="cm">     * @method createCaption</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;createCaption&#39;</span>

<span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;adding: &#39;</span> <span class="o">+</span> <span class="nx">method</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;node&#39;</span><span class="p">);</span>
    <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="nx">arg3</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="nx">arg3</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">});</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">importMethod</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">,</span> <span class="p">[</span>
    <span class="cm">/**</span>
<span class="cm">     * Determines whether the node is an ancestor of another HTML element in the DOM hierarchy.</span>
<span class="cm">     * @method contains</span>
<span class="cm">     * @param {Node | HTMLElement} needle The possible node or descendent</span>
<span class="cm">     * @return {Boolean} Whether or not this node is the needle its ancestor</span>
<span class="cm">     */</span>
    <span class="s1">&#39;contains&#39;</span><span class="p">,</span>
    <span class="cm">/**</span>
<span class="cm">     * Allows setting attributes on DOM nodes, normalizing in some cases.</span>
<span class="cm">     * This passes through to the DOM node, allowing for custom attributes.</span>
<span class="cm">     * @method setAttribute</span>
<span class="cm">     * @for Node</span>
<span class="cm">     * @for NodeList</span>
<span class="cm">     * @chainable</span>
<span class="cm">     * @param {string} name The attribute name </span>
<span class="cm">     * @param {string} value The value to set</span>
<span class="cm">     */</span>
    <span class="s1">&#39;setAttribute&#39;</span><span class="p">,</span>
    <span class="cm">/**</span>
<span class="cm">     * Allows getting attributes on DOM nodes, normalizing in some cases.</span>
<span class="cm">     * This passes through to the DOM node, allowing for custom attributes.</span>
<span class="cm">     * @method getAttribute</span>
<span class="cm">     * @for Node</span>
<span class="cm">     * @for NodeList</span>
<span class="cm">     * @param {string} name The attribute name </span>
<span class="cm">     * @return {string} The attribute value </span>
<span class="cm">     */</span>
    <span class="s1">&#39;getAttribute&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Wraps the given HTML around the node.</span>
<span class="cm">     * @method wrap</span>
<span class="cm">     * @param {String} html The markup to wrap around the node. </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;wrap&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Removes the node&#39;s parent node. </span>
<span class="cm">     * @method unwrap</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="s1">&#39;unwrap&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Applies a unique ID to the node if none exists</span>
<span class="cm">     * @method generateID</span>
<span class="cm">     * @return {String} The existing or generated ID</span>
<span class="cm">     */</span>
    <span class="s1">&#39;generateID&#39;</span>
<span class="p">]);</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">NodeList</span><span class="p">.</span><span class="nx">importMethod</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">[</span>
<span class="cm">/**</span>
<span class="cm"> * Allows getting attributes on DOM nodes, normalizing in some cases.</span>
<span class="cm"> * This passes through to the DOM node, allowing for custom attributes.</span>
<span class="cm"> * @method getAttribute</span>
<span class="cm"> * @see Node</span>
<span class="cm"> * @for NodeList</span>
<span class="cm"> * @param {string} name The attribute name </span>
<span class="cm"> * @return {string} The attribute value </span>
<span class="cm"> */</span>

    <span class="s1">&#39;getAttribute&#39;</span><span class="p">,</span>
<span class="cm">/**</span>
<span class="cm"> * Allows setting attributes on DOM nodes, normalizing in some cases.</span>
<span class="cm"> * This passes through to the DOM node, allowing for custom attributes.</span>
<span class="cm"> * @method setAttribute</span>
<span class="cm"> * @see Node</span>
<span class="cm"> * @for NodeList</span>
<span class="cm"> * @chainable</span>
<span class="cm"> * @param {string} name The attribute name </span>
<span class="cm"> * @param {string} value The value to set</span>
<span class="cm"> */</span>
    <span class="s1">&#39;setAttribute&#39;</span><span class="p">,</span>
 
<span class="cm">/**</span>
<span class="cm"> * Allows for removing attributes on DOM nodes.</span>
<span class="cm"> * This passes through to the DOM node, allowing for custom attributes.</span>
<span class="cm"> * @method removeAttribute</span>
<span class="cm"> * @see Node</span>
<span class="cm"> * @for NodeList</span>
<span class="cm"> * @param {string} name The attribute to remove </span>
<span class="cm"> */</span>
    <span class="s1">&#39;removeAttribute&#39;</span><span class="p">,</span>
<span class="cm">/**</span>
<span class="cm"> * Removes the parent node from node in the list. </span>
<span class="cm"> * @method unwrap</span>
<span class="cm"> * @chainable</span>
<span class="cm"> */</span>
    <span class="s1">&#39;unwrap&#39;</span><span class="p">,</span>
<span class="cm">/**</span>
<span class="cm"> * Wraps the given HTML around each node.</span>
<span class="cm"> * @method wrap</span>
<span class="cm"> * @param {String} html The markup to wrap around the node. </span>
<span class="cm"> * @chainable</span>
<span class="cm"> */</span>
    <span class="s1">&#39;wrap&#39;</span><span class="p">,</span>

<span class="cm">/**</span>
<span class="cm"> * Applies a unique ID to each node if none exists</span>
<span class="cm"> * @method generateID</span>
<span class="cm"> * @return {String} The existing or generated ID</span>
<span class="cm"> */</span>
    <span class="s1">&#39;generateID&#39;</span>
<span class="p">]);</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">methods</span> <span class="o">=</span> <span class="p">[</span>
    <span class="cm">/**</span>
<span class="cm">     * Determines whether each node has the given className.</span>
<span class="cm">     * @method hasClass</span>
<span class="cm">     * @for Node</span>
<span class="cm">     * @param {String} className the class name to search for</span>
<span class="cm">     * @return {Boolean} Whether or not the element has the specified class </span>
<span class="cm">     */</span>
     <span class="s1">&#39;hasClass&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Adds a class name to each node.</span>
<span class="cm">     * @method addClass         </span>
<span class="cm">     * @param {String} className the class name to add to the node&#39;s class attribute</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
     <span class="s1">&#39;addClass&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Removes a class name from each node.</span>
<span class="cm">     * @method removeClass         </span>
<span class="cm">     * @param {String} className the class name to remove from the node&#39;s class attribute</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
     <span class="s1">&#39;removeClass&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Replace a class with another class for each node.</span>
<span class="cm">     * If no oldClassName is present, the newClassName is simply added.</span>
<span class="cm">     * @method replaceClass  </span>
<span class="cm">     * @param {String} oldClassName the class name to be replaced</span>
<span class="cm">     * @param {String} newClassName the class name that will be replacing the old class name</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
     <span class="s1">&#39;replaceClass&#39;</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * If the className exists on the node it is removed, if it doesn&#39;t exist it is added.</span>
<span class="cm">     * @method toggleClass  </span>
<span class="cm">     * @param {String} className the class name to be toggled</span>
<span class="cm">     * @param {Boolean} force Option to force adding or removing the class. </span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
     <span class="s1">&#39;toggleClass&#39;</span>
    <span class="p">];</span>

    <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">importMethod</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">,</span> <span class="nx">methods</span><span class="p">);</span>
    <span class="cm">/**</span>
<span class="cm">     * Determines whether each node has the given className.</span>
<span class="cm">     * @method hasClass</span>
<span class="cm">     * @see Node.hasClass</span>
<span class="cm">     * @for NodeList</span>
<span class="cm">     * @param {String} className the class name to search for</span>
<span class="cm">     * @return {Array} An array of booleans for each node bound to the NodeList. </span>
<span class="cm">     */</span>

    <span class="cm">/**</span>
<span class="cm">     * Adds a class name to each node.</span>
<span class="cm">     * @method addClass         </span>
<span class="cm">     * @see Node.addClass</span>
<span class="cm">     * @param {String} className the class name to add to the node&#39;s class attribute</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>

    <span class="cm">/**</span>
<span class="cm">     * Removes a class name from each node.</span>
<span class="cm">     * @method removeClass         </span>
<span class="cm">     * @see Node.removeClass</span>
<span class="cm">     * @param {String} className the class name to remove from the node&#39;s class attribute</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>

    <span class="cm">/**</span>
<span class="cm">     * Replace a class with another class for each node.</span>
<span class="cm">     * If no oldClassName is present, the newClassName is simply added.</span>
<span class="cm">     * @method replaceClass  </span>
<span class="cm">     * @see Node.replaceClass</span>
<span class="cm">     * @param {String} oldClassName the class name to be replaced</span>
<span class="cm">     * @param {String} newClassName the class name that will be replacing the old class name</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>

    <span class="cm">/**</span>
<span class="cm">     * If the className exists on the node it is removed, if it doesn&#39;t exist it is added.</span>
<span class="cm">     * @method toggleClass  </span>
<span class="cm">     * @see Node.toggleClass</span>
<span class="cm">     * @param {String} className the class name to be toggled</span>
<span class="cm">     * @chainable</span>
<span class="cm">     */</span>
    <span class="nx">Y</span><span class="p">.</span><span class="nx">NodeList</span><span class="p">.</span><span class="nx">importMethod</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">methods</span><span class="p">);</span>
<span class="p">})(</span><span class="nx">Y</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// IE &lt; 8</span>
    <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">attr</span> <span class="o">===</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// IE &lt; 8 fails to populate specified when set in HTML</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">attr</span><span class="p">]</span> <span class="o">&amp;&amp;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">attr</span><span class="p">].</span><span class="nx">specified</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// IE throws an error when calling focus() on an element that&#39;s invisible, not</span>
<span class="c1">// displayed, or disabled.</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">focus</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;error focusing node: &#39;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;node&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// IE throws error when setting input.type = &#39;hidden&#39;,</span>
<span class="c1">// input.setAttribute(&#39;type&#39;, &#39;hidden&#39;) and input.attributes.type.value = &#39;hidden&#39;</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">ATTRS</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">===</span> <span class="s1">&#39;hidden&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_inputType</span> <span class="o">=</span> <span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span> <span class="c1">// IE errors when changing the type from &quot;hidden&#39;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;error setting type: &#39;</span> <span class="o">+</span> <span class="nx">val</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;node&#39;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_inputType</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">_bypassProxy</span><span class="o">:</span> <span class="kc">true</span> <span class="c1">// don&#39;t update DOM when using with Attribute</span>
<span class="p">};</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">).</span><span class="nx">elements</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// IE: elements collection is also FORM node which trips up scrubVal.</span>
    <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">ATTRS</span><span class="p">.</span><span class="nx">elements</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="s1">&#39;input, textarea, button, select&#39;</span><span class="p">);</span>
            <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">ATTRS</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">offsetHeight</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">.</span><span class="nx">setHeight</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">h</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">h</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">offsetWidth</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">w</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Y</span><span class="p">.</span><span class="nx">DOM</span><span class="p">.</span><span class="nx">setWidth</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">,</span> <span class="nx">w</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">w</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_node</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">sizeTo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">node</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">w</span><span class="p">);</span>
            <span class="nx">w</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;offsetWidth&#39;</span><span class="p">);</span>
            <span class="nx">h</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;offsetHeight&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">setAttrs</span><span class="p">({</span>
            <span class="nx">offsetWidth</span><span class="o">:</span> <span class="nx">w</span><span class="p">,</span>
            <span class="nx">offsetHeight</span><span class="o">:</span> <span class="nx">h</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="kd">var</span> <span class="nx">Y_NodeList</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">NodeList</span><span class="p">,</span>
    <span class="nx">ArrayProto</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span>
    <span class="nx">ArrayMethods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="cm">/** Returns a new NodeList combining the given NodeList(s) </span>
<span class="cm">          * @for NodeList</span>
<span class="cm">          * @method concat</span>
<span class="cm">          * @param {NodeList | Array} valueN Arrays/NodeLists and/or values to</span>
<span class="cm">          * concatenate to the resulting NodeList</span>
<span class="cm">          * @return {NodeList} A new NodeList comprised of this NodeList joined with the input.</span>
<span class="cm">          */</span>
        <span class="s1">&#39;concat&#39;</span><span class="p">,</span>
        <span class="cm">/** Removes the first last from the NodeList and returns it.</span>
<span class="cm">          * @for NodeList</span>
<span class="cm">          * @method pop</span>
<span class="cm">          * @return {Node} The last item in the NodeList.</span>
<span class="cm">          */</span>
        <span class="s1">&#39;pop&#39;</span><span class="p">,</span>
        <span class="cm">/** Adds the given Node(s) to the end of the NodeList. </span>
<span class="cm">          * @for NodeList</span>
<span class="cm">          * @method push</span>
<span class="cm">          * @param {Node | DOMNode} nodeN One or more nodes to add to the end of the NodeList. </span>
<span class="cm">          */</span>
        <span class="s1">&#39;push&#39;</span><span class="p">,</span>
        <span class="cm">/** Removes the first item from the NodeList and returns it.</span>
<span class="cm">          * @for NodeList</span>
<span class="cm">          * @method shift</span>
<span class="cm">          * @return {Node} The first item in the NodeList.</span>
<span class="cm">          */</span>
        <span class="s1">&#39;shift&#39;</span><span class="p">,</span>
        <span class="cm">/** Returns a new NodeList comprising the Nodes in the given range. </span>
<span class="cm">          * @for NodeList</span>
<span class="cm">          * @method slice</span>
<span class="cm">          * @param {Number} begin Zero-based index at which to begin extraction.</span>
<span class="cm">          As a negative index, start indicates an offset from the end of the sequence. slice(-2) extracts the second-to-last element and the last element in the sequence.</span>
<span class="cm">          * @param {Number} end Zero-based index at which to end extraction. slice extracts up to but not including end.</span>
<span class="cm">          slice(1,4) extracts the second element through the fourth element (elements indexed 1, 2, and 3).</span>
<span class="cm">          As a negative index, end indicates an offset from the end of the sequence. slice(2,-1) extracts the third element through the second-to-last element in the sequence.</span>
<span class="cm">          If end is omitted, slice extracts to the end of the sequence.</span>
<span class="cm">          * @return {NodeList} A new NodeList comprised of this NodeList joined with the input.</span>
<span class="cm">          */</span>
        <span class="s1">&#39;slice&#39;</span><span class="p">,</span>
        <span class="cm">/** Changes the content of the NodeList, adding new elements while removing old elements.</span>
<span class="cm">          * @for NodeList</span>
<span class="cm">          * @method splice</span>
<span class="cm">          * @param {Number} index Index at which to start changing the array. If negative, will begin that many elements from the end.</span>
<span class="cm">          * @param {Number} howMany An integer indicating the number of old array elements to remove. If howMany is 0, no elements are removed. In this case, you should specify at least one new element. If no howMany parameter is specified (second syntax above, which is a SpiderMonkey extension), all elements after index are removed.</span>
<span class="cm">          * {Node | DOMNode| element1, ..., elementN </span>
<span class="cm">          The elements to add to the array. If you don&#39;t specify any elements, splice simply removes elements from the array.</span>
<span class="cm">          * @return {NodeList} The element(s) removed.</span>
<span class="cm">          */</span>
        <span class="s1">&#39;splice&#39;</span><span class="p">,</span>
        <span class="cm">/** Adds the given Node(s) to the beginning of the NodeList. </span>
<span class="cm">          * @for NodeList</span>
<span class="cm">          * @method push</span>
<span class="cm">          * @param {Node | DOMNode} nodeN One or more nodes to add to the NodeList. </span>
<span class="cm">          */</span>
        <span class="s1">&#39;unshift&#39;</span>
    <span class="p">];</span>


<span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">ArrayMethods</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Y_NodeList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[],</span>
            <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">arg</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="k">typeof</span> <span class="p">(</span><span class="nx">arg</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="o">++</span><span class="p">])</span> <span class="o">!=</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// use DOM nodes/nodeLists </span>
            <span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arg</span><span class="p">.</span><span class="nx">_node</span> <span class="o">||</span> <span class="nx">arg</span><span class="p">.</span><span class="nx">_nodes</span> <span class="o">||</span> <span class="nx">arg</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">scrubVal</span><span class="p">(</span><span class="nx">ArrayProto</span><span class="p">[</span><span class="nx">name</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_nodes</span><span class="p">,</span> <span class="nx">args</span><span class="p">));</span>
    <span class="p">};</span>
<span class="p">});</span>


<span class="p">},</span> <span class="s1">&#39;3.3.0&#39;</span> <span class="p">,{</span><span class="nx">requires</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;dom-base&#39;</span><span class="p">,</span> <span class="s1">&#39;selector-css2&#39;</span><span class="p">,</span> <span class="s1">&#39;event-base&#39;</span><span class="p">]});</span>
</pre></div>

							</div>
						<!-- /End/Start -->
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="aui-footer">
		Copyright &copy; 2011 Yahoo! Inc. All rights reserved.
	</div>
</div>

<script type="text/javascript">

    var ALL_YUI_PROPS = [{"url": "Node.html#method_addClass", "access": "", "host": "Node", "type": "method", "name": "addClass"}, {"url": "NodeList.html#method_addClass", "access": "", "host": "NodeList", "type": "method", "name": "addClass"}, {"url": "Node.html#method_addMethod", "access": "", "host": "Node", "type": "method", "name": "addMethod"}, {"url": "NodeList.html#method_after", "access": "", "host": "NodeList", "type": "method", "name": "after"}, {"url": "Node.html#method_all", "access": "", "host": "Node", "type": "method", "name": "all"}, {"url": "Node.html#method_ancestor", "access": "", "host": "Node", "type": "method", "name": "ancestor"}, {"url": "Node.html#method_ancestors", "access": "", "host": "Node", "type": "method", "name": "ancestors"}, {"url": "Node.html#method_append", "access": "", "host": "Node", "type": "method", "name": "append"}, {"url": "NodeList.html#method_append", "access": "", "host": "NodeList", "type": "method", "name": "append"}, {"url": "Node.html#method_appendChild", "access": "", "host": "Node", "type": "method", "name": "appendChild"}, {"url": "Node.html#method_appendTo", "access": "", "host": "Node", "type": "method", "name": "appendTo"}, {"url": "Node.html#property_ATTRS", "access": "", "host": "Node", "type": "property", "name": "ATTRS"}, {"url": "Transition.html#property_behaviors", "access": "", "host": "Transition", "type": "property", "name": "behaviors"}, {"url": "Node.html#method_blur", "access": "", "host": "Node", "type": "method", "name": "blur"}, {"url": "Node.html#config_children", "access": "", "host": "Node", "type": "config", "name": "children"}, {"url": "Node.html#method_clearData", "access": "", "host": "Node", "type": "method", "name": "clearData"}, {"url": "Node.html#method_cloneNode", "access": "", "host": "Node", "type": "method", "name": "cloneNode"}, {"url": "Node.html#method_compareTo", "access": "", "host": "Node", "type": "method", "name": "compareTo"}, {"url": "NodeList.html#method_concat", "access": "", "host": "NodeList", "type": "method", "name": "concat"}, {"url": "Node.html#method_contains", "access": "", "host": "Node", "type": "method", "name": "contains"}, {"url": "Node.html#method_create", "access": "", "host": "Node", "type": "method", "name": "create"}, {"url": "Node.html#method_createCaption", "access": "", "host": "Node", "type": "method", "name": "createCaption"}, {"url": "Node.html#method_DEFAULT_GETTER", "access": "", "host": "Node", "type": "method", "name": "DEFAULT_GETTER"}, {"url": "Transition.html#property_DEFAULT_GETTER", "access": "", "host": "Transition", "type": "property", "name": "DEFAULT_GETTER"}, {"url": "Node.html#method_DEFAULT_SETTER", "access": "", "host": "Node", "type": "method", "name": "DEFAULT_SETTER"}, {"url": "Transition.html#property_DEFAULT_SETTER", "access": "", "host": "Transition", "type": "property", "name": "DEFAULT_SETTER"}, {"url": "Transition.html#property_DEFAULT_UNIT", "access": "", "host": "Transition", "type": "property", "name": "DEFAULT_UNIT"}, {"url": "Node.html#method_delegate", "access": "", "host": "Node", "type": "method", "name": "delegate"}, {"url": "Node.html#method_destroy", "access": "", "host": "Node", "type": "method", "name": "destroy"}, {"url": "NodeList.html#method_destroy", "access": "", "host": "NodeList", "type": "method", "name": "destroy"}, {"url": "NodeList.html#method_detach", "access": "", "host": "NodeList", "type": "method", "name": "detach"}, {"url": "NodeList.html#method_detachAll", "access": "", "host": "NodeList", "type": "method", "name": "detachAll"}, {"url": "Node.html#config_docHeight", "access": "", "host": "Node", "type": "config", "name": "docHeight"}, {"url": "Node.html#config_docScrollX", "access": "", "host": "Node", "type": "config", "name": "docScrollX"}, {"url": "Node.html#config_docScrollY", "access": "", "host": "Node", "type": "config", "name": "docScrollY"}, {"url": "Node.html#property_DOM_EVENTS", "access": "", "host": "Node", "type": "property", "name": "DOM_EVENTS"}, {"url": "NodeList.html#method_each", "access": "", "host": "NodeList", "type": "method", "name": "each"}, {"url": "Node.html#method_empty", "access": "", "host": "Node", "type": "method", "name": "empty"}, {"url": "NodeList.html#method_empty", "access": "", "host": "NodeList", "type": "method", "name": "empty"}, {"url": "NodeList.html#method_even", "access": "", "host": "NodeList", "type": "method", "name": "even"}, {"url": "NodeList.html#method_filter", "access": "", "host": "NodeList", "type": "method", "name": "filter"}, {"url": "Node.html#method_focus", "access": "", "host": "Node", "type": "method", "name": "focus"}, {"url": "Node.html#method_generateID", "access": "", "host": "Node", "type": "method", "name": "generateID"}, {"url": "NodeList.html#method_generateID", "access": "", "host": "NodeList", "type": "method", "name": "generateID"}, {"url": "Node.html#method_get", "access": "", "host": "Node", "type": "method", "name": "get"}, {"url": "NodeList.html#method_get", "access": "", "host": "NodeList", "type": "method", "name": "get"}, {"url": "Node.html#method_getAttribute", "access": "", "host": "Node", "type": "method", "name": "getAttribute"}, {"url": "NodeList.html#method_getAttribute", "access": "", "host": "NodeList", "type": "method", "name": "getAttribute"}, {"url": "Node.html#method_getAttrs", "access": "", "host": "Node", "type": "method", "name": "getAttrs"}, {"url": "Node.html#method_getComputedStyle", "access": "", "host": "Node", "type": "method", "name": "getComputedStyle"}, {"url": "NodeList.html#method_getComputedStyle", "access": "", "host": "NodeList", "type": "method", "name": "getComputedStyle"}, {"url": "Node.html#method_getContent", "access": "", "host": "Node", "type": "method", "name": "getContent"}, {"url": "Node.html#method_getData", "access": "", "host": "Node", "type": "method", "name": "getData"}, {"url": "Node.html#method_getDOMNode", "access": "", "host": "Node", "type": "method", "name": "getDOMNode"}, {"url": "Node.html#method_getElementsByTagName", "access": "", "host": "Node", "type": "method", "name": "getElementsByTagName"}, {"url": "Node.html#method_getStyle", "access": "", "host": "Node", "type": "method", "name": "getStyle"}, {"url": "NodeList.html#method_getStyle", "access": "", "host": "NodeList", "type": "method", "name": "getStyle"}, {"url": "Node.html#method_getX", "access": "", "host": "Node", "type": "method", "name": "getX"}, {"url": "Node.html#method_getXY", "access": "", "host": "Node", "type": "method", "name": "getXY"}, {"url": "Node.html#method_getY", "access": "", "host": "Node", "type": "method", "name": "getY"}, {"url": "Node.html#method_hasAttribute", "access": "", "host": "Node", "type": "method", "name": "hasAttribute"}, {"url": "Node.html#method_hasChildNodes", "access": "", "host": "Node", "type": "method", "name": "hasChildNodes"}, {"url": "Node.html#method_hasClass", "access": "", "host": "Node", "type": "method", "name": "hasClass"}, {"url": "NodeList.html#method_hasClass", "access": "", "host": "NodeList", "type": "method", "name": "hasClass"}, {"url": "Node.html#method__hide", "access": "protected", "host": "Node", "type": "method", "name": "_hide"}, {"url": "Node.html#method_hide", "access": "", "host": "Node", "type": "method", "name": "hide"}, {"url": "NodeList.html#method_hide", "access": "", "host": "NodeList", "type": "method", "name": "hide"}, {"url": "Node.html#method_importMethod", "access": "", "host": "Node", "type": "method", "name": "importMethod"}, {"url": "NodeList.html#method_indexOf", "access": "", "host": "NodeList", "type": "method", "name": "indexOf"}, {"url": "Node.html#method_inDoc", "access": "", "host": "Node", "type": "method", "name": "inDoc"}, {"url": "Node.html#method_inRegion", "access": "", "host": "Node", "type": "method", "name": "inRegion"}, {"url": "Node.html#method_insert", "access": "", "host": "Node", "type": "method", "name": "insert"}, {"url": "NodeList.html#method_insert", "access": "", "host": "NodeList", "type": "method", "name": "insert"}, {"url": "Node.html#method_insertBefore", "access": "", "host": "Node", "type": "method", "name": "insertBefore"}, {"url": "Node.html#method_intersect", "access": "", "host": "Node", "type": "method", "name": "intersect"}, {"url": "Transition.html#property_intervalTime", "access": "", "host": "Transition", "type": "property", "name": "intervalTime"}, {"url": "Node.html#method_invoke", "access": "", "host": "Node", "type": "method", "name": "invoke"}, {"url": "NodeList.html#method_isEmpty", "access": "", "host": "NodeList", "type": "method", "name": "isEmpty"}, {"url": "NodeList.html#method_item", "access": "", "host": "NodeList", "type": "method", "name": "item"}, {"url": "NodeList.html#method_modulus", "access": "", "host": "NodeList", "type": "method", "name": "modulus"}, {"url": "Node.html#property_NAME", "access": "", "host": "Node", "type": "property", "name": "NAME"}, {"url": "Node.html#method_next", "access": "", "host": "Node", "type": "method", "name": "next"}, {"url": "NodeList.html#method_NodeList.getDOMNodes", "access": "", "host": "NodeList", "type": "method", "name": "NodeList.getDOMNodes"}, {"url": "Node.html#method_Node.plug", "access": "", "host": "Node", "type": "method", "name": "Node.plug"}, {"url": "Node.html#method_Node.unplug", "access": "", "host": "Node", "type": "method", "name": "Node.unplug"}, {"url": "NodeList.html#method_odd", "access": "", "host": "NodeList", "type": "method", "name": "odd"}, {"url": "NodeList.html#method_on", "access": "", "host": "NodeList", "type": "method", "name": "on"}, {"url": "NodeList.html#method_once", "access": "", "host": "NodeList", "type": "method", "name": "once"}, {"url": "Node.html#method_one", "access": "", "host": "Node", "type": "method", "name": "one"}, {"url": "NodeList.html#method_parse", "access": "", "host": "NodeList", "type": "method", "name": "parse"}, {"url": "NodeList.html#method_pop", "access": "", "host": "NodeList", "type": "method", "name": "pop"}, {"url": "Node.html#method_prepend", "access": "", "host": "Node", "type": "method", "name": "prepend"}, {"url": "NodeList.html#method_prepend", "access": "", "host": "NodeList", "type": "method", "name": "prepend"}, {"url": "Node.html#method_previous", "access": "", "host": "Node", "type": "method", "name": "previous"}, {"url": "Node.html#method_purge", "access": "", "host": "Node", "type": "method", "name": "purge"}, {"url": "NodeList.html#method_push", "access": "", "host": "NodeList", "type": "method", "name": "push"}, {"url": "Transition.html#property_RE_DEFAULT_UNIT", "access": "", "host": "Transition", "type": "property", "name": "RE_DEFAULT_UNIT"}, {"url": "NodeList.html#method_refresh", "access": "", "host": "NodeList", "type": "method", "name": "refresh"}, {"url": "Node.html#config_region", "access": "", "host": "Node", "type": "config", "name": "region"}, {"url": "Node.html#method_remove", "access": "", "host": "Node", "type": "method", "name": "remove"}, {"url": "NodeList.html#method_remove", "access": "", "host": "NodeList", "type": "method", "name": "remove"}, {"url": "Node.html#method_removeAttribute", "access": "", "host": "Node", "type": "method", "name": "removeAttribute"}, {"url": "NodeList.html#method_removeAttribute", "access": "", "host": "NodeList", "type": "method", "name": "removeAttribute"}, {"url": "Node.html#method_removeChild", "access": "", "host": "Node", "type": "method", "name": "removeChild"}, {"url": "Node.html#method_removeClass", "access": "", "host": "Node", "type": "method", "name": "removeClass"}, {"url": "NodeList.html#method_removeClass", "access": "", "host": "NodeList", "type": "method", "name": "removeClass"}, {"url": "Node.html#method_replace", "access": "", "host": "Node", "type": "method", "name": "replace"}, {"url": "Node.html#method_replaceChild", "access": "", "host": "Node", "type": "method", "name": "replaceChild"}, {"url": "Node.html#method_replaceClass", "access": "", "host": "Node", "type": "method", "name": "replaceClass"}, {"url": "NodeList.html#method_replaceClass", "access": "", "host": "NodeList", "type": "method", "name": "replaceClass"}, {"url": "Node.html#method_reset", "access": "", "host": "Node", "type": "method", "name": "reset"}, {"url": "Node.html#method_scrollIntoView", "access": "", "host": "Node", "type": "method", "name": "scrollIntoView"}, {"url": "Node.html#method_scrubVal", "access": "", "host": "Node", "type": "method", "name": "scrubVal"}, {"url": "Node.html#method_select", "access": "", "host": "Node", "type": "method", "name": "select"}, {"url": "Node.html#method_set", "access": "", "host": "Node", "type": "method", "name": "set"}, {"url": "NodeList.html#method_set", "access": "", "host": "NodeList", "type": "method", "name": "set"}, {"url": "Node.html#method_setAttribute", "access": "", "host": "Node", "type": "method", "name": "setAttribute"}, {"url": "NodeList.html#method_setAttribute", "access": "", "host": "NodeList", "type": "method", "name": "setAttribute"}, {"url": "Node.html#method_setAttrs", "access": "", "host": "Node", "type": "method", "name": "setAttrs"}, {"url": "Node.html#method_setContent", "access": "", "host": "Node", "type": "method", "name": "setContent"}, {"url": "NodeList.html#method_setContent", "access": "", "host": "NodeList", "type": "method", "name": "setContent"}, {"url": "Node.html#method_setData", "access": "", "host": "Node", "type": "method", "name": "setData"}, {"url": "Node.html#method_setStyle", "access": "", "host": "Node", "type": "method", "name": "setStyle"}, {"url": "NodeList.html#method_setStyle", "access": "", "host": "NodeList", "type": "method", "name": "setStyle"}, {"url": "Node.html#method_setStyles", "access": "", "host": "Node", "type": "method", "name": "setStyles"}, {"url": "NodeList.html#method_setStyles", "access": "", "host": "NodeList", "type": "method", "name": "setStyles"}, {"url": "Node.html#method_setX", "access": "", "host": "Node", "type": "method", "name": "setX"}, {"url": "Node.html#method_setXY", "access": "", "host": "Node", "type": "method", "name": "setXY"}, {"url": "Node.html#method_setY", "access": "", "host": "Node", "type": "method", "name": "setY"}, {"url": "NodeList.html#method_shift", "access": "", "host": "NodeList", "type": "method", "name": "shift"}, {"url": "Node.html#method__show", "access": "protected", "host": "Node", "type": "method", "name": "_show"}, {"url": "Node.html#method_show", "access": "", "host": "Node", "type": "method", "name": "show"}, {"url": "NodeList.html#method_show", "access": "", "host": "NodeList", "type": "method", "name": "show"}, {"url": "Node.html#method_siblings", "access": "", "host": "Node", "type": "method", "name": "siblings"}, {"url": "NodeList.html#method_size", "access": "", "host": "NodeList", "type": "method", "name": "size"}, {"url": "NodeList.html#method_slice", "access": "", "host": "NodeList", "type": "method", "name": "slice"}, {"url": "NodeList.html#method_some", "access": "", "host": "NodeList", "type": "method", "name": "some"}, {"url": "NodeList.html#method_splice", "access": "", "host": "NodeList", "type": "method", "name": "splice"}, {"url": "Node.html#method_submit", "access": "", "host": "Node", "type": "method", "name": "submit"}, {"url": "Node.html#method_swap", "access": "", "host": "Node", "type": "method", "name": "swap"}, {"url": "Node.html#method_swapXY", "access": "", "host": "Node", "type": "method", "name": "swapXY"}, {"url": "Node.html#method_test", "access": "", "host": "Node", "type": "method", "name": "test"}, {"url": "Node.html#config_text", "access": "", "host": "Node", "type": "config", "name": "text"}, {"url": "NodeList.html#method_toFrag", "access": "", "host": "NodeList", "type": "method", "name": "toFrag"}, {"url": "Node.html#method_toggleClass", "access": "", "host": "Node", "type": "method", "name": "toggleClass"}, {"url": "NodeList.html#method_toggleClass", "access": "", "host": "NodeList", "type": "method", "name": "toggleClass"}, {"url": "Node.html#method_toString", "access": "", "host": "Node", "type": "method", "name": "toString"}, {"url": "Node.html#method_transition", "access": "", "host": "Node", "type": "method", "name": "transition"}, {"url": "NodeList.html#method_transition", "access": "", "host": "NodeList", "type": "method", "name": "transition"}, {"url": "Node.html#method_unwrap", "access": "", "host": "Node", "type": "method", "name": "unwrap"}, {"url": "NodeList.html#method_unwrap", "access": "", "host": "NodeList", "type": "method", "name": "unwrap"}, {"url": "NodeList.html#property_useNativeParse", "access": "", "host": "NodeList", "type": "property", "name": "useNativeParse"}, {"url": "Node.html#config_viewportRegion", "access": "", "host": "Node", "type": "config", "name": "viewportRegion"}, {"url": "Node.html#config_winHeight", "access": "", "host": "Node", "type": "config", "name": "winHeight"}, {"url": "Node.html#config_winWidth", "access": "", "host": "Node", "type": "config", "name": "winWidth"}, {"url": "Node.html#method_wrap", "access": "", "host": "Node", "type": "method", "name": "wrap"}, {"url": "NodeList.html#method_wrap", "access": "", "host": "NodeList", "type": "method", "name": "wrap"}, {"url": "Node.html#method_Y.one", "access": "", "host": "Node", "type": "method", "name": "Y.one"}];
</script>
</body>
</html>
