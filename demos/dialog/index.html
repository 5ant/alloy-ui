<!DOCTYPE html>

<html>
<head>
	<script src="../../lib/yui/build/yui/yui.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../src/javascript/defaults.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../src/javascript/core.js" type="text/javascript" charset="utf-8"></script>

	<link rel="stylesheet" href="../../themes/base/css/main.css" type="text/css" media="screen" title="no title" charset="utf-8" />
</head>

<style type="text/css" media="screen">
body {
	font-size: 12px;
}
</style>

<body>
<h1>Alloy - Dialog</h1>

<p><button id="showAll">Show All</button></p>
<p><button id="hideAll">Hide All</button></p>
<p><button id="alignHere">Align here</button></p>
<p><button id="createNew">Create a new Dialog</button></p>

<script type="text/javascript" charset="utf-8">

AUI().ready('dialog', 'overlay-manager', 'io-stdmod', 'dd-constrain', function(A) {

	var options = {
		title: 'Dialog',
		bodyContent: 'Testing body',
		// centered: true,
		constrain2view: true,
		draggable: true,
		// destroyOnClose: true,
		group: 'default',
		stack: true,
		// shim: true,
		width: 500,
		// zIndex: 0,
		buttons: [
			{
				text: 'Change title',
				handler: function() {
					this.set('title', 'Dialog - new title');
				}
			},
			{
				text: 'Change body',
				handler: function() {
					this.set('bodyContent', 'New body content');
				}
			},
			{
				text: 'Toggle stack',
				handler: function() {
					this.set('stack', !this.get('stack'));
				}
			},
			{
				text: 'Refresh content',
				handler: function() {
					this.io.refresh();
				}
			}
		]
	};

	var dialog1 = new A.Dialog(
		A.merge(options, {
			title: 'Dialog 1',
			xy: [200, 50],
			io: {
				url: 'assets/content.html',
				formatter: function(v) {
					return '<b>' + v + '</b>';
				}
			}
		})
	)
	.render();

	var dialog2 = new A.Dialog(
		A.merge(options, {
			title: 'Dialog 2',
			// title: false,
			xy: [225, 100],
			io: {
				url: 'assets/content.html',
				cfg: {
					data: 'foo=bar&bar=foo',
					on: {
						success: function(id, o) {
							// overloading the this._defSuccessHandler
							this._defSuccessHandler.apply(this, arguments);
						},
						render: function() {
							console.log('render');
						}
					}
				}
			}
		})
	)
	.render();

	var dialog3 = new A.Dialog(
		A.merge(options, {
			title: 'Dialog 3 - no buttons',
			xy: [250, 150],
			buttons: null,
			io: {
				url: 'assets/content.html'
			}
		})
	)
	.render();

	var dialog4 = new A.Dialog(
		A.merge(options, {
			collapsible: true,
			title: 'Dialog 4 - Collapsible',
			xy: [275, 200],
			buttons: null,
			io: {
				url: 'assets/content.html'
			}
		})
	)
	.render();

	var dialog5 = new A.Dialog(
		A.merge(options, {
			close: false,
			tools: [
				{
					icon: 'pin-l',
					id: 'pin',
					activeState: true,
					handler: function(event, tool) {
						var instance = this;

						var pinned = !instance.StateInteraction.get('active');
						var cursor = 'move';
						var icon = 'pin-l';

						if (pinned) {
							cursor = 'default';
							icon = 'pin-b';
						}

						dialog5.get('dragInstance').set('lock', pinned);

						dialog5.headerNode.setStyle('cursor', cursor);
						tool.set('icon', icon);
					}
				}
			],
			title: 'Dialog 5 - Pinnable (uses custom tools option)',
			xy: [300, 250],
			buttons: null,
			io: {
				url: 'assets/content.html'
			}
		})
	)
	.render();

	A.get('#createNew').on('click', function() {
		var dialog = new A.Dialog(
			A.merge(options, {
				title: 'New Dialog',
				xy: [150, 150],
				modal: true,
				io: {
					autoRefresh: false,
					url: 'assets/content.html'
				}
			})
		)
		.render();

		// manually refresh
		dialog.io.refresh();
	});

	A.get('#showAll').on('click', function() {
		A.DialogManager.showAll();
	});

	A.get('#hideAll').on('click', function() {
		A.DialogManager.hideAll();
	});

	A.get('#alignHere').on('click', function() {
		dialog1.set('align', { node: '#alignHere', points: [ 'tl', 'tr' ]});
	});

});

</script>

</body>
</html>