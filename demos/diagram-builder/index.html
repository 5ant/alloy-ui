<!DOCTYPE html>

<html>
<head>
	<script src="../../build/aui/aui.js" type="text/javascript"></script>

	<link rel='stylesheet' href='../../build/aui-skin-classic/css/aui-skin-classic-all-min.css' type='text/css' media='screen' />

	<style type="text/css" media="screen">
		body {
			font-size: 12px;
		}

		#wrapper {
			padding: 10px;
		}

		#markupTabs {
			width: 250px;
		}


		.aui-diagram-builder-base-drop-container .aui-diagram-node-editing .aui-diagram-node-content {
			background-color: lightyellow !important;
		}

		.aui-diagram-builder-base-viewport {
			position: relative;
			background-image: url("checker-bg.png");
			outline: 0;

			border-left: 1px solid #CCCCCC;
		    border-right: 1px solid #BBBBBB;

		    border-bottom: 1px solid #BBBBBB;
		    border-top: 1px solid #CCCCCC;
		}

		.aui-diagram-node {
			z-index: 10 !important;
		}

		.aui-diagram-node-content {
			background-color: #D5E1DD;
			border: 2px solid #747E80;
			border-radius: 15px;
		}

		.aui-diagram-builder-connector-wrapper {
			z-index: 1;
		}

		.aui-diagram-builder-anchor-node {
			width: 15px;
			height: 15px;
			background: #2B3E42;
			position: absolute;
/*			border: 1px solid #2B3E42;*/
			cursor: pointer;
			border-radius: 12px;
		}

		.aui-diagram-builder-anchor-hover {
			background: green;
		}

		.aui-diagram-builder-anchor-node.yui3-dd-dragging {
			background: yellow;
		}

		.aui-diagram-builder-anchor-node.yui3-dd-drop-active-valid {
			background: green;
		}

		.aui-diagram-builder-anchor-node.yui3-dd-drop-over {
			background: #F7F3E8;
			border: 2px solid #747E80;
			-moz-transform: scale(1.3);
			-moz-transition:-moz-transform 0.4s ease-in-out;
			-moz-transition: background-color 0.4s linear;
			-webkit-transform: scale(1.3);
			-webkit-transition:-moz-transform 0.4s ease-in-out;
			-webkit-transition: background-color 0.4s linear;
		}

		.aui-diagram-node-content {
			padding: 10px;
		}

		.log {
			width: 300px;
			font-size: 10px;
		}

		.aui-diagram-builder-controls {
			display: none;
		}

		.aui-diagram-node-selected .aui-diagram-builder-controls {
			display: block;
			text-align: center;
			padding: 3px;
		}

		.aui-diagram-node-controls-icon {
			display: inline-block;
		    margin-top: -3px;
		    vertical-align: middle;
		}

		.aui-diagram-node-selected {
			border: 1px dotted #666;
		}

		.aui-diagram-node-selected .aui-diagram-node-content {
/*			background-color: lightgreen !important;*/
/*			border-radius: 15px;*/
/*			border: 1px dotted #666;*/
		}

		.aui-diagram-node-focused {
			outline: 0;
		}

		.aui-diagram-node-focused .aui-diagram-node-content {
/*			background-color: lightyellow !important;*/
		}
	</style>
</head>

<body class='yui3-skin-sam'>

<div id="wrapper">
	<h1>Alloy - diagram-builder-base Demo</h1>

	<div id="demo">

		<div id="diagrambuilderBB" class="aui-diagram-builder-base">
			<div id="diagrambuilderCB" class="aui-helper-clearfix aui-diagram-builder-base-content">

				<div class="aui-diagram-builder-base-tabs-container">
					<div class="aui-diagram-builder-base-tabs-container-content">
						<ul class="aui-tabview-list aui-widget-hd">
							<li class="aui-tab aui-state-default aui-state-active aui-tab-active aui-diagram-builder-base-tab-add">
								<span class="aui-tab-content"><a class="aui-tab-label" href="javascript:;">Add node</a></span>
							</li>
							<li class="aui-tab aui-state-default aui-diagram-builder-base-tab-settings">
								<span class="aui-tab-content"><a class="aui-tab-label" href="javascript:;">Node settings</a></span>
							</li>
						</ul>

						<div class="aui-tabview-content aui-widget-bd">
							<div class="aui-tabview-content-item"></div>
							<div class="aui-tabview-content-item aui-helper-hidden"></div>
						</div>
					</div>
				</div>

				<div class="aui-diagram-builder-base-viewport">
					<div class="aui-diagram-builder-base-drop-container"></div>
				</div>

			</div>
		</div>

		<br/>
		<br/>
		<br/>

		<div id="diagramBuilder2"></div>

	</div>
</div>

<script type="text/javascript" charset="utf-8">

AUI().use('aui-diagram-builder', function(A) {

	var availableFields = [
		{
			type: 'node',
			label: 'Node',
			iconClass: 'node-icon'
		},
		{
			type: 'task',
			label: 'Task',
			iconClass: 'task-icon'
		}
	];

	node = new A.DiagramNode({
		bodyContent: 'Node',
		xy: [400, 200],
		fields: [
			{},
			{}
		]
	});

	diagramBuilder1 = new A.DiagramBuilder(
		{
			boundingBox: '#diagrambuilderBB',
			srcNode: '#diagrambuilderCB',
			// height: 600,
			availableFields: availableFields,
			fields: [
				node,
				{
					bodyContent: 'Node1',
					xy: [200, 200],
					fields: [
						{},
						{}
					]
				},
				{
					bodyContent: 'Node2',
					fields: [
						{},
						{}
					]
				},
				{
					xy: [600, 200],
					bodyContent: 'Node3',
					fields: [
						{},
						{},
						{},
						{}
					]
				}
			]
		}
	).render();

	diagramBuilder2 = new A.DiagramBuilder(
		{
			after: {
				cancel: function(event) {
					console.log('cancel', event);
				},

				save: function(event) {
					console.log('save', event);
				},

				addField: function(event) {
					// console.log('addField', event);
				}
			},
			availableFields: availableFields,

			fields: [
				{
					bodyContent: 'Node1',
					xy: [200, 200]
				},
				{
					bodyContent: 'Node2'
				}
			],
			// fields: new A.ArrayList([{a:1}, {a:2}]),

			// propertyList: {
			// 	recordset: [
			// 		{
			// 			name: 'Text1',
			// 			value: 'Text value'
			// 		},
			// 		{
			// 			name: 'Text2',
			// 			value: 'Text value'
			// 		},
			// 		{
			// 			name: 'Text3',
			// 			value: 'Text value'
			// 		}
			// 	]
			// }
		}
	).render('#diagramBuilder2');

	// diagramBuilder2.set('height', 1000);
	// diagramBuilder2.set('fields', [1,2]);
	// diagramBuilder2.addField({bodyContent:'ABC'});

	// console.log(diagramBuilder2.get('fields'));

});

</script>

</body>
</html>