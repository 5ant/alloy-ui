--- pluginhost.js.orig	2009-08-19 00:35:46.000000000 -0300
+++ pluginhost.js	2009-08-22 19:01:19.000000000 -0300
@@ -174,6 +174,7 @@
             if (PluginClass && PluginClass.NS) {
                 var ns = PluginClass.NS;
     
+				this._plugins = this._plugins || {};
                 config = config || {};
                 config.host = this;
     
@@ -199,14 +200,14 @@
             var ns = plugin, 
                 plugins = this._plugins;
     
-            if (L.isFunction(plugin)) {
+            if (plugins && L.isFunction(plugin)) {
                 ns = plugin.NS;
                 if (ns && (!plugins[ns] || plugins[ns] !== plugin)) {
                     ns = null;
                 }
             }
     
-            if (ns) {
+            if (ns && plugins) {
                 if (this[ns]) {
                     this[ns].destroy();
                     delete this[ns];
